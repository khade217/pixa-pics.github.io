(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{727:function(e,t,n){"use strict";!function(e,r,a){function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e){if("function"==typeof Symbol){if(Symbol.asyncIterator){var t=e[Symbol.asyncIterator];if(null!=t)return t.call(e)}if(Symbol.iterator)return e[Symbol.iterator]()}throw new TypeError("Object is not async iterable")}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function c(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,n){return function r(a,s){var i,o;try{o=(i=t[a](s)).value}catch(u){return void n(u)}if(!i.done)return Promise.resolve(o).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(o)}("next")}))}}function p(e,t,n){return e=e.split("."),t=t.split("."),he(e[0],t[0])||he(e[1],t[1])||(t[2]=t.slice(2).join("."),(n=/[.-]/.test(e[2]=e.slice(2).join(".")))==/[.-]/.test(t[2])?he(e[2],t[2]):n?-1:1)}function f(e,t,n){return t.startsWith("http://")||t.startsWith("https://")?n?e:t:e+t}function l(e){var t={};return e.forEach((function(e){var n=e.api_name,r=e.id;n&&(t[n]=r)})),t}function h(e){if(e.startsWith("http")){var t=new URL(e),n=t.protocol,r=t.host,a=t.pathname;return r.endsWith("hf.space")?{ws_protocol:"wss",host:r,http_protocol:n}:{ws_protocol:"https:"===n?"wss":"ws",http_protocol:n,host:r+("/"!==a?a:"")}}return e.startsWith("file:")?{ws_protocol:"ws",http_protocol:"http:",host:"lite.local"}:{ws_protocol:"wss",http_protocol:"https:",host:e}}function d(e,t,n){var r={named_endpoints:{},unnamed_endpoints:{}};return Object.keys(e).forEach((function(a){"named_endpoints"!==a&&"unnamed_endpoints"!==a||(r[a]={},Object.entries(e[a]).forEach((function(e){var s,i,o,u,c,p,f=D(e,2),l=f[0],h=f[1],d=h.parameters,v=h.returns,b=(null==(s=t.dependencies.find((function(e){return e.api_name===l||e.api_name===l.replace("/","")})))?void 0:s.id)||n[l.replace("/","")]||-1,_=-1!==b?null==(i=t.dependencies.find((function(e){return e.id==b})))?void 0:i.types:{continuous:!1,generator:!1,cancel:!1};if(-1!==b&&(null==(u=null==(o=t.dependencies.find((function(e){return e.id==b})))?void 0:o.inputs)?void 0:u.length)!==d.length){c=t.dependencies.find((function(e){return e.id==b})).inputs.map((function(e){var n;return null==(n=t.components.find((function(t){return t.id===e})))?void 0:n.type}));try{c.forEach((function(e,t){"state"===e&&d.splice(t,0,{component:"state",example:null,parameter_default:null,parameter_has_default:!0,parameter_name:null,hidden:!0})}))}catch(w){console.error(w)}}p=function(e,t,n,r){return T({},e,{description:g(null==e?void 0:e.type,n),type:m(null==e?void 0:e.type,t,n,r)||""})},r[a][l]={parameters:d.map((function(e){return p(e,null==e?void 0:e.component,null==e?void 0:e.serializer,"parameter")})),returns:v.map((function(e){return p(e,null==e?void 0:e.component,null==e?void 0:e.serializer,"return")})),type:_}})))})),r}function m(e,t,n,r){switch(null==e?void 0:e.type){case"string":return"string";case"boolean":return"boolean";case"number":return"number"}return"JSONSerializable"===n||"StringSerializable"===n?"any":"ListStringSerializable"===n?"string[]":"Image"===t?"parameter"===r?"Blob | File | Buffer":"string":"FileSerializable"===n?"array"===(null==e?void 0:e.type)?"parameter"===r?"(Blob | File | Buffer)[]":"{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}[]":"parameter"===r?"Blob | File | Buffer":"{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}":"GallerySerializable"===n?"parameter"===r?"[(Blob | File | Buffer), (string | null)][]":"[{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}, (string | null))][]":void 0}function g(e,t){return"GallerySerializable"===t?"array of [file, label] tuples":"ListStringSerializable"===t?"array of strings":"FileSerializable"===t?"array of files or single file":null==e?void 0:e.description}function v(e,t){var n=!0;switch(e.msg){case"send_data":return{type:"data"};case"send_hash":return{type:"hash"};case"queue_full":return{type:"update",status:{queue:n,message:ye,stage:"error",code:e.code,success:e.success}};case"heartbeat":return{type:"heartbeat"};case"unexpected_error":return{type:"unexpected_error",status:{queue:n,message:e.message,stage:"error",success:!1}};case"estimation":return{type:"update",status:{queue:n,stage:t||"pending",code:e.code,size:e.queue_size,position:e.rank,eta:e.rank_eta,success:e.success}};case"progress":return{type:"update",status:{queue:n,stage:"pending",code:e.code,progress_data:e.progress_data,success:e.success}};case"log":return{type:"log",data:e};case"process_generating":return{type:"generating",status:{queue:n,message:e.success?null:e.output.error,stage:e.success?"generating":"error",code:e.code,progress_data:e.progress_data,eta:e.average_duration},data:e.success?e.output:null};case"process_completed":return"error"in e.output?{type:"update",status:{queue:n,message:e.output.error,stage:"error",code:e.code,success:e.success}}:{type:"complete",status:{queue:n,message:e.success?void 0:e.output.error,stage:e.success?"complete":"error",code:e.code,progress_data:e.progress_data,changed_state_ids:e.success?e.output.changed_state_ids:void 0},data:e.success?e.output:null};case"process_starts":return{type:"update",status:{queue:n,stage:"pending",code:e.code,size:e.rank,position:0,success:e.success,eta:e.eta}}}return{type:"none",status:{stage:"error",queue:n}}}function b(e,t,n){for(var r,a;n.length>1;){if("string"!=typeof(r=n.shift())&&"number"!=typeof r)throw Error("Invalid key type");e=e[r]}if("string"!=typeof(a=n.shift())&&"number"!=typeof a)throw Error("Invalid key type");e[a]=t}function _(e,t){var n,r,a=null==(r=null==(n=null==t?void 0:t.dependencies)?void 0:n.find((function(t){return t.id==e})))?void 0:r.queue;return null!=a?!a:!t.enable_queue}function w(e,t){return new Promise((function(n,r){var a=new MessageChannel;a.port1.onmessage=function(e){var t=e.data;a.port1.close(),n(t)},window.parent.postMessage(e,t,[a.port2])}))}function x(e,t,n,r){var a,s,i,o,u=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("input"===r&&!u)throw Error("Invalid code path. Cannot skip state inputs for input.");if("output"===r&&u)return e;for(a=[],s=0,i=function(r){var i,o,c=t.inputs[r],p=n.find((function(e){return e.id===c}));if("state"===(null==p?void 0:p.type))return u?(e.length===t.inputs.length?(i=e[s],a.push(i),s++):a.push(null),"continue"):(s++,"continue");o=e[s],a.push(o),s++},o=0;o<t.inputs.length;o++)i(o);return a}function y(e){var t=e.match(/https:\/\/huggingface.co\/spaces\/([^/]+\/[^/]+)/);if(t)return t[1]}function k(e){var t=/[:]\s*/.exec(e),n=t&&t.index;if(n)return[e.substring(0,n),e.substring(n+t[0].length)]}function R(e,t,n){e.get(t)||e.set(t,n)}function S(e,t){e&&(e.open=!1,null==t||t.abort())}function E(e,t,n){e[t]?n.data.forEach((function(r,a){var s,i=(s=e[t][a],r.forEach((function(e){var t=D(e,3),n=t[0],r=t[1],a=t[2];s=function(e,t,n,r){var a,s,i;if(0===t.length){if("replace"===n)return r;if("append"===n)return e+r;throw Error("Unsupported action: "+n)}for(a=e,s=0;s<t.length-1;s++)a=a[t[s]];switch(i=t[t.length-1],n){case"replace":a[i]=r;break;case"append":a[i]+=r;break;case"add":Array.isArray(a)?a.splice(Number(i),0,r):a[i]=r;break;case"delete":Array.isArray(a)?a.splice(Number(i),1):delete a[i];break;default:throw Error("Unknown action: "+n)}return e}(s,r,n,a)})),s);e[t][a]=i,n.data[a]=i})):(e[t]=[],n.data.forEach((function(n,r){e[t][r]=n})))}function j(e,t,n,r,a){var i,o,l,h,d,m,g,b,y,k,R,j,O,P,C,q,z,N,A,F,I,L,U,J,W,G,M,$,H,Z,K,V,Y,Q,X,ee,te,ne,re,ae,se,ie,oe,ue,ce,pe,fe,le,he,de,me,ge=this;try{if(me=c(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(te=t={stage:"complete",queue:!1,time:new Date},d(T({},t,{type:"status",endpoint:Q,fn_index:M})),n={},r={},"ws"===Y?(K&&0===K.readyState?K.addEventListener("open",(function(){K.close()})):K.close(),n={fn_index:M,session_hash:C}):(S(N,W.abort_controller),m(),n={event_id:ee},r={event_id:ee,session_hash:C,fn_index:M}),e.prev=6,P){e.next=9;break}throw Error("Could not resolve app config");case 9:if(!("event_id"in r)){e.next=12;break}return e.next=12,j(P.root+"/cancel",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(r)});case 12:return e.next=14,j(P.root+"/reset",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(n)});case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(6),console.warn("The `/reset` endpoint could not be called. Subsequent endpoint results may be unreliable.");case 19:case"end":return e.stop()}}),e,this,[[6,16]])}))),l=function(){return me.apply(this,arguments)},de=c(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P){e.next=2;break}return e.abrupt("return");case 2:return n=t.render_id,P.components=[].concat(u(P.components.filter((function(e){return e.props.rendered_in!==n}))),u(t.components)),P.dependencies=[].concat(u(P.dependencies.filter((function(e){return e.rendered_in!==n}))),u(t.dependencies)),r=P.components.some((function(e){return"state"===e.type})),a=P.dependencies.some((function(e){return e.targets.some((function(e){return"unload"===e[1]}))})),P.connect_heartbeat=r||a,e.next=10,se(P);case 10:d({type:"render",data:t,endpoint:Q,fn_index:M});case 11:case"end":return e.stop()}}),e,this)}))),h=function(e){return de.apply(this,arguments)},d=function(e){(a||ae[e.type])&&y(e)},m=function(){for(ie=!0;ue.length>0;)ue.shift()({value:void 0,done:!0})},g=function(e){ie||(ue.length>0?ue.shift()(e):oe.push(e))},b=function(e){g(function(e){return{then:function(t,n){return n(e)}}}(e)),m()},y=function(e){g({value:e,done:!1})},k=function(){return oe.length>0?Promise.resolve(oe.shift()):ie?Promise.resolve({value:void 0,done:!0}):new Promise((function(e){return ue.push(e)}))},R=this.options.hf_token,j=this.fetch,O=this.app_reference,P=this.config,C=this.session_hash,q=this.api_info,z=this.api_map,N=this.stream_status,A=this.pending_stream_messages,F=this.pending_diff_streams,I=this.event_callbacks,L=this.unclosed_events,U=this.post_data,J=this.options,W=this,!q)throw Error("No API found");if(!P)throw Error("Could not resolve app config");return G=function(e,t,n,r){var a,s=void 0,i=void 0,o=void 0;if("number"==typeof t?(s=t,i=e.unnamed_endpoints[s],o=r.dependencies.find((function(e){return e.id==t}))):(a=t.replace(/^\//,""),s=n[a],i=e.named_endpoints[t.trim()],o=r.dependencies.find((function(e){return e.id==n[a]}))),"number"!=typeof s)throw Error("There is no endpoint matching that name of fn_index matching that number.");return{fn_index:s,endpoint_info:i,dependency:o}}(q,e,z,P),M=G.fn_index,$=G.endpoint_info,H=G.dependency,Z=Be(t,q),K=void 0,V=void 0,Y=P.protocol||"ws",Q="number"==typeof e?"/predict":e,X=void 0,ee=null,te=!1,ne={},re="undefined"!=typeof window&&"undefined"!=typeof document?new URLSearchParams(window.location.search).toString():"",ae=(null==(i=null==J?void 0:J.events)?void 0:i.reduce((function(e,t){return e[t]=!0,e}),{}))||{},he=c(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ge._resolve_hearbeat(t);case 2:case"end":return e.stop()}}),e,ge)}))),se=function(e){return he.apply(this,arguments)},this.handle_blob(P.root,Z,$).then((le=c(regeneratorRuntime.mark((function e(t){var a,s,i,o,u,l,g,b,y,k,j,q;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=x(t,H,P.components,"input",!0),X={data:s||[],event_data:n,fn_index:M,trigger_id:r},!_(M,P)){e.next=7;break}d({type:"status",endpoint:Q,stage:"pending",queue:!1,fn_index:M,time:new Date}),U(P.root+"/run"+(Q.startsWith("/")?Q:"/"+Q)+(re?"?"+re:""),T({},X,{session_hash:C})).then((function(e){var t=D(e,2),a=t[0],s=t[1],i=a.data;200==s?(d({type:"data",endpoint:Q,fn_index:M,data:x(i,H,P.components,"output",J.with_null_state),time:new Date,event_data:n,trigger_id:r}),a.render_config&&h(a.render_config),d({type:"status",endpoint:Q,fn_index:M,stage:"complete",eta:a.average_duration,queue:!1,time:new Date})):d({type:"status",stage:"error",endpoint:Q,fn_index:M,message:a.error,queue:!1,time:new Date})})).catch((function(e){d({type:"status",stage:"error",message:e.message,endpoint:Q,fn_index:M,queue:!1,time:new Date})})),e.next=34;break;case 7:if("ws"!=Y){e.next=22;break}return e.next=10,B(O,R);case 10:i=e.sent,o=i.ws_protocol,u=i.host,d({type:"status",stage:"pending",queue:!0,endpoint:Q,fn_index:M,time:new Date}),l=new URL(o+"://"+f(u,P.path,!0)+"/queue/join"+(re?"?"+re:"")),ge.jwt&&l.searchParams.set("__sign",ge.jwt),(K=new WebSocket(l)).onclose=function(e){e.wasClean||d({type:"status",stage:"error",broken:!0,message:ke,queue:!0,endpoint:Q,fn_index:M,time:new Date})},K.onmessage=function(e){var t=v(JSON.parse(e.data),ne[M]),a=t.type,s=t.status,i=t.data;if("update"===a&&s&&!te)d(T({type:"status",endpoint:Q,fn_index:M,time:new Date},s)),"error"===s.stage&&K.close();else{if("hash"===a)return void K.send(JSON.stringify({fn_index:M,session_hash:C}));"data"===a?K.send(JSON.stringify(T({},X,{session_hash:C}))):"complete"===a?te=s:"log"===a?d({type:"log",log:i.log,level:i.level,endpoint:Q,fn_index:M}):"generating"===a&&d(T({type:"status",time:new Date},s,{stage:null==s?void 0:s.stage,queue:!0,endpoint:Q,fn_index:M}))}i&&(d({type:"data",time:new Date,data:x(i.data,H,P.components,"output",J.with_null_state),endpoint:Q,fn_index:M,event_data:n,trigger_id:r}),te&&(d(T({type:"status",time:new Date},te,{stage:null==s?void 0:s.stage,queue:!0,endpoint:Q,fn_index:M})),K.close()))},p(P.version||"2.0.0","3.6")<0&&addEventListener("open",(function(){return K.send(JSON.stringify({hash:C}))})),e.next=34;break;case 22:if("sse"!=Y){e.next=33;break}if(d({type:"status",stage:"pending",queue:!0,endpoint:Q,fn_index:M,time:new Date}),g=new URLSearchParams({fn_index:M.toString(),session_hash:C}).toString(),b=new URL(P.root+"/queue/join?"+(re?re+"&":"")+g),ge.jwt&&b.searchParams.set("__sign",ge.jwt),V=ge.stream(b)){e.next=30;break}return e.abrupt("return",Promise.reject(Error("Cannot connect to SSE endpoint: "+b.toString())));case 30:V.onmessage=function(){var e=c(regeneratorRuntime.mark((function e(t){var a,s,i,o,u,c,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=JSON.parse(t.data),s=v(a,ne[M]),i=s.type,o=s.status,u=s.data,"update"!==i||!o||te){e.next=7;break}d(T({type:"status",endpoint:Q,fn_index:M,time:new Date},o)),"error"===o.stage&&(null==V||V.close(),m()),e.next=19;break;case 7:if("data"!==i){e.next=18;break}return ee=a.event_id,e.next=11,U(P.root+"/queue/data",T({},X,{session_hash:C,event_id:ee}));case 11:c=e.sent,(p=D(c,2))[0],200!==p[1]&&(d({type:"status",stage:"error",message:ke,queue:!0,endpoint:Q,fn_index:M,time:new Date}),null==V||V.close(),m()),e.next=19;break;case 18:"complete"===i?te=o:"log"===i?d({type:"log",log:u.log,level:u.level,endpoint:Q,fn_index:M}):"generating"===i&&d(T({type:"status",time:new Date},o,{stage:null==o?void 0:o.stage,queue:!0,endpoint:Q,fn_index:M}));case 19:u&&(d({type:"data",time:new Date,data:x(u.data,H,P.components,"output",J.with_null_state),endpoint:Q,fn_index:M,event_data:n,trigger_id:r}),te&&(d(T({type:"status",time:new Date},te,{stage:null==o?void 0:o.stage,queue:!0,endpoint:Q,fn_index:M})),null==V||V.close(),m()));case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e.next=34;break;case 33:"sse_v1"!=Y&&"sse_v2"!=Y&&"sse_v2.1"!=Y&&"sse_v3"!=Y||(d({type:"status",stage:"pending",queue:!0,endpoint:Q,fn_index:M,time:new Date}),y="","undefined"!=typeof window&&"undefined"!=typeof document&&(y=null==(a=null==window?void 0:window.location)?void 0:a.hostname),k=y.includes(".dev.")?"https://moon-"+y.split(".")[1]+".dev.spaces.huggingface.tech":"https://huggingface.co",j="undefined"!=typeof window&&"undefined"!=typeof document&&window.parent!=window,q=H.zerogpu&&P.space_id,(j&&q?w("zerogpu-headers",k):Promise.resolve(null)).then((function(e){return U(P.root+"/queue/join?"+re,T({},X,{session_hash:C}),e)})).then(function(){var e=c(regeneratorRuntime.mark((function e(t){var n,r=D(t,2),a=r[0],s=r[1];return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(503!==s){e.next=4;break}d({type:"status",stage:"error",message:ye,queue:!0,endpoint:Q,fn_index:M,time:new Date}),e.next=16;break;case 4:if(200===s){e.next=8;break}d({type:"status",stage:"error",message:ke,queue:!0,endpoint:Q,fn_index:M,time:new Date}),e.next=16;break;case 8:if(ee=a.event_id,n=function(){var e=c(regeneratorRuntime.mark((function e(t){var n,r,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=v(t,ne[M]),r=n.type,a=n.status,s=n.data,"heartbeat"!=r){e.next=4;break}return e.abrupt("return");case 4:if("update"!==r||!a||te){e.next=8;break}d(T({type:"status",endpoint:Q,fn_index:M,time:new Date},a)),e.next=23;break;case 8:if("complete"!==r){e.next=12;break}te=a,e.next=23;break;case 12:if("unexpected_error"!=r){e.next=17;break}console.error("Unexpected error",null==a?void 0:a.message),d({type:"status",stage:"error",message:(null==a?void 0:a.message)||"An Unexpected Error Occurred!",queue:!0,endpoint:Q,fn_index:M,time:new Date}),e.next=23;break;case 17:if("log"!==r){e.next=22;break}return d({type:"log",log:s.log,level:s.level,endpoint:Q,fn_index:M}),e.abrupt("return");case 22:"generating"===r&&(d(T({type:"status",time:new Date},a,{stage:null==a?void 0:a.stage,queue:!0,endpoint:Q,fn_index:M})),s&&["sse_v2","sse_v2.1","sse_v3"].includes(Y)&&E(F,ee,s));case 23:if(!s){e.next=29;break}if(d({type:"data",time:new Date,data:x(s.data,H,P.components,"output",J.with_null_state),endpoint:Q,fn_index:M}),!s.render_config){e.next=28;break}return e.next=28,h(s.render_config);case 28:te&&d(T({type:"status",time:new Date},te,{stage:null==a?void 0:a.stage,queue:!0,endpoint:Q,fn_index:M}));case 29:"complete"!==(null==a?void 0:a.stage)&&"error"!==(null==a?void 0:a.stage)||(I[ee]&&delete I[ee],ee in F&&delete F[ee]),e.next=37;break;case 32:e.prev=32,e.t0=e.catch(0),console.error("Unexpected client exception",e.t0),d({type:"status",stage:"error",message:"An Unexpected Error Occurred!",queue:!0,endpoint:Q,fn_index:M,time:new Date}),["sse_v2","sse_v2.1","sse_v3"].includes(Y)&&(S(N,W.abort_controller),N.open=!1,m());case 37:case"end":return e.stop()}}),e,this,[[0,32]])})));return function(t){return e.apply(this,arguments)}}(),ee in A&&(A[ee].forEach((function(e){return n(e)})),delete A[ee]),I[ee]=n,L.add(ee),N.open){e.next=16;break}return e.next=16,ge.open_stream();case 16:case"end":return e.stop()}}),e,ge)})));return function(t){return e.apply(this,arguments)}}()));case 34:case"end":return e.stop()}}),e,ge)}))),function(e){return le.apply(this,arguments)})),ie=!1,oe=[],ue=[],s(o={},Symbol.asyncIterator,(function(){return ce})),s(o,"next",k),s(o,"throw",(fe=c(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(t),e.abrupt("return",k());case 2:case"end":return e.stop()}}),e,ge)}))),function(e){return fe.apply(this,arguments)})),s(o,"return",(pe=c(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(),e.abrupt("return",k());case 2:case"end":return e.stop()}}),e,ge)}))),function(){return pe.apply(this,arguments)})),s(o,"cancel",l),ce=o}catch(ve){throw console.error("Submit function encountered an error:",ve),ve}}var O,P,D,T,C,q,z,N,A,B,F,I,L,U,J,W,G,M,$,H,Z,K,V,Y,Q,X,ee,te,ne,re,ae,se,ie,oe,ue,ce,pe,fe,le,he,de,me,ge,ve,be,_e,we,xe,ye,ke,Re,Se,Ee,je,Oe,Pe,De,Te,Ce,qe,ze,Ne,Ae,Be,Fe,Ie,Le,Ue,Je,We,Ge,Me,$e,He,Ze,Ke,Ve,Ye,Qe,Xe,et,tt,nt,rt,at,st,it,ot,ut,ct,pt,ft,lt,ht,dt,mt,gt;Object.defineProperty(t,"__esModule",{value:!0}),O=function(){function e(e,t){var n,r;for(n=0;n<t.length;n++)(r=t[n]).enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),P=function(){function e(e){this.value=e}function t(t){function n(a,s){var i,o;try{(o=(i=t[a](s)).value)instanceof e?Promise.resolve(o.value).then((function(e){n("next",e)}),(function(e){n("throw",e)})):r(i.done?"return":"normal",i.value)}catch(u){r("throw",u)}}function r(e,t){switch(e){case"return":a.resolve({value:t,done:!0});break;case"throw":a.reject(t);break;default:a.resolve({value:t,done:!1})}(a=a.next)?n(a.key,a.arg):s=null}var a,s;this._invoke=function(e,t){return new Promise((function(r,i){var o={key:e,arg:t,resolve:r,reject:i,next:null};s?s=s.next=o:(a=s=o,n(e,t))}))},"function"!=typeof t.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)},{wrap:function(e){return function(){return new t(e.apply(this,arguments))}},await:function(t){return new e(t)}}}(),D=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n,r,a=[],s=!0,i=!1,o=void 0;try{for(n=e[Symbol.iterator]();!(s=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);s=!0);}catch(u){i=!0,o=u}finally{try{!s&&n.return&&n.return()}finally{if(i)throw o}}return a}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},T=Object.assign||function(e){var t,n,r;for(t=1;t<arguments.length;t++)for(r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Me=c(regeneratorRuntime.mark((function e(t,n,r){var a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://huggingface.co/api/spaces/"+t+"/jwt",{headers:T({Authorization:"Bearer "+n},r?{Cookie:r}:{})});case 3:return a=e.sent,e.next=6,a.json();case 6:return s=e.sent.token,e.abrupt("return",s||!1);case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,this,[[0,10]])}))),q=function(e,t,n){return Me.apply(this,arguments)},$e=c(regeneratorRuntime.mark((function e(t){var n,r,a,s,i,o,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=this.options.hf_token?{Authorization:"Bearer "+this.options.hf_token}:{})["Content-Type"]="application/json","undefined"==typeof window||!window.gradio_config||"http://localhost:9876"===location.origin||window.gradio_config.dev_mode){e.next=10;break}return a=window.gradio_config.root,s=window.gradio_config,i=f(t,s.root,!1),s.root=i,e.abrupt("return",T({},s,{path:a}));case 10:if(!t){e.next=34;break}return o=Ae(t,ve),e.next=14,this.fetch(o,{headers:r,credentials:"include"});case 14:if(401!==(null==(u=e.sent)?void 0:u.status)||this.options.auth){e.next=19;break}throw Error(Pe);case 19:if(401!==(null==u?void 0:u.status)||!this.options.auth){e.next=21;break}throw Error(Oe);case 21:if(200!==(null==u?void 0:u.status)){e.next=31;break}return e.next=24,u.json();case 24:return(c=e.sent).path=c.path||"",c.root=t,null==(n=c.dependencies)||n.forEach((function(e,t){void 0===e.id&&(e.id=t)})),e.abrupt("return",c);case 31:if(401!==(null==u?void 0:u.status)){e.next=33;break}throw Error(je);case 33:case 34:throw Error(Re);case 35:case"end":return e.stop()}}),e,this)}))),z=function(e){return $e.apply(this,arguments)},He=c(regeneratorRuntime.mark((function e(){var t,n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B(this.app_reference,this.options.hf_token);case 2:if(t=e.sent,n=t.http_protocol,r=t.host,e.prev=5,!this.options.auth){e.next=11;break}return e.next=9,A(n,r,this.options.auth,this.fetch,this.options.hf_token);case 9:(a=e.sent)&&this.set_cookies(a);case 11:e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),Error(e.t0.message);case 16:case"end":return e.stop()}}),e,this,[[5,13]])}))),N=function(){return He.apply(this,arguments)},Ze=c(regeneratorRuntime.mark((function e(t,n,r,a,s){var i,o,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=new FormData).append("username",null==r?void 0:r[0]),i.append("password",null==r?void 0:r[1]),o={},s&&(o.Authorization="Bearer "+s),e.next=7,a(t+"//"+n+"/"+ge,{headers:o,method:"POST",body:i,credentials:"include"});case 7:if(200!==(u=e.sent).status){e.next=12;break}return e.abrupt("return",u.headers.get("set-cookie"));case 12:if(401!==u.status){e.next=16;break}throw Error(Oe);case 16:throw Error(Ee);case 17:case"end":return e.stop()}}),e,this)}))),A=function(e,t,n,r,a){return Ze.apply(this,arguments)},Ke=c(regeneratorRuntime.mark((function e(t,n){var r,a,s,i,o,u,c,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={},n&&(r.Authorization="Bearer "+n),a=t.trim().replace(/\/$/,""),!ze.test(a)){e.next=17;break}return e.prev=4,e.next=7,fetch("https://huggingface.co/api/spaces/"+a+"/"+de,{headers:r});case 7:return s=e.sent,e.next=10,s.json();case 10:return i=e.sent.host,e.abrupt("return",T({space_id:t},h(i)));case 14:throw e.prev=14,e.t0=e.catch(4),Error(Ee);case 17:if(!Ne.test(a)){e.next=20;break}return o=h(a),u=o.ws_protocol,c=o.http_protocol,p=o.host,e.abrupt("return",{space_id:p.replace(".hf.space",""),ws_protocol:u,http_protocol:c,host:p});case 20:return e.abrupt("return",T({space_id:!1},h(a)));case 21:case"end":return e.stop()}}),e,this,[[4,14]])}))),B=function(e,t){return Ke.apply(this,arguments)},Ve=c(regeneratorRuntime.mark((function e(){var t,n,r,a,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.api_info){e.next=2;break}return e.abrupt("return",this.api_info);case 2:if(t=this.options.hf_token,n=this.config,r={"Content-Type":"application/json"},t&&(r.Authorization="Bearer "+t),n){e.next=8;break}return e.abrupt("return");case 8:if(e.prev=8,a=void 0,!(p((null==n?void 0:n.version)||"2.0.0","3.30")<0)){e.next=16;break}return e.next=13,this.fetch(xe,{method:"POST",body:JSON.stringify({serialize:!1,config:JSON.stringify(n)}),headers:r,credentials:"include"});case 13:a=e.sent,e.next=20;break;case 16:return s=Ae(n.root,be),e.next=19,this.fetch(s,{headers:r,credentials:"include"});case 19:a=e.sent;case 20:if(a.ok){e.next=22;break}throw Error(ke);case 22:return e.next=24,a.json();case 24:return"api"in(i=e.sent)&&(i=i.api),i.named_endpoints["/predict"]&&!i.unnamed_endpoints[0]&&(i.unnamed_endpoints[0]=i.named_endpoints["/predict"]),e.abrupt("return",d(i,n,this.api_map));case 30:e.prev=30,e.t0=e.catch(8),e.t0.message;case 33:case"end":return e.stop()}}),e,this,[[8,30]])}))),F=function(){return Ve.apply(this,arguments)},Ye=c(regeneratorRuntime.mark((function e(t,n,r){var a,s,i,o,c,p,f,l,h=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s={},(null==(a=null==this?void 0:this.options)?void 0:a.hf_token)&&(s.Authorization="Bearer "+this.options.hf_token),i=1e3,o=[],c=void 0,p=regeneratorRuntime.mark((function e(a){var p,f,l,d,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p=n.slice(a,a+i),f=new FormData,p.forEach((function(e){f.append("files",e)})),e.prev=3,l=r?t+"/"+me+"?upload_id="+r:t+"/"+me,e.next=7,h.fetch(l,{method:"POST",body:f,headers:s,credentials:"include"});case 7:c=e.sent,e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(3),Error(ke+e.t0.message);case 13:if(c.ok){e.next=18;break}return e.next=16,c.text();case 16:return d=e.sent,e.abrupt("return",{v:{error:"HTTP "+c.status+": "+d}});case 18:return e.next=20,c.json();case 20:(m=e.sent)&&o.push.apply(o,u(m));case 22:case"end":return e.stop()}}),e,h,[[3,10]])})),f=0;case 7:if(!(f<n.length)){e.next=15;break}return e.delegateYield(p(f),"t0",9);case 9:if("object"!==(void 0===(l=e.t0)?"undefined":C(l))){e.next=12;break}return e.abrupt("return",l.v);case 12:f+=i,e.next=7;break;case 15:return e.abrupt("return",{files:o});case 16:case"end":return e.stop()}}),e,this)}))),I=function(e,t,n){return Ye.apply(this,arguments)},Qe=c(regeneratorRuntime.mark((function e(t,n,r,a){var s,i,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=(Array.isArray(t)?t:[t]).map((function(e){return e.blob})),!(i=s.filter((function(e){return e.size>(a||1/0)}))).length){e.next=4;break}throw Error("File size exceeds the maximum allowed size of "+a+" bytes: "+i.map((function(e){return e.name})).join(", "));case 4:return e.t0=Promise,e.next=7,this.upload_files(n,s,r).then(function(){var e=c(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.error){e.next=4;break}throw Error(r.error);case 4:if(!r.files){e.next=6;break}return e.abrupt("return",r.files.map((function(e,r){return new Fe(T({},t[r],{path:e,url:n+"/file="+e}))})));case 6:return e.abrupt("return",[]);case 7:case"end":return e.stop()}}),e,o)})));return function(t){return e.apply(this,arguments)}}());case 7:return e.t1=e.sent,e.next=10,e.t0.all.call(e.t0,e.t1);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)}))),L=function(e,t,n,r){return Qe.apply(this,arguments)},Xe=c(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.map((function(e){return new Fe({path:e.name,orig_name:e.name,blob:e,size:e.size,mime_type:e.type,is_stream:n})})));case 1:case"end":return e.stop()}}),e,this)}))),U=function(e,t){return Xe.apply(this,arguments)},et=c(regeneratorRuntime.mark((function e(t){var n,r,a,s,i,o,p,f,l,h,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],g=this,v=arguments.length>3&&void 0!==arguments[3]&&arguments[3],b=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Array.isArray(t)){e.next=7;break}return n=[],e.next=4,Promise.all(t.map(function(){var e=c(regeneratorRuntime.mark((function e(r,a){var s,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=m.slice()).push(a+""),e.next=4,J(t[a],v?(null==(s=null==b?void 0:b.parameters[a])?void 0:s.component)||void 0:d,i,!1,b);case 4:o=e.sent,n=n.concat(o);case 6:case"end":return e.stop()}}),e,g)})));return function(t,n){return e.apply(this,arguments)}}()));case 4:return e.abrupt("return",n);case 7:if(!(globalThis.Buffer&&t instanceof globalThis.Buffer||t instanceof Blob)){e.next=11;break}return e.abrupt("return",[{path:m,blob:new Blob([t]),type:d}]);case 11:if("object"!==(void 0===t?"undefined":C(t))||null===t){e.next=45;break}r=[],a=!0,s=!1,i=void 0,e.prev=16,o=Object.keys(t)[Symbol.iterator]();case 18:if(a=(p=o.next()).done){e.next=30;break}return f=p.value,l=[].concat(u(m),[f]),h=t[f],e.t0=r,e.next=25,J(h,void 0,l,!1,b);case 25:e.t1=e.sent,r=e.t0.concat.call(e.t0,e.t1);case 27:a=!0,e.next=18;break;case 30:e.next=36;break;case 32:e.prev=32,e.t2=e.catch(16),s=!0,i=e.t2;case 36:e.prev=36,e.prev=37,!a&&o.return&&o.return();case 39:if(e.prev=39,!s){e.next=42;break}throw i;case 42:return e.finish(39);case 43:return e.finish(36);case 44:return e.abrupt("return",r);case 45:return e.abrupt("return",[]);case 46:case"end":return e.stop()}}),e,this,[[16,32,36,44],[37,,39,43]])}))),J=function(e){return et.apply(this,arguments)},tt=c(regeneratorRuntime.mark((function e(t,n,r){var a,s,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this,e.next=3,G(a,n);case 3:return e.next=5,J(n,void 0,[],!0,r);case 5:return s=e.sent,e.next=8,Promise.all(s.map(function(){var e=c(regeneratorRuntime.mark((function e(n){var r,s,o=n.path,u=n.blob,c=n.type;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u){e.next=2;break}return e.abrupt("return",{path:o,type:c});case 2:return e.next=4,a.upload_files(t,[u]);case 4:return r=e.sent,s=r.files&&r.files[0],e.abrupt("return",{path:o,file_url:s,type:c,name:u instanceof File?null==u?void 0:u.name:void 0});case 7:case"end":return e.stop()}}),e,i)})));return function(t){return e.apply(this,arguments)}}()));case 8:return e.sent.forEach((function(e){var t,r=e.path,a=e.file_url,s=e.type,i=e.name;"Gallery"===s?b(n,a,r):a&&(t=new Fe({path:a,orig_name:i}),b(n,t,r))})),e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)}))),W=function(e,t,n){return tt.apply(this,arguments)},nt=c(regeneratorRuntime.mark((function e(t,n){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null==(r=t.config)?void 0:r.root)||(null==(a=t.config)?void 0:a.root_url)){e.next=3;break}throw Error(Te);case 3:return e.next=5,M(t,n);case 5:case"end":return e.stop()}}),e,this)}))),G=function(e,t){return nt.apply(this,arguments)},rt=c(regeneratorRuntime.mark((function e(t,n){var r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=regeneratorRuntime.keys(n);case 1:if((e.t1=e.t0()).done){e.next=13;break}if(r=e.t1.value,!(n[r]instanceof Ie)){e.next=8;break}return e.next=6,$(t,n,r);case 6:e.next=11;break;case 8:if("object"!==C(n[r])||null===n[r]){e.next=11;break}return e.next=11,M(t,n[r],[].concat(u(a),[r]));case 11:e.next=1;break;case 13:case"end":return e.stop()}}),e,this)}))),M=function(e,t){return rt.apply(this,arguments)},at=c(regeneratorRuntime.mark((function t(r,a,s){var i,o,u,c,p,f,l,h,d,m,g,v;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(u=a[s],c=(null==(i=r.config)?void 0:i.root)||(null==(o=r.config)?void 0:o.root_url)){t.next=4;break}throw Error(Te);case 4:if(t.prev=4,p=void 0,f=void 0,void 0===e||!e.versions||!e.versions.node){t.next=20;break}return t.next=10,n.e(3).then(n.t.bind(null,723,7));case 10:return l=t.sent,t.next=13,n.e(8).then(n.t.bind(null,657,7));case 13:return h=t.sent,f=h.resolve(e.cwd(),u.meta.path),t.next=17,l.readFile(f);case 17:p=t.sent,t.next=21;break;case 20:throw Error(De);case 21:return d=new Blob([p],{type:"application/octet-stream"}),t.next=24,r.upload_files(c,[d]);case 24:m=t.sent,(g=m.files&&m.files[0])&&(v=new Fe({path:g,orig_name:u.meta.name||""}),a[s]=v),t.next=32;break;case 29:t.prev=29,t.t0=t.catch(4),console.error(Ce,t.t0);case 32:case"end":return t.stop()}}),t,this,[[4,29]])}))),$=function(e,t,n){return at.apply(this,arguments)},st=c(regeneratorRuntime.mark((function e(t,n,r){var a,s,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={"Content-Type":"application/json"},this.options.hf_token&&(a.Authorization="Bearer "+this.options.hf_token),e.prev=2,e.next=5,this.fetch(t,{method:"POST",body:JSON.stringify(n),headers:T({},a,r),credentials:"include"});case 5:s=e.sent,e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",[{error:ke},500]);case 11:return i=void 0,o=void 0,e.prev=13,e.next=16,s.json();case 16:i=e.sent,o=s.status,e.next=24;break;case 20:e.prev=20,e.t1=e.catch(13),i={error:"Could not parse server response: "+e.t1},o=500;case 24:return e.abrupt("return",[i,o]);case 25:case"end":return e.stop()}}),e,this,[[2,8],[13,20]])}))),H=function(e,t,n){return st.apply(this,arguments)},it=c(regeneratorRuntime.mark((function e(t,n){var r,a,s,o,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!1,a=!1,s=void 0,this.config){e.next=5;break}throw Error("Could not resolve app config");case 5:if("number"==typeof t?s=this.config.dependencies.find((function(e){return e.id==t})):(o=t.replace(/^\//,""),s=this.config.dependencies.find((function(e){return e.id==u.api_map[o]}))),!(null==s?void 0:s.types.continuous)){e.next=8;break}throw Error("Cannot call predict on this function as it may run forever. Use submit instead");case 8:return e.abrupt("return",new Promise(function(){var e=c(regeneratorRuntime.mark((function e(s,o){var c,p,f,l,h,d,m,g,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=u.submit(t,n,null,null,!0),p=void 0,f=!0,l=!1,h=void 0,e.prev=5,d=i(c);case 7:return e.next=9,d.next();case 9:return m=e.sent,f=m.done,e.next=13,m.value;case 13:if(g=e.sent,f){e.next=21;break}"data"===(v=g).type&&(a&&s(p),r=!0,p=v),"status"===v.type&&("error"===v.stage&&o(v),"complete"===v.stage&&(a=!0,r&&s(p)));case 18:f=!0,e.next=7;break;case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(5),l=!0,h=e.t0;case 27:if(e.prev=27,e.prev=28,f||!d.return){e.next=32;break}return e.next=32,d.return();case 32:if(e.prev=32,!l){e.next=35;break}throw h;case 35:return e.finish(32);case 36:return e.finish(27);case 37:case"end":return e.stop()}}),e,u,[[5,23,27,37],[28,,32,36]])})));return function(t,n){return e.apply(this,arguments)}}()));case 9:case"end":return e.stop()}}),e,this)}))),Z=function(e,t){return it.apply(this,arguments)},ot=c(regeneratorRuntime.mark((function e(t,n,r){var a,s,i,o,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="subdomain"===n?"https://huggingface.co/api/spaces/by-subdomain/"+t:"https://huggingface.co/api/spaces/"+t,s=void 0,i=void 0,e.prev=3,e.next=6,fetch(a);case 6:if(s=e.sent,200===(i=s.status)){e.next=10;break}throw Error();case 10:return e.next=12,s.json();case 12:s=e.sent,e.next=19;break;case 15:return e.prev=15,e.t0=e.catch(3),r({status:"error",load_status:"error",message:Se,detail:"NOT_FOUND"}),e.abrupt("return");case 19:if(s&&200===i){e.next=21;break}return e.abrupt("return");case 21:u=(o=s).runtime.stage,c=o.id,e.t1=u,e.next="STOPPED"===e.t1||"SLEEPING"===e.t1?25:"PAUSED"===e.t1?28:"RUNNING"===e.t1||"RUNNING_BUILDING"===e.t1?36:"BUILDING"===e.t1?38:41;break;case 25:return r({status:"sleeping",load_status:"pending",message:"Space is asleep. Waking it up...",detail:u}),setTimeout((function(){K(t,n,r)}),1e3),e.abrupt("break",49);case 28:return e.t2=r,e.t3=u,e.next=32,V(c);case 32:return e.t4=e.sent,e.t5={status:"paused",load_status:"error",message:"This space has been paused by the author. If you would like to try this demo, consider duplicating the space.",detail:e.t3,discussions_enabled:e.t4},(0,e.t2)(e.t5),e.abrupt("break",49);case 36:return r({status:"running",load_status:"complete",message:"",detail:u}),e.abrupt("break",49);case 38:return r({status:"building",load_status:"pending",message:"Space is building...",detail:u}),setTimeout((function(){K(t,n,r)}),1e3),e.abrupt("break",49);case 41:return e.t6=r,e.t7=u,e.next=45,V(c);case 45:return e.t8=e.sent,e.t9={status:"space_error",load_status:"error",message:"This space is experiencing an issue.",detail:e.t7,discussions_enabled:e.t8},(0,e.t6)(e.t9),e.abrupt("break",49);case 49:case"end":return e.stop()}}),e,this,[[3,15]])}))),K=function(e,t,n){return ot.apply(this,arguments)},ut=c(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://huggingface.co/api/spaces/"+t+"/discussions",{method:"HEAD"});case 3:if(n=e.sent,r=n.headers.get("x-error-message"),!(!n.ok||r&&Ue.test(r))){e.next=7;break}return e.abrupt("return",!1);case 7:return e.abrupt("return",!0);case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,this,[[0,10]])}))),V=function(e){return ut.apply(this,arguments)},ct=c(regeneratorRuntime.mark((function e(t,n){var r,a,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={},n&&(r.Authorization="Bearer "+n),e.prev=2,e.next=5,fetch("https://huggingface.co/api/spaces/"+t+"/"+_e,{headers:r});case 5:if(200===(a=e.sent).status){e.next=8;break}throw Error("Space hardware could not be obtained.");case 8:return e.next=10,a.json();case 10:return s=e.sent,i=s.hardware,e.abrupt("return",i.current);case 15:throw e.prev=15,e.t0=e.catch(2),Error(e.t0.message);case 18:case"end":return e.stop()}}),e,this,[[2,15]])}))),Y=function(e,t){return ct.apply(this,arguments)},pt=c(regeneratorRuntime.mark((function e(t,n,r){var a,s,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={},r&&(a.Authorization="Bearer "+r),s={seconds:n},e.prev=3,e.next=6,fetch("https://huggingface.co/api/spaces/"+t+"/"+we,{method:"POST",headers:T({"Content-Type":"application/json"},a),body:JSON.stringify(s)});case 6:if(200===(i=e.sent).status){e.next=9;break}throw Error("Could not set sleep timeout on duplicated Space. Please visit *ADD HF LINK TO SETTINGS* to set a timeout manually to reduce billing charges.");case 9:return e.next=11,i.json();case 11:return o=e.sent,e.abrupt("return",o);case 15:throw e.prev=15,e.t0=e.catch(3),Error(e.t0.message);case 18:case"end":return e.stop()}}),e,this,[[3,15]])}))),Q=function(e,t,n){return pt.apply(this,arguments)},ft=c(regeneratorRuntime.mark((function e(t,n){var r,a,s,i,o,u,c,p,f,l,h,d,m,g,v,b,_,w,x;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.hf_token,a=n.private,s=n.hardware,i=n.timeout,o=n.auth,!s||Je.includes(s)){e.next=3;break}throw Error("Invalid hardware type provided. Valid types are: "+Je.map((function(e){return'"'+e+'"'})).join(",")+".");case 3:return e.next=5,B(t,r);case 5:if(u=e.sent,c=u.http_protocol,p=u.host,f=null,!o){e.next=14;break}return e.next=12,A(c,p,o,fetch);case 12:(l=e.sent)&&(f=qe(l));case 14:return h=T({Authorization:"Bearer "+r,"Content-Type":"application/json"},f?{Cookie:f.join("; ")}:{}),e.next=17,fetch("https://huggingface.co/api/whoami-v2",{headers:h});case 17:return e.next=19,e.sent.json();case 19:if(d=e.sent.name,m=t.split("/")[1],g={repository:d+"/"+m},a&&(g.private=!0),v=void 0,e.prev=24,s){e.next=29;break}return e.next=28,Y(t,r);case 28:v=e.sent;case 29:e.next=34;break;case 31:throw e.prev=31,e.t0=e.catch(24),Error(Ee+e.t0.message);case 34:return b=s||v||"cpu-basic",g.hardware=b,e.prev=36,e.next=39,fetch("https://huggingface.co/api/spaces/"+t+"/duplicate",{method:"POST",headers:h,body:JSON.stringify(g)});case 39:if(409!==(_=e.sent).status){e.next=54;break}return e.prev=41,e.next=44,Ge.connect(d+"/"+m,n);case 44:return w=e.sent,e.abrupt("return",w);case 48:throw e.prev=48,e.t1=e.catch(41),console.error("Failed to connect Client instance:",e.t1),e.t1;case 52:e.next=56;break;case 54:if(200===_.status){e.next=56;break}throw Error(_.statusText);case 56:return e.next=58,_.json();case 58:return x=e.sent,e.next=61,Q(d+"/"+m,i||300,r);case 61:return e.next=63,Ge.connect(y(x.url),n);case 63:return e.abrupt("return",e.sent);case 66:throw e.prev=66,e.t2=e.catch(36),Error(e.t2);case 69:case"end":return e.stop()}}),e,this,[[24,31],[36,66],[41,48]])}))),X=function(e,t){return ft.apply(this,arguments)},lt=P.wrap(regeneratorRuntime.mark((function e(t,n){var r,a,s,i,o,u,c,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.body){e.next=2;break}return e.abrupt("return");case 2:f=t.body,l=new TextDecoderStream,h=new We({allowCR:!0}),r=f.pipeThrough(l).pipeThrough(h),a=void 0,s=r.getReader(),i=void 0;case 5:if(!n||!n.aborted){e.next=7;break}return e.abrupt("return",s.cancel());case 7:return e.next=9,P.await(s.read());case 9:if(!(a=e.sent).done){e.next=12;break}return e.abrupt("return");case 12:if(a.value){e.next=18;break}if(!i){e.next=16;break}return e.next=16,i;case 16:return i=void 0,e.abrupt("continue",22);case 18:if(o=k(a.value)||[],u=D(o,2),c=u[0],p=u[1],c){e.next=21;break}return e.abrupt("continue",22);case 21:"data"===c?(i||(i={}),i[c]=i[c]?i[c]+"\n"+p:p):"event"===c?(i||(i={}),i[c]=p):"id"===c?(i||(i={}),i[c]=+p||p):"retry"===c&&(i||(i={}),i[c]=+p||void 0);case 22:e.next=5;break;case 24:case"end":return e.stop()}var f,l,h}),e,this)}))),ee=function(e,t){return lt.apply(this,arguments)},ht=c(regeneratorRuntime.mark((function e(t,n){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return R((r=new Request(t,n)).headers,"Accept","text/event-stream"),R(r.headers,"Content-Type","application/json"),e.next=5,fetch(r);case 5:if((a=e.sent).ok){e.next=8;break}throw a;case 8:return e.abrupt("return",ee(a,r.signal));case 9:case"end":return e.stop()}}),e,this)}))),te=function(e,t){return ht.apply(this,arguments)},dt=c(regeneratorRuntime.mark((function e(){var t,n,r,a,s,i,o,u,p,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.event_callbacks,n=this.unclosed_events,r=this.pending_stream_messages,a=this.stream_status,s=this.config,i=this.jwt,o=this,s){e.next=4;break}throw Error("Could not resolve app config");case 4:if(a.open=!0,u=null,p=new URLSearchParams({session_hash:this.session_hash}).toString(),f=new URL(s.root+"/queue/data?"+p),i&&f.searchParams.set("__sign",i),u=this.stream(f)){e.next=13;break}return console.warn("Cannot connect to SSE endpoint: "+f.toString()),e.abrupt("return");case 13:u.onmessage=function(){var e=c(regeneratorRuntime.mark((function e(i){var u,c,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("close_stream"!==(u=JSON.parse(i.data)).msg){e.next=4;break}return S(a,o.abort_controller),e.abrupt("return");case 4:if(c=u.event_id){e.next=10;break}return e.next=8,Promise.all(Object.keys(t).map((function(e){return t[e](u)})));case 8:e.next=11;break;case 10:t[c]&&s?("process_completed"===u.msg&&["sse","sse_v1","sse_v2","sse_v2.1","sse_v3"].includes(s.protocol)&&n.delete(c),p=t[c],"undefined"!=typeof window&&"undefined"!=typeof document?setTimeout(p,0,u):p(u)):(r[c]||(r[c]=[]),r[c].push(u));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),u.onerror=c(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(Object.keys(t).map((function(e){return t[e]({msg:"unexpected_error",message:ke})})));case 2:case"end":return e.stop()}}),e,this)})));case 15:case"end":return e.stop()}}),e,this)}))),ne=function(){return dt.apply(this,arguments)},mt=c(regeneratorRuntime.mark((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{events:["data"]};return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ge.connect(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),re=function(e){return mt.apply(this,arguments)},gt=c(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ge.duplicate(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),ae=function(e,t){return gt.apply(this,arguments)},se=Object.defineProperty,ie=function(e,t,n){return t in e?se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},oe=function(e,t,n){return ie(e,"symbol"!==(void 0===t?"undefined":C(t))?t+"":t,n),n},ue=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},ce=function(e,t,n){return ue(e,t,"read from private field"),n?n.call(e):t.get(e)},pe=function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},fe=function(e,t,n,r){return ue(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n},he=new Intl.Collator(0,{numeric:1}).compare,de="host",me="upload",ge="login",ve="config",be="info",_e="runtime",we="sleeptime",xe="https://gradio-space-api-fetcher-v2.hf.space/api",ye="This application is currently busy. Please try again. ",ke="Connection errored out. ",Re="Could not resolve app config. ",Se="Could not get space status. ",Ee="Space metadata could not be loaded. ",je="Not authorized to access this space. ",Oe="Invalid credentials. Could not login. ",Pe="Login credentials are required to access this space.",De="File system access is only available in Node.js environments",Te="Root URL not found in client config",Ce="Error uploading file",qe=function(e){var t=[];return e.split(/,(?=\s*[^\s=;]+=[^\s=;]+)/).forEach((function(e){var n=e.split(";")[0].split("="),r=D(n,2),a=r[0],s=r[1];a&&s&&t.push(a.trim()+"="+s.trim())})),t},ze=/^[a-zA-Z0-9_\-\.]+\/[a-zA-Z0-9_\-\.]+$/,Ne=/.*hf\.space\/{0,1}$/,Ae=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];try{return t.reduce((function(e,t){return e=e.replace(/\/+$/,""),t=t.replace(/^\/+/,""),new URL(t,e+"/").toString()}))}catch(r){throw Error("Invalid URL. A full URL path is required.")}},Be=function(e,t){var n,r,a=Object.values(t.named_endpoints).flatMap((function(e){return e.parameters}));return Array.isArray(e)?(e.length>a.length&&console.warn("Too many arguments provided for the endpoint."),e):(n=[],r=Object.keys(e),a.forEach((function(t,r){if(e.hasOwnProperty(t.parameter_name))n[r]=e[t.parameter_name];else{if(!t.parameter_has_default)throw Error("No value provided for required parameter: "+t.parameter_name);n[r]=t.parameter_default}})),r.forEach((function(e){if(!a.some((function(t){return t.parameter_name===e})))throw Error("Parameter `"+e+"` is not a valid keyword argument. Please refer to the API for usage.")})),n.forEach((function(e,t){if(void 0===e&&!a[t].parameter_has_default)throw Error("No value provided for required parameter: "+a[t].parameter_name)})),n)},Fe=function e(t){var n=t.path,r=t.url,a=t.orig_name,s=t.size,i=t.blob,u=t.is_stream,c=t.mime_type,p=t.alt_text;o(this,e),oe(this,"path"),oe(this,"url"),oe(this,"orig_name"),oe(this,"size"),oe(this,"blob"),oe(this,"is_stream"),oe(this,"mime_type"),oe(this,"alt_text"),oe(this,"meta",{_type:"gradio.FileData"}),this.path=n,this.url=r,this.orig_name=a,this.size=s,this.blob=r?void 0:i,this.is_stream=u,this.mime_type=c,this.alt_text=p},Ie=function e(t,n){o(this,e),oe(this,"type"),oe(this,"command"),oe(this,"meta"),oe(this,"fileData"),this.type="command",this.command=t,this.meta=n},Le=void 0!==e&&e.versions&&e.versions.node,Ue=/^(?=[^]*\b[dD]iscussions{0,1}\b)(?=[^]*\b[dD]isabled\b)[^]*$/,Je=["cpu-basic","cpu-upgrade","cpu-xl","t4-small","t4-medium","a10g-small","a10g-large","a10g-largex2","a10g-largex4","a100-large","zero-a10g","h100","h100x8"],We=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{allowCR:!1};return o(this,t),e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{transform:function(t,r){var a,s,i;for(t=ce(e,le)+t;;)if(a=t.indexOf("\n"),-1!==(s=n.allowCR?t.indexOf("\r"):-1)&&s!==t.length-1&&(-1===a||a-1>s))r.enqueue(t.slice(0,s)),t=t.slice(s+1);else{if(-1===a)break;i="\r"===t[a-1]?a-1:a,r.enqueue(t.slice(0,i)),t=t.slice(a+1)}fe(e,le,t)},flush:function(t){if(""!==ce(e,le)){var r=n.allowCR&&ce(e,le).endsWith("\r")?ce(e,le).slice(0,-1):ce(e,le);t.enqueue(r)}}})),pe(e,le,""),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,TransformStream),t}(),le=new WeakMap,Ge=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{events:["data"]};o(this,e),oe(this,"app_reference"),oe(this,"options"),oe(this,"config"),oe(this,"api_info"),oe(this,"api_map",{}),oe(this,"session_hash",Math.random().toString(36).substring(2)),oe(this,"jwt",!1),oe(this,"last_status",{}),oe(this,"cookies",null),oe(this,"stream_status",{open:!1}),oe(this,"pending_stream_messages",{}),oe(this,"pending_diff_streams",{}),oe(this,"event_callbacks",{}),oe(this,"unclosed_events",new Set),oe(this,"heartbeat_event",null),oe(this,"abort_controller",null),oe(this,"stream_instance",null),oe(this,"view_api"),oe(this,"upload_files"),oe(this,"upload"),oe(this,"handle_blob"),oe(this,"post_data"),oe(this,"submit"),oe(this,"predict"),oe(this,"open_stream"),oe(this,"resolve_config"),oe(this,"resolve_cookies"),this.app_reference=t,n.events||(n.events=["data"]),this.options=n,this.view_api=F.bind(this),this.upload_files=I.bind(this),this.handle_blob=W.bind(this),this.post_data=H.bind(this),this.submit=j.bind(this),this.predict=Z.bind(this),this.open_stream=ne.bind(this),this.resolve_config=z.bind(this),this.resolve_cookies=N.bind(this),this.upload=L.bind(this)}var t,r,s,u,p,f,h,d;return O(e,[{key:"fetch",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return""+e},t}((function(e,t){var n=new Headers((null==t?void 0:t.headers)||{});return this&&this.cookies&&n.append("Cookie",this.cookies),fetch(e,T({},t,{headers:n}))}))},{key:"stream",value:function(e){return this.abort_controller=new AbortController,this.stream_instance=function(e){var t,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a={close:function(){throw Error("Method not implemented.")},onerror:null,onmessage:null,onopen:null,readyState:0,url:e.toString(),withCredentials:!1,CONNECTING:0,OPEN:1,CLOSED:2,addEventListener:function(){throw Error("Method not implemented.")},dispatchEvent:function(){throw Error("Method not implemented.")},removeEventListener:function(){throw Error("Method not implemented.")}};return te(e,r).then((t=c(regeneratorRuntime.mark((function e(t){var r,s,o,u,c,p,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.readyState=a.OPEN,e.prev=1,r=!0,s=!1,o=void 0,e.prev=5,u=i(t);case 7:return e.next=9,u.next();case 9:return c=e.sent,r=c.done,e.next=13,c.value;case 13:if(p=e.sent,r){e.next=20;break}f=p,a.onmessage&&a.onmessage(f);case 17:r=!0,e.next=7;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(5),s=!0,o=e.t0;case 26:if(e.prev=26,e.prev=27,r||!u.return){e.next=31;break}return e.next=31,u.return();case 31:if(e.prev=31,!s){e.next=34;break}throw o;case 34:return e.finish(31);case 35:return e.finish(26);case 36:a.readyState=a.CLOSED,e.next=43;break;case 39:e.prev=39,e.t1=e.catch(1),a.onerror&&a.onerror(e.t1),a.readyState=a.CLOSED;case 43:case"end":return e.stop()}}),e,n,[[1,39],[5,22,26,36],[27,,31,35]])}))),function(e){return t.apply(this,arguments)})).catch((function(e){console.error(e),a.onerror&&a.onerror(e),a.readyState=a.CLOSED})),a}(e.toString(),{signal:this.abort_controller.signal}),this.stream_instance}},{key:"init",value:(d=c(regeneratorRuntime.mark((function e(){var t,r,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!=typeof window&&"WebSocket"in window||a.WebSocket){e.next=5;break}return e.next=3,Promise.resolve().then(n.t.bind(null,727,7));case 3:r=e.sent,a.WebSocket=r.WebSocket;case 5:if(e.prev=5,!this.options.auth){e.next=9;break}return e.next=9,this.resolve_cookies();case 9:return e.next=11,this._resolve_config().then((function(e){var t=e.config;return s._resolve_hearbeat(t)}));case 11:e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),Error(e.t0);case 16:return e.next=18,this.view_api();case 18:this.api_info=e.sent,this.api_map=l((null==(t=this.config)?void 0:t.dependencies)||[]);case 20:case"end":return e.stop()}}),e,this,[[5,13]])}))),function(){return d.apply(this,arguments)})},{key:"_resolve_hearbeat",value:(h=c(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=7;break}if(this.config=t,!this.config||!this.config.connect_heartbeat){e.next=7;break}if(!this.config.space_id||!this.options.hf_token){e.next=7;break}return e.next=6,q(this.config.space_id,this.options.hf_token,this.cookies);case 6:this.jwt=e.sent;case 7:if(!t.space_id||!this.options.hf_token){e.next=11;break}return e.next=10,q(t.space_id,this.options.hf_token);case 10:this.jwt=e.sent;case 11:this.config&&this.config.connect_heartbeat&&(n=new URL(this.config.root+"/heartbeat/"+this.session_hash),this.jwt&&n.searchParams.set("__sign",this.jwt),this.heartbeat_event||(this.heartbeat_event=this.stream(n)));case 12:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"close",value:function(){var e;null==(e=this.heartbeat_event)||e.close()}},{key:"_resolve_config",value:(f=c(regeneratorRuntime.mark((function e(){var t,n,r,a,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B(this.app_reference,this.options.hf_token);case 2:return t=e.sent,n=t.http_protocol,r=t.host,a=t.space_id,s=this.options.status_callback,i=void 0,e.prev=8,e.next=11,this.resolve_config(n+"//"+r);case 11:if(i=e.sent){e.next=14;break}throw Error(Re);case 14:return e.abrupt("return",this.config_success(i));case 17:if(e.prev=17,e.t0=e.catch(8),!a||!s){e.next=23;break}K(a,ze.test(a)?"space_name":"subdomain",this.handle_space_success),e.next=25;break;case 23:throw s&&s({status:"error",message:"Could not load this space.",load_status:"error",detail:"NOT_FOUND"}),Error(e.t0);case 25:case"end":return e.stop()}}),e,this,[[8,17]])}))),function(){return f.apply(this,arguments)})},{key:"config_success",value:(p=c(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.config=t,"undefined"!=typeof window&&"undefined"!=typeof document&&"https:"===window.location.protocol&&(this.config.root=this.config.root.replace("http://","https://")),!this.config.auth_required){e.next=4;break}return e.abrupt("return",this.prepare_return_obj());case 4:return e.prev=4,e.next=7,this.view_api();case 7:this.api_info=e.sent,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),console.error("Could not get API info. "+e.t0.message);case 13:return e.abrupt("return",this.prepare_return_obj());case 14:case"end":return e.stop()}}),e,this,[[4,10]])}))),function(e){return p.apply(this,arguments)})},{key:"handle_space_success",value:(u=c(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this){e.next=2;break}throw Error(Re);case 2:if((n=this.options.status_callback)&&n(t),"running"!==t.status){e.next=21;break}return e.prev=5,e.next=8,this._resolve_config();case 8:if(this.config=e.sent,this.config){e.next=11;break}throw Error(Re);case 11:return e.next=13,this.config_success(this.config);case 13:return r=e.sent,e.abrupt("return",r);case 17:throw e.prev=17,e.t0=e.catch(5),n&&n({status:"error",message:"Could not load this space.",load_status:"error",detail:"NOT_FOUND"}),e.t0;case 21:case"end":return e.stop()}}),e,this,[[5,17]])}))),function(e){return u.apply(this,arguments)})},{key:"component_server",value:(s=c(regeneratorRuntime.mark((function e(t,n,r){var a,s,i,o,u,c,p,f,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.config){e.next=2;break}throw Error(Re);case 2:if(s={},i=this.options.hf_token,o=this.session_hash,i&&(s.Authorization="Bearer "+this.options.hf_token),u=void 0,c=this.config.components.find((function(e){return e.id===t})),u=(null==(a=null==c?void 0:c.props)?void 0:a.root_url)?c.props.root_url:this.config.root,p=void 0,!("binary"in r)){e.next=25;break}p=new FormData,e.t0=regeneratorRuntime.keys(r.data);case 13:if((e.t1=e.t0()).done){e.next=20;break}if("binary"!==(f=e.t1.value)){e.next=17;break}return e.abrupt("continue",13);case 17:p.append(f,r.data[f]),e.next=13;break;case 20:p.set("component_id",t.toString()),p.set("fn_name",n),p.set("session_hash",o),e.next=27;break;case 25:p=JSON.stringify({data:r,component_id:t,fn_name:n,session_hash:o}),s["Content-Type"]="application/json";case 27:return i&&(s.Authorization="Bearer "+i),e.prev=28,e.next=31,this.fetch(u+"/component_server/",{method:"POST",body:p,headers:s,credentials:"include"});case 31:if((l=e.sent).ok){e.next=34;break}throw Error("Could not connect to component server: "+l.statusText);case 34:return e.next=36,l.json();case 36:return h=e.sent,e.abrupt("return",h);case 40:e.prev=40,e.t2=e.catch(28),console.warn(e.t2);case 43:case"end":return e.stop()}}),e,this,[[28,40]])}))),function(e,t,n){return s.apply(this,arguments)})},{key:"set_cookies",value:function(e){this.cookies=qe(e).join("; ")}},{key:"prepare_return_obj",value:function(){return{config:this.config,predict:this.predict,submit:this.submit,view_api:this.view_api,component_server:this.component_server}}}],[{key:"connect",value:(r=c(regeneratorRuntime.mark((function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{events:["data"]};return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new this(t,r),e.next=3,n.init();case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"duplicate",value:(t=c(regeneratorRuntime.mark((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{events:["data"]};return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",X(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}(),t.Client=Ge,t.FileData=Fe,t.client=re,t.duplicate=ae,t.handle_file=function(e){if("string"==typeof e){if(e.startsWith("http://")||e.startsWith("https://"))return{path:e,url:e,orig_name:e.split("/").pop()||"unknown",meta:{_type:"gradio.FileData"}};if(Le)return new Ie("upload_file",{path:e,name:e,orig_path:e})}else{if("undefined"!=typeof File&&e instanceof File)return{path:e instanceof File?e.name:"blob",orig_name:e instanceof File?e.name:"unknown",blob:e instanceof File?e:new Blob([e]),size:e instanceof Blob?e.size:r.byteLength(e),mime_type:e instanceof File?e.type:"application/octet-stream",meta:{_type:"gradio.FileData"}};if(e instanceof r)return new Blob([e]);if(e instanceof Blob)return e}throw Error("Invalid input: must be a URL, File, Blob, or Buffer object.")},t.predict=Z,t.prepare_files=U,t.submit=j,t.upload=L,t.upload_files=I}(n(43),n(210).Buffer,n(67))}}]);