(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{716:function(t,e,_){"use strict";async function n(){function t(t,e){if(o.buffer.byteLength<t+e){const _=Math.ceil((t+e-o.buffer.byteLength)/65536);o.grow(_),m=new Uint8Array(o.buffer)}}function e(e,_,n,a,s,i){t(e);const o=new Uint8Array(e);return m.set(o),n(0,_),o.set(m.slice(0,e)),{update(_){let n;return m.set(o),"string"==typeof _?(t(3*_.length,e),n=y.encodeInto(_,m.subarray(e)).written):(t(_.byteLength,e),m.set(_,e),n=_.byteLength),a(0,e,n),o.set(m.slice(0,e)),this},digest:()=>(m.set(o),i(s(0)))}}function _(t){return t>>>0}function n(t){return t&g}function s(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t(3*e.length,0),_(r(0,y.encodeInto(e,m).written,n))}function i(e){let _=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0n;return t(3*e.length,0),n(l(0,y.encodeInto(e,m).written,_))}const{instance:{exports:{mem:o,xxh32:r,xxh64:l,init32:h,update32:p,digest32:c,init64:u,update64:d,digest64:f}}}=await WebAssembly.instantiate(a);let m=new Uint8Array(o.buffer);const g=2n**64n-1n,y=new TextEncoder;return{h32:s,h32ToString(t){return s(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0).toString(16).padStart(8,"0")},h32Raw(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t(e.byteLength,0),m.set(e),_(r(0,e.byteLength,n))},create32(){return e(48,arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,h,p,c,_)},h64:i,h64ToString(t){return i(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0n).toString(16).padStart(16,"0")},h64Raw(e){let _=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0n;return t(e.byteLength,0),m.set(e),n(l(0,e.byteLength,_))},create64(){return e(88,arguments.length>0&&void 0!==arguments[0]?arguments[0]:0n,u,d,f,n)}}}_.r(e),_.d(e,"default",(function(){return n}));const a=new Uint8Array([0,97,115,109,1,0,0,0,1,48,8,96,3,127,127,127,0,96,3,127,127,127,1,127,96,2,127,127,0,96,2,127,126,0,96,1,127,1,127,96,1,127,1,126,96,3,127,127,126,1,126,96,3,126,127,127,1,126,3,11,10,1,1,2,0,4,6,7,3,0,5,5,3,1,0,1,7,85,9,3,109,101,109,2,0,5,120,120,104,51,50,0,0,6,105,110,105,116,51,50,0,2,8,117,112,100,97,116,101,51,50,0,3,8,100,105,103,101,115,116,51,50,0,4,5,120,120,104,54,52,0,5,6,105,110,105,116,54,52,0,7,8,117,112,100,97,116,101,54,52,0,8,8,100,105,103,101,115,116,54,52,0,9,10,211,23,10,242,1,1,4,127,32,0,32,1,106,33,3,32,1,65,16,79,4,127,32,3,65,16,107,33,6,32,2,65,168,136,141,161,2,106,33,3,32,2,65,247,148,175,175,120,106,33,4,32,2,65,177,243,221,241,121,107,33,5,3,64,32,0,40,2,0,65,247,148,175,175,120,108,32,3,106,65,13,119,65,177,243,221,241,121,108,33,3,32,0,65,4,106,34,0,40,2,0,65,247,148,175,175,120,108,32,4,106,65,13,119,65,177,243,221,241,121,108,33,4,32,0,65,4,106,34,0,40,2,0,65,247,148,175,175,120,108,32,2,106,65,13,119,65,177,243,221,241,121,108,33,2,32,0,65,4,106,34,0,40,2,0,65,247,148,175,175,120,108,32,5,106,65,13,119,65,177,243,221,241,121,108,33,5,32,0,65,4,106,34,0,32,6,77,13,0,11,32,2,65,12,119,32,5,65,18,119,106,32,4,65,7,119,106,32,3,65,1,119,106,5,32,2,65,177,207,217,178,1,106,11,32,1,106,32,0,32,1,65,15,113,16,1,11,146,1,0,32,1,32,2,106,33,2,3,64,32,1,65,4,106,32,2,75,69,4,64,32,1,40,2,0,65,189,220,202,149,124,108,32,0,106,65,17,119,65,175,214,211,190,2,108,33,0,32,1,65,4,106,33,1,12,1,11,11,3,64,32,1,32,2,79,69,4,64,32,1,45,0,0,65,177,207,217,178,1,108,32,0,106,65,11,119,65,177,243,221,241,121,108,33,0,32,1,65,1,106,33,1,12,1,11,11,32,0,65,15,118,32,0,115,65,247,148,175,175,120,108,34,0,32,0,65,13,118,115,65,189,220,202,149,124,108,34,0,32,0,65,16,118,115,11,63,0,32,0,65,8,106,32,1,65,168,136,141,161,2,106,54,2,0,32,0,65,12,106,32,1,65,247,148,175,175,120,106,54,2,0,32,0,65,16,106,32,1,54,2,0,32,0,65,20,106,32,1,65,177,243,221,241,121,107,54,2,0,11,211,4,1,6,127,32,1,32,2,106,33,6,32,0,65,24,106,33,5,32,0,65,40,106,40,2,0,33,3,32,0,32,0,40,2,0,32,2,106,54,2,0,32,0,65,4,106,34,4,32,4,40,2,0,32,2,65,16,79,32,0,40,2,0,65,16,79,114,114,54,2,0,32,2,32,3,106,65,16,73,4,64,32,3,32,5,106,32,1,32,2,252,10,0,0,32,0,65,40,106,32,2,32,3,106,54,2,0,15,11,32,3,4,64,32,3,32,5,106,32,1,65,16,32,3,107,34,2,252,10,0,0,32,0,65,8,106,34,3,40,2,0,32,5,40,2,0,65,247,148,175,175,120,108,106,65,13,119,65,177,243,221,241,121,108,33,4,32,3,32,4,54,2,0,32,0,65,12,106,34,3,40,2,0,32,5,65,4,106,40,2,0,65,247,148,175,175,120,108,106,65,13,119,65,177,243,221,241,121,108,33,4,32,3,32,4,54,2,0,32,0,65,16,106,34,3,40,2,0,32,5,65,8,106,40,2,0,65,247,148,175,175,120,108,106,65,13,119,65,177,243,221,241,121,108,33,4,32,3,32,4,54,2,0,32,0,65,20,106,34,3,40,2,0,32,5,65,12,106,40,2,0,65,247,148,175,175,120,108,106,65,13,119,65,177,243,221,241,121,108,33,4,32,3,32,4,54,2,0,32,0,65,40,106,65,0,54,2,0,32,1,32,2,106,33,1,11,32,1,32,6,65,16,107,77,4,64,32,6,65,16,107,33,8,32,0,65,8,106,40,2,0,33,2,32,0,65,12,106,40,2,0,33,3,32,0,65,16,106,40,2,0,33,4,32,0,65,20,106,40,2,0,33,7,3,64,32,1,40,2,0,65,247,148,175,175,120,108,32,2,106,65,13,119,65,177,243,221,241,121,108,33,2,32,1,65,4,106,34,1,40,2,0,65,247,148,175,175,120,108,32,3,106,65,13,119,65,177,243,221,241,121,108,33,3,32,1,65,4,106,34,1,40,2,0,65,247,148,175,175,120,108,32,4,106,65,13,119,65,177,243,221,241,121,108,33,4,32,1,65,4,106,34,1,40,2,0,65,247,148,175,175,120,108,32,7,106,65,13,119,65,177,243,221,241,121,108,33,7,32,1,65,4,106,34,1,32,8,77,13,0,11,32,0,65,8,106,32,2,54,2,0,32,0,65,12,106,32,3,54,2,0,32,0,65,16,106,32,4,54,2,0,32,0,65,20,106,32,7,54,2,0,11,32,1,32,6,73,4,64,32,5,32,1,32,6,32,1,107,34,1,252,10,0,0,32,0,65,40,106,32,1,54,2,0,11,11,97,1,1,127,32,0,65,16,106,40,2,0,33,1,32,0,65,4,106,40,2,0,4,127,32,1,65,12,119,32,0,65,20,106,40,2,0,65,18,119,106,32,0,65,12,106,40,2,0,65,7,119,106,32,0,65,8,106,40,2,0,65,1,119,106,5,32,1,65,177,207,217,178,1,106,11,32,0,40,2,0,106,32,0,65,24,106,32,0,65,40,106,40,2,0,16,1,11,157,4,2,1,127,3,126,32,0,32,1,106,33,3,32,1,65,32,79,4,126,32,3,65,32,107,33,3,32,2,66,135,149,175,175,152,182,222,155,158,127,124,66,207,214,211,190,210,199,171,217,66,124,33,4,32,2,66,207,214,211,190,210,199,171,217,66,124,33,5,32,2,66,0,124,33,6,32,2,66,135,149,175,175,152,182,222,155,158,127,125,33,2,3,64,32,0,41,3,0,66,207,214,211,190,210,199,171,217,66,126,32,4,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,4,32,0,65,8,106,34,0,41,3,0,66,207,214,211,190,210,199,171,217,66,126,32,5,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,5,32,0,65,8,106,34,0,41,3,0,66,207,214,211,190,210,199,171,217,66,126,32,6,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,6,32,0,65,8,106,34,0,41,3,0,66,207,214,211,190,210,199,171,217,66,126,32,2,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,2,32,0,65,8,106,34,0,32,3,77,13,0,11,32,6,66,12,137,32,2,66,18,137,124,32,5,66,7,137,124,32,4,66,1,137,124,32,4,66,207,214,211,190,210,199,171,217,66,126,66,0,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,133,66,135,149,175,175,152,182,222,155,158,127,126,66,227,220,202,149,252,206,242,245,133,127,124,32,5,66,207,214,211,190,210,199,171,217,66,126,66,0,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,133,66,135,149,175,175,152,182,222,155,158,127,126,66,227,220,202,149,252,206,242,245,133,127,124,32,6,66,207,214,211,190,210,199,171,217,66,126,66,0,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,133,66,135,149,175,175,152,182,222,155,158,127,126,66,227,220,202,149,252,206,242,245,133,127,124,32,2,66,207,214,211,190,210,199,171,217,66,126,66,0,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,133,66,135,149,175,175,152,182,222,155,158,127,126,66,227,220,202,149,252,206,242,245,133,127,124,5,32,2,66,197,207,217,178,241,229,186,234,39,124,11,32,1,173,124,32,0,32,1,65,31,113,16,6,11,137,2,0,32,1,32,2,106,33,2,3,64,32,1,65,8,106,32,2,77,4,64,32,1,41,3,0,66,207,214,211,190,210,199,171,217,66,126,66,0,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,32,0,133,66,27,137,66,135,149,175,175,152,182,222,155,158,127,126,66,227,220,202,149,252,206,242,245,133,127,124,33,0,32,1,65,8,106,33,1,12,1,11,11,32,1,65,4,106,32,2,77,4,64,32,1,53,2,0,66,135,149,175,175,152,182,222,155,158,127,126,32,0,133,66,23,137,66,207,214,211,190,210,199,171,217,66,126,66,249,243,221,241,153,246,153,171,22,124,33,0,32,1,65,4,106,33,1,11,3,64,32,1,32,2,73,4,64,32,1,49,0,0,66,197,207,217,178,241,229,186,234,39,126,32,0,133,66,11,137,66,135,149,175,175,152,182,222,155,158,127,126,33,0,32,1,65,1,106,33,1,12,1,11,11,32,0,66,33,136,32,0,133,66,207,214,211,190,210,199,171,217,66,126,34,0,32,0,66,29,136,133,66,249,243,221,241,153,246,153,171,22,126,34,0,32,0,66,32,136,133,11,88,0,32,0,65,8,106,32,1,66,135,149,175,175,152,182,222,155,158,127,124,66,207,214,211,190,210,199,171,217,66,124,55,3,0,32,0,65,16,106,32,1,66,207,214,211,190,210,199,171,217,66,124,55,3,0,32,0,65,24,106,32,1,55,3,0,32,0,65,32,106,32,1,66,135,149,175,175,152,182,222,155,158,127,125,55,3,0,11,132,5,2,3,127,4,126,32,1,32,2,106,33,5,32,0,65,40,106,33,4,32,0,65,200,0,106,40,2,0,33,3,32,0,32,0,41,3,0,32,2,173,124,55,3,0,32,2,32,3,106,65,32,73,4,64,32,3,32,4,106,32,1,32,2,252,10,0,0,32,0,65,200,0,106,32,2,32,3,106,54,2,0,15,11,32,3,4,64,32,3,32,4,106,32,1,65,32,32,3,107,34,2,252,10,0,0,32,0,65,8,106,34,3,41,3,0,32,4,41,3,0,66,207,214,211,190,210,199,171,217,66,126,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,6,32,3,32,6,55,3,0,32,0,65,16,106,34,3,41,3,0,32,4,65,8,106,41,3,0,66,207,214,211,190,210,199,171,217,66,126,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,6,32,3,32,6,55,3,0,32,0,65,24,106,34,3,41,3,0,32,4,65,16,106,41,3,0,66,207,214,211,190,210,199,171,217,66,126,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,6,32,3,32,6,55,3,0,32,0,65,32,106,34,3,41,3,0,32,4,65,24,106,41,3,0,66,207,214,211,190,210,199,171,217,66,126,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,6,32,3,32,6,55,3,0,32,0,65,200,0,106,65,0,54,2,0,32,1,32,2,106,33,1,11,32,1,65,32,106,32,5,77,4,64,32,5,65,32,107,33,2,32,0,65,8,106,41,3,0,33,6,32,0,65,16,106,41,3,0,33,7,32,0,65,24,106,41,3,0,33,8,32,0,65,32,106,41,3,0,33,9,3,64,32,1,41,3,0,66,207,214,211,190,210,199,171,217,66,126,32,6,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,6,32,1,65,8,106,34,1,41,3,0,66,207,214,211,190,210,199,171,217,66,126,32,7,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,7,32,1,65,8,106,34,1,41,3,0,66,207,214,211,190,210,199,171,217,66,126,32,8,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,8,32,1,65,8,106,34,1,41,3,0,66,207,214,211,190,210,199,171,217,66,126,32,9,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,33,9,32,1,65,8,106,34,1,32,2,77,13,0,11,32,0,65,8,106,32,6,55,3,0,32,0,65,16,106,32,7,55,3,0,32,0,65,24,106,32,8,55,3,0,32,0,65,32,106,32,9,55,3,0,11,32,1,32,5,73,4,64,32,4,32,1,32,5,32,1,107,34,1,252,10,0,0,32,0,65,200,0,106,32,1,54,2,0,11,11,200,2,1,5,126,32,0,65,24,106,41,3,0,33,1,32,0,41,3,0,34,2,66,32,90,4,126,32,0,65,8,106,41,3,0,34,3,66,1,137,32,0,65,16,106,41,3,0,34,4,66,7,137,124,32,1,66,12,137,32,0,65,32,106,41,3,0,34,5,66,18,137,124,124,32,3,66,207,214,211,190,210,199,171,217,66,126,66,0,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,133,66,135,149,175,175,152,182,222,155,158,127,126,66,227,220,202,149,252,206,242,245,133,127,124,32,4,66,207,214,211,190,210,199,171,217,66,126,66,0,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,133,66,135,149,175,175,152,182,222,155,158,127,126,66,227,220,202,149,252,206,242,245,133,127,124,32,1,66,207,214,211,190,210,199,171,217,66,126,66,0,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,133,66,135,149,175,175,152,182,222,155,158,127,126,66,227,220,202,149,252,206,242,245,133,127,124,32,5,66,207,214,211,190,210,199,171,217,66,126,66,0,124,66,31,137,66,135,149,175,175,152,182,222,155,158,127,126,133,66,135,149,175,175,152,182,222,155,158,127,126,66,227,220,202,149,252,206,242,245,133,127,124,5,32,1,66,197,207,217,178,241,229,186,234,39,124,11,32,2,124,32,0,65,40,106,32,2,66,31,131,167,16,6,11])},924:function(t,e,_){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var a,s,i,o,r,l,h,p,c,u,d,f,m,g,y,v,x,w,b,M,I,z,C,A,S,j,E,D,L,k,O,F,U,G,T;Object.defineProperty(e,"__esModule",{value:!0}),a=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var _,n,a=[],s=!0,i=!1,o=void 0;try{for(_=t[Symbol.iterator]();!(s=(n=_.next()).done)&&(a.push(n.value),!e||a.length!==e);s=!0);}catch(r){i=!0,o=r}finally{try{!s&&_.return&&_.return()}finally{if(i)throw o}}return a}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},s=function(){function t(t,e){var _,n;for(_=0;_<e.length;_++)(n=e[_]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}return function(e,_,n){return _&&t(e.prototype,_),n&&t(e,n),e}}(),i=_(651),o=_(687),r=_(0),l=n(r),h=_(691),p=n(h),c=_(654),u=n(c),d=_(928),f=n(d),m=_(929),g=n(m),y=_(652),v=_(930),x=n(v),w=_(935),b=n(w),M=_(936),I=n(M),z=_(717),C=n(z),A=_(937),S=n(A),j=_(711),E=n(j),D=_(938),L=n(D),k=_(686),O=n(k),F=_(645),U=_(668),G=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var _=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return T.call(_),_.hasnt_been_mount||(_.super_state=new I.default(t,_.forceUpdate),_.xxhash=Object.create(L.default).new(),_.bmp_layer=Object.create(g.default).from(u.default),_.color_conversion=Object.create(S.default).new(),_.super_blend=C.default.init(1,1),_.super_canvas=new b.default(null,32,32),_.canvas_pos=Object.create(O.default).from(32,32,.9,32,0,0),_.sraf=Object.create(E.default).init(),_.sraf.start_timer(),_.super_master_meta=Object.create(x.default).init(_.super_state,_.super_canvas,_.super_blend,_.canvas_pos,_.color_conversion,_.sraf),_.hasnt_been_mount=!0,_._ripple=null,_.filters=new o.Filters),_}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),s(e,[{key:"componentDidMount",value:function(){var t,e,_=this;window.addEventListener("resize",this._update_canvas_container_size),this.props.on_fps_change&&this.sraf.set_notify_fps_callback((function(t){_.props.on_fps_change(t)})),(t=[])[0]=setInterval(this._maybe_save_state,625),t[1]=setInterval(this._maybe_update_selection_highlight,this.sraf.get_state().is_mobile_or_tablet?2e3:1e3),t[2]=setInterval(this._notify_export_state,this.super_state.get_state().export_state_every_ms),(e=document.createElement("style")).innerHTML='body {touch-action:none;}.Canvas-Pixels, .Canvas-Wrapper-Overflow, .Canvas-Wrapper, .Canvas-Pixels-Cover {-ms-interpolation-mode: nearest-neighbor;\n            image-rendering: optimizeSpeed;\n            image-rendering: -o-pixelated;\n            image-rendering: -webkit-optimize-contrast;\n            image-rendering: -webkit-crisp-edges;\n            image-rendering: -moz-crisp-edges;\n            image-rendering: crisp-edges;\n            image-rendering: pixelated;touch-action: none;pointer-events: none;backface-visibility: hidden;mix-blend-mode: normal;background-blend-mode: normal;transition: none;}.Canvas-Wrapper-Overflow.Shown {\n                animation-name: canvanimation;\n                transform-origin: center center !important;\n                animation-fill-mode: both;\n                animation-duration: 350ms;\n                animation-delay: 0ms;\n                animation-timing-function: linear;\n            }\n            .Canvas-Wrapper-Overflow .Canvas-Wrapper::after {\n                content: "";\n                position: fixed;\n                width: 100%;\n                background: linear-gradient(to bottom, #ffffff00 0%, #1700ff14 14%, #1700ff57 21%, transparent);\n                height: 50%;\n                left: 0;\n                z-index: 2;\n                top: 100%;\n            }\n            .Canvas-Wrapper-Overflow.Shown .Canvas-Wrapper::after {\n                animation-name: canvanimationscan;\n                animation-fill-mode: both;\n                animation-duration: 450ms;\n                animation-delay: 350ms;\n                animation-timing-function: linear;\n            }\n            .Canvas-Wrapper-Overflow.Not-Shown {\n                animation-name: canvanimation;\n                transform-origin: center center !important;\n                animation-fill-mode: both;\n                animation-duration: 300ms;\n                animation-delay: 50ms;\n                animation-timing-function: linear;\n                animation-direction: reverse;\n            }\n            @keyframes canvanimation { \n                  0% { transform: matrix3d(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); filter: opacity(.0); will-change: transform, filter; }\n                  4.3% { transform: matrix3d(0.136, 0, 0, 0, 0, 0.271, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); filter: opacity(.2); will-change: transform, filter; }\n                  8.61% { transform: matrix3d(.729, 0, 0, 0, 0, .818, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); filter: opacity(.8); will-change: transform, filter; }\n                  12.91% { transform: matrix3d(1.146, 0, 0, 0, 0, 1.078, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); filter: opacity(.9); will-change: transform, filter; }\n                  17.22% { transform: matrix3d(1.22, 0, 0, 0, 0, 1.11, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); filter: opacity(1); will-change: transform, filter; }\n                  28.33% { transform: matrix3d(1.046, 0, 0, 0, 0, 1.031, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); filter: opacity(1); will-change: transform, filter; }\n                  39.44% { transform: matrix3d(.988, 0, 0, 0, 0, .991, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); filter: opacity(1); will-change: transform, filter; }\n                  61.66% { transform: matrix3d(1.002, 0, 0, 0, 0, 1.001, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); filter: opacity(1); will-change: transform, filter; }\n                  83.98% { transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); filter: opacity(1); will-change: transform, filter; }\n                  100% { transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); filter: opacity(1); will-change: initial; } \n            }\n            @keyframes canvanimationscan { \n                  0% { top: -50% }\n                  100% { top: 100% } \n            }.Canvas-Pixels-Cover::after {top: 0;\n                left: 0;\n                width: calc(60% - 12px);\n                content: ""attr(datatexttop)"";\n                padding: 0px 0px 8px 12px;\n                position: fixed;\n                transform: translate(0px, -100%);\n                line-height: 20px;\n                font-size: 14px;\n                font-family: "Industry Book";\n                color: #FAFAFAAA;}.Canvas-Pixels-Cover::before {bottom: 0;\n                right: 0;\n                width: calc(80% - 12px);\n                text-align: right;\n                content: ""attr(datatextbottom)"";\n                padding: 8px 12px 0px 0px;\n                position: fixed;\n                transform: translate(0px, 100%);\n                line-height: 20px;\n                font-size: 14px;\n                font-family: "Industry Book";\n                color: #FAFAFAAA;}.Canvas-Wrapper.MOVE:not(.Canvas-Focused), .Canvas-Wrapper.PICKER:not(.Canvas-Focused) {cursor: grab;}.Canvas-Wrapper.MOVE:active:not(.Canvas-Focused), .Canvas-Wrapper.PICKER:active:not(.Canvas-Focused) {cursor: grabbing;}',e.id="canvas-style",document.head.appendChild(e),this.super_state.set_state({_intervals:t}),this.super_master_meta.set_notifiers(this.props.onPositionChange,this.props.onSomethingSelectedChange,this.props.onCurrentColorChange,this.props.onRelevantActionEvent,this._request_force_update),this.canvas_pos.set_notifiers(this._request_force_update,this._handle_canvas_wrapper_overflow_context_menu,this._super_master_meta_handle_canvas_mouse_move,this._super_master_meta_handle_canvas_mouse_up,this._super_master_meta_handle_canvas_mouse_down,this._request_force_update,this._set_cursor,this._function_ripple),this.canvas_pos.init_speed_interval(),this._update_canvas_container_size(),this._notify_image_load_complete(!0)}},{key:"componentWillReceiveProps",value:function(t){var e,_,n,a,s,i,o=this,r=this.super_state.get_state();"MOVE"===t.tool&&0===r._imported_image_pxl_colors.length?this.canvas_pos.set_boolean_move_on_click(!0):this.canvas_pos.set_boolean_move_on_click(!1),r.perspective!==t.perspective&&this.canvas_pos.set_perspective(t.perspective||0),("NONE"!==r.pencil_mirror_mode&&"NONE"===t.pencil_mirror_mode||r.tool.includes("PENCIL")&&!t.tool.includes("PENCIL"))&&this.super_state.set_state({_pencil_mirror_index:-1}),r.tool===t.tool||t.tool.includes("SELECT")||(this.super_state.get_state()._pxl_indexes_of_selection.clear(),this._request_force_update(),this._notify_is_something_selected()),e=r.hide_canvas_content,_=r.show_original_image_in_background,n=r.show_transparent_image_in_background,a=r.pencil_mirror_mode,s=r.tool,i=r.select_mode,e!==t.hide_canvas_content||_!==t.show_original_image_in_background||n!==t.show_transparent_image_in_background||a!==t.pencil_mirror_mode||s!==t.tool||i!==t.select_mode?this.super_state.set_state(t,!0).then((function(){o._request_force_update(!1,!1).then((function(){return o.super_master_meta.update_canvas()}))})):this.super_state.set_state(t,!0)}},{key:"componentWillUnmount",value:function(){document.querySelectorAll("#canvas-style").forEach((function(t){t.remove()}));try{window.removeEventListener("resize",this._update_canvas_container_size)}catch(e){}try{var t=this.super_state.get_state()._canvas_wrapper_overflow;t.removeEventListener("wheel",this._canvas_pos_handle_wheel),t.removeEventListener("pointerdown",this._canvas_pos_handle_pointer_down),t.removeEventListener("pointermove",this._canvas_pos_handle_pointer_move),t.removeEventListener("pointerup",this._canvas_pos_handle_pointer_up),t.removeEventListener("pointercancel",this._canvas_pos_handle_pointer_up),t.removeEventListener("pointerout",this._canvas_pos_handle_pointer_up),t.removeEventListener("pointerleave",this._canvas_pos_handle_pointer_up)}catch(e){}this.super_state.get_state()._intervals.forEach((function(t){clearInterval(t)})),delete this.hasnt_been_mount}},{key:"render",value:function(){var t=this.super_state.get_state(),e=t.className,_=t.canvas_wrapper_background_color,n=t.canvas_wrapper_background_color_focused,a=t.canvas_wrapper_border_radius,s=t.tool,i=t.cursor,o=t._mouse_inside,r=t.perspective,h=t.cached_background_image,c=t.pxl_width,u=t.pxl_height,d=this.super_master_meta.is_there_new_dimension(),f=this.canvas_pos.get_state(),m=f.canvas_wrapper,g=f.device_pixel_ratio,y=f.scale,v=f.canvas_event_target,x=this.canvas_pos.get_screen_zoom_ratio(),w=this.canvas_pos.get_style(),b=w.box_shadow,M=w.will_change,I=r?this.canvas_pos.get_perspective_state():{},z=I.background_image,C=I.transform_rotate,A=I.filter,S=(this.sraf.get_state().is_mobile_or_tablet,c*x*y.current+.5|0),j=u*x*y.current+.5|0,E=m.padding/g*y.current|0;return l.default.createElement("div",{onContextMenu:function(t){t.preventDefault()},ref:this._set_canvas_container_ref,draggable:"false",style:{zIndex:11,boxSizing:"border-box",position:"relative",pointerEvents:"none",overflow:"hidden",touchAction:"none",userSelect:"none",display:"block"},className:e},l.default.createElement("div",{ref:this._set_canvas_wrapper_overflow_ref,className:"Canvas-Wrapper-Overflow"+(d?" Not-Shown ":" Shown "),style:{display:"block",height:"100%",width:"100%",contain:"layout style size paint",overflow:"hidden",position:"absolute",boxSizing:"border-box",touchAction:"none",pointerEvents:"all",userSelect:"none",perspective:Math.round(Math.max(Math.floor(c),Math.floor(u)))+"px",zIndex:9}},l.default.createElement("div",{ref:this._set_canvas_wrapper_ref,className:"Canvas-Wrapper "+(o?" Canvas-Focused ":" "+s),style:{flexShrink:0,display:"inline-block",position:"fixed",contain:"layout style size paint",overflow:"hidden",left:0,top:0,borderWidth:m.border_width,borderStyle:"solid",borderColor:"#fff",background:r?"linear-gradient(135deg, #fcee15 10%, #f60088 33%, #04aaf2 65%, #00ac5c 100%)":"CANVAS"===v?n:_,transition:"background, filter cubic-bezier(0.4, 0, 0.2, 1) 225ms",margin:0,borderRadius:a,padding:E,width:0|S,height:0|j,boxShadow:b,filter:"opacity("+(d?"0":"1")+") "+(r?A:""),WebkitFilter:"opacity("+(d?"0":"1")+") "+(r?A:""),transform:"translate("+(0|y.move_x)+"px, "+(0|y.move_y)+"px) "+(r?C:""),willChange:M?"transform, box-shadow":"",transformOrigin:"center middle",mixBlendMode:r?"screen":"inherit",boxSizing:"content-box",touchAction:"none",pointerEvents:"none",userSelect:"none",zIndex:4}},l.default.createElement("canvas",{style:{display:"block",flexShrink:0,zIndex:2,position:"absolute",overflow:"hidden",contain:"layout style size paint",touchAction:"none",pointerEvents:"none",userSelect:"none",width:0|c,height:0|u,minWidth:x*y.current*c|0,maxWidth:x*y.current*c+1|0,minHeight:x*y.current*u|0,maxHeight:x*y.current*u+1|0,transformOrigin:"left top",boxSizing:"content-box",borderWidth:0,background:h},className:"Canvas-Pixels",ref:this._set_canvas_ref,width:0|c,height:0|u}),!!r&&l.default.createElement("div",{className:"Canvas-Pixels-Cover",style:{flexShrink:0,display:"block",backgroundImage:z,zIndex:3,borderRadius:a,padding:0,left:0,top:0,borderWidth:0,position:"absolute",width:(0|c)*(x*y.current)+2*E+.5|0,height:(0|u)*(x*y.current)+2*E+.5|0,boxSizing:"content-box",touchAction:"none",pointerEvents:"none",userSelect:"none",willChange:"background-image"}})),l.default.createElement("div",{style:{flexShrink:0,display:"block",left:0,top:0,position:"absolute",cursor:i,height:"100%",width:"100%",boxSizing:"border-box",touchAction:"none",pointerEvents:"visible",userSelect:"none",contain:"layout size style paint",zIndex:10},onContextMenu:function(t){t.preventDefault()}}),l.default.createElement("div",{style:{flexShrink:0,display:"block",zIndex:1,color:_,textAlign:"center",position:"fixed",bottom:0,left:0,width:"100%",height:"100px",backgroundImage:'url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzU4LjY2NyAyNDAiIHdpZHRoPSI3Njc4LjIyMyIgaGVpZ2h0PSIzMjAiPjxkZWZzPjxjbGlwUGF0aCBpZD0iQSI+PHBhdGggZD0iTTAgMGg1NzU4LjY2N3YyNDBIMHoiLz48L2NsaXBQYXRoPjwvZGVmcz48ZyBjbGlwLXBhdGg9InVybCgjQSkiIGZpbGw9IiM3NzciPjxwYXRoIGQ9Ik05MjEgMTgwaDMwdjYwaC0zMHptLTIzMiAwaDMwdjYwaC0zMHptLTIyOSAwaDMwdjYwaC0zMHptLTIyOSAwaDMwdjYwaC0zMHpNMCAwaDMwdjI0MEgwem0yMDczIDE4MGgzMHY2MGgtMzB6bS0yMzIgMGgzMHY2MGgtMzB6bS0yMjkgMGgzMHY2MGgtMzB6bS0yMjkgMGgzMHY2MGgtMzB6TTExNTIgMGgzMHYyNDBoLTMwem0yMDczIDE4MGgzMHY2MGgtMzB6bS0yMzIgMGgzMHY2MGgtMzB6bS0yMjkgMGgzMHY2MGgtMzB6bS0yMjkgMGgzMHY2MGgtMzB6TTIzMDQgMGgzMHYyNDBoLTMwem0yMDczIDE4MGgzMHY2MGgtMzB6bS0yMzIgMGgzMHY2MGgtMzB6bS0yMjkgMGgzMHY2MGgtMzB6bS0yMjkgMGgzMHY2MGgtMzB6TTM0NTYgMGgzMHYyNDBoLTMwem0yMDczIDE4MGgzMHY2MGgtMzB6bS0yMzIgMGgzMHY2MGgtMzB6bS0yMjkgMGgzMHY2MGgtMzB6bS0yMjkgMGgzMHY2MGgtMzB6TTQ2MDggMGgzMHYyNDBoLTMweiIvPjwvZz48L3N2Zz4K")',backgroundPosition:"bottom",backgroundRepeat:"repeat-x",backgroundSize:(y.current*x*5*5|0)+"px",pointerEvents:"none",touchAction:"none"}},l.default.createElement("span",null,"[",(y.current*x*100|0)/100,"x]"))),l.default.createElement(p.default,{style:{color:"#050c4c4d"},ref:this._set_ripple_ref,center:!1}))}}]),e}(l.default.PureComponent),T=function(){var t=this;this._set_cursor=function(e,_){t.super_state.set_cursor(e,_)},this.xxhashthat=function(e){return t.xxhash.base58_that(e)},this._new_blank=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t.super_state.set_state({_id:Date.now(),pxl_width:parseInt(e),pxl_height:parseInt(_),_pxl_indexes_of_selection:new i.SetFixed(e*_),_base64_original_images:[],_layers:[{id:Date.now(),name:"Layer 0",hidden:!1,opacity:1}],_json_state_history:{history_position:0,state_history:[]},_s_layers:[o.Layer.new_from_colors_and_indexes(new Uint32Array(1),new Uint16Array(parseInt(e)*parseInt(_)),parseInt(e),parseInt(_),!0)],_layer_index:0,_pxls_hovered:-1,_original_image_index:-1,_last_action_timestamp:Date.now()}).then((function(){t._set_size()}))},this._set_size=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e=e||t.super_state.get_state().pxl_width,_=_||t.super_state.get_state().pxl_height,t.super_state.set_state({pxl_width:e,pxl_height:_}).then((function(){t.canvas_pos.set_sizes(e,_),t.canvas_pos.set_current_scale_default(),t._request_force_update(!1,!1).then((function(){t.super_canvas.setDimensions(e,_).then((function(){t.super_master_meta.update_canvas(!0).catch((function(){t._set_size(e,_)}))})).catch((function(){t.super_master_meta.update_canvas(!0).catch((function(){t._set_size(e,_)}))}))})).catch((function(){t._set_size(e,_)}))}))},this.export_state=function(){t._notify_export_state()},this._notify_export_state=function(){t.props.on_state_export&&t.props.on_state_export(),t.props.on_state_exported&&t.export_JS_state((function(e){t.props.on_state_exported(e)}))},this._maybe_update_selection_highlight=function(){var e=t.super_state.get_state(),_=e.tool,n=e._select_shape_index_a,a=e._selection_pair_highlight;_.toUpperCase().includes("SELECT")&&parseInt(n)<0&&t.super_state.set_state({_selection_pair_highlight:!a}).then((function(){t.super_master_meta.update_canvas(!1,Date.now())}))},this._set_props=function(e){t.componentWillReceiveProps(Object.assign(Object.assign({},t.props),e))},this.zoom_in=function(){t.canvas_pos.set_zoom(1.33)},this.zoom_out=function(){t.canvas_pos.set_zoom(.75)},this.current_layer_up=function(){var e=t.super_state.get_state(),_=e._layers,n=e._layer_index,a=e._s_layers;if(n<_.length-1)return _.splice(n+1,0,_.splice(n,1)[0]),a.splice(n+1,0,a.splice(n,1)[0]),t.super_state.set_state({_layers:_,_layer_index:parseInt(n+1),_s_layers:a,_last_action_timestamp:Date.now()}).then((function(){return t.super_master_meta.update_canvas(!0),t._maybe_save_state(void 0,!0),Promise.resolve()}))},this.current_layer_down=function(){var e=t.super_state.get_state(),_=e._layers,n=e._layer_index,a=e._s_layers;if(n>0)return _.splice(n-1,0,_.splice(n,1)[0]),a.splice(n-1,0,a.splice(n,1)[0]),t.super_state.set_state({_layers:_,_s_layers:a,_layer_index:parseInt(n-1),_last_action_timestamp:Date.now()}).then((function(){return t.super_master_meta.update_canvas(!0),t._maybe_save_state(void 0,!0),Promise.resolve()}))},this.new_layer=function(e){var _=t.super_state.get_state(),n=_.pxl_width,a=_.pxl_height,s=t.super_state.get_state(),i=s._layers,r=s._s_layers;return e=void 0===e?r.length:e,r.splice(e+1,0,o.Layer.new_from_colors_and_indexes(Uint32Array.of(0),new Uint8Array(n*a),n,a,!0)),i.splice(e+1,0,{id:Date.now(),hash:"",name:"Layer "+(e+1),hidden:!1,opacity:1,colors:["#00000000"],number_of_colors:1}),t.super_state.set_state({_layers:i,_s_layers:r,_layer_index:e+1,_last_action_timestamp:Date.now()}).then((function(){return t._maybe_save_state(void 0,!0),t.super_master_meta.update_canvas(!0),Promise.resolve()}))},this.new_layer_from_image=function(e){var _=t.super_state.get_state(),n=_._layers,s=_._s_layers,i=(0,o.split_image_data)(e),r=a(i,2),l=r[0],h=r[1];return s.splice(0,0,o.Layer.new_from_colors_and_indexes(h,l,e.width,e.height,!0)),n.splice(0,0,{id:Date.now(),name:"Background",hidden:!1,opacity:1,colors:["#00000000"],number_of_colors:1}),t.super_state.set_state({_layers:n,_s_layers:s,_layer_index:0,_last_action_timestamp:Date.now()}).then((function(){return t._maybe_save_state(void 0,!0),t.super_master_meta.update_canvas(!0),Promise.resolve()}))},this.duplicate_layer=function(e){var _=t.super_state.get_state(),n=_._layers,a=_._s_layers,s=_.pxl_width,i=_.pxl_height;return e=void 0===e?a.length:e,a.splice(e+1,0,o.Layer.new_from_colors_and_indexes(a[e].colors_copy,a[e].indexes_copy,s,i,!0)),n.splice(e+1,0,{id:Date.now(),hash:n[e].hash,name:n[e].name+" (copy)",hidden:!!n[e].hidden,opacity:parseFloat(n[e].opacity),colors:Array.from(n[e].colors||[]),number_of_colors:parseInt(n[e].number_of_colors),thumbnail:n[e].thumbnail}),t.super_state.set_state({_layers:n,_layer_index:e+1,_s_layers:a,_last_action_timestamp:Date.now()}).then((function(){return t.super_master_meta.update_canvas(!0),t._maybe_save_state(void 0,!0),Promise.resolve()}))},this.delete_layer=function(e){var _=t.super_state.get_state(),n=_._layers,a=_._s_layers,s=_._layer_index;if(n.length>1)return a.splice(e,1),n.splice(e,1),s=(s=e-1)<0?0:s,t.super_state.set_state({_layers:n,_layer_index:s,_s_layers:a,_last_action_timestamp:Date.now()}).then((function(){return t.super_master_meta.update_canvas(!0),t._maybe_save_state(void 0,!0),Promise.resolve()}))},this.change_active_layer=function(e){if(t.super_state.get_state()._layers.length>e&&0<=e)return t.super_state.set_state({_layer_index:e,_last_action_timestamp:1/0}).then((function(){return t.super_master_meta.update_canvas(!0),t._maybe_save_state(void 0,!0),Promise.resolve()}))},this.toggle_layer_visibility=function(e){var _=Array.from(t.super_state.get_state()._layers);_[parseInt(e)].hidden=!_[parseInt(e)].hidden,t.super_state.set_state({_layers:_,_last_action_timestamp:Date.now()}).then((function(){return t.super_master_meta.update_canvas(!0)}))},this.change_layer_opacity=function(e,_){var n=Array.from(t.super_state.get_state()._layers);n[parseInt(e)].opacity=parseFloat(_),t.super_state.set_state({_layers:n,_last_action_timestamp:Date.now()}).then((function(){return t.super_master_meta.update_canvas(!0)}))},this.merge_down_layer=function(e){var _,n,s,i,r,l,h,p,c,u,d=t.super_state.get_state(),f=d._layers,m=d._s_layers,g=d.pxl_width,y=d.pxl_height;if(void 0!==f[e]&&void 0!==f[e-1]){for(_=m[e].indexes,n=m[e-1].indexes,s=m[e].colors,i=m[e-1].colors,r=255&Math.round(255*parseFloat(f[e].opacity)),l=255&Math.round(255*parseFloat(f[e-1].opacity)),h=0|_.length,p={id:Date.now(),name:"Merged layers "+e+"+"+(e-1),hidden:!(!f[e].hidden||!f[e-1].hidden),opacity:parseFloat(1)},c=C.default.init(2,h,Uint8Array.of(l,r)),u=0;(0|u)<(0|h);u=(u+1|0)>>>0)c.for(u,0),c.stack(0,i[n[0|u]]),c.stack(1,s[_[0|u]]),c.next();c.blend(!1,!1).then((function(_){var n,s,i,r,l,h=a(_,2),u=h[0],d=h[1],v=new Uint32Array(new ArrayBuffer(y*g*4)),x=0|u.length;for(n=0;F.simdops.int_less(n,x);n=F.simdops.plus_uint(n,1))v[u[n]]=d[0|n];s=new ImageData(new Uint8ClampedArray(v.buffer),g,y),r=(i=t._get_pixels_palette_and_list_from_image_data(s,!0)).new_pxl_colors,l=i.new_pxls,c.clear(),f.splice(e-1,2,p),m.splice(e-1,2,o.Layer.new_from_colors_and_indexes(r,l,g,y,!0)),t.super_state.set_state({_layer_index:e-1,_layers:f,_s_layers:m,_old_pxl_colors:new Uint32Array(m[0].indexes.length),_last_action_timestamp:Date.now()}).then((function(){t.super_master_meta.update_canvas(!0),t._maybe_save_state(void 0,!0)}))}))}},this.compute_filters_preview=function(){t._notify_filters_change(1)},this._notify_filters_change=function(){var e,_,n,a,s,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;t.props.onFiltersThumbnailChange&&(e=t.super_state.get_state(),_=e._processing_filters,n=e._layer_index,a=e._last_filters_hash,s=e._s_layers,i=e._filter_thumbnails,s[n].hash_hex_async().then((function(e){var r,l,h;a===e&&!1!==_||(r=i||new Map,l=0,h=0,t.super_state.set_state({_last_filters_hash:e,_processing_filters:!0}).then((function(){t.filters.names.forEach((function(_,a,i){t.filters.use(_,s[n],o,!0).bitmap_async().then((function(n){h++;var a=r.get(_);void 0!==a&&void 0!==a.destroy&&a.destroy(),r.set(_,n),l=Math.round(h/i.length*100).toString(),t.props.onFiltersThumbnailChange(r,e,l),r.size===i.length&&t.super_state.set_state({_filter_thumbnails:r,_processing_filters:!1})}))}))})))})))},this.get_pixel_color_from_pos=function(e,_){return t.super_master_meta.get_pixel_color_from_pos(e,_)},this.get_layer_bitmap_image=function(e,_,n,a,s){t.bmp_layer.render(e,_,n,a,s)},this.set_png_compressors=function(e,_){t.png_quant=e||t.png_quant,t.oxi_png=_||t.oxi_png},this.get_base64_png_data_url=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,_=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:35;return t._get_base64_png_data_url(e,_,n,a,s)},this._get_base64_png_data_url=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,_=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:35,s=t.super_state.get_state(),i=s.pxl_width,o=s.pxl_height,r=s._s_layers,l=s._layers;return new Promise((function(s,h){f.default.from(u.default,parseInt(i),parseInt(o),r.map((function(t){return t.indexes})),r.map((function(t){return t.colors})),l,parseInt(e),!0).render().then((function(e){t.png_quant&&0!==_&&e.colors.length<=256?t.png_quant(""+e.url,n,a,_,u.default).then((function(t){e.url=t,s(e)})).catch((function(t){this.props.set_compressor(),h(t)})):t.oxi_png&&0!==_&&e.colors.length>256?t.oxi_png(""+e.url,Math.round(a/33),!1,u.default).then((function(t){e.url=t,s(e)})).catch((function(t){this.png_quant(""+e.url,n,a,_,u.default).then((function(t){e.url=t,s(e)})).catch((function(t){this.props.set_compressor(),h(t)}))})):s(e)})).catch((function(t){h(t)}))}))},this._get_pixels_palette_and_list_from_image_data=function(e){var _,n,a,s,i,o,r,l,h,p,c,u,d=arguments.length>1&&void 0!==arguments[1]&&arguments[1],f=t.super_state.get_state(),m=f.max_size,g=f._lazy_lazy_compute_time_ms,y=(f.pxl_width,f.pxl_height,e.data.length/4>m*m),v=[],x=new Set,w=void 0;if(!y||d)for(w=new Uint16Array(e.width*e.height).fill(0),_=0;_<e.data.length;_+=4)n=new F.Color(Uint8ClampedArray.of(e.data[_+0],e.data[_+1],e.data[_+2],e.data[_+3])).uint32,-1===(a=x.has((0|n)>>>0)?v.indexOf((0|n)>>>0):-1)&&(a=(v.push((0|n)>>>0)-1|0)>>>0,x.add((0|n)>>>0)),w[_/4|0]=(0|a)>>>0;else for(s=Date.now(),w=new Uint16Array(e.width*(m+1)).fill(0),i=0,o=0;o<=m&&!(s+g<Date.now());o++){for(r=Math.round(i)*e.width*4,l=0;l<4*e.width;l+=4)h=l+r,p=new F.Color(Uint8ClampedArray.of(e.data[h+0],e.data[h+1],e.data[h+2],e.data[h+3])).uint32,v.includes(p)||v.push(p),c=v.indexOf(p),w[o*e.width+l/4]=c;i+=e.height/m}return{too_much_pixel_cpu_would_go_brrrrr:y,ratio_pixel_per_color:(u=t.color_conversion.clean_duplicate_colors(w,v))[0].length/u[1].length,new_pxl_colors:u[1],new_pxls:u[0]}},this._get_new_ctx_from_canvas=function(t,e){var _,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"high",s=document.createElement("canvas");return s.width=t,s.height=e,_=s.getContext("2d"),n?(_.mozImageSmoothingEnabled=!1,_.webkitImageSmoothingEnabled=!1,_.msImageSmoothingEnabled=!1,_.imageSmoothingEnabled=!1):a.length&&(_.imageSmoothingQuality=a),[_,s]},this.copy_selection=function(){t.import_image_on_canvas_from_selection()},this.cut_selection=function(){t.import_image_on_canvas_from_selection(),t.erase_selection(),t.to_selection_none()},this.erase_selection=function(){var e=t.super_state.get_state(),_=e._s_layers,n=e._layer_index,a=e._pxl_indexes_of_selection,s=(e.pxl_width,e.pxl_height,Array.from(_[n].colors));a.size>0&&(s.includes(0)||(s.push(0),_[n].set_colors(s)),a.forEach((function(t){_[n].set_uint32(t,0)})),t.super_state.set_state({_s_layers:_,_last_action_timestamp:Date.now()}).then((function(){t.super_master_meta.update_canvas()})))},this.import_image_on_canvas_from_selection=function(){var e,_,n,s,i,o,r,l,h,p,c,u,d,f=t.super_state.get_state(),m=f._s_layers,g=f._layer_index,y=f._pxl_indexes_of_selection,v=f.pxl_width,x=f.pxl_height;if(y.size>0){for(e=[v,x],_=[-1,-1],y.forEach((function(t){var n=t%v,a=(t-n)/v;n<e[0]&&(e[0]=n),a<e[1]&&(e[1]=a),n>_[0]&&(_[0]=n),a>_[1]&&(_[1]=a)})),n=1+_[0]-e[0],s=1+_[1]-e[1],i=m[g].indexes,o=new Uint16Array(n*s),r=Array.from(m[g].colors),l=0;l<n*s;l++)p=(l-(h=l%n))/n,h+=e[0],c=(p+=e[1])*v+h,y.has(c)?o[l]=i[c]:(r.includes(0)||r.push(0),o[l]=r.indexOf(0));u=t.color_conversion.clean_duplicate_colors(o,r),o=(d=a(u,2))[0],r=d[1],t.super_state.set_state({_imported_image_start_x:e[0],_imported_image_start_y:e[1],_imported_image_scale_delta_x:0,_imported_image_scale_delta_y:0,_imported_image_pxls:o,_imported_image_width:n,_imported_image_height:s,_imported_image_pxl_colors:r}).then((function(){t._notify_image_import_complete(),t._notify_is_image_import_mode(),t.super_master_meta.update_canvas()}))}},this.import_image_on_canvas=function(e){return t.props.onImageImport&&t.props.onImageImport(),new Promise((function(_,n){setTimeout((function(){var n,s,i,o,r,l,h,p=t.super_state.get_state(),c=(p.pxl_width,p.pxl_height,e.width),u=e.height;n=t._get_new_ctx_from_canvas(c,u,!0),i=(s=a(n,2))[0],s[1],i.drawImage(e,0,0,c,u),o=i.getImageData(0,0,c,u),i=null,l=(r=t._get_pixels_palette_and_list_from_image_data(o,!0)).new_pxl_colors,h=r.new_pxls,o=null,t.super_state.set_state({_imported_image_start_x:0,_imported_image_start_y:0,_imported_image_scale_delta_x:0,_imported_image_scale_delta_y:0,_imported_image_pxls:h,_imported_image_width:c,_imported_image_height:u,_imported_image_pxl_colors:l}).then((function(){t._notify_image_import_complete(),t._notify_is_image_import_mode(),t.super_master_meta.update_canvas(!0),t._maybe_save_state(void 0,!0),_()}))}),50)}))},this.set_canvas_from_image=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];t.props.onLoad&&t.props.onLoad("image_load"),n.id?t.super_state.set_state({_id:Date.now(),pxl_width:parseInt(n.width),pxl_height:parseInt(n.height),_pxl_indexes_of_selection:new i.SetFixed(n.width*n.height),_base64_original_images:[_],_s_layers:[o.Layer.new_from_colors_and_indexes(n.pxl_colors,n.pxls,parseInt(n.width),parseInt(n.height),!0)],_layers:[{id:Date.now(),name:"Layer 0",hidden:!1,opacity:1}],_layer_index:0,_pxls_hovered:-1,_original_image_index:0,_last_action_timestamp:Date.now(),_json_state_history:{history_position:0,state_history:[]}}).then((function(){t._set_size(),t._notify_image_load_complete(),t._notify_export_state()})):setTimeout((function(){var n,r,l,h,p,c,u,d,f,m,g,y,v,x,w,b,M,I,z,C,A,S,j,E,D,L,k,O,F,U,G,T,N,P,H,R,B,W,Y,q,Z,Q,V,J,X,K,$,tt,et,_t=t.super_state.get_state(),nt=_t.default_size,at=_t.max_size,st=_t.ideal_size,it=_t._base64_original_images,ot=_t.dont_change_img_size_onload,rt=_t.dont_compute_base64_original_image,lt=e.naturalWidth,ht=e.naturalHeight,pt=t._get_new_ctx_from_canvas(lt,ht,!0),ct=a(pt,2),ut=ct[0],dt=ct[1];if(ut.drawImage(e,0,0,lt,ht),n=ut.getImageData(0,0,lt,ht),r=rt?"":_.length>0?_:dt.toDataURL("image/jpeg"),ut=null,dt=null,l=!1,h=1,!1===ot){if(c=(p=t._get_pixels_palette_and_list_from_image_data(n,!0)).new_pxls,u=p.new_pxl_colors,n=null,d=c.length/u.length,!(f=at*at>ht*lt)){if(m=1/0,y=0,v=-1,(g=[])[1]=0,c.forEach((function(t,e){v===t||0===e?y++:(y<m&&(m=y),g[y]=void 0!==g[y]?g[y]+1:1,y=1),v=t})),x=1,w=1,b=1,M=Math.sqrt(lt*ht/(st*st)),Object.entries(g).forEach((function(t,e){var _,n,s=a(t,2),i=s[0],o=s[1];(i=parseInt(i))>32||(_=i>32?1:42/(i+10),n=i>32?0:(i>32?1:_*M)*Math.pow(i,1-1/_+1),1!==i&&w<o*i+n&&(b=i,x=o*i,w=o*i+n))})),I=x*M*4>g[1]?b:1,z=I,g[1]<g.length)for(C=0;;){if(void 0!==g[C]&&0!==g[C]){C>g[1]&&(z=C,f=!0);break}C++}if(A=z,Object.entries(g).forEach((function(t,e){var _=a(t,2),n=_[0],s=_[1];n=parseInt(n),e>1&&s>g[A]&&n<z&&(A=n)})),e.naturalWidth%A!=0)for(S=1;e.naturalWidth%(A+S)!=0&&e.naturalWidth%(A-S)!=0&&e.naturalHeight%(A+S)!=0&&e.naturalHeight%(A-S)!=0&&S<16;)e.naturalWidth%(A-S)==0&&e.naturalHeight%(A-S)==0?A-=S:e.naturalWidth%(A+S)==0&&e.naturalHeight%(A+S)==0&&(A+=S),S++;h=1/A}if(E=d>16*Math.sqrt(j=ht*h*(lt*h))&&j<=nt*nt*4||d>9*Math.sqrt(j)&&j<=nt*nt*3||d>4*Math.sqrt(j)&&j<=nt*nt*2||d>1*Math.sqrt(j)&&j<=nt*nt*1,D=j>u.length,(E||f)&&j<at*at&&D&&!0!==s)ht*lt>nt*nt&&(lt*=h,ht*=h,l=!0);else{for(L=1;Math.round(lt*L)*Math.round(ht*L)>nt*nt;)L-=.01;lt*=L,ht*=L}}k=void 0,O=null,l&&!1===ot?(N=(G=ht/h)-G%(F=1/h),P=Math.floor((T=(U=lt/h)-U%F)/F),H=Math.floor(N/F),R=T,B=N,W=Math.floor((U-T)/2),Y=Math.floor((G-N)/2),lt=Math.floor(P),ht=Math.floor(H),q=t._get_new_ctx_from_canvas(lt,ht,!0),k=(Z=a(q,2))[0],Z[1],k.drawImage(e,W,Y,R,B,0,0,lt,ht),O=k.getImageData(0,0,lt,ht)):!1===ot?(lt=Math.floor(lt),ht=Math.floor(ht),Q=t._get_new_ctx_from_canvas(lt,ht,!0),k=(V=a(Q,2))[0],V[1],k.drawImage(e,0,0,lt,ht),O=k.getImageData(0,0,lt,ht)):O=n,J=t._get_pixels_palette_and_list_from_image_data(O,!0),k=null,n=null,O=null,(X=it).includes(r)||X.push(r),K=t.color_conversion.clean_duplicate_colors(J.new_pxls,J.new_pxl_colors),tt=($=a(K,2))[0],et=$[1],t.super_state.set_state({_id:Date.now(),pxl_width:parseInt(lt),pxl_height:parseInt(ht),_pxl_indexes_of_selection:new i.SetFixed(lt*ht),_base64_original_images:X,_layers:[{id:Date.now(),name:"Layer 0",hidden:!1,opacity:1}],_json_state_history:{history_position:0,state_history:[]},_s_layers:[o.Layer.new_from_colors_and_indexes(et,tt,parseInt(lt),parseInt(ht),!0)],_layer_index:0,_pxls_hovered:-1,_original_image_index:X.indexOf(r),_last_action_timestamp:Date.now()}).then((function(){t._set_size(),t._notify_image_load_complete(),t._notify_export_state()}))}),50)},this._set_canvas_ref=function(e){if(void 0===e)return t._set_size();if(null===e)return t._set_size();if(void 0===e.width)return t._set_size();if(null===e.width)return t._set_size();var _=t.super_state.get_state(),n=_.pxl_width,a=_.pxl_height;t.super_canvas.new(e,n,a).then((function(){t.super_master_meta.update_canvas(!0),t._maybe_save_state(void 0,!0)}))},this._set_canvas_container_ref=function(e){null!==e&&t.super_state.set_state({_canvas_container:e}).then((function(){t._update_canvas_container_size()}))},this._set_canvas_wrapper_ref=function(e){null!==e&&t.super_state.set_state({_canvas_wrapper:e})},this._set_canvas_wrapper_overflow_ref=function(e){null!==e&&(e.addEventListener("wheel",t._canvas_pos_handle_wheel,{passive:!1}),e.addEventListener("pointerdown",t._canvas_pos_handle_pointer_down,{passive:!1}),e.addEventListener("pointermove",t._canvas_pos_handle_pointer_move,{passive:!1}),e.addEventListener("pointerup",t._canvas_pos_handle_pointer_up,{passive:!1}),e.addEventListener("pointercancel",t._canvas_pos_handle_pointer_up,{passive:!1}),e.addEventListener("pointerout",t._canvas_pos_handle_pointer_up,{passive:!1}),e.addEventListener("pointerleave",t._canvas_pos_handle_pointer_up,{passive:!1}),t.super_state.set_state({_canvas_wrapper_overflow:e}))},this._super_master_meta_handle_canvas_mouse_move=function(e){t.super_master_meta._handle_canvas_mouse_move(e)},this._super_master_meta_handle_canvas_mouse_up=function(e){t.super_master_meta._handle_canvas_mouse_up(e)},this._super_master_meta_handle_canvas_mouse_down=function(e){t.super_master_meta._handle_canvas_mouse_down(e)},this._function_ripple=function(e){t._ripple.start(e),setTimeout((function(){t._ripple.stop(e)}),75)},this._canvas_pos_handle_wheel=function(e){t.canvas_pos.handle_wheel(e)},this._canvas_pos_handle_pointer_down=function(e){t.canvas_pos.handle_pointer_down(e)},this._canvas_pos_handle_pointer_move=function(e){t.canvas_pos.handle_pointer_move(e)},this._canvas_pos_handle_pointer_up=function(e){t.canvas_pos.handle_pointer_up(e)},this.write_text=function(e,_){var n,a=t.super_state.get_state()._layer_index;t.new_layer(a),t.change_active_layer(a+1),n=(new t.super_state.create_shape).from_text(e,_),t.super_state.paint_shape(n,t.super_state.get_state().pxl_current_color_uint32)},this._match_color=function(e,_,n){var s,i,o,r,l,h,p,c,u,d,f,m,g,y,v,x,w,b;return 1===(n=void 0===n?null:n)||(0===n?e===_:(s=Math.round(255*n),i=t.color_conversion.to_rgba_from_uint32(e),r=(o=a(i,4))[0],l=o[1],h=o[2],p=o[3],c=t.color_conversion.to_rgba_from_uint32(_),d=(u=a(c,4))[0],f=u[1],m=u[2],g=u[3],y=Math.abs(p-g),v=Math.abs(r-d),x=Math.abs(l-f),w=Math.abs(h-m),b=Math.abs(1-y/255),null!==n?!!(v<s&&x<s&&w<s&&y<s):parseFloat(parseInt(v+x+w)/parseInt(765))*b))},this.exchange_pixel_color=function(e,_,n){var a=t.super_state.get_state(),s=a.pxl_width,i=a._s_layers,o=a._layer_index,r=i[o].colors[i[o].indexes[_*s+e]];(""+n).startsWith("#")&&(n=new F.Color.new_hex(n).uint32),t._exchange_pixel_color(r,n)},this._exchange_pixel_color=function(e,_){t.super_master_meta.exchange_pixel_color(e,_)},this.set_selection_by_colors=function(e,_){var n=t.super_state.get_state(),a=n._s_layers,s=n._layer_index,i=t.super_state.get_state()._pxl_indexes_of_selection,o=a[s].indexes;i.clear(),a[s].colors.forEach((function(n,a){t._match_color(e,n,_)&&o.forEach((function(t,e){t===a&&i.add(e)}))})),t.super_state.set_state({_pxl_indexes_of_selection:i,_last_action_timestamp:Date.now()}).then((function(){t.super_master_meta.update_canvas(),t._notify_is_something_selected()}))},this._handle_canvas_wrapper_overflow_context_menu=function(e){var _=t.canvas_pos.get_canvas_pos_from_event(e.pageX,e.pageY),n=a(_,2),s=n[0],i=n[1],o=t.super_master_meta.get_pixel_color_from_pos(s,i);t.props.onRightClick&&t.props.onRightClick(e,{pos_x:s,pos_y:i,pxl_color:o}),t.props.onRelevantActionEvent&&t.props.onRelevantActionEvent(e,o,1,!1),t.props.setCursorFuckYou&&(t.props.setCursorFuckYou(!0),setTimeout(t.props.setCursorFuckYou,2500,!1))},this.maybe_set_layers=function(e,_,n,a,s){var i=!(void 0===e._layers),o=!!(n>t.super_state.get_state()._layers_defined_at),r=Object.assign({},e);r._layers=Array.from(e._layers.map((function(t){return{id:0|t.id,hash:t.hash+"",name:t.name+"",hidden:t.hidden&&!0,opacity:parseFloat(t.opacity),colors:Array.from(t.colors),number_of_colors:0|t.number_of_colors}}))),s&&o&&i?t.super_state.set_state({_layer_index:parseInt(e._layer_index),_layers:Array.from(e._layers),_layers_defined_at:n}).then((function(){t.props.onLayersChange&&t.props.onLayersChange(t.super_state.get_state()._layer_index,Array.from(e._layers)),null!==_&&_(t.super_state.get_state()._layers,t.super_state.get_state()._layer_index,s,r)})):(t.props.onLayersChange&&t.props.onLayersChange(t.super_state.get_state()._layer_index,Array.from(e._layers)),(s||a)&&i?null!==_&&_(t.super_state.get_state()._layers,t.super_state.get_state()._layer_index,s,r):null!==_&&_(t.super_state.get_state()._layers,t.super_state.get_state()._layer_index,s,{}))},this._get_most_used_color_sorted=function(t,e,_){var n,a,s,i;for(_=Math.min(e.length,_||256),n=new F.Colors(new F.Colors(e.buffer).get_deduplicated_sorted_uint32a(_).buffer),a=new F.Color(new ArrayBuffer(4)),s=Array(_),i=0;i<_;i++)s[i]=n.get_use_element(i,a).hex;return s},this._notify_layers_and_compute_thumbnails_change=function(e,_,n,a){var s,i,o,r,l,h,p,c,u;for(a=a||Date.now(),s=0,i=parseInt(e._timestamp)||Date.now(),o=parseInt(_._timestamp),r=_._layers.length,l=parseInt(i),h=!1,p=!1,c=function(i){_._s_layers[i].bitmap_async(!0).then((function(c){var u=""+c.hash,d=Object.assign({},(e._layers||[])[i]),f=d.thumbnail,m=d.hash;m===u&&m&&f&&_._s_layers[i].thumbnail?(_._layers[i].hash=u,_._layers[i].thumbnail=f,0!==_._layers[i].colors.length&&_._layers[i].colors.length===_._layers[i].number_of_colors||(_._layers[i].colors=t._get_most_used_color_sorted(_._s_layers[i].indexes,_._s_layers[i].colors,256),_._layers[i].number_of_colors=parseInt(_._s_layers[i].colors.length)),++s===r&&(_._timestamp=parseInt(l),t.maybe_set_layers(_,n,a,p,h))):(p=!0,m===u&&m||(h=!0,l=o),_._layers[i].hash=u,_._layers[i].thumbnail=c,_._layers[i].colors=t._get_most_used_color_sorted(_._s_layers[i].indexes,_._s_layers[i].colors,256),_._layers[i].number_of_colors=parseInt(_._s_layers[i].colors.length),++s===r&&(_._timestamp=parseInt(l),t.maybe_set_layers(_,n,a,p,h)))}))},u=0;u<r;u++)c(u)},this._maybe_save_state=function(e,_,n){var a,s,i,r,l,h,p,c,u,d,f,m,g,y,v;_=_||!1,n=n||Date.now(),a=t.canvas_pos.get_style().will_change,s=t.super_state.get_state(),i=s._json_state_history,(n>s._saving_json_state_history_ran_timestamp||_)&&(s._last_action_timestamp+625<=Date.now()||_||0===i.state_history.length)?s._saving_json_state_history_running||a&&!_?setTimeout((function(){t._maybe_save_state(e,_,n)}),125):(t.super_state.set_state({_saving_json_state_history_running:!0}),r=s._id,l=s._layers,h=s.pxl_width,p=s.pxl_height,c=s._s_layers,u=s._original_image_index,d=s._layer_index,f=s._pxl_indexes_of_selection,m=s._pencil_mirror_index,g=parseInt(i.history_position),y=0===i.state_history.length?{}:i.state_history[g-1],(v={})._timestamp=parseInt(Date.now()),v._id=r.toString(),v.pxl_width=parseInt(h),v.pxl_height=parseInt(p),v._original_image_index=parseInt(u),v._layers=Array.from(l.map((function(t){return{id:parseInt(t.id),hash:t.hash+"",name:t.name+"",hidden:!!t.hidden,opacity:parseFloat(t.opacity||1),thumbnail:t.thumbnail||null,colors:Array.from(t.colors||[]),number_of_colors:parseInt(t.number_of_colors||0)}}))),v._layer_index=parseInt(d),v._s_layers=Array.from(c.map((function(t){return t=t||{},o.Layer.new_from_colors_and_indexes(t.colors_copy,t.indexes_copy,parseInt(h),parseInt(p),!0)}))),v._pxl_indexes_of_selection=f.export,v._pencil_mirror_index=parseInt(m),t._notify_layers_and_compute_thumbnails_change(Object.assign({},y),Object.assign({},v),(function(_,n,a){var o,r,l=s._state_history_length,h=s._saving_json_state_history_ran_timestamp,p=!(0!==i.state_history.length),c=parseInt(i.history_position),u=v._timestamp||0,d=Date.now();if(p&&0!==u)i.state_history=[],i.state_history.push(Object.assign({},v)),i.history_position=1,h=d;else if(a){if(i.state_history.length-c>0)for(o=i.state_history.splice(c);o.length;)i.state_history.push(Object.assign({},o.shift()));i.state_history.length>=l&&i.state_history.splice(1,1),i.state_history.push(Object.assign({},v)),i.history_position=parseInt(i.state_history.length),h=d}else for(r=0;r<i.state_history.length;r++)(0|i.state_history[r]._timestamp)===u&&(i.state_history[r]=Object.assign({},v),h=d,r=i.state_history.length);t.super_state.set_state({_json_state_history:Object.assign({},i),_saving_json_state_history_running:!1,_saving_json_state_history_ran_timestamp:h}).then((function(){t._notify_can_undo_redo_change(),e&&e(Object.assign({},i),!(h!==d))}))}))):e&&e(Object.assign({},i),!1)},this._notify_is_something_selected=function(){var e=t.super_state.get_state(),_=e._pxl_indexes_of_selection;!!e._previous_pxl_indexes_of_selection.size!=!!_.size&&t.super_state.set_state({_is_something_selected:!!_.size,_previous_pxl_indexes_of_selection:i.SetFixed.import(_.export)}).then((function(){t.props.onSomethingSelectedChange&&t.props.onSomethingSelectedChange(!!_.size)}))},this._notify_image_load_complete=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],_=t.super_state.get_state(),n=_._s_layers,a={width:_.pxl_width,height:_.pxl_height,number_of_colors:n[0].colors.length,only_scan:e};t._maybe_save_state(void 0,!0),t.props.onLoadComplete&&t.props.onLoadComplete("image_load",a)},this._notify_image_import_complete=function(){t.props.onImageImportComplete&&t.props.onImageImportComplete()},this._notify_can_undo_redo_change=function(){t.props.onCanUndoRedoChange&&t.props.onCanUndoRedoChange(t._can_undo(),t._can_redo())},this._notify_size_change=function(){var e=t.super_state.get_state(),_=e.pxl_width,n=e.pxl_height;t.props.onSizeChange&&t.props.onSizeChange(_,n)},this.import_JSON_state=function(e){t.import_JS_state(e)},this.import_JS_state=function(e,_){var n=Array.from(e._base64_original_images);Promise.all(n.map((function(t){return(0,U.bytesToBase64)(t[1])}))).then((function(a){var s,r;a.forEach((function(t,e){n[e]=n[e][0]+","+t})),s={history_position:parseInt(e._json_state_history.history_position),state_history:e._json_state_history.state_history.map((function(t){return Object.assign({},{_original_image_index:parseInt(t._original_image_index),pxl_width:parseInt(t.pxl_width),pxl_height:parseInt(t.pxl_height),_pxl_indexes_of_selection:i.SetFixed.import(t._pxl_indexes_of_selection),_s_layers:Array(t._s_pxls.length).fill({}).map((function(e,_){return o.Layer.new_from_colors_and_indexes(t._s_pxl_colors[_],t._s_pxls[_],parseInt(t.pxl_width),parseInt(t.pxl_height),!0)})),_layers:Array.from(t._layers.map((function(t){return Object.assign({},{id:parseInt(t.id),hash:t.hash+"",name:t.name+"",hidden:!!t.hidden,opacity:parseFloat(t.opacity)})}))),_layer_index:parseInt(t._layer_index),_pencil_mirror_index:parseInt(t._pencil_mirror_index),_id:t._id.toString()})}))},e=null,r=s.state_history[s.history_position-1],t.super_state.set_state({_id:r._id.toString(),pxl_width:parseInt(r.pxl_width),pxl_height:parseInt(r.pxl_height),_base64_original_images:Array.from(n),_original_image_index:parseInt(r._original_image_index)||0,_layers:Array.from(r._layers.map((function(t){return{id:parseInt(t.id),hash:t.hash+"",name:t.name+"",hidden:!!t.hidden,opacity:parseFloat(t.opacity)}}))),_layer_index:parseInt(r._layer_index)||0,_s_layers:Array.from(r._s_layers),_pxl_indexes_of_selection:i.SetFixed.import(r._pxl_indexes_of_selection),_pencil_mirror_index:parseInt(r._pencil_mirror_index),_json_state_history:s,_pxls_hovered:-1,_last_action_timestamp:1/0}).then((function(){t._set_size(),t._notify_image_load_complete(),t._notify_is_something_selected(),t._notify_can_undo_redo_change(),_()}))}))},this.export_JS_state=function(e){t._maybe_save_state((function(_){var n=t.super_state.get_state()._base64_original_images.map((function(t){return t.split(",")}));Promise.all([Promise.all(n.map((function(t){return(0,U.base64ToBytes)(t[1])}))),t.get_base64_png_data_url(1,!1,1,100,100)]).then((function(a){Array.from(a[0]).forEach((function(t,e){n[e][1]=t})),_={history_position:parseInt(_.history_position),state_history:_.state_history.map((function(t){return Object.assign({},{_original_image_index:parseInt(t._original_image_index),pxl_width:parseInt(t.pxl_width),pxl_height:parseInt(t.pxl_height),_pxl_indexes_of_selection:t._pxl_indexes_of_selection.export,_s_pxls:Array.from(t._s_layers).map((function(t){return t.indexes_copy})),_s_pxl_colors:Array.from(t._s_layers).map((function(t){return t.colors_copy})),_layers:Array.from(t._layers.map((function(t){return{id:parseInt(t.id),hash:t.hash+"",name:t.name+"",hidden:!!t.hidden,opacity:parseFloat(t.opacity)}}))),_layer_index:parseInt(t._layer_index),_pencil_mirror_index:parseInt(t._pencil_mirror_index),_id:t._id.toString()})}))};var s=3*Math.ceil(a[1].url.length/4);e({id:t.super_state.get_state()._id.toString(),kb:s/1024,preview:a[1].url,timestamp:Date.now(),_base64_original_images:n,_json_state_history:_})}))}))},this._can_undo=function(e){return e||(e=t.super_state.get_state()._json_state_history),parseInt(e.history_position-1)},this.undo=function(){t._maybe_save_state((function(e){var _,n;t._can_undo(e)>0&&(e.history_position=parseInt(e.history_position-1),_=e.state_history[e.history_position-1],n=!(_.pxl_width===t.super_state.get_state().pxl_width&&_.pxl_height===t.super_state.get_state().pxl_height),t.super_state.set_state({_id:_._id.toString(),pxl_width:parseInt(_.pxl_width),pxl_height:parseInt(_.pxl_height),_original_image_index:parseInt(_._original_image_index),_layers:Array.from(_._layers.map((function(t){return{id:parseInt(t.id),hash:t.hash+"",name:t.name+"",hidden:!!t.hidden,opacity:parseFloat(t.opacity)}}))),_layer_index:parseInt(_._layer_index),_s_layers:Array.from(_._s_layers.map((function(t){return o.Layer.new_from_colors_and_indexes(t.colors_copy,t.indexes_copy,parseInt(_.pxl_width),parseInt(_.pxl_height),!0)}))),_pxl_indexes_of_selection:i.SetFixed.import(_._pxl_indexes_of_selection),_pencil_mirror_index:parseInt(_._pencil_mirror_index),_json_state_history:e,_last_action_timestamp:Date.now()}).then((function(){n?t._set_size():t.super_master_meta.update_canvas(!0),t._notify_is_something_selected(),t._notify_can_undo_redo_change()})))}),!0)},this._can_redo=function(e){return e||(e=t.super_state.get_state()._json_state_history),e.state_history.length-parseInt(e.history_position-1)-1|0},this.redo=function(){t._maybe_save_state((function(e){var _,n;t._can_redo(e)>0&&(e.history_position=parseInt(e.history_position+1),_=e.state_history[e.history_position-1],n=!(_.pxl_width===t.super_state.get_state().pxl_width&&_.pxl_height===t.super_state.get_state().pxl_height),t.super_state.set_state({_id:_._id.toString(),pxl_width:parseInt(_.pxl_width),pxl_height:parseInt(_.pxl_height),_original_image_index:parseInt(_._original_image_index),_layers:Array.from(_._layers.map((function(t){return{id:parseInt(t.id),hash:t.hash+"",name:t.name+"",hidden:!!t.hidden,opacity:parseFloat(t.opacity)}}))),_layer_index:parseInt(_._layer_index),_s_layers:Array.from(_._s_layers.map((function(t){return o.Layer.new_from_colors_and_indexes(t.colors_copy,t.indexes_copy,parseInt(_.pxl_width),parseInt(_.pxl_height),!0)}))),_pxl_indexes_of_selection:i.SetFixed.import(_._pxl_indexes_of_selection),_pencil_mirror_index:parseInt(_._pencil_mirror_index),_json_state_history:e,_last_action_timestamp:Date.now()}).then((function(){n?t._set_size():t.super_master_meta.update_canvas(!0),t._notify_is_something_selected(),t._notify_can_undo_redo_change()})))}),!0)},this.to_selection_border=function(){var e=t.super_state.get_state(),_=e.pxl_current_color_uint32,n=e._pxl_indexes_of_selection,a=e._s_layers,s=e._layer_index,i=e.pxl_current_opacity,o=(a[s]||{}).indexes_copy||new Uint8Array(0),r=Array.from(a[s].colors_copy);t._get_border_from_selection(n).forEach((function(e){var n,a=o[e],s=r[a],l=t.color_conversion.blend_colors(s,_,i,!1,!1);r.includes(l)||r.push(l),n=r.indexOf(l),o[e]=n})),a[s].set_colors_and_indexes(r,o),t.super_state.set_state({_s_layers:a,_last_action_timestamp:Date.now()}).then((function(){return t.super_master_meta.update_canvas()}))},this.to_selection_bucket=function(){var e=t.super_state.get_state(),_=e._s_layers,n=e._pxl_indexes_of_selection,a=e._layer_index,s=e.pxl_current_opacity,i=e.pxl_current_color_uint32,o=Array.from(_[a].indexes),r=Array.from(_[a].colors);n.forEach((function(e){var _,n=o[e],a=r[n],l=t.color_conversion.blend_colors(a,i,s,!1,!1);r.includes(l)||r.push(l),_=r.indexOf(l),o[e]=_})),_[a].set_colors_and_indexes(r,o),t.super_state.set_state({_s_layers:_,_last_action_timestamp:Date.now()}).then((function(){return t.super_master_meta.update_canvas()}))},this.to_selection_invert=function(){var e,_=t.super_state.get_state(),n=_._s_layers,a=_._pxl_indexes_of_selection,s=_._layer_index,o=_.pxl_width,r=_.pxl_height,l=a,h=new i.SetFixed(o*r);for(e=0;e<n[s].indexes.length;e++)l.has(e)||h.add(e);t.super_state.set_state({_pxl_indexes_of_selection:h,_last_action_timestamp:Date.now()}).then((function(){return t.super_master_meta.update_canvas()}))},this.get_average_color_of_selection=function(){return t.color_conversion.to_hex_from_uint32(t._get_average_color_of_selection())},this._get_average_color_of_selection=function(e,_,n){var s,o,r,l,h=t.super_state.get_state(),p=h._s_layers,c=h._layer_index,u=h.pxl_width,d=h.pxl_height;return _=_||p[c].indexes,n=n||p[c].colors,s=new i.SetFixed(u*d),o=[],s.forEach((function(t){o[t]=1})),(e=e||t.super_state.get_state()._pxl_indexes_of_selection).forEach((function(t){o[_[t]]++})),r=0,Object.entries(o).forEach((function(t){r+=t[1]})),l=0,Object.entries(o).forEach((function(e){var _=a(e,2),s=_[0],i=_[1];l=t.color_conversion.blend_colors(l,n[s],i/r,!1,!1)})),l},this.to_selection_changes=function(e){var _=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.color_conversion.to_rgba_from_uint32(e),s=a(n,4),i=s[0],o=s[1],r=s[2],l=s[3],h=t.color_conversion.to_hsla_from_rgba(Uint8ClampedArray.of(i,o,r,l)),p=a(h,4),c=p[0],u=p[1],d=p[2],f=(p[3],t.super_state.get_state()),m=f._s_layers,g=f._pxl_indexes_of_selection,y=f._layer_index,v=Array.from(m[y].indexes),x=Array.from(m[y].colors),w=t._get_average_color_of_selection(),b=t.color_conversion.to_rgba_from_uint32(w),M=a(b,4),I=M[0],z=M[1],C=M[2],A=M[3],S=t.color_conversion.to_hsla_from_rgba(Uint8ClampedArray.of(I,z,C,A)),j=a(S,4),E=j[0],D=(j[1],j[2],j[3],E-c);g.forEach((function(e,n,s){var i,o,r,l,h,p,c,f=v[e],m=x[f],g=t.color_conversion.to_rgba_from_uint32(m),y=a(g,4),w=y[0],b=y[1],M=y[2],I=y[3],z=t.color_conversion.to_hsla_from_rgba(Uint8ClampedArray.of(w,b,M,I)),C=a(z,4),A=C[0],S=C[1],j=C[2],E=C[3],L=A+D<0?(360+A+D)%360:(A+D)%360,k=[u,d,1],O=[S,j,1],F=[];0!==I&&_?(F[2]=1-(1-k[2])*(1-O[2]),F[0]=Math.round(k[0]*k[2]/F[2]+O[0]*O[2]*(1-k[2])/F[2]),F[1]=Math.round(k[1]*k[2]/F[2]+O[1]*O[2]*(1-k[2])/F[2])):F=[S,j],i=t.color_conversion.to_rgba_from_hsla(Array.of(L,F[0],F[1],E)),r=(o=a(i,4))[0],l=o[1],h=o[2],p=o[3],c=0,0!==I&&(c=t.color_conversion.to_uint32_from_rgba(Uint8ClampedArray.of(r,l,h,p))),x.includes(c)||x.push(c),v[e]=x.indexOf(c)})),m[y].set_colors_and_indexes(x,v),t.super_state.set_state({_s_layers:m,_last_action_timestamp:Date.now()}).then((function(){return t.super_master_meta.update_canvas()}))},this._get_border_from_selection=function(e){var _=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=t.super_state.get_state(),s=a.pxl_width,o=a.pxl_height,r=new i.SetFixed(s*o);return e.forEach((function(t,a){var i,l,h,p,c=void 0,u=void 0,d=void 0,f=void 0;u=(u=t+1)%s==0?-1:u,f=(f=t-1)%s==s-1?-1:f,i=void 0,l=void 0,h=void 0,p=void 0,i=(c=(c=t-s)<0?-1:c)-1,i=-1===c||-1===f?-1:i,l=c+1,l=-1===c||-1===u?-1:l,h=(d=(d=t+s)>s*o?-1:d)-1,h=-1===d||-1===f?-1:h,p=d+1,p=-1===d||-1===u?-1:p,_?(e.has(c)&&-1!==c&&e.has(u)&&-1!==u&&e.has(d)&&-1!==d&&e.has(f)&&-1!==f||r.add(t),n&&(e.has(i)&&-1!==i&&e.has(l)&&-1!==l&&e.has(h)&&-1!==h&&e.has(p)&&-1!==p||r.add(t))):(e.has(c)||r.add(c),e.has(u)||r.add(u),e.has(d)||r.add(d),e.has(f)||r.add(f),n&&(e.has(i)||r.add(i),e.has(l)||r.add(l),e.has(h)||r.add(h),e.has(p)||r.add(p)))})),r},this._to_selection_crop=function(){var e,_,n,s,r,l,h,p,c,u,d,f,m=t.super_state.get_state(),g=m._s_layers,y=(m._layer_index,m._pxl_indexes_of_selection),v=m.pxl_width,x=m.pxl_height,w=m._base64_original_images,b=m._original_image_index;if(y.size>0){for(e=[v,x],_=[-1,-1],y.forEach((function(t){var n=t%v,a=(t-n)/v;n<e[0]&&(e[0]=n),a<e[1]&&(e[1]=a),n>_[0]&&(_[0]=n),a>_[1]&&(_[1]=a)})),n=1+_[0]-e[0],s=1+_[1]-e[1],r=0;r<g.length;r++){for(l=g[r].indexes,h=new Uint16Array(n*s),p=0;p<n*s;p++)u=(p-(c=p%n))/n,c+=e[0],d=(u+=e[1])*v+c,h[p]=l[d];g[r]=o.Layer.new_from_colors_and_indexes(g[r].colors,h,n,s)}void 0!==w[b]?((f=new Image).onload=function(){var _,o,r=f.width*(n/v)|0,l=f.height*(s/x)|0,h=t._get_new_ctx_from_canvas(r,l),p=a(h,2),c=p[0],u=p[1];c.drawImage(f,f.width*(e[0]/v)|0,f.height*(e[1]/x)|0,r,l,0,0,r,l),_=f.src.includes("image/webp")?u.toDataURL("image/webp"):f.src.includes("image/png")?u.toDataURL("image/png"):u.toDataURL("image/jpeg"),o=w.includes(_)?w:w.concat([_]),t.super_state.set_state({_s_layers:g,pxl_width:n,pxl_height:s,_pxl_indexes_of_selection:new i.SetFixed(n*s),_base64_original_images:o,_original_image_index:o.indexOf(_),_last_action_timestamp:Date.now()}).then((function(){t._notify_image_load_complete(!0),t._set_size()}))},f.src=w[b]):t.super_state.set_state({_s_layers:g,pxl_width:n,pxl_height:s,_pxl_indexes_of_selection:new i.SetFixed(n*s),_last_action_timestamp:Date.now()}).then((function(){t._notify_image_load_complete(!0),t._set_size()}))}},this.to_selection_size=function(e){var _=t.super_state.get_state()._pxl_indexes_of_selection;_=t._to_selection_size(e,_),t.super_state.set_state({_pxl_indexes_of_selection:_}).then((function(){return t.super_master_meta.update_canvas()}))},this._to_selection_size=function(e,_){var n,a;for(n=1;n<=Math.abs(e);n++)a=t._get_border_from_selection(_,e<0,!1),e<0?a.forEach((function(t){_.delete(t)})):a.forEach((function(t){_.add(t)}));return _},this.to_selection_none=function(){t.super_state.get_state()._pxl_indexes_of_selection.clear(),t._notify_is_something_selected(),t.super_master_meta.update_canvas()},this.confirm_import=function(){return t._merge_import()},this._merge_import=function(){var e=t.super_state.get_imported_image_data(),_=e.imported_image_pxls_positioned,n=e.imported_image_pxl_colors,s=t.super_state.get_state(),i=s._s_layers,o=i[s._layer_index];return Object.entries(_).forEach((function(t){var e=a(t,2),_=e[0],s=e[1];o.set_uint32(_,n[s])})),t.super_state.set_state({_s_layers:i,_imported_image_start_x:0,_imported_image_start_y:0,_imported_image_scale_delta_x:0,_imported_image_scale_delta_y:0,_imported_image_pxls:[],_imported_image_width:0,_imported_image_height:0,_imported_image_pxl_colors:[],_imported_image_move_from:[0,0],_last_action_timestamp:Date.now()}).then((function(){return t.super_master_meta.update_canvas(!0),t._notify_is_image_import_mode(),Promise.resolve()}))},this._notify_is_image_import_mode=function(){var e=t.super_state.get_state()._imported_image_pxls.length>0;t.super_state.set_state({_is_image_import_mode:e}),t.props.onImageImportModeChange&&t.props.onImageImportModeChange(e)},this.to_selection_crop=function(){t._to_selection_crop()},this.to_rotation=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t._to_rotation(e)},this.to_greyscale=function(){t._to_colorized("greyscale")},this.to_sepia=function(){t._to_colorized("sepia")},this.to_opacity=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;t._to_colorized(null,e)},this.to_color=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;t._to_colorized(e,_,n,a)},this.to_vignette=function(e,_){t._to_vignette(e,_)},this.less_colors_stepped=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};t._to_less_color(e,_)},this.less_colors_stepped=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=0,a=e;!function s(){t.to_less_color(a/64,(function(t){n=t.colors_removed,a+=e,e-=n>0?1:0,n<1?s():_(t)}))}()},this.to_less_color=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/16,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};t.props.onLoad&&("auto"===e?t.props.onLoad("less_color_auto"):t.props.onLoad("less_color")),t._to_less_color(e,(function(n){t.props.onLoadComplete&&("auto"===e?t.props.onLoadComplete&&t.props.onLoadComplete("less_color_auto",n):t.props.onLoadComplete&&t.props.onLoadComplete("less_color",n)),_(n)}))},this.auto_adjust_contrast=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;t._auto_adjust_contrast(e)},this.auto_adjust_saturation=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1.5;t._auto_adjust_saturation(e)},this.smooth_adjust=function(){t._auto_adjust_smoothness()},this.to_alpha=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#00000000",_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;t._to_alpha(t.color_conversion.to_uint32_from_hex(t.color_conversion.format_hex_color(e)),_)},this.to_filter=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"1997",_=arguments[1];t._to_filter(e,parseFloat(_))},this.to_mirror=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t._invert_pixel(e?"HORIZONTAL":"VERTICAL")},this.to_dutone=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.8,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#ffffffff",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#000000ff";t._to_dutone(e,t.color_conversion.to_uint32_from_hex(t.color_conversion.format_hex_color(_)),t.color_conversion.to_uint32_from_hex(t.color_conversion.format_hex_color(n)))},this._invert_pixel=function(e){var _,n,s,o=t.super_state.get_state(),r=o._s_layers,l=o.pxl_width,h=o.pxl_height,p=o._base64_original_images,c=o._original_image_index,u=o._pxl_indexes_of_selection,d=o._shape_index_a,f=o._select_shape_index_a,m=o._layer_index,g=t.super_state.get_state(),y=g._imported_image_pxls,v=g._imported_image_width,x=g._imported_image_height,w=Array.from(r[m].indexes),b=new i.SetFixed(w.length),M=d,I=f,z=1,C=1;"HORIZONTAL"===e?y.length?(_=new Uint16Array(y.length),y.forEach((function(t,e){var n=e%v;_[(e-n)/v*v+(n=v-1-n)]=t})),y=_):(r[m].indexes.forEach((function(t,e){var _,n=e%l;w[_=(e-n)/l*l+(n=l-1-n)]=t,u.has(e)&&b.add(_),d===e&&(M=_),f===e&&(I=_)})),r[m].set_indexes(w),z=-1):y.length?(n=new Uint16Array(y.length),y.forEach((function(t,e){var _=e%v,a=(e-_)/v;n[(a=x-1-a)*v+_]=t})),y=n):(r[m].indexes.forEach((function(t,e){var _,n=e%l,a=(e-n)/l;w[_=(a=h-1-a)*l+n]=t,u.has(e)&&b.add(_),d===e&&(M=_),f===e&&(I=_)})),C=-1,r[m].set_indexes(w)),void 0===p[c]||0!==m||y.length?t.super_state.set_state({_shape_index_a:M,_select_shape_index_a:I,_pxl_indexes_of_selection:b,_s_layers:r,_last_action_timestamp:Date.now(),_imported_image_pxls:y}).then((function(){return t.super_master_meta.update_canvas()})):((s=new Image).onload=function(){var e,_=t._get_new_ctx_from_canvas(s.naturalWidth,s.naturalHeight),n=a(_,2),i=n[0],o=n[1];i.save(),i.scale(z,C),i.drawImage(s,0,0,s.naturalWidth*z,s.naturalHeight*C),i.restore(),e=s.src.includes("image/png")?o.toDataURL("image/png"):o.toDataURL("image/jpeg"),p.includes(e)||(p.push(e),c++),t.super_state.set_state({_shape_index_a:M,_select_shape_index_a:I,_pxl_indexes_of_selection:b,_s_layers:r,_base64_original_images:p,_original_image_index:c,_imported_image_pxls:y,_last_action_timestamp:Date.now()}).then((function(){return t.super_master_meta.update_canvas()}))},s.src=p[c])},this._get_darkest_color=function(e){var _=t.color_conversion.to_rgba_from_hex(e[0]);return e.forEach((function(e){var n=t.color_conversion.to_rgba_from_hex(e);n[0]+n[1]+n[2]<_[0]+_[1]+_[2]&&(_=n)})),t.color_conversion.to_hex_from_rgba(Uint8ClampedArray.of(_[0],_[1],_[2],255))},this._to_alpha=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=t.super_state.get_state(),s=n._s_layers,i=n._layer_index,o=t._pxl_colors_to_alpha(s[i].indexes,s[i].colors,e,_),r=a(o,2),l=r[0],h=r[1];s[i].set_colors_and_indexes(h,l),t.super_state.set_state({_layer_index:i,_last_action_timestamp:Date.now()}).then((function(){return t.super_master_meta.update_canvas(!0)}))},this._to_less_color=function(e){var _=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=t.super_state.get_state()._layer_index,s=t.super_state.get_state()._s_layers,i=s[n].colors.length;t._remove_close_pxl_colors(s[n].image_data,"auto").then((function(e){var o,r,l=a(e,2),h=l[0],p=l[1];s[n].set_colors_and_indexes(p,h),o=s[n].colors.length,r={colors_removed:i-o,colors_remaining:o},t.super_state.set_state({_s_layers:s,_last_action_timestamp:Date.now()}).then((function(){t.super_master_meta.update_canvas(!0),_(r)}))}))},this._auto_adjust_contrast=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,_=t.super_state.get_state(),n=_._layer_index,a=_._s_layers,s=a[n]||{},i=t._pxl_adjust_contrast(s.indexes_copy,s.colors_copy,e);a[n].set_colors_and_indexes(i[1],i[0]),t.super_state.set_state({_s_layers:a,_last_action_timestamp:Date.now()}).then((function(){return t.super_master_meta.update_canvas(!0)}))},this._auto_adjust_saturation=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,_=t.super_state.get_state(),n=_._s_layers,a=_._layer_index,s=n[a]||{},i=t._pxl_adjust_saturation(s.indexes_copy,s.colors_copy,e);n[a].set_colors_and_indexes(i[1],i[0]),t.super_state.set_state({_s_layers:n,_last_action_timestamp:Date.now()}).then((function(){return t.super_master_meta.update_canvas(!0)}))},this._pxl_adjust_saturation=function(t,e,_){var n,a,s,i,o,r,l,h,p,c=100,u=0;for(_=0|Math.round(255*parseFloat(_)),n=0,a=void 0,i=(s=new F.Colors(e)).length,o=void 0,r=0;(0|r)<(0|i);r=(r+1|0)>>>0)n=(a=s.get_element(r)).hsla[1],(0|a.a)>0&&((0|n)>(0|u)&&(u=0|n),(0|n)<(0|c)&&(c=0|n));for(h=-c*(l=100/Math.max(1,u-c))|0,p=0;(0|p)<(0|i);p=(p+1|0)>>>0)o=(a=s.get_element(p)).hsla,a.blend_with(F.Color.new_hsla(o[0],o[1]*l+h|0,o[2],o[3]),_,!1,!1);return[t,e=s.slice_uint32(0,i),l,h]},this._selection_pxl_adjust_sat_lum=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t.super_state.get_state(),s=n._layer_index,i=n._s_layers,o=n._pxl_indexes_of_selection,r=i[s].indexes,l=Array.from(i[s].colors);o.forEach((function(n){var s=l[r[n]],i=t.color_conversion.to_hsla_from_rgba(t.color_conversion.to_rgba_from_uint32(s)),o=a(i,4),h=o[0],p=o[1],c=o[2],u=o[3],d=Math.min(100,Math.max(0,p+e)),f=Math.min(100,Math.max(0,c+_)),m=t.color_conversion.to_uint32_from_rgba(t.color_conversion.to_rgba_from_hsla(Array.of(h,d,f,u)));-1===l.indexOf(m)&&l.push(m),r[n]=l.indexOf(m)})),i[s].set_colors_and_indexes(l,r),t.super_state.set_state({_s_layers:i})},this._auto_adjust_smoothness=function(){var e=t.super_state.get_state(),_=e._layer_index,n=e._s_layers,a=e.pxl_width,s=e.pxl_height,i=t._pxl_adjust_smoothness(n[_].indexes,n[_].colors,a,s);n[_].set_colors_and_indexes(i[1],i[0]),t.super_state.set_state({_s_layers:n,_last_action_timestamp:Date.now()}).then((function(){return t.super_master_meta.update_canvas(!0)}))},this._pxl_to_vignette=function(e,_,n,s,i){var o,r=t.super_state.get_state().pxl_current_color_uint32,l=t.super_state.get_state(),h=l.pxl_width,p=l.pxl_height,c=t._get_new_ctx_from_canvas(h,p),u=a(c,2),d=u[0],f=(u[1],Math.max(h,p)),m=t.color_conversion.invert_uint32(r),g=d.createRadialGradient(h/2,p/2,0,h/2,p/2,f/2);g.addColorStop(1,t.color_conversion.to_hex_from_uint32(r)),g.addColorStop(.8,t.color_conversion.to_hex_from_uint32(t.color_conversion.blend_colors(r,m,.6))),g.addColorStop(0,t.color_conversion.to_hex_from_uint32(m)),d.fillStyle=g,d.fillRect(0,0,h,p),o=d.getImageData(0,0,h,p),t._remove_close_pxl_colors(o,18).then((function(n){var o,l,h,p,c,u,d=a(n,2),f=d[0],g=d[1],y=t._pxl_colors_to_alpha(f,g,m,1),v=a(y,2);f=v[0],g=v[1],o=t.color_conversion.to_rgba_from_uint32(r),l=a(o,3),h=l[0],p=l[1],c=l[2],g=g.map((function(e){e|=0;var _=t.color_conversion.to_rgba_from_uint32(e)[3];return 0|t.color_conversion.to_uint32_from_rgba(Uint8ClampedArray.of(h,p,c,_))})),u=[],f=f.map((function(n,a){var i,o,r;return a|=0,i=0|g[n|=0],o=0|_[e[a]],r=t.color_conversion.blend_colors(o,i,s,!1,!1),-1===u.indexOf(r)&&u.push(r),u.indexOf(r)})),i(Array.of(f,g=u))}))},this._to_vignette=function(e,_){var n,a,s,i;_>0&&(n=t.super_state.get_state(),a=n._layer_index,s=t.super_state.get_state(),i=s._s_layers,t._pxl_to_vignette(i[a].indexes,i[a].colors,e,_,(function(e){i[a].set_colors_and_indexes(e[1],e[0]),t.super_state.set_state({_s_layers:i,_last_action_timestamp:Date.now()}).then((function(){return t.super_master_meta.update_canvas(!0)}))})))},this._to_colorized=function(){var e,_=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=t.super_state.get_state(),r=o._s_layers,l=o._layer_index;n=null===n?1:n,e=r[l].colors.map((function(e){var o,r,l,h,p,c,u=t.color_conversion.to_rgba_from_uint32(e),d=a(u,4),f=d[0],m=d[1],g=d[2],y=d[3],v=t.color_conversion.to_hsla_from_rgba(Uint8ClampedArray.of(f,m,g,y)),x=a(v,4),w=(x[0],x[1]),b=x[2],M=x[3],I=[s,i,n],z=[w,b,M/100],C=[];return 0!==n?(C[2]=1-(1-I[2])*(1-z[2]),C[0]=Math.round(I[0]*I[2]/C[2]+Math.round(z[0]*z[2]*(1-I[2])/C[2])),C[1]=Math.round(I[1]*I[2]/C[2]+Math.round(z[1]*z[2]*(1-I[2])/C[2]))):C=[w,b],o=t.color_conversion.to_rgba_from_hsla(Array.of(_,C[0],C[1],100*C[2])),l=(r=a(o,4))[0],h=r[1],p=r[2],c=r[3],0===y?0:t.color_conversion.to_uint32_from_rgba(Uint8ClampedArray.of(l,h,p,c))})),r[l].set_colors(e),t.super_state.set_state({_s_layers:r,_last_action_timestamp:Date.now()}).then((function(){return t.super_master_meta.update_canvas(!0)}))},this.get_filter_names=function(){return t.filters.names},this._dutone_pixels=function(e,_,n,a,s){return s=s.map((function(a){var s=t.color_conversion.to_hsla_from_rgba(t.color_conversion.to_rgba_from_uint32(a))[2];return t.color_conversion.blend_colors(_,n,parseFloat(s/100)/e,!1,!1)})),t.color_conversion.clean_duplicate_colors(a,s)},this._to_dutone=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.8,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#ffffffff",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#000000ff",a=t.super_state.get_state(),s=a._layer_index,i=a._s_layers,o=t._dutone_pixels(e,_,n,i[s].indexes,i[s].colors);i[s].set_indexes(o[0]),i[s].set_colors(o[1]),t.super_state.set_state({_s_layers:i,_pxls_hovered:-1,_last_action_timestamp:Date.now()}).then((function(){return t.super_master_meta.update_canvas(!0)}))},this._to_filter=function(e,_){var n=t.super_state.get_state(),a=n._s_layers,s=n._layer_index;t.filters.use(e,a[s],_),t.super_state.set_state({_s_layers:a,_pxls_hovered:-1,_last_action_timestamp:Date.now()}).then((function(){return t.super_master_meta.update_canvas(!0)}))},this._to_rotation=function(){var e,_,n,s,o,r,l=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],h=t.super_state.get_state(),p=h._imported_image_pxls,c=h._imported_image_width,u=h._imported_image_height,d=h.pxl_width,f=h.pxl_height,m=h._s_layers,g=h._pxl_indexes_of_selection,y=h._select_shape_index_a,v=h._shape_index_a,x=h._base64_original_images,w=h._original_image_index,b=(h._layer_index,u),M=c,I=new Uint16Array(b*M),z=f,C=d,A=new i.SetFixed(z*C),S=y,j=v,E=0,D=0,L=0;if(p.length)p.forEach((function(t,e){D=(e-(E=e%c))/c,I[L=(l?b-1-D:D)+(l?E:M-1-E)*b]=t,g.has(e)&&A.add(L)}));else{for(e=0,_=m[0].indexes.length;e<_;e++)D=(e-(E=e%d))/d,L=(l?z-1-D:D)+(l?E:C-1-E)*z,g.has(e)&&A.add(L),y===e&&(S=L),v===e&&(j=L);for(n=function(t){var e=new Uint16Array(z*C);m[t].indexes.forEach((function(t,_){D=(_-(E=_%d))/d,e[L=(l?z-1-D:D)+(l?E:C-1-E)*z]=t})),m[t].set_indexes(e)},s=0;s<m.length;s++)n(s)}p.length?t.super_state.set_state({_imported_image_width:b,_imported_image_height:M,_imported_image_pxls:I,_pxl_indexes_of_selection:A,_last_action_timestamp:Date.now()}).then((function(){t.super_master_meta.update_canvas(!0)})):void 0===x[w]||p.length?t.super_state.set_state({pxl_width:z,pxl_height:C,_s_layers:m,_pxl_indexes_of_selection:A,_select_shape_index_a:S,_shape_index_a:j,_last_action_timestamp:Date.now()}).then((function(){t._set_size()})):(o=l?90:-90,(r=new Image).onload=function(){var e,_=t._get_new_ctx_from_canvas(r.naturalHeight,r.naturalWidth),n=a(_,2),s=n[0],i=n[1];s.clearRect(0,0,i.width,i.height),s.save(),s.translate(i.width/2,i.height/2),s.rotate(o*Math.PI/180),s.drawImage(r,-r.naturalWidth/2,-r.naturalHeight/2),s.restore(),e=r.src.includes("image/png")?i.toDataURL("image/png"):i.toDataURL("image/jpeg"),x.includes(e)||(x.push(e),w++),t.super_state.set_state({pxl_width:z,pxl_height:C,_s_layers:m,_pxl_indexes_of_selection:A,_select_shape_index_a:S,_shape_index_a:j,_base64_original_images:x,_original_image_index:w,_last_action_timestamp:Date.now()}).then((function(){t._set_size()}))},r.src=x[w])},this._pxl_colors_to_alpha=function(e,_,n,s){return[e,_=_.map((function(e){var _=t._match_color(n,e),i=t.color_conversion.to_rgba_from_uint32(e),o=a(i,4),r=o[0],l=o[1],h=o[2],p=o[3];return p-=p*(1-_)*s,t.color_conversion.to_uint32_from_rgba(Uint8ClampedArray.of(r,l,h,p))}))]},this._pxl_adjust_contrast=function(t,e){var _,n,a,s,i,o,r,l,h,p=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,c=255,u=0;for(p=0|Math.round(255*parseFloat(p)),_=0,n=new F.Color(new ArrayBuffer(4)),a=(0,F.Colors)(e),s=F.simdops.clamp_int,i=a.length,o=0;(0|o)<(0|i);o=(o+1|0)>>>0)_=(n=a.get_element(0|o,n)).sum_rgb()/3*n.a/255|0,(0|n.a)>0&&((0|_)>(0|u)&&(u=0|_),(0|_)<(0|c)&&(c=0|_));for(l=-c*(r=255/Math.max(1,u-c))|0,h=0;(0|h)<(0|i);h=(h+1|0)>>>0)(n=a.get_element(0|h,n)).blend_with(F.Color.new_of(s(n.r*r+l|0,0,255),s(n.g*r+l|0,0,255),s(n.b*r+l|0,0,255),n.a),p,!1,!1);return[t,e=a.subarray_uint32(0,i),r,l]},this._pxl_adjust_smoothness=function(e,_,n,s,i){n|=0,s|=0,i=i||1;for(var o=0;o<i;o++)e.forEach((function(t,e,i){var o,r,l,h,p,c,u,d,f,m,g=void 0,y=void 0,v=void 0,x=void 0;y=(y=e+1)%n==0?-1:y,x=(x=e-1)%n==n-1?-1:x,o=void 0,r=void 0,l=void 0,h=void 0,o=(g=(g=e-n)<0?-1:g)-1,o=-1===g||-1===x?-1:o,r=g+1,r=-1===g||-1===y?-1:r,l=(v=(v=e+n)>n*s?-1:v)-1,l=-1===v||-1===x?-1:l,h=v+1,h=-1===v||-1===y?-1:h,p=[i[g],i[y],i[v],i[x],i[o],i[r],i[l],i[h]],c=[],p.forEach((function(t){c[t]=void 0===c[t]?1:c[t]+1})),u=-1,d=-1,Object.entries(c).forEach((function(t){var e=a(t,2),_=e[0],n=e[1];d<n&&(d=n,u=_)})),f=-1,m=-1,Object.entries(c).forEach((function(t){var e=a(t,2),_=e[0],n=e[1];m<n&&_!==u&&(m=n,f=_)})),(d>=6&&-1!==u||d+m>=8&&d>=5&&F.Color.new_uint32(_[i[e]]).match_with(F.Color.new_uint32(_[u]).blend_with(F.Color.new_uint32(_[f]),128,!1,!1),24))&&(i[e]=u)}));return t.color_conversion.clean_duplicate_colors(e,_)},this._set_ripple_ref=function(e){null!==e&&null===t._ripple&&(t._ripple=e)},this._remove_close_pxl_colors=function(t,e){return new Promise((function(_,n){(0,y.QuantiMatGlobal)(t,e).then((function(t){var e=t[1],n=t[2];return _([e,n])}))}))},this._request_force_update=function(e,_){return e=void 0===e||e,_=void 0===_||_,t.sraf.run_frame((function(){return new Promise((function(e,_){t.forceUpdate(e)}))}),!e,!_,Date.now(),"inner_pixel_page").catch((function(){return t._request_force_update(e,_)}))},this._update_canvas_container_size=function(){var e,_,n,a,s=t.super_state.get_state()._canvas_container?t.super_state.get_state()._canvas_container.getBoundingClientRect():null;s?(e=s.width||0,_=s.height||0,n=s.left||0,a=s.top||0,t.canvas_pos.set_canvas_container(a,n,_,e)):setTimeout((function(){t._update_canvas_container_size()}),50)}},e.default=G},925:function(t,e,_){e.UINT32=_(926),e.UINT64=_(927)},926:function(t,e,_){var n;!function(e){function _(t,e){return this instanceof _?(this._low=0,this._high=0,this.remainder=null,void 0===e?s.call(this,t):"string"==typeof t?i.call(this,t,e):void a.call(this,t,e)):new _(t,e)}function a(t,e){return this._low=0|t,this._high=0|e,this}function s(t){return this._low=65535&t,this._high=t>>>16,this}function i(t,e){var _=parseInt(t,e||10);return this._low=65535&_,this._high=_>>>16,this}_(60466176),_(268435456),_(1e9),_(1073741824),_(36),_(16),_(10),_(2),_.prototype.fromBits=a,_.prototype.fromNumber=s,_.prototype.fromString=i,_.prototype.toNumber=function(){return 65536*this._high+this._low},_.prototype.toString=function(t){return this.toNumber().toString(t||10)},_.prototype.add=function(t){var e=this._low+t._low,_=e>>>16;return _+=this._high+t._high,this._low=65535&e,this._high=65535&_,this},_.prototype.subtract=function(t){return this.add(t.clone().negate())},_.prototype.multiply=function(t){var e=this._high,_=this._low,n=t._high,a=t._low,s=_*a,i=s>>>16;return i+=e*a,i&=65535,i+=_*n,this._low=65535&s,this._high=65535&i,this},_.prototype.div=function(t){var e,n;if(0==t._low&&0==t._high)throw Error("division by zero");if(0==t._high&&1==t._low)return this.remainder=new _(0),this;if(t.gt(this))return this.remainder=this.clone(),this._low=0,this._high=0,this;if(this.eq(t))return this.remainder=new _(0),this._low=1,this._high=0,this;for(e=t.clone(),n=-1;!this.lt(e);)e.shiftLeft(1,!0),n++;for(this.remainder=this.clone(),this._low=0,this._high=0;n>=0;n--)e.shiftRight(1),this.remainder.lt(e)||(this.remainder.subtract(e),n>=16?this._high|=1<<n-16:this._low|=1<<n);return this},_.prototype.negate=function(){var t=1+(65535&~this._low);return this._low=65535&t,this._high=~this._high+(t>>>16)&65535,this},_.prototype.equals=_.prototype.eq=function(t){return this._low==t._low&&this._high==t._high},_.prototype.greaterThan=_.prototype.gt=function(t){return this._high>t._high||!(this._high<t._high)&&this._low>t._low},_.prototype.lessThan=_.prototype.lt=function(t){return this._high<t._high||!(this._high>t._high)&&this._low<t._low},_.prototype.or=function(t){return this._low|=t._low,this._high|=t._high,this},_.prototype.and=function(t){return this._low&=t._low,this._high&=t._high,this},_.prototype.not=function(){return this._low=65535&~this._low,this._high=65535&~this._high,this},_.prototype.xor=function(t){return this._low^=t._low,this._high^=t._high,this},_.prototype.shiftRight=_.prototype.shiftr=function(t){return t>16?(this._low=this._high>>t-16,this._high=0):16==t?(this._low=this._high,this._high=0):(this._low=this._low>>t|this._high<<16-t&65535,this._high>>=t),this},_.prototype.shiftLeft=_.prototype.shiftl=function(t,e){return t>16?(this._high=this._low<<t-16,this._low=0,e||(this._high&=65535)):16==t?(this._high=this._low,this._low=0):(this._high=this._high<<t|this._low>>16-t,this._low=this._low<<t&65535,e||(this._high&=65535)),this},_.prototype.rotateLeft=_.prototype.rotl=function(t){var e=this._high<<16|this._low;return e=e<<t|e>>>32-t,this._low=65535&e,this._high=e>>>16,this},_.prototype.rotateRight=_.prototype.rotr=function(t){var e=this._high<<16|this._low;return e=e>>>t|e<<32-t,this._low=65535&e,this._high=e>>>16,this},_.prototype.clone=function(){return new _(this._low,this._high)},void 0===(n=_)||(t.exports=n)}()},927:function(t,e,_){var n;!function(e){function _(t,e,n,o){return this instanceof _?(this.remainder=null,"string"==typeof t?i.call(this,t,e):void 0===e?s.call(this,t):void a.apply(this,arguments)):new _(t,e,n,o)}function a(t,e,_,n){return void 0===_?(this._a00=65535&t,this._a16=t>>>16,this._a32=65535&e,this._a48=e>>>16,this):(this._a00=0|t,this._a16=0|e,this._a32=0|_,this._a48=0|n,this)}function s(t){return this._a00=65535&t,this._a16=t>>>16,this._a32=0,this._a48=0,this}function i(t,e){var n,a,s,i,r;for(e=e||10,this._a00=0,this._a16=0,this._a32=0,this._a48=0,n=o[e]||new _(Math.pow(e,5)),a=0,s=t.length;a<s;a+=5)i=Math.min(5,s-a),r=parseInt(t.slice(a,a+i),e),this.multiply(i<5?new _(Math.pow(e,i)):n).add(new _(r));return this}var o={16:_(1048576),10:_(1e5),2:_(32)},r={16:_(16),10:_(10),2:_(2)};_.prototype.fromBits=a,_.prototype.fromNumber=s,_.prototype.fromString=i,_.prototype.toNumber=function(){return 65536*this._a16+this._a00},_.prototype.toString=function(t){var e,n,a,s;if(e=r[t=t||10]||new _(t),!this.gt(e))return this.toNumber().toString(t);for(n=this.clone(),a=Array(64),s=63;s>=0&&(n.div(e),a[s]=n.remainder.toNumber().toString(t),n.gt(e));s--);return a[s-1]=n.toNumber().toString(t),a.join("")},_.prototype.add=function(t){var e,_,n=this._a00+t._a00,a=n>>>16;return e=(a+=this._a16+t._a16)>>>16,_=(e+=this._a32+t._a32)>>>16,_+=this._a48+t._a48,this._a00=65535&n,this._a16=65535&a,this._a32=65535&e,this._a48=65535&_,this},_.prototype.subtract=function(t){return this.add(t.clone().negate())},_.prototype.multiply=function(t){var e,_,n=this._a00,a=this._a16,s=this._a32,i=this._a48,o=t._a00,r=t._a16,l=t._a32,h=n*o,p=h>>>16;return e=(p+=n*r)>>>16,p&=65535,e+=(p+=a*o)>>>16,_=(e+=n*l)>>>16,e&=65535,_+=(e+=a*r)>>>16,e&=65535,_+=(e+=s*o)>>>16,_+=n*t._a48,_&=65535,_+=a*l,_&=65535,_+=s*r,_&=65535,_+=i*o,this._a00=65535&h,this._a16=65535&p,this._a32=65535&e,this._a48=65535&_,this},_.prototype.div=function(t){var e,n;if(0==t._a16&&0==t._a32&&0==t._a48){if(0==t._a00)throw Error("division by zero");if(1==t._a00)return this.remainder=new _(0),this}if(t.gt(this))return this.remainder=this.clone(),this._a00=0,this._a16=0,this._a32=0,this._a48=0,this;if(this.eq(t))return this.remainder=new _(0),this._a00=1,this._a16=0,this._a32=0,this._a48=0,this;for(e=t.clone(),n=-1;!this.lt(e);)e.shiftLeft(1,!0),n++;for(this.remainder=this.clone(),this._a00=0,this._a16=0,this._a32=0,this._a48=0;n>=0;n--)e.shiftRight(1),this.remainder.lt(e)||(this.remainder.subtract(e),n>=48?this._a48|=1<<n-48:n>=32?this._a32|=1<<n-32:n>=16?this._a16|=1<<n-16:this._a00|=1<<n);return this},_.prototype.negate=function(){var t=1+(65535&~this._a00);return this._a00=65535&t,t=(65535&~this._a16)+(t>>>16),this._a16=65535&t,t=(65535&~this._a32)+(t>>>16),this._a32=65535&t,this._a48=~this._a48+(t>>>16)&65535,this},_.prototype.equals=_.prototype.eq=function(t){return this._a48==t._a48&&this._a00==t._a00&&this._a32==t._a32&&this._a16==t._a16},_.prototype.greaterThan=_.prototype.gt=function(t){return this._a48>t._a48||!(this._a48<t._a48)&&(this._a32>t._a32||!(this._a32<t._a32)&&(this._a16>t._a16||!(this._a16<t._a16)&&this._a00>t._a00))},_.prototype.lessThan=_.prototype.lt=function(t){return this._a48<t._a48||!(this._a48>t._a48)&&(this._a32<t._a32||!(this._a32>t._a32)&&(this._a16<t._a16||!(this._a16>t._a16)&&this._a00<t._a00))},_.prototype.or=function(t){return this._a00|=t._a00,this._a16|=t._a16,this._a32|=t._a32,this._a48|=t._a48,this},_.prototype.and=function(t){return this._a00&=t._a00,this._a16&=t._a16,this._a32&=t._a32,this._a48&=t._a48,this},_.prototype.xor=function(t){return this._a00^=t._a00,this._a16^=t._a16,this._a32^=t._a32,this._a48^=t._a48,this},_.prototype.not=function(){return this._a00=65535&~this._a00,this._a16=65535&~this._a16,this._a32=65535&~this._a32,this._a48=65535&~this._a48,this},_.prototype.shiftRight=_.prototype.shiftr=function(t){return(t%=64)>=48?(this._a00=this._a48>>t-48,this._a16=0,this._a32=0,this._a48=0):t>=32?(t-=32,this._a00=65535&(this._a32>>t|this._a48<<16-t),this._a16=this._a48>>t&65535,this._a32=0,this._a48=0):t>=16?(t-=16,this._a00=65535&(this._a16>>t|this._a32<<16-t),this._a16=65535&(this._a32>>t|this._a48<<16-t),this._a32=this._a48>>t&65535,this._a48=0):(this._a00=65535&(this._a00>>t|this._a16<<16-t),this._a16=65535&(this._a16>>t|this._a32<<16-t),this._a32=65535&(this._a32>>t|this._a48<<16-t),this._a48=this._a48>>t&65535),this},_.prototype.shiftLeft=_.prototype.shiftl=function(t,e){return(t%=64)>=48?(this._a48=this._a00<<t-48,this._a32=0,this._a16=0,this._a00=0):t>=32?(t-=32,this._a48=this._a16<<t|this._a00>>16-t,this._a32=this._a00<<t&65535,this._a16=0,this._a00=0):t>=16?(t-=16,this._a48=this._a32<<t|this._a16>>16-t,this._a32=65535&(this._a16<<t|this._a00>>16-t),this._a16=this._a00<<t&65535,this._a00=0):(this._a48=this._a48<<t|this._a32>>16-t,this._a32=65535&(this._a32<<t|this._a16>>16-t),this._a16=65535&(this._a16<<t|this._a00>>16-t),this._a00=this._a00<<t&65535),e||(this._a48&=65535),this},_.prototype.rotateLeft=_.prototype.rotl=function(t){var e,_,n,a,s;if(0==(t%=64))return this;if(t>=32){if(e=this._a00,this._a00=this._a32,this._a32=e,e=this._a48,this._a48=this._a16,this._a16=e,32==t)return this;t-=32}return a=(_=this._a48<<16|this._a32)<<t|(n=this._a16<<16|this._a00)>>>32-t,s=n<<t|_>>>32-t,this._a00=65535&s,this._a16=s>>>16,this._a32=65535&a,this._a48=a>>>16,this},_.prototype.rotateRight=_.prototype.rotr=function(t){var e,_,n,a,s;if(0==(t%=64))return this;if(t>=32){if(e=this._a00,this._a00=this._a32,this._a32=e,e=this._a48,this._a48=this._a16,this._a16=e,32==t)return this;t-=32}return a=(_=this._a48<<16|this._a32)>>>t|(n=this._a16<<16|this._a00)<<32-t,s=n>>>t|_<<32-t,this._a00=65535&s,this._a16=s>>>16,this._a32=65535&a,this._a48=a>>>16,this},_.prototype.clone=function(){return new _(this._a00,this._a16,this._a32,this._a48)},void 0===(n=_)||(t.exports=n)}()},931:function(t,e,_){"use strict";var n=_(932),a=Set.prototype;t.exports={Set:Set,add:n(a.add),has:n(a.has),remove:n(a.delete),proto:a}},932:function(t,e,_){"use strict";var n=_(933),a=Function.prototype,s=a.call,i=n&&a.bind.bind(s,s);t.exports=n?i:function(t){return function(){return s.apply(t,arguments)}}},933:function(t,e,_){"use strict";var n=_(934);t.exports=!n((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},934:function(t,e,_){"use strict";t.exports=function(t){try{return!!t()}catch(e){return!0}}}}]);