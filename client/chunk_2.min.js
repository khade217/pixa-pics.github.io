(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{603:function(t,i){var e=function(){function t(t,i){"use strict";return(0|(t=(0|t)>>>0))>>>0==(0|(i=(0|i)>>>0))>>>0}function i(t,i){"use strict";return((t=(0|t)>>>0)+(i=(0|i)>>>0)|0)>>>0}function e(t,i){"use strict";return((t=(0|t)>>>0)&(i=(0|i)>>>0)|0)>>>0}function _(t,i){"use strict";return((t=(0|t)>>>0)|(i=(0|i)>>>0)|0)>>>0}function s(t,i){"use strict";return((t=(0|t)>>>0)^(i=(0|i)>>>0)|0)>>>0}function n(t){"use strict";return(0|t)>>>5}function r(t){"use strict";return(0|t)>>>0}function o(h){"use strict";return this instanceof o?(this.format_uint_=r,this.plus_uint_=i,this.uint_equal_=t,this.uint_bit_and_=e,this.uint_bit_or_=_,this.uint_bit_xor_=s,this.uint_bitwise_5_=n,h instanceof o?this._data_=h.dataCopy:h instanceof Uint32Array?this._data_=h:(h=(0|h)>>>0,this._data_=new Uint32Array(1+((h+31|0)>>>5)),this._data_[this._data_.length-1]=(0|h)>>>0),this._M_OR_=u,this._M_AND_=a,this._M_OPP_=c,this.buildTemporaryIndexesDataStore(),this._I_=new Uint32Array(11),this):new o(h)}var h,u=Uint32Array.of(1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576,2097152,4194304,8388608,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648),a=Uint32Array.of(4294967294,4294967293,4294967291,4294967287,4294967279,4294967263,4294967231,4294967167,4294967039,4294966783,4294966271,4294965247,4294963199,4294959103,4294950911,4294934527,4294901759,4294836223,4294705151,4294443007,4293918719,4292870143,4290772991,4286578687,4278190079,4261412863,4227858431,4160749567,4026531839,3758096383,3221225471,2147483647),c=Uint32Array.of(0,4294967295);return Object.defineProperties(o.prototype,{idealConstructor:{get:function(){"use strict";return this.length>65535?Uint32Array:this.length>255?Uint16Array:Uint8Array}},buildTemporaryIndexesDataStore:{get:function(){"use strict";return function(){this._M_A_=new this.idealConstructor(32)}}},getMin:{get:function(){"use strict";return function(){for(this._I_[4]=0,this._I_[5]=this.length,this._I_[8]=this.getElement(this.uint_bitwise_5_(this._I_[4]));this._I_[4]<this._I_[5];this._I_[4]=this.plus_uint_(this._I_[4],32))if(!this.uint_equal_(this._I_[8],this._M_OPP_[0])&&(this._I_[3]=0,this._I_[7]=0,this.readFourBytesCheckByte(),this.readFourBytesCheckByte(),this.readFourBytesCheckByte(),this.readFourBytesCheckByte(),this._I_[7]>0))return this._M_A_[0];return-1}}},getMax:{get:function(){"use strict";return function(){for(this._I_[4]=this.length,this._I_[5]=0,this._I_[8]=this.getElement(this.uint_bitwise_5_(this._I_[4]));this._I_[4]>=this._I_[5];this._I_[4]=(this._I_[4]-32|0)>>>0)if(!this.uint_equal_(this._I_[8],this._M_OPP_[0])&&(this._I_[3]=0,this._I_[7]=0,this.readFourBytesCheckByte(),this.readFourBytesCheckByte(),this.readFourBytesCheckByte(),this.readFourBytesCheckByte(),this._I_[7]>0))return this._M_A_[this._I_[7]-1|0];return-1}}},countOnes:{get:function(){"use strict";return function(){for(this._I_[4]=0,this._I_[5]=this.length,this._I_[8]=this.getElement(this.uint_bitwise_5_(this._I_[4]));this._I_[4]<this._I_[5];this._I_[4]=this.plus_uint_(this._I_[4],32))this.uint_equal_(this._I_[8],this._M_OPP_[0])||(this.uint_equal_(this._I_[8],this._M_OPP_[1])?this._I_[6]=this.plus_uint_(this._I_[6],32):(this._I_[3]=0,this._I_[7]=0,this.readFourBytesCountByte(),this.readFourBytesCountByte(),this.readFourBytesCountByte(),this.readFourBytesCountByte(),this._I_[6]=this.plus_uint_(this._I_[6],this._I_[7])));return this.format_uint_(this._I_[6])}}},countZeros:{get:function(){"use strict";return function(){return this.format_uint_(this.length-this.countOnes())}}},readFourBytes:{get:function(){"use strict";return function(t,i,e){if(this._I_[4]=this.format_uint_(t),this._I_[9]=this.format_uint_(e),this._I_[3]=0,this._I_[7]=0,this._I_[8]=this.getElement(this.uint_bitwise_5_(this._I_[4])),this.uint_equal_(this._I_[8],this._M_OPP_[0]))return(0|this._I_[9])>>>0;if(this.uint_equal_(this._I_[8],this._M_OPP_[1])){if(void 0!==i)for(this._I_[10]=0;this._I_[10]<32;this._I_[10]=this.plus_uint_(this._I_[10],1))i[this.plus_uint_(this._I_[9],this._I_[10])]=this.plus_uint_(this._I_[4],this._I_[10]);return this.plus_uint_(this._I_[9],32)}return this.readFourBytesCheckByte(),this.readFourBytesCheckByte(),this.readFourBytesCheckByte(),this.readFourBytesCheckByte(),void 0!==i&&this._I_[7]>0&&i.set(this._M_A_.subarray(0,this._I_[7]),this._I_[9]),this.plus_uint_(this._I_[9],this._I_[7])}}},readFourBytesCountBit:{get:function(){"use strict";return function(){this.uint_equal_(this.uint_bit_and_(this._I_[8],this._M_OR_[this._I_[3]]),this._M_OR_[this._I_[3]])&&(this._I_[7]=this.plus_uint_(this._I_[7],1)),this._I_[3]=this.plus_uint_(this._I_[3],1)}}},readFourBytesCheckBit:{get:function(){"use strict";return function(){this.uint_equal_(this.uint_bit_and_(this._I_[8],this._M_OR_[this._I_[3]]),this._M_OR_[this._I_[3]])&&(this._M_A_[this._I_[7]]=this.plus_uint_(this._I_[4],this._I_[3]),this._I_[7]=this.plus_uint_(this._I_[7],1)),this._I_[3]=this.plus_uint_(this._I_[3],1)}}},readFourBytesCountByte:{get:function(){"use strict";return function(){this.readFourBytesCountBit(),this.readFourBytesCountBit(),this.readFourBytesCountBit(),this.readFourBytesCountBit(),this.readFourBytesCountBit(),this.readFourBytesCountBit(),this.readFourBytesCountBit(),this.readFourBytesCountBit()}}},readFourBytesCheckByte:{get:function(){"use strict";return function(){this.readFourBytesCheckBit(),this.readFourBytesCheckBit(),this.readFourBytesCheckBit(),this.readFourBytesCheckBit(),this.readFourBytesCheckBit(),this.readFourBytesCheckBit(),this.readFourBytesCheckBit(),this.readFourBytesCheckBit()}}},getElement:{get:function(){"use strict";return function(t){return this._data_[t]}}},data:{get:function(){"use strict";return this._data_}},dataCopy:{get:function(){"use strict";return Uint32Array.from(this._data_)}},readBit:{get:function(){"use strict";return function(t){return this._I_[0]=this.format_uint_(t),this._I_[1]=this.uint_bitwise_5_(this._I_[0]),this._I_[2]=this.uint_bit_and_(this._I_[0],31),this.uint_equal_(this.uint_bit_and_(this._data_[this._I_[1]],this._M_OR_[this._I_[2]]),this._M_OR_[this._I_[2]])}}},writeBit1:{get:function(){"use strict";return function(t){this._I_[0]=this.format_uint_(t),this._I_[1]=this.uint_bitwise_5_(this._I_[0]),this._I_[2]=this.uint_bit_and_(this._I_[0],31),this._data_[this._I_[1]]=this.uint_bit_or_(this._data_[this._I_[1]],this._M_OR_[this._I_[2]])}}},writeBit0:{get:function(){"use strict";return function(t){this._I_[0]=this.format_uint_(t),this._I_[1]=this.uint_bitwise_5_(this._I_[0]),this._I_[2]=this.uint_bit_and_(this._I_[0],31),this._data_[this._I_[1]]=this.uint_bit_and_(this._data_[this._I_[1]],this._M_AND_[this._I_[2]])}}},toggleBit:{get:function(){"use strict";return function(t){return this._I_[0]=this.format_uint_(t),this._I_[1]=this.uint_bitwise_5_(this._I_[0]),this._I_[2]=this.uint_bit_and_(this._I_[0],31),this.uint_equal_(this.uint_bit_and_(this._data_[this._I_[1]],this._M_OR_[this._I_[2]]),this._M_OR_[this._I_[2]])?(this._data_[this._I_[1]]=this.uint_bit_and_(this._data_[this._I_[1]],this._M_AND_[this._I_[2]]),!1):(this._data_[this._I_[1]]=this.uint_bit_or_(this._data_[this._I_[1]],this._M_OR_[this._I_[2]]),!0)}}},setFromBitArrayData:{get:function(){"use strict";return function(t){this._data_.length===t.length?this._data_.set(t):(this._data_=Uint32Array.from(t),this.buildTemporaryIndexesDataStore())}}},invert:{get:function(){"use strict";return function(){for(var t=this._data_.length-1|0,i=0;(0|i)<(0|t);i=this.plus_uint_(i,1))this._data_[0|i]=~this._data_[0|i]}}},addFromArray:{get:function(){"use strict";return function(t,i,e,_){var s,n;if(i=void 0===i?this._data_:i,void 0===e&&void 0===_)for(s=Math.min(t.length,i.length,this._data_.length)-1,n=0;(0|n)<(0|s);n=this.plus_uint_(n,1))this._data_[0|n]=this.uint_bit_or_(i[0|n],t[0|n]);else if(void 0!==e&&void 0===_)for(s=Math.min(t.length,i.length,e.length,this._data_.length)-1,n=0;(0|n)<(0|s);n=this.plus_uint_(n,1))this._data_[0|n]=this.uint_bit_or_(this.uint_bit_or_(i[0|n],t[0|n]),e[0|n]);else for(s=Math.min(t.length,i.length,e.length,this._data_.length)-1,n=0;(0|n)<(0|s);n=this.plus_uint_(n,1))this._data_[0|n]=this.uint_bit_or_(this.uint_bit_or_(t[0|n],i[0|n]),this.uint_bit_or_(e[0|n],_[0|n]))}}},differentFromArray:{get:function(){"use strict";return function(t,i){i=void 0===i?this._data_:i;for(var e=Math.min(t.length,i.length,this._data_.length)-1,_=0;(0|_)<(0|e);_=this.plus_uint_(_,1))this._data_[0|_]=this.uint_bit_xor_(i[0|_],t[0|_])}}},sameFromArray:{get:function(){"use strict";return function(t,i){i=void 0===i?this._data_:i;for(var e=Math.min(t.length,i.length,this._data_.length)-1,_=0;(0|_)<(0|e);_=this.plus_uint_(_,1))this._data_[0|_]=this.uint_bit_and_(i[0|_],t[0|_])}}},clear:{get:function(){"use strict";return function(){this._data_.fill(0,0,this._data_.length-1)}}},charge:{get:function(){"use strict";return function(){this._data_.fill(4294967295,0,this._data_.length-1)}}},length:{get:function(){"use strict";return this.format_uint_(this._data_[this._data_.length-1])}},resize:{get:function(){"use strict";return function(t){var i,e;this.length!==t&&(i=this._data_,(e=new Uint32Array(1+((t+31|0)>>>5)))[e.length-1]=(0|t)>>>0,e.set(i.subarray(0,Math.min(i.length-1,e.length-1))),this._data_=e,this.buildTemporaryIndexesDataStore())}}},resizeToMax:{get:function(){"use strict";return function(){this.resize(this.getMax())}}}}),(h=function(e){"use strict";var _,s;if(!(this instanceof h))return new h(e);if(this.format_uint_=r,this.plus_uint_=i,this.uint_equal_=t,this._VA_=Uint32Array.of(0),e instanceof h)this._ba_=e.bitArrayCopy,this._VA_.fill(e.size);else if(e instanceof o)this._ba_=e,this._VA_[0]=this._ba_.countOnes();else if("object"==typeof e){for(this._max_=0,this._c_=null,e instanceof Uint8ClampedArray||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array?(this._set_=new Set(e),this._VA_[0]=this._set_.size,this._c_=e instanceof Uint32Array?Uint32Array:e instanceof Uint16Array?Uint16Array:Uint8Array,this._indexes_=this._c_.from(this._set_)):(e instanceof Set?this._set_=e:this._set_=new Set(e),this._VA_[0]=this._set_.size,this._indexes_=Uint32Array.from(this._set_)),_=0,s=0|this._indexes_.length;this.format_uint_(_)<this.format_uint_(s);_=this.plus_uint_(_,1))this.format_uint_(this._max_)<this.format_uint_(this._indexes_[this.format_uint_(_)])&&(this._max_=this.format_uint_(this._indexes_[this.format_uint_(_)]));for(this._ba_=new o(this._max_),_=0,s=0|this._indexes_.length;this.format_uint_(_)<this.format_uint_(s);_=this.plus_uint_(_,1))this._ba_.writeBit1(this.format_uint_(this._indexes_[this.format_uint_(_)]));delete this._set_,delete this._indexes_,delete this._max_,delete this._c_}else this._ba_=new o(0|e),this._VA_[0]=0;return this.bindInnerMethods(),this}).compute=function(t,i,e){for(var _=t.bitArrayData,s=i.map((function(t){return t.bitArrayData})),n=_.length-1|0,r=0,o=new Uint32Array(s.length);(0|r)<(0|n);r=this.plus_uint_(r,1))o.set(s.map((function(t){"use strict";return t[0|r]}))),_[0|r]=e.apply(e,o);t.computeSize()},h.import=function(t){return new h(new o(t))},Object.defineProperties(h.prototype,{bindInnerMethods:{get:function(){"use strict";return function(){this.readbit_=this._ba_.readBit.bind(this._ba_),this.read4bytes_=this._ba_.readFourBytes.bind(this._ba_),this.write1_=this._ba_.writeBit1.bind(this._ba_),this.write0_=this._ba_.writeBit0.bind(this._ba_)}}},bitArrayCopy:{get:function(){"use strict";return new o(this.bitArrayDataCopy)}},bitArrayData:{get:function(){"use strict";return this.bitArray.data}},bitArrayDataCopy:{get:function(){"use strict";var t=this.bitArrayData;return t.slice(0,t.length)}},bitArray:{get:function(){"use strict";return this._ba_}},size:{get:function(){"use strict";return this.format_uint_(this._VA_[0])}},length:{get:function(){"use strict";return this.format_uint_(this._ba_.length)}},idealConstructor:{get:function(){"use strict";return this._ba_.idealConstructor}},indexes:{get:function(){"use strict";for(var t=new this.idealConstructor(this.size),i=Uint32Array.of(0|this.length,0,0);i[1]<i[0];i[1]=this.plus_uint_(i[1],32))i[2]=this.read4bytes_(i[1],t,i[2]);return t}},export:{get:function(){"use strict";return function(t){return(t=void 0!==t&&Boolean(t))?this.bitArrayDataCopy:this.bitArrayData}}},has:{get:function(){"use strict";return function(t){return this.readbit_(this.format_uint_(t))}}},hasnt:{get:function(){"use strict";return function(t){return!this.readbit_(this.format_uint_(t))}}},add:{get:function(){"use strict";return function(t){t=this.format_uint_(t),(0|this.length)<(0|t)&&this._ba_.resize(t+t|0),this.hasnt(t)&&(this._VA_[0]=this.plus_uint_(this._VA_[0],1),this.write1_(t))}}},addUnsafe:{get:function(){"use strict";return function(t){t=this.format_uint_(t),this.hasnt(t)&&(this._VA_[0]=this.plus_uint_(this._VA_[0],1),this.write1_(t))}}},delete:{get:function(){"use strict";return function(t){t=this.format_uint_(t),this.has(t)&&(this.write0_(t),this._VA_[0]=(this._VA_[0]-1|0)>>>0)}}},bulkAdd:{get:function(){"use strict";return function(t){for(var i=Uint32Array.of(t.length,0);i[1]<i[0];i[1]=this.plus_uint_(i[1],1))this.add(t[i[1]])}}},bulkAddUnsafe:{get:function(){"use strict";return function(t){for(var i=Uint32Array.of(t.length,0);i[1]<i[0];i[1]=this.plus_uint_(i[1],1))this.addUnsafe(t[i[1]]);this._VA_[0]=this.plus_uint_(this._VA_[0],i[0])}}},bulkDelete:{get:function(){"use strict";return function(t){for(var i=Uint32Array.of(t.length,0);i[1]<i[0];i[1]=this.plus_uint_(i[1],1))this.delete(t[i[1]])}}},invert:{get:function(){"use strict";return function(){var t=this.length,i=this.size;this._ba_.invert(),this._VA_[0]=t-i}}},clear:{get:function(){"use strict";return function(){this._VA_[0]>0&&(this._ba_.clear(),this._VA_[0]=0)}}},clearAndBulkAdd:{get:function(){"use strict";return function(t){this.clear(),this.bulkAdd(t)}}},clearAndBulkAddUnsafe:{get:function(){"use strict";return function(t){this.clear(),this.bulkAddUnsafe(t)}}},setFromSetFixed:{get:function(){"use strict";return function(t){this._ba_.setFromBitArrayData(t.bitArrayData),this._VA_[0]=t.size}}},computeSize:{get:function(){"use strict";return function(){this._VA_[0]=this._ba_.countOnes()}}},optimize:{get:function(){"use strict";return function(){this._ba_.resizeToMax()}}},resizeUnsafe:{get:function(){"use strict";return function(t){this._ba_.resize(t)}}},resize:{get:function(){"use strict";return function(t){this.resizeUnsafe(t),this.computeSize()}}},addFromSetFixedUnsafe:{get:function(){"use strict";return function(t,i,e,_){this._ba_.addFromArray(t.bitArrayData,i instanceof h?i.bitArrayData:void 0,e instanceof h?e.bitArrayData:void 0,_ instanceof h?_.bitArrayData:void 0)}}},differentFromSetFixedUnsafe:{get:function(){"use strict";return function(t,i){this._ba_.differentFromArray(t.bitArrayData,i instanceof h?i.bitArrayData:void 0)}}},sameFromSetFixedUnsafe:{get:function(){"use strict";return function(t,i){this._ba_.sameFromArray(t.bitArrayData,i instanceof h?i.bitArrayData:void 0)}}},addFromSetFixed:{get:function(){"use strict";return function(t,i,e,_){this.addFromSetFixedUnsafe(t,i,e,_),this.computeSize()}}},differentFromSetFixed:{get:function(){"use strict";return function(t,i){this.differentFromSetFixedUnsafe(t,i),this.computeSize()}}},sameFromSetFixed:{get:function(){"use strict";return function(t,i){this.sameFromSetFixedUnsafe(t,i),this.computeSize()}}},charge:{get:function(){"use strict";return function(){this._ba_.charge(),this._VA_[0]=this._ba_.length}}},forEach:{get:function(){"use strict";return function(t){this.indexes.forEach(t)}}},map:{get:function(){"use strict";return function(t){this.indexes.map(t)}}},filter:{get:function(){"use strict";return function(t){this.indexes.filter(t)}}}}),{BitArray:o,SetFixed:h}}();void 0!==t.exports&&(t.exports=e)},630:function(t,i,e){"use strict";var _,s,n=e(603),r=e(595),o=(0,r.SIMDopeCreateConfAdd)({create:{new_of:!0},properties:{uint32:!0,laba:!0,rgbaon4bits:!0,rgbaon6bits:!0,rgbaon8bits:!0,rgbaon12bits:!0,rgbaon16bits:!0,skin:!0},methods:{simplify:!0,get_new_element:!0,get_use_element:!0,set_tail:!0,is_dark:!0,blend_first_with:!0,blend_first_with_tails:!0,blend_all:!0,euclidean_match_with:!0,manhattan_match_with:!0,cie76_match_with:!0,copy:!0}}),h=Math.fround,u=h(.9),a=h(.95);const{simdops:c,Color:l,Colors:f}=(0,r.SIMDopeCreate)(o),{minus_int:p,int_not_equal:d,plus_int:g,plus_uint:y,minus_uint:b,multiply_int:x,multiply_uint:m,multiply_uint_4:w,divide_uint:I,clamp_uint8:A,clamp_uint32:B,int_equal:F,uint_less:k,int_less:O,int_greater_equal:v,uint_not_equal:U,uint_less_equal:C,min_uint:P}=c;_=function(t){if(t=t||{},!(this instanceof _))return new _(t);t.pxl_colors=t.pxl_colors||new Uint32Array(0),t.pxls=t.pxls||new Uint32Array(0),this.new_pxls_="buffer"in t.pxls?new Uint32Array(t.pxls.buffer):Uint32Array.from(t.pxls),this.new_pxl_colors_="buffer"in t.pxl_colors?new f(t.pxl_colors.buffer):new f(Uint32Array.from(t.pxl_colors).buffer);var i=0|this.new_pxl_colors_.length;this.new_pxl_colors_is_skin_mask_=new n.SetFixed(0|i),this.set_new_pxl_skin_mask(),this.best_color_number_=t.number_of_color,this.max_cluster_=i>65536?65537:i>16384?4097:i>8192?257:i>512?17:1,this.index_clusters_=new Array(this.max_cluster_),this.length_clusters_=new Uint32Array(this.max_cluster_),this.pxl_colors_usage_=new Uint32Array(i),this.all_index_clusters_=new Uint32Array(i),this.clean_pxl_colors_=new Uint32Array(i),this.clean_pxl_colors_lookup_={},this.is_skin_ops_=0,this.match_ops_=0,this.blend_ops_=0,this.remove_duplicate_ops_=0,this.simplify_ops_=0,this.classify_on_x_bits_ops_=0},Object.defineProperty(_.prototype,"set_is_skin_ops",{get:function(){return function(t){this.is_skin_ops_=(0|t)>>>0}}}),Object.defineProperty(_.prototype,"set_match_ops",{get:function(){return function(t){this.match_ops_=(0|t)>>>0}}}),Object.defineProperty(_.prototype,"set_blend_ops",{get:function(){return function(t){this.blend_ops_=(0|t)>>>0}}}),Object.defineProperty(_.prototype,"set_remove_duplicate_ops",{get:function(){return function(t){this.remove_duplicate_ops_=(0|t)>>>0}}}),Object.defineProperty(_.prototype,"set_simplify_ops",{get:function(){return function(t){this.simplify_ops_=t}}}),Object.defineProperty(_.prototype,"set_classify_on_x_bits_ops",{get:function(){return function(t){this.classify_on_x_bits_ops_=t}}}),Object.defineProperty(_.prototype,"get_is_skin_ops",{get:function(){return function(){return 0|this.is_skin_ops_}}}),Object.defineProperty(_.prototype,"get_match_ops",{get:function(){return function(){return 0|this.match_ops_}}}),Object.defineProperty(_.prototype,"get_blend_ops",{get:function(){return function(){return 0|this.blend_ops_}}}),Object.defineProperty(_.prototype,"get_remove_duplicate_ops",{get:function(){return function(){return 0|this.remove_duplicate_ops_}}}),Object.defineProperty(_.prototype,"get_simplify_ops",{get:function(){return function(){return this.simplify_ops_}}}),Object.defineProperty(_.prototype,"get_classify_on_x_bits_ops",{get:function(){return function(){return this.classify_on_x_bits_ops_}}}),Object.defineProperty(_.prototype,"reset_deduplicate",{get:function(){return function(t){this.clean_pxl_colors_lookup_={},this.pxl_colors_usage_.fill(0,0,0|t),this.clean_pxl_colors_.fill(0,0,0|t)}}}),Object.defineProperty(_.prototype,"index_of_color_within_cleaned",{get:function(){return function(t){return(0|this.clean_pxl_colors_lookup_[(0|t)>>>0])-1|0}}}),Object.defineProperty(_.prototype,"set_cleaned_pxl_colors",{get:function(){return function(t,i){this.clean_pxl_colors_[(0|t)>>>0]=(0|i)>>>0,this.clean_pxl_colors_lookup_[(0|i)>>>0]=(t+1|0)>>>0}}}),Object.defineProperty(_.prototype,"increase_color_usage",{get:function(){return function(t){this.pxl_colors_usage_[(0|t)>>>0]=(this.pxl_colors_usage_[(0|t)>>>0]+1|0)>>>0}}}),Object.defineProperty(_.prototype,"set_new_pxls",{get:function(){return function(t,i){this.new_pxls_[(0|t)>>>0]=(0|i)>>>0}}}),Object.defineProperty(_.prototype,"set_new_pxl_colors",{get:function(){return function(t){this.new_pxl_colors_=new f(this.clean_pxl_colors_.buffer.slice(0,w(0|t))),this.set_new_pxl_skin_mask()}}}),Object.defineProperty(_.prototype,"set_new_pxl_skin_mask",{get:function(){return function(){var t=new l(new ArrayBuffer(4)),i=0|this.new_pxl_colors_.length,e=0;for(this.new_pxl_colors_is_skin_mask_=new n.SetFixed(0|i);(0|e)<(0|i);e=e+1|0)this.new_pxl_colors_.get_use_element(0|e,t).skin&&this.new_pxl_colors_is_skin_mask_.add(0|e);this.set_is_skin_ops(this.get_is_skin_ops()+e|0)}}}),Object.defineProperty(_.prototype,"get_a_new_pxl_color_from_pxl_index",{get:function(){return function(t){return 4294967295&this.new_pxl_colors_.buffer_getUint32(this.new_pxls_[0|t])}}}),Object.defineProperty(_.prototype,"reset_cluster",{get:function(){return function(){this.max_cluster_=this.new_pxl_colors_.length>65536?65537:this.new_pxl_colors_.length>16384?4097:this.new_pxl_colors_.length>8192?257:this.new_pxl_colors_.length>512?17:1,this.length_clusters_.fill(0,0,0|this.max_cluster);for(var t=0;(0|t)<(0|this.max_cluster);t=(t+1|0)>>>0)this.index_clusters_[0|t]=[]}}}),Object.defineProperty(_.prototype,"add_in_indexes_cluster",{get:function(){return function(t,i){this.index_clusters_[(0|t)>>>0].push((0|i)>>>0)}}}),Object.defineProperty(_.prototype,"set_all_cluster_indexes",{get:function(){return function(){for(var t=0,i=0;(0|t)<(0|this.max_cluster);t=(t+1|0)>>>0)this.all_index_clusters_.set(this.index_clusters_[(0|t)>>>0],(0|i)>>>0),i=(i+this.get_length_in_index_clusters(0|t)|0)>>>0}}}),Object.defineProperty(_.prototype,"get_length_in_index_clusters",{get:function(){return function(t){return(0|this.index_clusters_[(0|t)>>>0].length)>>>0}}}),Object.defineProperty(_.prototype,"get_in_cluster_lengths",{get:function(){return function(t){return(0|this.length_clusters_[(0|t)>>>0])>>>0}}}),Object.defineProperty(_.prototype,"get_an_index_in_clusters",{get:function(){return function(t){return(0|this.all_index_clusters_[0|t])>>>0}}}),Object.defineProperty(_.prototype,"get_a_color_usage",{get:function(){return function(t){return(0|this.pxl_colors_usage_[0|t])>>>0}}}),Object.defineProperty(_.prototype,"set_a_color_usage",{get:function(){return function(t,i){return this.pxl_colors_usage_[0|t]=(0|i)>>>0}}}),Object.defineProperty(_.prototype,"get_a_color_usage_percent",{get:function(){return function(t){return this.pxl_colors_usage_[0|t]/this.new_pxls_.length}}}),Object.defineProperty(_.prototype,"get_average_color_usage_percent",{get:function(){return function(t,i){var e,_,s;for(i=0|((i|=0)<(t|=0)?this.pxl_colors_usage_.length:i),e=0,_=0,s=0,_=0|t;(0|_)<(0|i);_=(_+1|0)>>>0)s=(0|this.get_an_index_in_clusters((0|_)>>>0))>>>0,e+=this.pxl_colors_usage_[0|s]/this.new_pxls_.length;return e/(i-t|0)}}}),Object.defineProperty(_.prototype,"get_a_new_pxl_color",{get:function(){return function(t){return this.new_pxl_colors_.get_new_element(0|t)}}}),Object.defineProperty(_.prototype,"is_pxl_color_skin",{get:function(){return function(t){return this.new_pxl_colors_is_skin_mask_.has(0|t)}}}),Object.defineProperty(_.prototype,"max_cluster",{get:function(){return 0|this.max_cluster_}}),Object.defineProperty(_.prototype,"new_pxls_length",{get:function(){return 0|this.new_pxls_.length}}),Object.defineProperty(_.prototype,"new_pxl_colors_length",{get:function(){return 0|this.new_pxl_colors_.length}}),Object.defineProperty(_.prototype,"best_color_number",{get:function(){return 0|this.best_color_number_}}),Object.defineProperty(_.prototype,"get_data",{get:function(){return function(){return Array.of(this.new_pxls_,this.new_pxl_colors_.subarray_uint32(0,this.new_pxl_colors_.length),{deduplicate:this.get_remove_duplicate_ops(),simplify:this.get_simplify_ops(),classify:this.get_classify_on_x_bits_ops(),skin:this.get_is_skin_ops(),blend:this.get_blend_ops(),match:this.get_match_ops()})}}}),_.prototype.output=function(t){var i,e;return t=t||"heap",i=this.get_data(),"heap"==t?((e=new Uint32Array(2+i[0].length+i[1].length))[0]=0|i[0].length,e[1]=0|i[1].length,e.set(i[0],2),e.set(i[1],2+i[0].length),e.buffer):i},_.prototype.deduplicate=function(){var t,i,e,_,s;for(this.set_remove_duplicate_ops(this.get_remove_duplicate_ops()+1|0),this.reset_deduplicate(0|this.new_pxl_colors_length),t=0,i=0,e=0,_=0,s=0|this.new_pxls_length;(0|_)<(0|s);_=(_+1|0)>>>0)i=0|this.get_a_new_pxl_color_from_pxl_index(0|_),-1==(0|(e=0|this.index_of_color_within_cleaned(0|i)))&&(this.set_cleaned_pxl_colors(0|t,0|i),e=0|t,t=t+1|0),this.increase_color_usage(0|e),this.set_new_pxls(0|_,0|e);this.set_new_pxl_colors(t)},_.prototype.clusterize=function(){this.reset_cluster();var t=0;if(65537===this.max_cluster)for(;(0|t)<(0|this.new_pxl_colors_length);t=(t+1|0)>>>0)this.add_in_indexes_cluster((0|this.get_a_new_pxl_color((0|t)>>>0).rgbaon16bits)>>>0,(0|t)>>>0);else if(4097===this.max_cluster)for(;(0|t)<(0|this.new_pxl_colors_length);t=(t+1|0)>>>0)this.add_in_indexes_cluster((0|this.get_a_new_pxl_color((0|t)>>>0).rgbaon12bits)>>>0,(0|t)>>>0);else if(257===this.max_cluster)for(;(0|t)<(0|this.new_pxl_colors_length);t=(t+1|0)>>>0)this.add_in_indexes_cluster((0|this.get_a_new_pxl_color((0|t)>>>0).rgbaon8bits)>>>0,(0|t)>>>0);else if(17===this.max_cluster)for(;(0|t)<(0|this.new_pxl_colors_length);t=(t+1|0)>>>0)this.add_in_indexes_cluster((0|this.get_a_new_pxl_color((0|t)>>>0).rgbaon4bits)>>>0,(0|t)>>>0);else for(;(0|t)<(0|this.new_pxl_colors_length);t=(t+1|0)>>>0)this.add_in_indexes_cluster(0,(0|t)>>>0);this.max_cluster>1&&this.set_classify_on_x_bits_ops(this.get_classify_on_x_bits_ops()+this.new_pxl_colors_length),this.set_all_cluster_indexes()},_.prototype.process_threshold=function(t){var i,e,_,s,n,r,o,c,f,p,d,g,y,b,x,m,w,I,A,B,F,k,O,v,U;for(i=h((t=(0|t)>>>0)/2048),e=!1,_=[],s=[],n=0,r=0,f=!1,p=!1,d=0,g=0,y=0,b=0,x=0,m=0,B=0,F=0,k=0,O=0,v=0,U=0,w=h(h(t/256+t/256*i)/h(1+i)),A=h(w*a),I=h(w*u);(0|v)<(0|this.max_cluster);v=(v+1|0)>>>0){for(r=(n+((0|this.get_length_in_index_clusters(0|v))>>>0)|0)>>>0,x=this.get_average_color_usage_percent(0|n,0|r),k=0|n;(0|k)<(0|r);k=(k+1|0)>>>0){if(B=(0|this.get_an_index_in_clusters((0|k)>>>0))>>>0,o=this.get_a_new_pxl_color((0|B)>>>0),f=this.is_pxl_color_skin((0|B)>>>0),(0|(d=(0|this.get_a_color_usage((0|B)>>>0))>>>0))>0)for(_=[],O=0|n;(0|O)<(0|r);O=(O+1|0)>>>0)F=(0|this.get_an_index_in_clusters((0|O)>>>0))>>>0,c=this.get_a_new_pxl_color((0|F)>>>0),p=this.is_pxl_color_skin((0|F)>>>0),0!=(0|(g=(0|this.get_a_color_usage((0|F)>>>0))>>>0))&&(0|B)!=(0|F)&&(0|f)==(0|p)&&(y=this.get_a_color_usage_percent((0|B)>>>0)/x,b=this.get_a_color_usage_percent((0|F)>>>0)/x,U=h((U=f&&p?A:f||p?I:w)+U/h(y+b-Math.abs(y-b))),o.cie76_match_with(c,h(U/2))&&(m=h(g/d),e=!0,this.set_a_color_usage(0|F,0),_.push(c),s.push(m)));(0|_.length)>0&&(l.blend_all(o,_,s),_=[],s=[])}n=0|r}return e},_.prototype.round=function(){var t,i;if(this.new_pxl_colors_length>1024){for(t=0|(this.new_pxl_colors_length>32768?24:this.new_pxl_colors_length>32768?20:this.new_pxl_colors_length>16384?16:this.new_pxl_colors_length>8192?12:this.new_pxl_colors_length>2048?8:this.new_pxl_colors_length>1024?4:1),i=0;(0|i)<(0|this.new_pxl_colors_length);i=(i+1|0)>>>0)this.get_a_new_pxl_color((0|i)>>>0).simplify(t);this.set_simplify_ops(this.get_simplify_ops()+this.new_pxl_colors_length)}},_.prototype.init=function(){return this.round(),this.deduplicate(),this.clusterize(),this},_.prototype.run=function(){for(var t=0|(this.new_pxl_colors_length>6e4?60:this.new_pxl_colors_length>32e3?32:this.new_pxl_colors_length>16e3?16:this.new_pxl_colors_length>8192?8:this.new_pxl_colors_length>4096?4:this.new_pxl_colors_length>2048?2:1);this.new_pxl_colors_length>this.best_color_number;)this.process_threshold(0|t)&&(this.deduplicate(),this.clusterize()),t=t+(this.new_pxl_colors_length>6e4?60:this.new_pxl_colors_length>32e3?32:this.new_pxl_colors_length>16e3?16:this.new_pxl_colors_length>8192?8:this.new_pxl_colors_length>4096?4:this.new_pxl_colors_length>2048?2:1)|0;return this},s=function(t,i){return new Promise((function(e){var s,n,r,o,h,u,a,c,l=new Uint32Array(t.data.buffer),f=Uint32Array.from(new Set(l)),p={},d=f.length,g=new Uint32Array(l.length);for(s=0,n=0|d;(0|s)<(0|n);s=(s+1|0)>>>0)p[f[0|s]]=(0|s)>>>0;for(s=0,n=0|l.length;(0|s)<(0|n);s=(s+1|0)>>>0)g[0|s]=(0|p[l[0|s]])>>>0;for(r=Date.now(),o=_({pxls:g,pxl_colors:f,number_of_color:"auto"===i?d/1.618|0:parseFloat(i)<1?d-5:i,width:t.width,height:t.height}).init().run().output("split"),h=Date.now(),a=0|(u=o[0]).length,u.length,c=o[1],s=0;(0|s)<(0|a);s=(s+1|0)>>>0)l[0|s]=(0|c[(0|u[0|s])>>>0])>>>0;e([t=new ImageData(new Uint8ClampedArray(l.buffer),t.width,t.height),u,c,d-c.length,c.length,h-r])}))},t.exports={QuantiMatGlobal:s,QuantiMat:_}}}]);