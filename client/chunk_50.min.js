(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{1046:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=1e-7;n.epsilon=function(){return r},n.setEpsilon=function(e){r=e},n.imageDataFormat=function(){return"channelsLast"}},1047:function(e,n,t){"use strict";function r(e){return e instanceof d.Tensor}function o(e){return Array.isArray(e)}function a(e){return!r(e)&&!o(e)}function i(e,n,t,r,i){var s,u,l,c,h,p,d,m,y,b,v;if(void 0===r&&(r=!0),void 0===i&&(i=""),null==n||0===n.length){if(null!=e){if(s=!1,o(e)&&e.length>0)s=!0;else if(a(e)){for(u in e)if(e.hasOwnProperty(u)){s=!0;break}}else s=!0;if(s)throw new g.ValueError("Error when checking model "+i+" expected no data, but got "+e)}return[]}if(null==e)return n.map((function(e){return null}));if(a(e))for(l=[],c=0,h=n;c<h.length;c++){if(null==e[p=h[c]])throw new g.ValueError('No data provided for "'+p+'". Need data for each key in: '+n);l.push(e[p])}else if(o(e)){if(e.length!==n.length)throw new g.ValueError("Error when checking model "+i+": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see "+n.length+" Tensor(s), but instead got the following list of Tensor(s): "+e);l=e}else{if(n.length>1)throw new g.ValueError("The model "+i+" expects "+n.length+" Tensor(s), but only received one Tensor. Found: Tensor with shape "+e.shape);l=[e]}for(d=0;d<n.length;++d)1===(m=l[d]).shape.length&&(l[d]=f.expandDims(m,1));if(null!=t)for(d=0;d<n.length;++d)if(null!=t[d]){if((m=l[d]).shape.length!==t[d].length)throw new g.ValueError("Error when checking "+i+": expected "+n[d]+" to have "+t[d].length+" dimension(s). but got array with shape "+m.shape);for(y=0;y<t[d].length;++y)if((0!==y||r)&&(b=m.shape[y],null!=(v=t[d][y])&&v>=0&&b!==v))throw new g.ValueError("Error when checking "+i+": expected "+n[d]+" to have shape ["+t[d]+"], but got array with shape ["+m.shape+"].")}return l}function s(e,n,t){var r,o=w.unique(e.map((function(e){return e.shape[0]})));if(o.sort(),(r=w.unique(n.map((function(e){return e.shape[0]})))).sort(),o.length>1)throw new g.ValueError("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(e.map((function(e){return e.shape}))));if(r.length>1)throw new g.ValueError("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(n.map((function(e){return e.shape}))));if(o.length>0&&r.length>0&&!d.util.arraysEqual(o,r))throw new g.ValueError("Input Tensors should have the same number of samples as target Tensors. Found "+o[0]+" input sample(s) and "+r[0]+" target sample(s).")}function u(e,n){for(var t=[],r=0,o=null;r<e;)(o=r+n)>=e&&(o=e),t.push([r,o]),r=o;return t}function l(e,n,t){return null==e?[null]:Array.isArray(e)?e.map((function(e){return f.sliceAlongFirstAxis(e,n,t-n)})):f.sliceAlongFirstAxis(e,n,t-n)}function c(e,n){return null==e?null:Array.isArray(e)?e.map((function(e){return c(e,n)})):f.gather(e,"int32"===n.dtype?n:n.toInt())}function h(e,n,t,r,o){var a,i,s,u,l,c;if(void 0===r&&(r=!0),void 0===o&&(o=""),Array.isArray(e)){if(e.length!==n.length)throw new g.ValueError("Error when checking model "+o+": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see "+n.length+" Tensor(s), but instead got "+e.length+" Tensors(s).");a=e}else{if(n.length>1)throw new g.ValueError("The model expects "+n.length+" "+o+" Tensors, but only received one Tensor. Found: array with shape "+JSON.stringify(e.shape)+".");a=[e]}if(null!=t)for(i=0;i<n.length;++i)if(null!=t[i]){if((s=a[i]).shape.length!==t[i].length)throw new g.ValueError("Error when checking "+o+": expected "+n[i]+" to have "+t[i].length+" dimension(s), but got array with shape "+JSON.stringify(s.shape));for(u=0;u<t[i].length;++u)if((0!==u||r)&&(l=s.shape[u],null!=(c=t[i][u])&&c!==l))throw new g.ValueError("Error when checking "+o+": expected "+n[i]+" to have shape "+JSON.stringify(t[i])+" but got array with shape "+JSON.stringify(s.shape)+".")}}var p,d,f,m,g,y,b,v,w,L,N,I,E,x,A,D=this&&this.__extends||(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])},function(e,n){function t(){this.constructor=e}x(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}),P=this&&this.__decorate||function(e,n,t,r){var o,a,i=arguments.length,s=i<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,n,t,r);else for(a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(n,t,s):o(n,t))||s);return i>3&&s&&Object.defineProperty(n,t,s),s},S=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(n){a(n)}}function s(e){try{u(r.throw(e))}catch(n){a(n)}}function u(e){e.done?o(e.value):new t((function(n){n(e.value)})).then(i,s)}u((r=r.apply(e,n||[])).next())}))},T=this&&this.__generator||function(e,n){function t(t){return function(i){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,o&&(a=o[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!((a=(a=s.trys).length>0&&a[a.length-1])||6!==t[0]&&2!==t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(e,s)}catch(i){t=[6,i],o=0}finally{r=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,i])}}var r,o,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i};Object.defineProperty(n,"__esModule",{value:!0}),p=t(644),d=t(644),f=t(652),m=t(1267),g=t(645),y=t(1048),b=t(1268),v=t(2205),w=t(646),L=t(733),N=t(2206),I=t(669),n.isDataTensor=r,n.isDataArray=o,n.isDataDict=a,n.standardizeInputData=i,n.checkArrayLengths=s,n.makeBatches=u,n.sliceArraysByIndices=c,(A=n.ModelLoggingVerbosity||(n.ModelLoggingVerbosity={}))[A.SILENT=0]="SILENT",A[A.VERBOSE=1]="VERBOSE",E=function(e){function n(n){return e.call(this,n)||this}return D(n,e),n.prototype.getClassName=function(){return"Model"},n.prototype.compile=function(e){var n,t,r,o,a,i,s,u,l,c,h,p=this;if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"==typeof e.optimizer)this.optimizer=v.getOptimizer(e.optimizer);else{if(!(e.optimizer instanceof d.Optimizer))throw new g.ValueError("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer=e.optimizer}if(n=[],Array.isArray(e.loss)||"string"==typeof e.loss||"function"==typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new g.ValueError("When passing an Array as loss, it should have one entry per model output. The model has "+this.outputs.length+" output(s), but you passed loss="+e.loss+".");o=e.loss,n=o.map((function(e){return y.get(e)}))}else a=y.get(e.loss),this.outputs.map((function(e){n.push(a)}));else{for(t in e.loss=e.loss,e.loss)if(-1===this.outputNames.indexOf(t))throw new g.ValueError('Unknown entry in loss dictionary: "'+t+'". Only expect the following keys: '+this.outputNames);for(r in this.outputNames)null==e.loss[r]&&console.warn('Output "'+r+'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to '+r+" during training"),n.push(y.get(e.loss[r]))}for(this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[],i=0;i<this.outputs.length;++i)s=this.internalOutputShapes[i],u=this.outputNames[i],this.feedOutputNames.push(u),this.feedOutputShapes.push(s),this.feedLossFns.push(this.lossFunctions[i]);l=[],this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],f.nameScope("loss",(function(){var e,n;for(e=0;e<p.outputs.length;++e)-1===l.indexOf(e)&&(n=p.lossFunctions[e],p.outputs.length>1&&(p.metricsTensors.push([n,e]),p.metricsNames.push(p.outputNames[e]+"_loss")))})),c=function(e,n){var t,r,o,a,i;if(null==e||Array.isArray(e)&&0===e.length)return n.map((function(e){return[]}));if(Array.isArray(e))return n.map((function(n){return e}));if(null!=e){for(t=[],r=0,o=n;r<o.length;r++)a=o[r],i=e.hasOwnProperty(a)?e[a]:[],Array.isArray(i)||(i=[i]),t.push(i);return t}throw new TypeError("Type of metrics argument not understood. Expected an Array or Object, found: "+e)}(e.metrics,this.outputNames),h=function(e,n,t){p.outputNames.length>1&&(n=p.outputNames[e]+"_"+n),p.metricsNames.push(n),p.metricsTensors.push([t,e])},f.nameScope("metric",(function(){var e,n=function(e){if(-1!==l.indexOf(e))return"continue";!function(n){var t,r,o,a,i,s=function(n){var a,i,s,u;-1!==["accuracy","acc","crossentropy","ce"].indexOf(n)?(1===(a=p.internalOutputShapes[e])[a.length-1]||p.lossFunctions[e]===y.binaryCrossentropy?-1!==["accuracy","acc"].indexOf(n)?r=b.binaryAccuracy:-1!==["crossentropy","ce"].indexOf(n)&&(r=b.binaryCrossentropy):p.lossFunctions[e]===y.sparseCategoricalCrossentropy?-1!==["accuracy","acc"].indexOf(n)?r=b.sparseCategoricalAccuracy:-1!==["crossentropy","ce"].indexOf(n)&&(r=b.sparseCategoricalCrossentropy):-1!==["accuracy","acc"].indexOf(n)?r=b.categoricalAccuracy:-1!==["crossentropy","ce"].indexOf(n)&&(r=b.categoricalCrossentropy),i=void 0,-1!==["accuracy","acc"].indexOf(n)?i="acc":-1!==["crossentropy","ce"].indexOf(n)&&(i="ce"),o=r,t=""+i):(s=b.get(n),o=s,t=""+n),f.nameScope(t,(function(){u=o})),h(e,t,u)};for(a=0,i=n;a<i.length;a++)s(i[a])}(c[e])};for(e=0;e<p.outputs.length;++e)n(e)})),this.collectedTrainableWeights=this.trainableWeights},n.prototype.checkTrainableWeightsConsistency=function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")},n.prototype.evaluate=function(e,n,t){var r,o,a,i,s;return void 0===t&&(t={}),r=null==t.batchSize?32:t.batchSize,a=(o=this.standardizeUserData(e,n,!0,r))[0].concat(o[1]),this.makeTestFunction(),i=this.testFunction,s=this.testLoop(i,a,r,t.verbose,t.steps),w.singletonOrArray(s)},n.prototype.checkNumSamples=function(e,n,t,r){var o;if(void 0===r&&(r="steps"),null!=t){if(o=null,null!=n)throw new g.ValueError("If "+r+" is set, batchSize must be null or undefined.Got batchSize = "+n)}else{if(null==e)throw new g.ValueError("Either the input data should have a defined shape, or "+r+" shoud be specified.");o=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return o},n.prototype.predictLoop=function(e,n,t){var r,o,a,i,s,c=this;if(void 0===n&&(n=32),void 0===t&&(t=!1),r=this.checkNumSamples(e),t)throw new g.NotImplementedError("Verbose predictLoop() is not implemented yet.");for(o=u(r,n),a=[],i=function(n){var t,r,i,s,u=p.tidy((function(){var t,r,a=o[n][0],i=o[n][1],s=l(e,a,i),u=[];if(Array.isArray(s))for(t=0;t<s.length;++t)u.push({key:c.inputs[t],value:s[t]});else u.push({key:c.inputs[0],value:s});return r=new N.FeedDict(u),N.execute(c.outputs,r)}));if(0===n)for(t=0,r=u;t<r.length;t++)i=r[t],a.push(i);else for(s=0;s<u.length;++s)a[s]=f.concatAlongFirstAxis(a[s],u[s])},s=0;s<o.length;++s)i(s);return w.singletonOrArray(a)},n.prototype.predict=function(e,n){void 0===n&&(n={}),h(e,this.inputNames,this.feedInputShapes,!1);var t=null==n.batchSize?32:n.batchSize;return this.predictLoop(e,t)},n.prototype.predictOnBatch=function(e){return h(e,this.inputNames,this.feedInputShapes,!0),this.predictLoop(e,e.shape[0])},n.prototype.standardizeUserData=function(e,n,t,r){var o,a,u;if(void 0===t&&(t=!0),null==this.optimizer)throw new g.RuntimeError("You must compile a model before training/testing. Use Model.compile(modelCompileConfig).");for(o=[],a=0;a<this.feedOutputShapes.length;++a)u=this.feedOutputShapes[a],this.feedLossFns[a]===y.sparseCategoricalCrossentropy?o.push(u.slice(0,u.length-1).concat([1])):o.push(u);if(s(e=i(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=i(n,this.feedOutputNames,o,!1,"target")),function(e,n,t){var r,o,a,i,s,u,l,c,h,p=[y.meanSquaredError,y.binaryCrossentropy,y.categoricalCrossentropy];for(r=0;r<e.length;++r)if(o=e[r],a=n[r],i=t[r],null!=a){if(a===y.categoricalCrossentropy&&1===o.shape[o.shape.length-1])throw new g.ValueError("You are passing a target array of shape "+o.shape+" while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==p.indexOf(a))for(s=o.shape.slice(1),u=i.slice(1),l=0;l<s.length;++l)if(c=s[l],null!=(h=u[l])&&c!==h)throw new g.ValueError("A target Tensor with shape "+o.shape+" was passed for an output of shape "+i+", while using a loss function that expects targets to have the same shape as the output.")}}(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=r&&r>0&&e[0].shape[0]%r!=0)throw new g.ValueError("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+r+". Found: "+e[0].shape[0]+" sample(s).");return[e,n,null]},n.prototype.fitLoop=function(e,n,t,r,o,a,i,s,l,h,y,b,v,w){return void 0===b&&(b=0),S(this,void 0,void 0,(function(){var N,I,E,x,A,D,P=this;return T(this,(function(S){switch(S.label){case 0:if(null==r&&(r=32),null==o&&(o=100),null==h&&(h=!0),null==b&&(b=0),N=!1,null!=s&&null!=l&&(N=!0),null!=w&&(N=!0,null==v))throw new g.ValueError("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");if(null!=(I=this.checkNumSamples(n,r,v,"steps_per_epoch"))&&(E=L.range(0,I)),this.history=new m.History,i=(i=null==i?[new m.BaseLogger]:[new m.BaseLogger].concat(i)).concat([this.history]),a>0)throw new g.NotImplementedError("Verbose mode is not implemented yet.");return(x=new m.CallbackList(i)).setModel(this),x.setParams({epochs:o,steps:v,verbose:a,doValidation:N,metrics:y}),[4,x.onTrainBegin()];case 1:S.sent(),A=function(o){var a,i,y,b,w;return T(this,(function(L){switch(L.label){case 0:return[4,x.onEpochBegin(o)];case 1:if(L.sent(),a={},null==v)return[3,2];throw new g.NotImplementedError("stepsPerEpoch mode is not implemented yet.");case 2:if("batch"===h)throw new g.NotImplementedError("batch shuffling is not implemneted yet");h&&d.util.shuffle(E),i=d.tensor1d(E),y=u(I,r),b=function(o){var u;return T(this,(function(h){switch(h.label){case 0:return u={},[4,x.onBatchBegin(o,u)];case 1:return h.sent(),p.tidy((function(){var h,p,d,m,g,b,v=y[o][0],w=y[o][1],L=f.sliceAlongFirstAxis(i,v,w-v);for(u.batch=o,u.size=w-v,h=c(n,L),p=e(h),d=0;d<t.length;++d)m=t[d],g=p[d],u[m]=g,f.keep(g);if(o===y.length-1&&N)for(b=P.testLoop(s,l,r),d=0;d<t.length;++d)m=t[d],g=b[d],f.keep(g),a["val_"+m]=g})),[4,x.onBatchEnd(o,u)];case 2:return h.sent(),m.disposeTensorsInLogs(u),[2]}}))},w=0,L.label=3;case 3:return w<y.length?[5,b(w)]:[3,6];case 4:L.sent(),L.label=5;case 5:return++w,[3,3];case 6:i.dispose(),L.label=7;case 7:return[4,x.onEpochEnd(o,a)];case 8:return L.sent(),[2]}}))},D=b,S.label=2;case 2:return D<o?[5,A(D)]:[3,5];case 3:S.sent(),S.label=4;case 4:return++D,[3,2];case 5:return[4,x.onTrainEnd()];case 6:return S.sent(),[4,this.history.syncData()];case 7:return S.sent(),[2,this.history]}}))}))},n.prototype.testLoop=function(e,n,t,r,o){var a,i,s,l,h,p,m,y,b,v;if(void 0===r&&(r=0),a=this.checkNumSamples(n,t,o,"steps"),i=[],1===r)throw new g.NotImplementedError("Verbose mode is not implemented yet.");if(null!=o)throw new g.NotImplementedError("steps mode in testLoop() is not implemented yet");for(s=u(a,t),l=d.tensor1d(L.range(0,a)),h=0;h<s.length;++h){if(p=s[h][0],m=s[h][1],y=e(c(n,f.sliceAlongFirstAxis(l,p,m-p))),0===h)for(b=0;b<y.length;++b)i.push(f.getScalar(0));for(b=0;b<y.length;++b)v=y[b],i[b]=f.add(i[b],f.scalarTimesArray(f.getScalar(m-p),v))}for(b=0;b<i.length;++b)i[b]=f.divide(i[b],f.getScalar(a));return i},n.prototype.getDedupedMetricsNames=function(){var e,n,t,r=this.metricsNames,o=[];for(e=0;e<r.length;++e)t=n=r[e],w.count(r,n)>1&&(t+="_"+w.count(r.slice(0,e),n)),o.push(t);return o},n.prototype.makeTestFunction=function(){var e=this;this.testFunction=function(n){return p.tidy((function(){var t,r,o,a,i,s,u,l,c,h=[],p=n.slice(0,e.inputs.length),d=n.slice(e.inputs.length,e.inputs.length+e.outputs.length),m=[];for(r=0;r<e.inputs.length;++r)m.push({key:e.inputs[r],value:p[r]});for(o=new N.FeedDict(m),a=N.execute(e.outputs,o),r=0;r<e.lossFunctions.length;++r)i=e.lossFunctions[r],s=f.mean(i(d[r],a[r])),t=0===r?s:f.add(t,s),h.push(t);for(r=0;r<e.metricsTensors.length;++r)u=e.metricsTensors[r][0],l=e.metricsTensors[r][1],c=f.mean(u(d[l],a[l])),h.push(c);return h}))}},n.prototype.fit=function(e,n,t){return void 0===t&&(t={}),S(this,void 0,void 0,(function(){var r,o,a,i,s,u,c,h,p,d,y,b,v,w,L,I,E,x=this;return T(this,(function(A){if(r=null==t.batchSize?32:t.batchSize,o=this.standardizeUserData(e,n,!1,r),a=o[0],i=o[1],s=!1,null!=t.validationData&&t.validationData.length>0){if(s=!0,2!==t.validationData.length)throw 3===t.validationData.length?new g.NotImplementedError("validationData including sample weights is not supported yet."):new g.ValueError("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+t.validationData+" is invalid.");u=t.validationData[0],c=t.validationData[1],p=this.standardizeUserData(u,c,!0,r),u=p[0],c=p[1],h=u.concat(c)}else null!=t.validationSplit&&t.validationSplit>0&&t.validationSplit<1?(s=!0,d=Math.floor(a[0].shape[0]*(1-t.validationSplit)),y=a[0].shape[0],u=l(a,d,y),a=l(a,0,d),c=l(i,d,y),i=l(i,0,d),h=u.concat(c)):null!=t.validationSteps&&(s=!0);return b=a.concat(i),this.checkTrainableWeightsConsistency(),v=function(e){var n=[],t=[],r=e.slice(0,x.inputs.length),o=e.slice(x.inputs.length,x.inputs.length+x.outputs.length),a=[],i=x.collectedTrainableWeights.map((function(e){return e.read()}));return[x.optimizer.minimize((function(){var e,i,s,u,l,c,h,p,d,m=[];for(e=0;e<x.inputs.length;++e)m.push({key:x.inputs[e],value:r[e]});for(i=new N.FeedDict(m),s=N.execute(x.outputs,i,{training:!0}),e=0;e<x.lossFunctions.length;++e)l=(0,x.lossFunctions[e])(o[e],s[e]),n.push(l),c=f.mean(l),t.push(c),u=0===e?l:f.add(u,l);for(e=0;e<x.metricsTensors.length;++e)h=x.metricsTensors[e][0],p=x.metricsTensors[e][1],d=f.mean(h(o[p],s[p])),f.keep(d),a.push(d);return u=f.mean(u),x.calculateLosses().forEach((function(e){u=f.add(u,e)})),u}),!0,i)].concat(a)},w=this.getDedupedMetricsNames(),s?(this.makeTestFunction(),L=this.testFunction,I=w.slice().concat(w.map((function(e){return"val_"+e})))):(L=null,h=[],I=w.slice()),E=m.standardizeCallbacks(t.callbacks),[2,this.fitLoop(v,b,w,r,t.epochs,t.verbose,E,L,h,t.shuffle,I,null,null,null)]}))}))},P([d.doc({heading:"Models",subheading:"Classes",configParamIndices:[0]})],n.prototype,"compile",null),P([d.doc({heading:"Models",subheading:"Classes",configParamIndices:[2]})],n.prototype,"evaluate",null),P([d.doc({heading:"Models",subheading:"Classes",configParamIndices:[1]})],n.prototype,"predict",null),P([d.doc({heading:"Models",subheading:"Classes"})],n.prototype,"predictOnBatch",null),P([d.doc({heading:"Models",subheading:"Classes",configParamIndices:[2]})],n.prototype,"fit",null),P([d.doc({heading:"Models",subheading:"Classes"})],n)}(I.Container),n.Model=E,w.ClassNameMap.register("Model",E)},1267:function(e,n,t){"use strict";function r(e){return f(this,void 0,void 0,(function(){var n,t,r,o,a,i,s;return m(this,(function(u){switch(u.label){case 0:if(null==e)return[2];for(r in n=[],t=[],e)"number"!=typeof(o=e[r])&&(a=o,n.push(a.data()),t.push(r));return[4,Promise.all(n)];case 1:for(i=u.sent(),s=0;s<i.length;++s)e[t[s]]=i[s][0];return[2]}}))}))}var o,a,i,s,u,l,c,h,p,d=this&&this.__extends||(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])},function(e,n){function t(){this.constructor=e}p(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}),f=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(n){a(n)}}function s(e){try{u(r.throw(e))}catch(n){a(n)}}function u(e){e.done?o(e.value):new t((function(n){n(e.value)})).then(i,s)}u((r=r.apply(e,n||[])).next())}))},m=this&&this.__generator||function(e,n){function t(t){return function(i){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,o&&(a=o[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!((a=(a=s.trys).length>0&&a[a.length-1])||6!==t[0]&&2!==t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(e,s)}catch(i){t=[6,i],o=0}finally{r=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,i])}}var r,o,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i};Object.defineProperty(n,"__esModule",{value:!0}),o=t(644),a=t(652),i=t(646),s=function(){function e(){this.validationData=null,this.model=null}return e.prototype.setParams=function(e){this.params=e},e.prototype.setModel=function(e){this.model=e},e.prototype.onEpochBegin=function(e,n){return f(this,void 0,void 0,(function(){return m(this,(function(e){return[2]}))}))},e.prototype.onEpochEnd=function(e,n){return f(this,void 0,void 0,(function(){return m(this,(function(e){return[2]}))}))},e.prototype.onBatchBegin=function(e,n){return f(this,void 0,void 0,(function(){return m(this,(function(e){return[2]}))}))},e.prototype.onBatchEnd=function(e,n){return f(this,void 0,void 0,(function(){return m(this,(function(e){return[2]}))}))},e.prototype.onTrainBegin=function(e){return f(this,void 0,void 0,(function(){return m(this,(function(e){return[2]}))}))},e.prototype.onTrainEnd=function(e){return f(this,void 0,void 0,(function(){return m(this,(function(e){return[2]}))}))},e}(),n.Callback=s,u=function(){function e(e,n){void 0===n&&(n=10),null==e&&(e=[]),this.callbacks=e,this.queueLength=n}return e.prototype.append=function(e){this.callbacks.push(e)},e.prototype.setParams=function(e){var n,t;for(n=0,t=this.callbacks;n<t.length;n++)t[n].setParams(e)},e.prototype.setModel=function(e){var n,t;for(n=0,t=this.callbacks;n<t.length;n++)t[n].setModel(e)},e.prototype.onEpochBegin=function(e,n){return f(this,void 0,void 0,(function(){var t,r;return m(this,(function(o){switch(o.label){case 0:null==n&&(n={}),t=0,r=this.callbacks,o.label=1;case 1:return t<r.length?[4,r[t].onEpochBegin(e,n)]:[3,4];case 2:o.sent(),o.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},e.prototype.onEpochEnd=function(e,n){return f(this,void 0,void 0,(function(){var t,r;return m(this,(function(o){switch(o.label){case 0:null==n&&(n={}),t=0,r=this.callbacks,o.label=1;case 1:return t<r.length?[4,r[t].onEpochEnd(e,n)]:[3,4];case 2:o.sent(),o.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},e.prototype.onBatchBegin=function(e,n){return f(this,void 0,void 0,(function(){var t,r;return m(this,(function(o){switch(o.label){case 0:null==n&&(n={}),t=0,r=this.callbacks,o.label=1;case 1:return t<r.length?[4,r[t].onBatchBegin(e,n)]:[3,4];case 2:o.sent(),o.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},e.prototype.onBatchEnd=function(e,n){return f(this,void 0,void 0,(function(){var t,r;return m(this,(function(o){switch(o.label){case 0:null==n&&(n={}),t=0,r=this.callbacks,o.label=1;case 1:return t<r.length?[4,r[t].onBatchEnd(e,n)]:[3,4];case 2:o.sent(),o.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},e.prototype.onTrainBegin=function(e){return f(this,void 0,void 0,(function(){var n,t;return m(this,(function(r){switch(r.label){case 0:null==e&&(e={}),n=0,t=this.callbacks,r.label=1;case 1:return n<t.length?[4,t[n].onTrainBegin(e)]:[3,4];case 2:r.sent(),r.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.onTrainEnd=function(e){return f(this,void 0,void 0,(function(){var n,t;return m(this,(function(r){switch(r.label){case 0:null==e&&(e={}),n=0,t=this.callbacks,r.label=1;case 1:return n<t.length?[4,t[n].onTrainEnd(e)]:[3,4];case 2:r.sent(),r.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e}(),n.CallbackList=u,l=function(e){function n(){return e.call(this)||this}return d(n,e),n.prototype.onEpochBegin=function(e,n){return f(this,void 0,void 0,(function(){return m(this,(function(e){return this.seen=0,this.totals={},[2]}))}))},n.prototype.onBatchEnd=function(e,n){return f(this,void 0,void 0,(function(){var e,t,r,i,s=this;return m(this,(function(u){for(i in null==n&&(n={}),e=null==n.size?0:n.size,this.seen+=e,t=function(t){var i=n[t];"number"==typeof i?(r.totals.hasOwnProperty(t)||(r.totals[t]=0),r.totals[t]=r.totals[t]+i*e):(r.totals.hasOwnProperty(t)||(r.totals[t]=a.getScalar(0)),o.tidy((function(){s.totals[t]=a.scalarPlusArray(s.totals[t],a.multiply(i,a.getScalar(e))),a.keep(s.totals[t])})))},r=this,n)t(i);return[2]}))}))},n.prototype.onEpochEnd=function(e,n){return f(this,void 0,void 0,(function(){var e,t,r,i,s,u=this;return m(this,(function(l){if(null!=n)for(e=function(e){if(null==t.totals[e])return"continue";"number"==typeof t.totals[e]?n[e]=t.totals[e]/t.seen:o.tidy((function(){n[e]=a.scalarTimesArray(a.divide(a.getScalar(1),a.getScalar(u.seen)),u.totals[e]),a.keep(n[e])}))},t=this,r=0,i=this.params.metrics;r<i.length;r++)s=i[r],e(s);return[2]}))}))},n}(s),n.BaseLogger=l,n.resolveScalarsInLogs=r,n.disposeTensorsInLogs=function(e){var n,t;if(null!=e)for(n in e)"number"!=typeof(t=e[n])&&t.dispose()},c=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return d(n,e),n.prototype.onTrainBegin=function(e){return f(this,void 0,void 0,(function(){return m(this,(function(e){return this.epoch=[],this.history={},[2]}))}))},n.prototype.onEpochEnd=function(e,n){return f(this,void 0,void 0,(function(){var t;return m(this,(function(r){for(t in null==n&&(n={}),this.epoch.push(e),n)null==this.history[t]&&(this.history[t]=[]),this.history[t].push(n[t]);return[2]}))}))},n.prototype.syncData=function(){return f(this,void 0,void 0,(function(){var e,n,t,r,o,a,i,s,u;return m(this,(function(l){switch(l.label){case 0:for(r in e=[],n=[],t=[],this.history)for(o=this.history[r],a=0;a<o.length;++a)"number"!=typeof o[a]&&(i=o[a],e.push(i.data()),n.push(r),t.push(a));return[4,Promise.all(e)];case 1:for(s=l.sent(),u=0;u<s.length;++u)this.history[n[u]][t[u]].dispose(),this.history[n[u]][t[u]]=s[u][0];return[2]}}))}))},n}(s),n.History=c,h=function(e){function n(n){var t=e.call(this)||this;return t.trainBegin=n.onTrainBegin,t.trainEnd=n.onTrainEnd,t.epochBegin=n.onEpochBegin,t.epochEnd=n.onEpochEnd,t.batchBegin=n.onBatchBegin,t.batchEnd=n.onBatchEnd,t}return d(n,e),n.prototype.onEpochBegin=function(e,n){return f(this,void 0,void 0,(function(){return m(this,(function(t){switch(t.label){case 0:return null==this.epochBegin?[3,3]:[4,r(n)];case 1:return t.sent(),[4,this.epochBegin(e,n)];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},n.prototype.onEpochEnd=function(e,n){return f(this,void 0,void 0,(function(){return m(this,(function(t){switch(t.label){case 0:return null==this.epochEnd?[3,3]:[4,r(n)];case 1:return t.sent(),[4,this.epochEnd(e,n)];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},n.prototype.onBatchBegin=function(e,n){return f(this,void 0,void 0,(function(){return m(this,(function(t){switch(t.label){case 0:return null==this.batchBegin?[3,3]:[4,r(n)];case 1:return t.sent(),[4,this.batchBegin(e,n)];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},n.prototype.onBatchEnd=function(e,n){return f(this,void 0,void 0,(function(){return m(this,(function(t){switch(t.label){case 0:return null==this.batchEnd?[3,3]:[4,r(n)];case 1:return t.sent(),[4,this.batchEnd(e,n)];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},n.prototype.onTrainBegin=function(e){return f(this,void 0,void 0,(function(){return m(this,(function(n){switch(n.label){case 0:return null==this.trainBegin?[3,3]:[4,r(e)];case 1:return n.sent(),[4,this.trainBegin(e)];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},n.prototype.onTrainEnd=function(e){return f(this,void 0,void 0,(function(){return m(this,(function(n){switch(n.label){case 0:return null==this.trainEnd?[3,3]:[4,r(e)];case 1:return n.sent(),[4,this.trainEnd(e)];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},n}(s),n.CustomCallback=h,n.standardizeCallbacks=function(e){return null==e?null:e instanceof s?[e]:Array.isArray(e)&&e[0]instanceof s?e:i.toList(e).map((function(e){return new h(e)}))}},2204:function(e,n,t){"use strict";var r,o,a,i,s,u,l,c,h,p,d,f,m,g,y,b,v,w,L,N,I,E,x,A,D,P,S=this&&this.__decorate||function(e,n,t,r){var o,a,i=arguments.length,s=i<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,n,t,r);else for(a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(n,t,s):o(n,t))||s);return i>3&&s&&Object.defineProperty(n,t,s),s};Object.defineProperty(n,"__esModule",{value:!0}),r=t(644),o=t(758),a=t(669),i=t(1047),s=t(734),u=t(2207),l=t(1269),c=t(2208),h=t(2209),p=t(2210),d=t(2211),f=t(2212),m=t(2213),g=t(2214),y=t(1270),b=t(2215),v=t(1048),w=t(1268),L=t(1271),N=t(759),I=function(){function e(){}return e.model=function(e){return new i.Model(e)},e.sequential=function(e){return new L.Sequential(e)},e.loadModel=function(e){return L.loadModelInternal(e)},e.input=function(e){return a.Input(e)},S([r.doc({heading:"Models",subheading:"Creation",configParamIndices:[0]})],e,"model",null),S([r.doc({heading:"Models",subheading:"Creation",configParamIndices:[0]})],e,"sequential",null),S([r.doc({heading:"Models",subheading:"Loading",useDocsFrom:"loadModelInternal"})],e,"loadModel",null),S([r.doc({heading:"Models",subheading:"Inputs",useDocsFrom:"Input",configParamIndices:[0]})],e,"input",null),e}(),n.ModelExports=I,E=function(){function e(){}return e.inputLayer=function(e){return new a.InputLayer(e)},e.elu=function(e){return new u.ELU(e)},e.leakyReLU=function(e){return new u.LeakyReLU(e)},e.softmax=function(e){return new u.Softmax(e)},e.thresholdedReLU=function(e){return new u.ThresholdedReLU(e)},e.conv1d=function(e){return new l.Conv1D(e)},e.conv2d=function(e){return new l.Conv2D(e)},e.conv2dTranspose=function(e){return new l.Conv2DTranspose(e)},e.separableConv2d=function(e){return new l.SeparableConv2D(e)},e.depthwiseConv2d=function(e){return new c.DepthwiseConv2D(e)},e.activation=function(e){return new h.Activation(e)},e.dense=function(e){return new h.Dense(e)},e.dropout=function(e){return new h.Dropout(e)},e.flatten=function(e){return new h.Flatten(e)},e.repeatVector=function(e){return new h.RepeatVector(e)},e.reshape=function(e){return new h.Reshape(e)},e.embedding=function(e){return new p.Embedding(e)},e.add=function(e){return new d.Add(e)},e.average=function(e){return new d.Average(e)},e.concatenate=function(e){return new d.Concatenate(e)},e.maximum=function(e){return new d.Maximum(e)},e.minimum=function(e){return new d.Minimum(e)},e.multiply=function(e){return new d.Multiply(e)},e.batchNormalization=function(e){return new f.BatchNormalization(e)},e.zeroPadding2d=function(e){return new m.ZeroPadding2D(e)},e.averagePooling1d=function(e){return new g.AveragePooling1D(e)},e.avgPool1d=function(n){return e.averagePooling1d(n)},e.avgPooling1d=function(n){return e.averagePooling1d(n)},e.averagePooling2d=function(e){return new g.AveragePooling2D(e)},e.avgPool2d=function(n){return e.averagePooling2d(n)},e.avgPooling2d=function(n){return e.averagePooling2d(n)},e.globalAveragePooling1d=function(e){return new g.GlobalAveragePooling1D(e)},e.globalAveragePooling2d=function(e){return new g.GlobalAveragePooling2D(e)},e.globalMaxPooling1d=function(e){return new g.GlobalMaxPooling1D(e)},e.globalMaxPooling2d=function(e){return new g.GlobalMaxPooling2D(e)},e.maxPooling1d=function(e){return new g.MaxPooling1D(e)},e.maxPooling2d=function(e){return new g.MaxPooling2D(e)},e.gru=function(e){return new y.GRU(e)},e.gruCell=function(e){return new y.GRUCell(e)},e.lstm=function(e){return new y.LSTM(e)},e.lstmCell=function(e){return new y.LSTMCell(e)},e.simpleRNN=function(e){return new y.SimpleRNN(e)},e.simpleRNNCell=function(e){return new y.SimpleRNNCell(e)},e.rnn=function(e){return new y.RNN(e)},e.stackedRNNCells=function(e){return new y.StackedRNNCells(e)},e.bidirectional=function(e){return new b.Bidirectional(e)},e.timeDistributed=function(e){return new b.TimeDistributed(e)},e.Layer=a.Layer,e.RNNCell=y.RNNCell,e.input=I.input,S([r.doc({heading:"Layers",subheading:"Inputs",namespace:"layers",useDocsFrom:"InputLayer",configParamIndices:[0]})],e,"inputLayer",null),S([r.doc({heading:"Layers",subheading:"Advanced Activation",namespace:"layers",useDocsFrom:"ELU",configParamIndices:[0]})],e,"elu",null),S([r.doc({heading:"Layers",subheading:"Advanced Activation",namespace:"layers",useDocsFrom:"LeakyReLU",configParamIndices:[0]})],e,"leakyReLU",null),S([r.doc({heading:"Layers",subheading:"Advanced Activation",namespace:"layers",useDocsFrom:"Softmax",configParamIndices:[0]})],e,"softmax",null),S([r.doc({heading:"Layers",subheading:"Advanced Activation",namespace:"layers",useDocsFrom:"ThresholdedReLU",configParamIndices:[0]})],e,"thresholdedReLU",null),S([r.doc({heading:"Layers",subheading:"Convolutional",namespace:"layers",useDocsFrom:"Conv1D",configParamIndices:[0]})],e,"conv1d",null),S([r.doc({heading:"Layers",subheading:"Convolutional",namespace:"layers",useDocsFrom:"Conv2D",configParamIndices:[0]})],e,"conv2d",null),S([r.doc({heading:"Layers",subheading:"Convolutional",namespace:"layers",useDocsFrom:"Conv2DTranspose",configParamIndices:[0]})],e,"conv2dTranspose",null),S([r.doc({heading:"Layers",subheading:"Convolutional",namespace:"layers",useDocsFrom:"SeparableConv2D",configParamIndices:[0]})],e,"separableConv2d",null),S([r.doc({heading:"Layers",subheading:"Convolutional",namespace:"layers",useDocsFrom:"DepthwiseConv2D",configParamIndices:[0]})],e,"depthwiseConv2d",null),S([r.doc({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"Activation",configParamIndices:[0]})],e,"activation",null),S([r.doc({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"Dense",configParamIndices:[0]})],e,"dense",null),S([r.doc({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"Dropout",configParamIndices:[0]})],e,"dropout",null),S([r.doc({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"Flatten",configParamIndices:[0]})],e,"flatten",null),S([r.doc({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"RepeatVector",configParamIndices:[0]})],e,"repeatVector",null),S([r.doc({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"Reshape",configParamIndices:[0]})],e,"reshape",null),S([r.doc({heading:"Layers",subheading:"Basic",namespace:"layers",useDocsFrom:"Embedding",configParamIndices:[0]})],e,"embedding",null),S([r.doc({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Add",configParamIndices:[0]})],e,"add",null),S([r.doc({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Average",configParamIndices:[0]})],e,"average",null),S([r.doc({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Concatenate",configParamIndices:[0]})],e,"concatenate",null),S([r.doc({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Maximum",configParamIndices:[0]})],e,"maximum",null),S([r.doc({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Minimum",configParamIndices:[0]})],e,"minimum",null),S([r.doc({heading:"Layers",subheading:"Merge",namespace:"layers",useDocsFrom:"Multiply",configParamIndices:[0]})],e,"multiply",null),S([r.doc({heading:"Layers",subheading:"Normalization",namespace:"layers",useDocsFrom:"BatchNormalization",configParamIndices:[0]})],e,"batchNormalization",null),S([r.doc({heading:"Layers",subheading:"Padding",namespace:"layers",useDocsFrom:"ZeroPadding2D",configParamIndices:[0]})],e,"zeroPadding2d",null),S([r.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"AveragePooling1D",configParamIndices:[0]})],e,"averagePooling1d",null),S([r.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"AveragePooling2D",configParamIndices:[0]})],e,"averagePooling2d",null),S([r.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"GlobalAveragePooling1D",configParamIndices:[0]})],e,"globalAveragePooling1d",null),S([r.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"GlobalAveragePooling2D",configParamIndices:[0]})],e,"globalAveragePooling2d",null),S([r.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"GlobalMaxPooling1D",configParamIndices:[0]})],e,"globalMaxPooling1d",null),S([r.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"GlobalMaxPooling2D",configParamIndices:[0]})],e,"globalMaxPooling2d",null),S([r.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"MaxPooling1D",configParamIndices:[0]})],e,"maxPooling1d",null),S([r.doc({heading:"Layers",subheading:"Pooling",namespace:"layers",useDocsFrom:"MaxPooling2D",configParamIndices:[0]})],e,"maxPooling2d",null),S([r.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"GRU",configParamIndices:[0]})],e,"gru",null),S([r.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"GRUCell",configParamIndices:[0]})],e,"gruCell",null),S([r.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"LSTM",configParamIndices:[0]})],e,"lstm",null),S([r.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"LSTMCell",configParamIndices:[0]})],e,"lstmCell",null),S([r.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"SimpleRNN",configParamIndices:[0]})],e,"simpleRNN",null),S([r.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"SimpleRNNCell",configParamIndices:[0]})],e,"simpleRNNCell",null),S([r.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"RNN",configParamIndices:[0]})],e,"rnn",null),S([r.doc({heading:"Layers",subheading:"Recurrent",namespace:"layers",useDocsFrom:"RNN",configParamIndices:[0]})],e,"stackedRNNCells",null),S([r.doc({heading:"Layers",subheading:"Wrapper",namespace:"layers",useDocsFrom:"Bidirectional",configParamIndices:[0]})],e,"bidirectional",null),S([r.doc({heading:"Layers",subheading:"Wrapper",namespace:"layers",useDocsFrom:"TimeDistributed",configParamIndices:[0]})],e,"timeDistributed",null),e}(),n.LayerExports=E,x=function(){function e(){}return e.maxNorm=function(e){return new o.MaxNorm(e)},e.unitNorm=function(e){return new o.UnitNorm(e)},e.nonNeg=function(){return new o.NonNeg},e.minMaxNorm=function(e){return new o.MinMaxNorm(e)},S([r.doc({heading:"Constraints",namespace:"constraints",useDocsFrom:"MaxNorm",configParamIndices:[0]})],e,"maxNorm",null),S([r.doc({heading:"Constraints",namespace:"constraints",useDocsFrom:"UnitNorm",configParamIndices:[0]})],e,"unitNorm",null),S([r.doc({heading:"Constraints",namespace:"constraints",useDocsFrom:"NonNeg"})],e,"nonNeg",null),S([r.doc({heading:"Constraints",namespace:"constraints",useDocsFrom:"MinMaxNormConfig",configParamIndices:[0]})],e,"minMaxNorm",null),e}(),n.ConstraintExports=x,A=function(){function e(){}return e.zeros=function(){return new s.Zeros},e.ones=function(){return new s.Ones},e.constant=function(e){return new s.Constant(e)},e.randomUniform=function(e){return new s.RandomUniform(e)},e.randomNormal=function(e){return new s.RandomNormal(e)},e.truncatedNormal=function(e){return new s.TruncatedNormal(e)},e.identity=function(e){return new s.Identity(e)},e.varianceScaling=function(e){return new s.VarianceScaling(e)},e.glorotUniform=function(e){return new s.GlorotUniform(e)},e.glorotNormal=function(e){return new s.GlorotNormal(e)},e.heNormal=function(e){return new s.HeNormal(e)},e.leCunNormal=function(e){return new s.LeCunNormal(e)},e.orthogonal=function(e){return new s.Orthogonal(e)},S([r.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"Zeros"})],e,"zeros",null),S([r.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"Ones"})],e,"ones",null),S([r.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"Constant",configParamIndices:[0]})],e,"constant",null),S([r.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"RandomUniform",configParamIndices:[0]})],e,"randomUniform",null),S([r.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"RandomNormal",configParamIndices:[0]})],e,"randomNormal",null),S([r.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"TruncatedNormal",configParamIndices:[0]})],e,"truncatedNormal",null),S([r.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"Identity",configParamIndices:[0]})],e,"identity",null),S([r.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"VarianceScaling",configParamIndices:[0]})],e,"varianceScaling",null),S([r.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"GlorotUniform",configParamIndices:[0]})],e,"glorotUniform",null),S([r.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"GlorotNormal",configParamIndices:[0]})],e,"glorotNormal",null),S([r.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"HeNormal",configParamIndices:[0]})],e,"heNormal",null),S([r.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"LeCunNormal",configParamIndices:[0]})],e,"leCunNormal",null),S([r.doc({heading:"Initializers",namespace:"initializers",useDocsFrom:"Orthogonal",configParamIndices:[0]})],e,"orthogonal",null),e}(),n.InitializerExports=A,D=function(){function e(){}return e.binaryAccuracy=function(e,n){return w.binaryAccuracy(e,n)},e.binaryCrossentropy=function(e,n){return w.binaryCrossentropy(e,n)},e.categoricalAccuracy=function(e,n){return w.categoricalAccuracy(e,n)},e.categoricalCrossentropy=function(e,n){return v.categoricalCrossentropy(e,n)},e.cosineProximity=function(e,n){return v.cosineProximity(e,n)},e.prototype.meanAbsoluteError=function(e,n){return v.meanAbsoluteError(e,n)},e.prototype.meanAbsolutePercentageError=function(e,n){return v.meanAbsolutePercentageError(e,n)},e.prototype.MAPE=function(e,n){return v.meanAbsolutePercentageError(e,n)},e.prototype.mape=function(e,n){return v.meanAbsolutePercentageError(e,n)},e.meanSquaredError=function(e,n){return v.meanSquaredError(e,n)},e.MSE=function(e,n){return v.meanSquaredError(e,n)},e.mse=function(e,n){return v.meanSquaredError(e,n)},S([r.doc({heading:"Metrics",namespace:"metrics",useDocsFrom:"meanAbsoluteError"})],e.prototype,"meanAbsoluteError",null),S([r.doc({heading:"Metrics",namespace:"metrics",useDocsFrom:"meanAbsolutePercentageError"})],e.prototype,"meanAbsolutePercentageError",null),S([r.doc({heading:"Metrics",namespace:"metrics",useDocsFrom:"binaryAccuracy"})],e,"binaryAccuracy",null),S([r.doc({heading:"Metrics",namespace:"metrics",useDocsFrom:"binaryCrossentropy"})],e,"binaryCrossentropy",null),S([r.doc({heading:"Metrics",namespace:"metrics",useDocsFrom:"categoricalAccuracy"})],e,"categoricalAccuracy",null),S([r.doc({heading:"Metrics",namespace:"metrics",useDocsFrom:"categoricalCrossentropy"})],e,"categoricalCrossentropy",null),S([r.doc({heading:"Metrics",namespace:"metrics",useDocsFrom:"cosineProximity"})],e,"cosineProximity",null),S([r.doc({heading:"Metrics",namespace:"metrics",useDocsFrom:"meanSquaredError"})],e,"meanSquaredError",null),e}(),n.MetricExports=D,P=function(){function e(){}return e.l1l2=function(e){return new N.L1L2(e)},e.l1=function(e){return N.l1(e)},e.l2=function(e){return N.l2(e)},S([r.doc({heading:"Regularizers",namespace:"regularizers",useDocsFrom:"L1L2"})],e,"l1l2",null),S([r.doc({heading:"Regularizers",namespace:"regularizers",useDocsFrom:"L1L2"})],e,"l1",null),S([r.doc({heading:"Regularizers",namespace:"regularizers",useDocsFrom:"L1L2"})],e,"l2",null),e}(),n.RegularizerExports=P},2206:function(e,n,t){"use strict";function r(e,n,t){var i,s,u,l,c,h,p,d;if(n.hasKey(e))return n.getValue(e);if(e.sourceLayer instanceof a.InputLayer)throw new o.ValueError("Missing a feed value for SymbolicTensor from InputLayer '"+a.InputLayer.name+"'");for(i=[],s=0,u=e.inputs;s<u.length;s++)l=r(u[s],n,t),i.push(l);for(c=e.sourceLayer.apply(i,t),Array.isArray(c)||(c=[c]),h=function(e){var n,t,r,o,a;if(1===e.sourceLayer.inboundNodes.length)n=e.sourceLayer.output;else{for(t=null,r=0;r<e.sourceLayer.inboundNodes.length;++r)for(o=0,a=e.sourceLayer.inboundNodes[r].outputTensors;o<a.length;o++)if(a[o].id===e.id){t=r;break}n=e.sourceLayer.getOutputAt(t)}return n}(e),p=Array.isArray(h)?h:[h],d=0;d<p.length;++d)n.add(p[d],c[d]);return 1===c.length?c[0]:c[e.outputTensorIndex]}var o,a,i;Object.defineProperty(n,"__esModule",{value:!0}),o=t(645),a=t(669),i=function(){function e(n){var t,r,o,a;if(this.id2Value={},n instanceof e)for(t in n.id2Value)this.id2Value[t]=n.id2Value[t];else{if(null==n)return;for(r=0,o=n;r<o.length;r++)a=o[r],this.add(a.key,a.value)}}return e.prototype.add=function(e,n){if(function(e,n){if(null!=e.dtype&&e.dtype!==n.dtype)throw new o.ValueError("The dtype of the feed ("+n.dtype+") is incompatible with that of the key '"+e.name+"' ("+e.dtype+").");if(null!=e.shape){if(e.shape.length!==n.shape.length)throw new o.ValueError("The rank of feed ("+n.shape.length+") does not match the rank of the key ("+e.shape.length+").");for(var t=0;t<e.shape.length;++t)if(null!=e.shape[t]&&e.shape[t]!==n.shape[t])throw new o.ValueError("The "+t+"-th dimension of the feed ("+n.shape[t]+") is incompatible with that of the key ("+e.shape[t]+").")}}(e,n),null!=this.id2Value[e.id])throw new o.ValueError("Duplicate key: name="+e.name+", id="+e.id);return this.id2Value[e.id]=n,this},e.prototype.addFeed=function(e){this.add(e.key,e.value)},e.prototype.hasKey=function(e){return null!=this.id2Value[e.id]},e.prototype.getValue=function(e){if(null==this.id2Value[e.id])throw new o.ValueError("Nonexistent key: "+JSON.stringify(e));return this.id2Value[e.id]},e}(),n.FeedDict=i,n.execute=function(e,n,t){var o,a,s,u=Array.isArray(e),l=u?e:[e],c=[],h=new i(n);for(o=0,a=l;o<a.length;o++)s=a[o],c.push(r(s,h,t));return u?c:c[0]}},645:function(e,n,t){"use strict";var r,o,a,i,s,u,l,c=this&&this.__extends||(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])},function(e,n){function t(){this.constructor=e}l(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)});Object.defineProperty(n,"__esModule",{value:!0}),r=function(e){function n(t){var r=e.call(this,t)||this;return Object.setPrototypeOf(r,n.prototype),r}return c(n,e),n}(Error),n.AttributeError=r,o=function(e){function n(t){var r=e.call(this,t)||this;return Object.setPrototypeOf(r,n.prototype),r}return c(n,e),n}(Error),n.RuntimeError=o,a=function(e){function n(t){var r=e.call(this,t)||this;return Object.setPrototypeOf(r,n.prototype),r}return c(n,e),n}(Error),n.ValueError=a,i=function(e){function n(t){var r=e.call(this,t)||this;return Object.setPrototypeOf(r,n.prototype),r}return c(n,e),n}(Error),n.NotImplementedError=i,s=function(e){function n(t){var r=e.call(this,t)||this;return Object.setPrototypeOf(r,n.prototype),r}return c(n,e),n}(Error),n.AssertionError=s,u=function(e){function n(t){var r=e.call(this,t)||this;return Object.setPrototypeOf(r,n.prototype),r}return c(n,e),n}(Error),n.IndexError=u},652:function(e,n,t){"use strict";function r(){var e,n;for(e in ne)for(n in ne[e])ne[e][n].dispose(),delete ne[e][n]}function o(e,n){return void 0===n&&(n=ee),null==ne[n][e]&&(ne[n][e]=G.scalar(e,n),q.keep(ne[n][e])),ne[n][e]}function a(e){return e.shape}function i(e){return e.shape.length}function s(e,n){if(null==n)return n;var t=a(e);return Array.isArray(n)?n.map((function(e){return Y.pyNormalizeArrayIndex(t,e)})):Y.pyNormalizeArrayIndex(t,n)}function u(e,n){return e.reshape(n)}function l(e,n){return q.transpose(e,n)}function c(e,n){return q.reverse(e,n)}function h(e,n){void 0===n&&(n=-1);var t=a(e).slice();return n<0&&(n=t.length+n+1),t.splice(n,0,1),u(e,t)}function p(e){return u(e,[Z.arrayProd(e.shape)])}function d(e,n,t){switch(e.rank){case 1:return q.slice1d(e,n,t);case 2:return q.slice2d(e,[n,0],[t,e.shape[1]]);case 3:return q.slice3d(e,[n,0,0],[t,e.shape[1],e.shape[2]]);case 4:return q.slice4d(e,[n,0,0,0],[t,e.shape[1],e.shape[2],e.shape[3]]);default:throw new J.ValueError("sliceAlongFirstAxis() received an unsupported tensor rank: "+e.rank)}}function f(e,n){switch(e.rank){case 1:return q.concat1d([e,n]);case 2:return q.concat2d([e,n],0);case 3:return q.concat3d([e,n],0);case 4:return q.concat4d([e,n],0);default:throw new J.ValueError("concatAlongFirstAxis() received an unsupported tensor rank: "+e.rank)}}function m(e,n){if(Array.isArray(n)||(n=[n]),i(e)!==n.length)throw new J.ValueError("The length of input n ("+n.length+") does not match the number of dimensions in input x ("+i(e)+")");return q.tile(e,n)}function g(e,n){return q.zeros(e)}function y(e,n,t){var r,o,a=[];for(r=0;r<e;++r)for(o=0;o<e;++o)a.push(r===o?1:0);return G.tensor2d(a,[e,e])}function b(e){return q.neg(e)}function v(e,n){return q.sub(e,n)}function w(e,n){return q.mul(e,n)}function L(e,n){return q.div(e,n)}function N(e,n){return q.mul(e,n)}function I(e,n){return q.add(e,n)}function E(e,n,t,r,o){return q.randomUniform(e,n,t)}function x(e,n,t,r,o){return void 0===n&&(n=0),void 0===t&&(t=1),q.truncatedNormal(e,n,t)}function A(e,n,t,r,o){if(void 0===n&&(n=0),void 0===t&&(t=1),r===K.DType.bool)throw new J.NotImplementedError("randomNormal does not support dType bool.");var a=r===K.DType.float32?"float32":"int32";return q.randomNormal(e,n,t,a,o)}function D(e){var n=G.zerosLike(e),t=G.onesLike(e);return G.where(k(e,n),n,G.where(C(e,G.zerosLike(e)),t,N(o(-1),t)))}function P(e,n,t){return q.sum(e,n,t)}function S(e){return q.mulStrict(e,e)}function T(e){return q.sqrt(e)}function O(e){return q.log(e)}function _(e,n,t){return q.clipByValue(e,n,t)}function k(e,n){return q.equal(e,n)}function C(e,n){return q.greater(e,n)}function V(e,n){return q.maximum(e,n)}function M(e,n,t,r,o,a){var s;if(void 0===a&&(a=.001),2===i(e))s=q.batchNormalization2d(e,n,t,a,o,r);else if(3===i(e))s=q.batchNormalization3d(e,n,t,a,o,r);else{if(4!==i(e))throw new J.NotImplementedError("batchNormalization is not implememnted for array of rank "+i(e)+" yet");s=q.batchNormalization4d(e,n,t,a,o,r)}return s}function F(e,n,t){var r,o;if(null==t&&(t=$.imageDataFormat()),H.checkDataFormat(t),1!==i(n)&&i(n)!==i(e))throw new J.ValueError("Unexpected bias dimensions: "+i(n)+"; expected it to be 1 or "+i(e));if(r=n.shape,5===i(e))"channelsFirst"===t?o=1===r.length?e.add(n.reshape([1,r[0],1,1,1])):e.add(n.reshape([1,r[3],r[0],r[1],r[2]])):"channelsLast"===t&&(o=1===r.length?e.add(n.reshape([1,1,1,1,r[0]])):e.add(n.reshape([1].concat(r))));else if(4===i(e))"channelsFirst"===t?o=1===r.length?e.add(n.reshape([1,r[0],1,1])):e.add(n.reshape([1,r[2],r[0],r[1]])):"channelsLast"===t&&(o=1===r.length?e.add(n.reshape([1,1,1,r[0]])):e.add(n.reshape([1].concat(r))));else if(3===i(e))"channelsFirst"===t?o=1===r.length?e.add(n.reshape([1,r[0],1])):e.add(n.reshape([1,r[1],r[0]])):"channelsLast"===t&&(o=1===r.length?e.add(n.reshape([1,1,r[0]])):e.add(n.reshape([1].concat(r))));else{if(!(i(e)<3))throw new J.ValueError("Unsupported input rank by biasAdd: "+i(e));o=e.add(n)}return o}function z(e,n){return H.checkDataFormat(n),"channelsFirst"===n?q.transpose(e,[0,2,3,1]):e}function R(e,n,t,r,o,a,i){if(void 0===r&&(r=1),void 0===o&&(o="valid"),void 0===i&&(i=1),null==a&&(a=$.imageDataFormat()),H.checkDataFormat(a),3!==e.shape.length)throw new J.ValueError("The input of a conv1dWithBias operation should be 3, but is "+e.shape.length+" instead.");if(3!==n.shape.length)throw new J.ValueError("The kernel for a conv1dWithBias operation should be 3, but is "+n.shape.length+" instead");if(null!=t&&1!==t.shape.length)throw new J.ValueError("The bias for a conv1dWithBias operation should be 1, but is "+n.shape.length+" instead");if("channelsFirst"===a&&(e=l(e,[0,2,1])),"casual"===o)throw new J.NotImplementedError("The support for CASUAL padding mode in conv1dWithBias is not implemented yet.");var s=q.conv1d(e,n,r,"same"===o?"same":"valid","NWC",i);return null!=t&&(s=F(s,t)),s}function B(e,n,t,r,o,a,s){if(void 0===r&&(r=[1,1]),void 0===o&&(o="valid"),null==a&&(a=$.imageDataFormat()),H.checkDataFormat(a),3!==i(e)&&4!==i(e))throw new J.ValueError("conv2dWithBias expects input to be of rank 3 or 4, but received "+i(e)+".");if(3!==i(n)&&4!==i(n))throw new J.ValueError("conv2dWithBias expects kernel to be of rank 3 or 4, but received "+i(e)+".");var u=z(e,a);if("casual"===o)throw new J.NotImplementedError("The support for CASUAL padding mode in conv1dWithBias is not implemented yet.");return u=q.conv2d(u,n,r,"same"===o?"same":"valid","NHWC",s),null!=t&&(u=F(u,t)),"channelsFirst"===a&&(u=q.transpose(u,[0,3,1,2])),u}function j(e,n){return void 0===n&&(n=-1),q.softmax(e,n)}function W(e,t,r){return void 0===r&&(r=!1),t=_(t=r?j(t):L(t,P(t,a(t).length-1,!0)),n.epsilon(),1-n.epsilon()),q.neg(q.sum(q.mul(e.toFloat(),q.log(t)),a(t).length-1))}function U(e,n){var t=q.maximum(n,q.zerosLike(n)),r=q.mul(n,e),a=q.log(q.add(o(1),q.exp(q.neg(q.abs(n)))));return q.add(q.sub(t,r),a)}var q,G,H,J,K,Y,Z,X,$,Q,ee,ne,te;Object.defineProperty(n,"__esModule",{value:!0}),q=t(644),G=t(644),H=t(830),J=t(645),K=t(699),Y=t(646),Z=t(733),X=t(1046),$=t(1046),Q="webgl",ee=K.DType.float32,n.disposeScalarCache=r,n.setBackend=function(e){q.setBackend(e),Q=e,r()},n.getBackend=function(){return Q},n.keep=function(e){return q.keep(e)},ne={float32:{},int32:{}},n.getScalar=o,n.epsilon=X.epsilon,n.isBackendSymbolic=function(){return!1},n.shape=a,n.intShape=function(e){return e.shape},n.ndim=i,n.dtype=function(e){return e instanceof G.Tensor?ee:e.dtype},n.normalizeAxis=s,n.countParams=function(e){var n=e.shape;return n.length>0?n.reduce((function(e,n){return e*n})):1},n.cast=function(e,n){return e.asType(n)},n.reshape=u,n.transpose=l,n.permuteDimensions=l,n.reverse=c,n.expandDims=h,n.squeeze=function(e,n){return q.squeeze(e,[n])},n.temporalPadding=function(e,n){if(3!==i(e))throw new J.ValueError("temporalPadding expects input tensor to be 3-D, but received a "+i(e)+"-D tensor.");if(null==n&&(n=[1,1]),2!==n.length)throw new J.ValueError("temporalPadding expects input padding pattern to be a length-2 array, but received a length-"+n.length+" array.");var t=[[0,0],n,[0,0]];return q.pad(e,t)},n.spatial2dPadding=function(e,n,t){if(4!==i(e))throw new J.ValueError("temporalPadding expects input tensor to be 4-D, but received a "+i(e)+"-D tensor.");if(null==n&&(n=[[1,1],[1,1]]),2!==n.length||2!==n[0].length||2!==n[1].length)throw new J.ValueError("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==t&&(t=$.imageDataFormat()),"channelsLast"!==t&&"channelsFirst"!==t)throw new J.ValueError("Unknown data format: "+t+". Supported data formats are 'channelsLast' and 'channelsFirst.");var r;return r="channelsFirst"===t?[[0,0],[0,0],n[0],n[1]]:[[0,0],n[0],n[1],[0,0]],q.pad(e,r)},n.repeat=function(e,n){if(2!==e.shape.length)throw new J.ValueError("repeat() expects a rank-2 tensor, but received a rank-"+e.shape.length+" tensor.");return m(h(e,1),[1,n,1])},n.flatten=p,n.batchFlatten=function(e){if(i(e)<=1)throw new J.ValueError("batchFlatten requires a minimum rank of 2. Got rank: "+i(e)+".");return u(e,[e.shape[0],Z.arrayProd(e.shape,1)])},n.sliceAlongFirstAxis=d,n.sliceAlongLastAxis=function(e,n,t){switch(e.rank){case 1:return q.slice1d(e,n,t);case 2:return q.slice2d(e,[0,n],[e.shape[0],t]);case 3:return q.slice3d(e,[0,0,n],[e.shape[0],e.shape[1],t]);case 4:return q.slice4d(e,[0,0,0,n],[e.shape[0],e.shape[1],e.shape[2],t]);default:throw new J.ValueError("sliceAlongLastAxis() received an unsupported tensor rank: "+e.rank)}},n.normalizeBatchInTraining=function(e,n,t,r,o){return void 0===o&&(o=.001),G.util.arraysEqual(r.slice().sort(),Z.range(0,i(e)-1))?function(e,n,t,r,o){return void 0===o&&(o=.001),G.tidy((function(){var a=q.moments(e,r),i=a.mean,s=a.variance;return[M(e,i,s,t,n,o),i,s]}))}(e,n,t,r,o):function(e,n,t,r,o){return void 0===o&&(o=.001),G.tidy((function(){var a,s,l,c,h,p,d,f=q.moments(e,r),m=f.mean,g=f.variance,y=[];for(a=0,s=Z.range(0,i(e));a<s.length;a++)l=s[a],-1!==r.indexOf(l)?y.push(1):y.push(e.shape[l]);return c=u(m,y),h=u(g,y),p=null==n?null:u(n,y),d=null==t?null:u(t,y),[M(e,c,h,d,p,o),m,g]}))}(e,n,t,r,o)},n.concatenate=function(e,n){var t;return void 0===n&&(n=-1),n<0&&(n=0!==(t=i(e[0]))?t:0),n===i(e[0])&&(n=-1),q.concat(e,n)},n.concatAlongFirstAxis=f,n.tile=m,n.variable=function(e,n,t,r){return new K.LayerVariable(e,n,t,!0,r)},n.batchGetValue=function(e){return e.map((function(e){return e.read()}))},n.batchSetValue=function(e){e.map((function(e){e[0].write(e[1])}))},n.zeros=g,n.zerosVariable=function(e,n,t){return new K.LayerVariable(g(e),n,t)},n.zerosLike=function(e,n,t){return new K.LayerVariable(q.zerosLike(e),n,t)},n.ones=function(e,n){return q.ones(e)},n.onesVariable=function(e,n,t){var r=q.ones(e);return new K.LayerVariable(r,n,t)},n.onesLike=function(e,n,t){var r=q.onesLike(e);return new K.LayerVariable(r,n,t)},n.identity=function(e){return e.clone()},n.eye=y,n.eyeVariable=function(e,n,t){return new K.LayerVariable(y(e),n,t)},n.neg=b,n.add=function(e,n){return q.add(e,n)},n.subtract=v,n.multiply=w,n.divide=L,n.scalarTimesArray=N,n.scalarPlusArray=I,n.randomUniform=E,n.randomUniformVariable=function(e,n,t,r,o,a){return void 0===a&&(a="randomUniform"),new K.LayerVariable(E(e,n,t),r,a)},n.truncatedNormal=x,n.truncatedNormalVariable=function(e,n,t,r,o,a){return void 0===n&&(n=0),void 0===t&&(t=1),void 0===a&&(a="truncatedNormal"),new K.LayerVariable(x(e,n,t),r,a)},n.randomNormal=A,n.randomNormalVariable=function(e,n,t,r,o,a){return void 0===n&&(n=0),void 0===t&&(t=1),void 0===a&&(a="randomNormal"),new K.LayerVariable(A(e,n,t,r,o),r,a)},n.update=function(e,n){return e.write(n)},n.updateAdd=function(e,n){return e.write(q.add(e.read(),n))},n.updateSub=function(e,n){return e.write(q.sub(e.read(),n))},n.dot=function(e,n){var t,r,o;if(2!==i(n))throw new J.NotImplementedError("dot support for y other than rank 2 is not yet implemented: y shape = "+a);if(2===i(e))return q.matMul(e,n);if(3===i(e))return t=e.shape[0],r=e.shape[1],o=e.shape[2],e=e.reshape([t*r,o]),q.matMul(e,n).reshape([t,r,n.shape[1]]);throw new J.NotImplementedError("dot support for x of rank "+i(e)+" is not yet implemented: x shape = "+a)},n.sign=D,n.qr=function(e){var n,t,r,o,a,i,s,u,l,c,h,p,d,f,m,g,b;if(2!==e.shape.length)throw new J.ValueError("qr() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");if(e.shape[0]<e.shape[1])throw new J.ValueError("qr() requires x.shape[0] >= x.shape[1], but got shape: ["+e.shape+"]");for(n=e.shape[0],t=e.shape[1],r=y(n),o=e,a=G.tensor2d([[1]],[1,1]),i=0;i<t;++i)s=o.slice([i,i],[n-i,1]),u=q.norm(s),l=o.slice([i,i],[1,1]),c=q.neg(D(l)),d=void 0,d=1===(p=L(s,h=l.sub(w(c,u)))).shape[0]?a:a.concat(p.slice([1,0],[p.shape[0]-1,p.shape[1]]),0),f=q.neg(L(q.matMul(c,h),u)),m=o.slice([i,0],[n-i,t]),g=f.mul(d),o=0===i?m.sub(g.matMul(d.transpose().matMul(m))):o.slice([0,0],[i,t]).concat(m.sub(g.matMul(d.transpose().matMul(m))),0),b=r.slice([0,i],[n,r.shape[1]-i]),r=0===i?b.sub(b.matMul(d).matMul(g.transpose())):r.slice([0,0],[n,i]).concat(b.sub(b.matMul(d).matMul(g.transpose())),1);return[r,o]},n.oneHot=function(e,n){if(1!==i(e))throw Error("Only 1D one-hot tensors are supported in the deeplearn backend, at present.");return e=e.toInt(),q.oneHot(e,n).toFloat()},n.mean=function(e,n,t){return n=s(e,n),q.mean(e,n,t)},n.argmax=function(e,n){return void 0===n&&(n=-1),q.argMax(e,n)},n.gather=function(e,n,t){return n=Array.isArray(n)?G.tensor1d(n,"int32"):n.toInt(),q.gather(e,n,t)},n.max=function(e,n,t){return q.max(e,n,t)},n.min=function(e,n,t){return q.min(e,n,t)},n.minimum=function(e,n){return q.minimum(e,n)},n.sum=P,n.abs=function(e){return q.abs(e)},n.square=S,n.sqrt=T,n.exp=function(e){return q.exp(e)},n.log=O,n.pow=function(e,n){if("number"==typeof n&&(n=G.scalar(Math.round(n),"int32")),"int32"!==n.dtype)throw new J.NotImplementedError("Non-int32 dtype ("+n.dtype+") is not supported by pow() yet");return q.pow(e,n)},n.clip=_,n.equal=k,n.greater=C,n.greaterEqual=function(e,n){return q.greaterEqual(e,n)},n.maximum=V,n.sin=function(e){return q.sin(e.value())},n.cos=function(e){return q.cos(e.value())},n.batchNormalization=M,n.biasAdd=F,n.elu=function(e,n){if(void 0===n&&(n=1),1!==n)throw new J.NotImplementedError("Support for alpha values other than 1 ("+n+") is not implemented yet.");return q.elu(e)},n.selu=function(e){return q.selu(e)},n.relu=function(e){return q.relu(e)},n.softplus=function(e){return q.log(q.add(o(1),q.exp(e)))},n.softsign=function(e){return q.div(e,q.add(o(1),q.abs(e)))},n.tanh=function(e){return q.tanh(e)},n.dropout=function(e,n,t,r){if(null!=t&&!G.util.arraysEqual(e.shape,t))throw new J.NotImplementedError("Non-default noise shape is not implemented yet: "+JSON.stringify(t));if(null!=r)throw new J.NotImplementedError("seed is not implemented for dropout yet.");var a=q.step(q.add(b(n),E(e.shape,0,1,K.DType.float32)));return a=q.mul(L(o(1),v(o(1),n)),a),q.mul(e,a)},n.l2Normalize=function(e,t){return L(e,T(V(P(S(e),t,!0),N(G.scalar(n.epsilon()),q.onesLike(e)))))},n.conv1dWithBias=R,n.conv1d=function(e,n,t,r,o,a){return void 0===t&&(t=1),void 0===r&&(r="valid"),void 0===a&&(a=1),H.checkDataFormat(o),R(e,n,null,t,r,o,a)},n.conv2d=function(e,n,t,r,o,a){return void 0===t&&(t=[1,1]),void 0===r&&(r="valid"),H.checkDataFormat(o),B(e,n,null,t,r,o,a)},n.conv2dWithBias=B,n.depthwiseConv2d=function(e,n,t,r,o,a){void 0===t&&(t=[1,1]),void 0===r&&(r="valid"),null==o&&(o=$.imageDataFormat()),H.checkDataFormat(o);var s=z(e,o);if(4!==i(e))throw new J.ValueError("Input for depthwiseConv2d is required to be 4-D, but is instead "+i(e)+"-D");if(4!==i(n))throw new J.ValueError("depthwiseKernel is required to be 4-D, but is instead "+i(n)+"-D");return s=q.depthwiseConv2d(s,n,t,"same"===r?"same":"valid","NHWC",a),"channelsFirst"===o&&(s=q.transpose(s,[0,3,1,2])),s},n.pool2d=function(e,n,t,r,o,a){var i,s;return H.checkDataFormat(o),H.checkPoolMode(a),H.checkPaddingMode(r),null==t&&(t=[1,1]),null==r&&(r="valid"),null==o&&(o=$.imageDataFormat()),null==a&&(a="max"),e=z(e,o),s="same"===r?"same":"valid",i="max"===a?q.maxPool(e,n,t,s):q.avgPool(e,n,t,s),"channelsFirst"===o&&(i=q.transpose(i,[0,3,1,2])),i},n.nameScope=function(e,n){return H.nameScope(e,n)},n.floatx=function(){return K.DType.float32},te={},n.getUid=function(e){return void 0===e&&(e=""),e in te||(te[e]=0),te[e]+=1,e+te[e].toString()},n.softmax=j,n.categoricalCrossentropy=W,n.sparseCategoricalCrossentropy=function(e,n,t){var r,o;return void 0===t&&(t=!1),r=q.floor(p(e)).toInt(),o=a(n),W(u(q.oneHot(r,o[o.length-1]),o),n,t)},n.binaryCrossentropy=function(e,t,r){var o;return void 0===r&&(r=!1),U(e,o=r?t:O(L(o=_(t,n.epsilon(),1-n.epsilon()),v(q.onesLike(o),o))))},n.sigmoidCrossEntropyWithLogits=U,n.sigmoid=function(e){return q.sigmoid(e)},n.hardSigmoid=function(e){return _(I(G.scalar(.5),N(G.scalar(.2),e)),0,1)},n.inTrainPhase=function(e,n,t){return void 0===t&&(t=!1),t?e():n()},n.rnn=function(e,n,t,r,o,a,i,s){var h,p,m,g,y,b,v,w;if(void 0===r&&(r=!1),void 0===i&&(i=!1),(h=n.shape.length)<3)throw new J.ValueError("Input should be at least 3D, but is "+h+"D.");if(n=l(n,[1,0].concat(Z.range(2,h))),null!=o)throw new J.NotImplementedError("The rnn() function of the deeplearn.js backend does not support masking yet.");if(null!=a)throw new J.NotImplementedError("The rnn() functoin of the deeplearn.js backend does not support constants yet.");for(i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r&&(n=c(n,0)),g=t,y=n.shape[0],b=0;b<y;++b)m=(w=e(v=u(v=d(n,b,1),v.shape.slice(1)),g))[0],p=0===b?m.reshape([1].concat(m.shape)):f(p,m.reshape([1].concat(m.shape))),g=w[1];return[m,l(p,[1,0].concat(Z.range(2,p.shape.length))),g]},n.gradients=function(e,n){var t=n.map((function(e){return e.read()})),r=G.variableGrads(e,t);return n.map((function(e){return r.grads[e.name]}))}},669:function(e,n,t){"use strict";function r(e,n,t,r){if(!t.startsWith("2."))throw new u.ValueError("Unsupported Keras version in weights being loaded: "+t);return n}function o(e,n){var t,r,o,a,i,l,c,h,p,d={},f=0;for(t=0,r=n;t<r.length;t++)for(o=0,a=r[t].weights;o<a.length;o++){if(null!=d[(i=a[o]).name])throw new u.ValueError("Duplicate weight name: "+i.name);d[i.name]=i,f++}for(c in l=[],e)l.push([d[c],e[c]]),delete d[c];for(p in h=[],d)h.push(p);if(h.length>0)throw new u.ValueError(h.length+" of "+f+" weights are not set: "+h);s.batchSetValue(l)}function a(e,n,t){var o,a,l,p,d,f,m,g,y,b,v,w,L,N,I,E,x,A,D,P,S,T;for(void 0===t&&(t=!1),o=e.keras_version,e.backend,a=n.map((function(e){return e.name})),l={},p=0,d=n;p<d.length;p++)null!=(f=d[p]).name&&(null==l[f.name]&&(l[f.name]=[]),l[f.name].push(f));for(m=e.weights,g=[],y=0;y<a.length;++y){for(null==(v=m[b=a[y]])&&(v=[]),w=[],L=0;L<v.length;++L)N=v[L],w.push(new c.LayerVariable((D=N.dtype,P=N.shape,S=N.value,T=h.stringToDType(D),i.Tensor.make(P,{values:0===P.length?S:i.util.flatten(S)},T))));for(I=0,E=l[b];I<E.length;I++){if(x=(f=E[I]).weights,(w=r(0,w,o)).length!==x.length){if(!t)throw new u.ValueError("Layer #"+y+' (named "'+f.name+'") expects '+x.length+" weight(s), but the saved weights have "+w.length+" element(s).");console.warn("Skipping loading of weights of layer "+f.name+" due to mismatch in number of weights: ("+w.length+" vs "+x.length+").")}for(A=0;A<w.length;++A)!t||i.util.arraysEqual(x[A].shape,w[A].shape)?g.push([x[A],w[A].read()]):console.warn("Skipping loading of weights for layer "+f.name+" due to mismatch in shape ("+x[A].shape+" vs "+w[A].shape+")")}}s.batchSetValue(g)}var i,s,u,l,c,h,p,d,f,m,g,y,b,v,w,L=this&&this.__extends||(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])},function(e,n){function t(){this.constructor=e}w(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}),N=this&&this.__decorate||function(e,n,t,r){var o,a,i=arguments.length,s=i<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,n,t,r);else for(a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(n,t,s):o(n,t))||s);return i>3&&s&&Object.defineProperty(n,t,s),s};Object.defineProperty(n,"__esModule",{value:!0}),i=t(644),s=t(652),u=t(645),l=t(902),c=t(699),h=t(646),p=t(1266),d=function(e){this.dtype=e.dtype,this.shape=e.shape,null!=e.shape?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}},n.InputSpec=d,f=0,m=function(){function e(e,n){var t,r,o;for(this.callArgs=n,this.id=f++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes,t=0,r=e.inboundLayers;t<r.length;t++)null!=(o=r[t])&&o.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}return e.prototype.getConfig=function(){var e,n,t,r=[];for(e=0,n=this.inboundLayers;e<n.length;e++)null!=(t=n[e])?r.push(t.name):r.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:r,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}},e}(),n.Node=m,g=0,y=function(e){function n(n){var t,r,o,a,i,u=e.call(this)||this;return u._callHook=null,u._addedWeightNames=[],u._stateful=!1,u.id=g++,u.activityRegularizer=null,u.inputSpec=null,u.supportsMasking=!1,u._trainableWeights=[],u._nonTrainableWeights=[],u._losses=[],u._updates=[],u._built=!1,u.inboundNodes=[],u.outboundNodes=[],(t=n.name)||(r=u.getClassName(),t=h.toSnakeCase(r)+"_"+s.getUid(r)),u.name=t,u.trainable=h.pyGetAttr(n,"trainable",!0),u.updatable=h.pyGetAttr(n,"updatable",!0),null==n.inputShape&&null==n.batchInputShape||(o=void 0,null!=n.batchInputShape?o=n.batchInputShape:null!=n.inputShape&&(a=null,null!=n.batchSize&&(a=n.batchSize),o=[a].concat(n.inputShape)),u.batchInputShape=o,null==(i=n.dtype)&&(i=n.inputDType),null==i&&(i=s.floatx()),u.dtype=i),null!=n.weights?u.initialWeights=n.weights:u.initialWeights=null,u}return L(n,e),n.nodeKey=function(e,n){return e.name+"_ib-"+n.toString()},n.prototype.getNodeAtIndex=function(e,n){if(0===this.inboundNodes.length)throw new u.RuntimeError("The layer has never been called and thus has no defined "+n+".");if(this.inboundNodes.length<=e)throw new u.ValueError("Asked to get "+n+" at node "+e+", but the layer has only "+this.inboundNodes.length+" inbound nodes.");return this.inboundNodes[e]},n.prototype.getInputAt=function(e){return h.singletonOrArray(this.getNodeAtIndex(e,"input").inputTensors)},n.prototype.getOutputAt=function(e){return h.singletonOrArray(this.getNodeAtIndex(e,"output").outputTensors)},Object.defineProperty(n.prototype,"input",{get:function(){if(this.inboundNodes.length>1)throw new u.AttributeError("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new u.AttributeError("Layer "+this.name+" is not connected, no input to return.");return h.singletonOrArray(this.getNodeAtIndex(0,"input").inputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"output",{get:function(){if(0===this.inboundNodes.length)throw new u.AttributeError("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new u.AttributeError("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return h.singletonOrArray(this.getNodeAtIndex(0,"output").outputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"losses",{get:function(){return this._losses},enumerable:!0,configurable:!0}),n.prototype.calculateLosses=function(){return this.losses.map((function(e){return e()}))},Object.defineProperty(n.prototype,"updates",{get:function(){return this._updates},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"built",{get:function(){return this._built},set:function(e){this._built=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"trainableWeights",{get:function(){return this.trainable?this._trainableWeights:[]},set:function(e){this._trainableWeights=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this._nonTrainableWeights:this._trainableWeights.concat(this._nonTrainableWeights)},set:function(e){this._nonTrainableWeights=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"stateful",{get:function(){return this._stateful},enumerable:!0,configurable:!0}),n.prototype.assertInputCompatibility=function(e){var n,t,r,o,a,i,l,c,p,d,f,m,g,y;if(e=h.toList(e),null!=this.inputSpec&&0!==this.inputSpec.length){if(n=h.toList(this.inputSpec),e.length!==n.length)throw new u.ValueError("Layer "+this.name+" expects "+n.length+" inputs, but it received "+e.length+" input tensors. Input received: "+e);for(t=0;t<e.length;t++)if(r=e[t],null!=(o=n[t])){if(a=s.ndim(r),null!=o.ndim&&a!==o.ndim)throw new u.ValueError("Input "+t+" is incompatible with layer "+this.name+": expected ndim="+o.ndim+", found ndim="+a);if(null!=o.maxNDim&&a>o.maxNDim)throw new u.ValueError("Input "+t+" is incompatible with layer "+this.name+": expected max_ndim="+o.maxNDim+", found ndim="+a);if(null!=o.minNDim&&a<o.minNDim)throw new u.ValueError("Input "+t+" is incompatible with layer "+this.name+": expected min_ndim="+o.minNDim+", found ndim="+a+".");if(null!=o.dtype&&s.dtype(r)!==o.dtype)throw i=s.dtype(r),new u.ValueError("Input "+t+" is incompatible with layer "+this.name+" : expected dtype="+o.dtype+", found dtype="+i+".");if(o.axes)for(c in l=s.intShape(r),o.axes)if(p=Number(c),d=o.axes[c],f=p>=0?l[p]:l[l.length+p],null!=d&&-1===[d,null].indexOf(f))throw new u.ValueError("Input "+t+" is incompatible with layer "+this.name+": expected axis "+p+" of input shape to have value "+d+" but got shape "+l+".");if(null!=o.shape)for(l=s.intShape(r),m=0;m<o.shape.length;++m)if(g=o.shape[m],y=l[m],null!=g&&null!=y&&g!==y)throw new u.ValueError("Input "+t+" is incompatible with layer "+this.name+": expected shape="+o.shape+", found shape=${xShape}.")}}},n.prototype.call=function(e,n){return e},n.prototype.invokeCallHook=function(e,n){null!=this._callHook&&this._callHook(e,n)},n.prototype.setCallHook=function(e){this._callHook=e},n.prototype.clearCallHook=function(){this._callHook=null},n.prototype.apply=function(e,n){var t,r,o,a,i,l,p,d=this;for(n=n||{},r=!0,o=0,a=t=h.toList(e);o<a.length;o++)if(!(a[o]instanceof c.SymbolicTensor)){r=!1;break}for(i=!0,l=0,p=t;l<p.length;l++)if(p[l]instanceof c.SymbolicTensor){i=!1;break}if(r===i)throw new u.ValueError("Arguments to apply() must be all SymbolicTensors or all Tensors");return s.nameScope(this.name,(function(){var r,o,a,l,p,f,m,g,y,b,v,w;if(!d.built){for(d.assertInputCompatibility(e),r=[],o=0,a=h.toList(e);o<a.length;o++)l=a[o],r.push(s.intShape(l));d.build(h.singletonOrArray(r)),d.built=!0,d.initialWeights&&d.setWeights(d.initialWeights)}if(d.assertInputCompatibility(e),i){for(p=d.call(e,n),f=[],m=0,g=h.toList(p);m<g.length;m++)y=g[m],-1!==t.indexOf(y)&&(y=s.identity(y)),f.push(y);if(p=h.singletonOrArray(f),null!=d.activityRegularizer)throw new u.NotImplementedError("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return p}if(b=function(e){var n,t,r,o;for(n=[],t=0,r=e=h.toList(e);t<r.length;t++)o=r[t],n.push(s.intShape(o));return h.singletonOrArray(n)}(e),v=d.computeOutputShape(b),p=void 0,w=c.DType.float32,p=null!=v&&v.length>0&&Array.isArray(v[0])?v.map((function(t,r){return new c.SymbolicTensor(w,t,d,h.toList(e),n,d.name,r)})):new c.SymbolicTensor(w,v,d,h.toList(e),n,d.name),d.addInboundNode(e,p,null,null,b,v,n),null!=d.activityRegularizer)throw new u.NotImplementedError("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return p}))},n.prototype.build=function(e){this.built=!0},n.prototype.getWeights=function(){return s.batchGetValue(this.weights)},n.prototype.setWeights=function(e){var n,t,r,o,a,l,c=this.weights;if(c.length!==e.length)throw new u.ValueError('You called setWeights(weights) on layer "'+this.name+'" with a weight list of length '+e.length+", but the layer was expecting "+c.length+" weights. Provided weights: "+e+"...");if(0!==c.length){for(n=[],t=s.batchGetValue(c),r=0;r<t.length;++r){if(o=t[r],a=c[r],l=e[r],!i.util.arraysEqual(o.shape,l.shape))throw new u.ValueError("Layer weight shape "+o.shape+" not compatible with provided weight shape "+l.shape);n.push([a,l])}s.batchSetValue(n)}},n.prototype.addWeight=function(e,n,t,r,o,a,i){if(-1!==this._addedWeightNames.indexOf(e))throw new u.ValueError("Duplicate weight name "+e+" for layer "+this.name);this._addedWeightNames.push(e),null==t&&(t=s.floatx());var l=new c.LayerVariable(r.apply(n,t),t,e,a,i);return null!=o&&this.addLoss((function(){return o.apply(l.read())})),null==a&&(a=!0),a?this._trainableWeights.push(l):this._nonTrainableWeights.push(l),l},n.prototype.addLoss=function(e){var n;null==e||Array.isArray(e)&&0===e.length||(e=h.toList(e),void 0!==this._losses&&null!==this._losses&&(n=this.losses).push.apply(n,e))},n.prototype.computeOutputShape=function(e){return e},n.prototype.computeMask=function(e,n){var t=this;if(!this.supportsMasking){if(null!=n){if(!Array.isArray(n))throw new TypeError("Layer "+this.name+" does not support masking,but was passed an inputMask.");n.forEach((function(e){if(null!=e)throw new TypeError("Layer "+t.name+" does not support masking,but was passed an inputMask.")}))}return null}return n},n.prototype.addInboundNode=function(e,n,t,r,o,a,i){var s,u,l,c,p,d,f,g;for(void 0===i&&(i=null),s=h.toList(e),n=h.toList(n),t=h.toList(t),r=h.toList(r),o=h.normalizeShapeList(o),a=h.normalizeShapeList(a),u=[],l=[],c=[],p=0,d=s;p<d.length;p++)f=d[p],u.push(f.sourceLayer),l.push(f.nodeIndex),c.push(f.tensorIndex);for(new m({outboundLayer:this,inboundLayers:u,nodeIndices:l,tensorIndices:c,inputTensors:s,outputTensors:n,inputMasks:t,outputMasks:r,inputShapes:o,outputShapes:a},i),g=0;g<n.length;g++)n[g].sourceLayer=this,n[g].nodeIndex=this.inboundNodes.length-1,n[g].tensorIndex=g},n.prototype.getConfig=function(){var e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e},n.fromConfig=function(e,n){return new e(n)},N([i.doc({heading:"Models",subheading:"Classes"})],n.prototype,"apply",null),N([i.doc({heading:"Layers",subheading:"Classes",namespace:"layers"})],n)}(c.Serializable),n.Layer=y,b=function(e){function n(n){var t,r,o,a=e.call(this,{dtype:n.dtype,name:null!=n.name?n.name:s.getUid("input").toString()})||this;if(null==n.batchSize&&(n.batchSize=null),null==n.sparse&&(n.sparse=!1),a.trainable=!1,a.built=!0,a.sparse=n.sparse,null!=n.inputShape&&null!=n.batchInputShape)throw new u.ValueError("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");if(null==(t=n.batchInputShape)){if(null==n.inputShape)throw new u.ValueError("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[n.batchSize].concat(n.inputShape)}else if(null!=n.batchSize)throw new u.ValueError("Cannot specify batchSize if batchInputShape isspecified when creating an InputLayer.");return r=n.dtype||s.floatx(),a.batchInputShape=t,a.dtype=r,a.inputSpec=[{shape:t}],(o=new c.SymbolicTensor(a.dtype,a.batchInputShape,a,[],{},a.name)).nodeIndex=0,o.tensorIndex=0,new m({outboundLayer:a,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]}),a}return L(n,e),n.prototype.apply=function(e,n){throw new u.ValueError("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)},n.prototype.getClassName=function(){return"InputLayer"},n.prototype.getConfig=function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}},n}(y),n.InputLayer=b,h.ClassNameMap.register("InputLayer",b),n.Input=function(e){var n,t;if(null==e.batchShape&&null==e.shape)throw Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new u.ValueError("Please provide either a `shape` or `batchShape` argument to Input, but not both.");return n=e.batchShape,null!=e.shape&&null==n&&(n=[null].concat(e.shape)),null==(t=e.dtype)&&(t=s.floatx()),new b({batchInputShape:n,name:e.name,dtype:t,sparse:e.sparse}).inboundNodes[0].outputTensors[0]},v=function(e){function n(t){var r,o,a,i,l,c,p,d,f,g,y,v,w,L,N,I,E,x,A,D,P,S,T,O,_,k,C,V,M,F,z,R,B,j,W,U,q,G,H,J,K,Y,Z,X,$,Q,ee,ne,te,re,oe,ae,ie,se,ue,le=e.call(this,{})||this;if(le.containerNodes=new Set,le.name=t.name,null==le.name&&(r=le.getClassName().toLowerCase(),le.name=s.getUid(r)),le.supportsMasking=!1,le.trainable=!0,le.updatable=!0,Array.isArray(t.inputs)?le.inputs=t.inputs.slice():le.inputs=[t.inputs],Array.isArray(t.outputs)?le.outputs=t.outputs.slice():le.outputs=[t.outputs],h.unique(le.inputs).length!==le.inputs.length)throw new u.ValueError("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+le.inputs.map((function(e){return e.name})));for(h.unique(le.outputs).length!==le.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+le.outputs.map((function(e){return e.name}))),le.inputLayers=[],le.inputLayersNodeIndices=[],le.inputLayersTensorIndices=[],le.outputLayers=[],le.outputLayersNodeIndices=[],le.outputLayersTensorIndices=[],le.layers=[],o=0,a=le.outputs;o<a.length;o++)l=(i=a[o]).sourceLayer,c=i.nodeIndex,p=i.tensorIndex,le.outputLayers.push(l),le.outputLayersNodeIndices.push(c),le.outputLayersTensorIndices.push(p);for(d=0,f=le.inputs;d<f.length;d++)l=(i=f[d]).sourceLayer,c=i.nodeIndex,p=i.tensorIndex,h.assert(0===c,"input layer has >1 nodes"),h.assert(0===p,"input layer has >1 tensors"),le.inputLayers.push(l),le.inputLayersNodeIndices.push(c),le.inputLayersTensorIndices.push(p);for(le.inputNames=[],le.outputNames=[],le.feedInputShapes=[],le.feedInputNames=[],le.feedOutputNames=[],g=0;g<le.inputLayers.length;g++){if(!((l=le.inputLayers[g])instanceof b))throw new TypeError("Input layers to a Model must be InputLayer objects. Received inputs: "+t.inputs+". Input "+g+" (0-based) originates from layer type "+l.getClassName()+".");le.inputNames.push(l.name),le.feedInputShapes.push(l.batchInputShape),le.feedInputNames.push(l.name)}for(y=0,v=le.outputLayers;y<v.length;y++)l=v[y],le.outputNames.push(l.name);for(le.internalInputShapes=le.inputs.map((function(e){return e.shape})),le.internalOutputShapes=le.outputs.map((function(e){return e.shape})),w={},L={},N={},I={},E={},x=[],A=function(e,t,r,o,a,i){var s,l,c,h,p,d,f;if(null!=o&&null!=a&&null!=i||(o=e.sourceLayer,a=e.nodeIndex,i=e.tensorIndex),s=o.inboundNodes[a],-1!==r.indexOf(s))throw new u.RuntimeError("The tensor "+e.name+' at layer "'+o.name+'" is part of a cycle.');if(-1===t.indexOf(s)){le.containerNodes.add(n.nodeKey(o,a)),o.id in E||(E[o.id]=Object.keys(E).length),-1===r.indexOf(s)&&r.push(s),l=s.inboundLayers.length;for(c=0;c<l;c++)h=s.inputTensors[c],p=s.inboundLayers[c],d=s.nodeIndices[c],f=s.tensorIndices[c],A(h,t,r,p,d,f);for(t.push(s);r.indexOf(s)>=0;)r.splice(r.indexOf(s),1);x.push(s)}},D=[],P=[],S=0,T=le.outputs;S<T.length;S++)i=T[S],A(i,D,P);for(O=0,_=x.slice().reverse();O<_.length;O++){L[(k=_[O]).id]=k,k.id in w||(w[k.id]=0),C=w[k.id],V=null==N[k.outboundLayer.id]?0:N[k.outboundLayer.id],C=Math.max(C,V),N[k.outboundLayer.id]=C,I[k.outboundLayer.id]=k.outboundLayer,w[k.id]=C;for(g=0;g<k.inboundLayers.length;g++)M=k.inboundLayers[g],c=k.nodeIndices[g],z=null==w[(F=M.inboundNodes[c]).id]?0:w[F.id],w[F.id]=Math.max(C+1,z),L[F.id]=F}for(B in R={},w)(C=w[B])in R||(R[C]=[]),R[C].push(L[B]);for(W in j={},N)(C=N[W])in j||(j[C]=[]),j[C].push(I[W]);for(U=Object.keys(j).map((function(e){return parseInt(e,10)})).sort(h.reverseNumberCompare),le.layers=[],q=0,G=U;q<G.length;q++)for((H=j[C=G[q]]).sort((function(e,n){var t=E[e.id],r=E[n.id];return t<r?-1:t>r?1:0})),J=0,K=H;J<K.length;J++)l=K[J],le.layers.push(l);for(le.layersByDepth=j,U=Object.keys(R).map((function(e){return parseInt(e,10)})).sort(h.reverseNumberCompare),Y=le.inputs.slice(),Z=[],X=0,$=U;X<$.length;X++)for(Q=0,ee=R[C=$[X]];Q<ee.length;Q++)if(null!=(l=(k=ee[Q]).outboundLayer)){for(ne=0,te=k.inputTensors;ne<te.length;ne++)if(i=te[ne],-1===Y.indexOf(i))throw new u.RuntimeError("Graph disconnected: cannot obtain value for tensor "+i+' at layer "'+l.name+'". The following previous layers were accessed without issue: '+Z);for(re=0,oe=k.outputTensors;re<oe.length;re++)i=oe[re],Y.push(i);Z.push(l.name)}for(le.nodesByDepth=R,ae=le.layers.map((function(e){return e.name})),ie=function(e){var n=ae.filter((function(n){return n===e})).length;if(1!==n)throw new u.RuntimeError('The name "'+e+'" is used '+n+" times in the model. All layer names should be unique. Layer names: "+JSON.stringify(ae))},se=0,ue=ae;se<ue.length;se++)ie(ue[se]);return le.outboundNodes=[],le.inboundNodes=[],new m({outboundLayer:le,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:le.inputs,outputTensors:le.outputs,inputMasks:le.inputs.map((function(e){return null})),outputMasks:le.outputs.map((function(e){return null})),inputShapes:le.inputs.map((function(e){return e.shape})),outputShapes:le.outputs.map((function(e){return e.shape}))}),le.built=!0,le}return L(n,e),Object.defineProperty(n.prototype,"trainableWeights",{get:function(){var e,n,t,r;if(this._trainableWeights.length>0)throw new u.ValueError("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];for(e=[],n=0,t=this.layers;n<t.length;n++)r=t[n],e=e.concat(r.trainableWeights);return e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"nonTrainableWeights",{get:function(){var e,n,t,r,o,a,i=[];for(e=0,n=this.layers;e<n.length;e++)t=n[e],i.push.apply(i,t.nonTrainableWeights);if(!this.trainable){for(r=[],o=0,a=this.layers;o<a.length;o++)t=a[o],r.push.apply(r,t.trainableWeights);return r.concat(i)}return i},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),n.prototype.loadWeights=function(e,n,t){void 0===n&&(n=!1),void 0===t&&(t=!1),t?o(e,this.layers):a(e,this.layers,n)},n.prototype.updatedConfig=function(){var e=this.getConfig();return{className:this.getClassName(),config:e,kerasVersion:"tfjs-layers pre-release",backend:"TensorFlow.js"}},n.prototype.toJSON=function(e){var n=this.updatedConfig();return JSON.stringify(p.convertTsToPythonic(n))},n.prototype.call=function(e,n){var t;return e=h.toList(e),t="mask"in n?h.toList(n.mask):h.pyListRepeat(null,e.length),this.runInternalGraph(e,t)[0]},n.prototype.computeMask=function(e,n){var t;return e=h.toList(e),t=null==n?h.pyListRepeat(null,e.length):h.toList(n),this.runInternalGraph(e,t)[1]},n.prototype.computeOutputShape=function(e){var n,t,r,o,a,i,s,l,c,p,d,f,m,g,y,b,v,w,L,N,I,E,x,A,D=h.normalizeShapeList(e);if(D.length!==this.inputLayers.length)throw new u.ValueError("Invalid inputShape argument "+e+": model has "+this.inputLayers.length+" tensor inputs.");for(n={},t=0;t<D.length;t++)r=this.inputLayers[t],o=D[t],n[a=r.name+"_0_0"]=o;if((i=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(h.reverseNumberCompare)).length>1)for(s=0,l=i;s<l.length;s++)for(c=l[s],p=0,d=this.nodesByDepth[c];p<d.length;p++)if(r=(f=d[p]).outboundLayer,-1===this.inputLayers.map((function(e){return e.id})).indexOf(r.id)){for(m=[],g=0;g<f.inboundLayers.length;g++)y=f.inboundLayers[g],b=f.nodeIndices[g],v=f.tensorIndices[g],w=n[a=y.name+"_"+b+"_"+v],m.push(w);for(L=r.computeOutputShape(h.singletonOrArray(m)),N=h.normalizeShapeList(L),I=r.inboundNodes.indexOf(f),g=0;g<N.length;g++)n[a=r.name+"_"+I+"_"+g]=N[g]}for(E=[],x=[],t=0;t<this.outputLayers.length;t++)r=this.outputLayers[t],I=this.outputLayersNodeIndices[t],v=this.outputLayersTensorIndices[t],a=r.name+"_"+I+"_"+v,x.push(a);for(t=0;t<x.length;t++)A=x[t],h.assert(A in n),E.push(n[A]);return h.singletonOrArray(E)},n.prototype.runInternalGraph=function(e,n){var t,r,o,a,i,s,l,c,p,d,f,m,g,y,b,v,w,L,N,I,E,x,A,D,P,S,T,O,_,k,C,V,M;for(null==n&&(n=h.pyListRepeat(null,e.length)),t={},r=0;r<this.inputs.length;++r)o=this.inputs[r],a=e[r],i=n[r],t[o.id]=[a,i];for(s=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(h.reverseNumberCompare),l=0,c=s;l<c.length;l++)for(p=c[l],d=0,f=this.nodesByDepth[p];d<f.length;d++){for(g=(m=f[d]).outboundLayer,y=m.inputTensors,b=m.outputTensors,v=[],w=0,L=y;w<L.length;w++)(o=L[w]).id in t&&v.push(t[o.id]);if(v.length===y.length){if(N={},I=void 0,E=void 0,x=void 0,A=void 0,null!=m.callArgs&&(N=m.callArgs),1===v.length?(P=(D=v[0])[0],S=D[1],null==N.mask&&(N.mask=S),x=h.toList(g.call(P,N)),A=h.toList(g.computeMask(P,S)),I=[P],E=[S]):(I=v.map((function(e){return e[0]})),E=v.map((function(e){return e[1]})),null==N.mask&&(N.mask=E),x=h.toList(g.call(I,N)),A=h.toList(g.computeMask(I,E))),g.activityRegularizer)throw new u.NotImplementedError("Model invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(r=0;r<b.length;++r)o=b[r],a=x[r],i=A[r],t[o.id]=[a,i]}}for(T=[],O=[],_=[],k=0,C=this.outputs;k<C.length;k++)o=C[k],h.assert(o.id in t,"Could not compute output "+o.name+" : "+o.id),M=(V=t[o.id])[0],i=V[1],_.push(M.shape),T.push(M),O.push(i);return[T,O,_]},n.prototype.buildNodeConversionMap=function(e){var t,r,o,a,i,s,u={};for(r=0,o=this.layers;r<o.length;r++)for(t=(a=o[r])instanceof n?1:0,i=0;i<a.inboundNodes.length;i++)(s=n.nodeKey(a,i))in this.containerNodes&&(u[s]=t,t+=1);return u},n.prototype.getLayer=function(e,n){var t,r,o;if(null!=n){if(this.layers.length<=n)throw new u.ValueError("Was asked to retrieve layer at index "+n+", but model only has "+this.layers.length+" layer(s).");return this.layers[n]}if(null==e)throw new u.ValueError("Provide either a layer name or layer index");for(t=0,r=this.layers;t<r.length;t++)if((o=r[t]).name===e)return o;throw new u.ValueError("No such layer: "+e)},n.prototype.calculateLosses=function(){var e=this;return i.tidy((function(){var t,r,o,a,i,s=[];for(t=0,r=e.layers;t<r.length;t++)for(o=r[t],a=0;a<o.inboundNodes.length;++a)i=n.nodeKey(o,a),e.containerNodes.has(i)&&s.push.apply(s,o.calculateLosses());return s}))},n.prototype.getConfig=function(){var e,t,r,o,a,i,s,u,l,c,h,p,d,f,m,g,y,b,v={name:this.name},w=this.buildNodeConversionMap(this.layers),L=[];for(e=0,t=this.layers;e<t.length;e++){for(o=(r=t[e]).getClassName(),a=r.getConfig(),i=[],s=0;s<r.inboundNodes.length;s++)if(u=r.inboundNodes[s],l=n.nodeKey(r,s),c={},this.containerNodes.has(l)&&(u.callArgs&&(-1===JSON.stringify(u.callArgs).indexOf("undefined")?c=u.callArgs:(console.warn("Layer "+r.name+" was passed non-serializable keyword arguments: "+u.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),c={})),u.inboundLayers.length>0)){for(h=[],p=0;p<u.inboundLayers.length;p++)d=u.inboundLayers[p],f=u.nodeIndices[p],m=u.tensorIndices[p],null==(g=w[n.nodeKey(d,f)])&&(g=0),h.push([d.name,g,m,c]);i.push(h)}L.push({name:r.name,className:o,config:a,inboundNodes:i})}for(v.layers=L,y=[],p=0;p<this.inputLayers.length;p++)r=this.inputLayers[p],f=this.inputLayersNodeIndices[p],l=n.nodeKey(r,f),this.containerNodes.has(l)&&(null==(g=w[l])&&(g=0),m=this.inputLayersTensorIndices[p],y.push([r.name,g,m]));for(v.inputLayers=y,b=[],p=0;p<this.outputLayers.length;p++)r=this.outputLayers[p],f=this.outputLayersNodeIndices[p],l=n.nodeKey(r,f),this.containerNodes.has(l)&&(null==(g=w[l])&&(g=0),m=this.outputLayersTensorIndices[p],b.push([r.name,g,m]));return v.outputLayers=b,v},n.fromConfig=function(e,n){function t(e,n){e.name in D?D[e.name].push(n):D[e.name]=[n]}function r(e,n){var r,o,a,i,s,l,c,p,d,f=[];for(o=0,a=n;o<a.length;o++){if(s=(i=a[o])[0],l=i[1],c=i[2],3===i.length)r={};else{if(4!==i.length)throw new u.ValueError("Improperly formatted model config for layer "+JSON.stringify(e)+": "+JSON.stringify(i));r=i[3]}if(!(s in A))return void t(e,n);if((p=A[s]).inboundNodes.length<=l)return void t(e,n);d=p.inboundNodes[l],f.push(d.outputTensors[c])}f.length>0&&e.apply(h.singletonOrArray(f),r)}function o(e){var r,o,a,i=e.name,s=l.deserialize(e,null!=n.customObjects?n.customObjects:{});for(A[i]=s,r=0,o=e.inboundNodes;r<o.length;r++){if(!((a=o[r])instanceof Array))throw new u.ValueError("Corrupted configuration, expected array for nodeData: "+a);t(s,a)}}var a,i,s,c,p,d,f,m,g,y,b,v,w,L,N,I,E,x,A={},D={},P=n.name,S=n.layers;for(a=0,i=S;a<i.length;a++)o(s=i[a]);for(;!h.isObjectEmpty(D);)for(c=0,p=S;c<p.length;c++)if(s=p[c],(d=A[s.name]).name in D){for(f=0,m=D[d.name];f<m.length;f++)r(d,m[f]);delete D[d.name]}for(g=[],y=[],b=0,v=n.inputLayers;b<v.length;b++)w=(s=v[b])[0],L=s[1],N=s[2],h.assert(w in A),I=(d=A[w]).inboundNodes[L].outputTensors,g.push(I[N]);for(E=0,x=n.outputLayers;E<x.length;E++)w=(s=x[E])[0],L=s[1],N=s[2],h.assert(w in A),I=(d=A[w]).inboundNodes[L].outputTensors,y.push(I[N]);return new e({inputs:g,outputs:y,name:P})},Object.defineProperty(n.prototype,"stateful",{get:function(){var e,n;if(this._stateful)throw new u.ValueError("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(e=0,n=this.layers;e<n.length;e++)if(n[e].stateful)return!0;return!1},enumerable:!0,configurable:!0}),N([i.doc({heading:"Layers",subheading:"Classes",namespace:"layers",subclasses:["Model"]})],n.prototype,"getLayer",null),n}(y),n.Container=v,n.getSourceInputs=function e(n,t,r){var o,a,i,s,u,l;if((null==t||null!=r&&r>0)&&(t=n.sourceLayer,r=n.nodeIndex),0===t.inboundNodes.length)return[n];if(0===(o=t.inboundNodes[r]).inboundLayers.length)return o.inputTensors;for(a=[],i=0;i<o.inboundLayers.length;i++)for(s=0,u=e(o.inputTensors[i],o.inboundLayers[i],o.nodeIndices[i]);s<u.length;s++)l=u[s],-1===a.indexOf(l)&&a.push(l);return a},n.loadWeightsFromNamedTensorMap=o,n.loadWeightsFromJson=a},758:function(e,n,t){"use strict";function r(e,n){return i.sqrt(i.sum(i.square(e),n,!0))}function o(e,n){return void 0===n&&(n={}),u.deserializeKerasObject(e,u.ClassNameMap.getMap().pythonClassNameMap,n,"constraint")}var a,i,s,u,l,c,h,p,d,f,m=this&&this.__extends||(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])},function(e,n){function t(){this.constructor=e}f(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}),g=this&&this.__decorate||function(e,n,t,r){var o,a,i=arguments.length,s=i<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,n,t,r);else for(a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(n,t,s):o(n,t))||s);return i>3&&s&&Object.defineProperty(n,t,s),s};Object.defineProperty(n,"__esModule",{value:!0}),a=t(644),i=t(652),s=t(699),u=t(646),l=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return m(n,e),n.prototype.getConfig=function(){return{}},g([a.doc({heading:"Constraints",subheading:"Classes",namespace:"constraints"})],n)}(s.Serializable),n.Constraint=l,c=function(e){function n(n){var t=e.call(this)||this;return t.defaultMaxValue=2,t.defaultAxis=0,t.maxValue=null!=n.maxValue?n.maxValue:t.defaultMaxValue,t.axis=null!=n.axis?n.axis:t.defaultAxis,t}return m(n,e),n.prototype.apply=function(e){var n=r(e,this.axis),t=i.clip(n,0,this.maxValue);return i.multiply(e,i.divide(t,i.scalarPlusArray(i.getScalar(i.epsilon()),n)))},n.prototype.getClassName=function(){return"MaxNorm"},n.prototype.getConfig=function(){return{maxValue:this.maxValue,axis:this.axis}},n}(l),n.MaxNorm=c,u.ClassNameMap.register("MaxNorm",c),h=function(e){function n(n){var t=e.call(this)||this;return t.defaultAxis=0,t.axis=null!=n.axis?n.axis:t.defaultAxis,t}return m(n,e),n.prototype.apply=function(e){return i.divide(e,i.scalarPlusArray(i.getScalar(i.epsilon()),r(e,this.axis)))},n.prototype.getClassName=function(){return"UnitNorm"},n.prototype.getConfig=function(){return{axis:this.axis}},n}(l),n.UnitNorm=h,u.ClassNameMap.register("UnitNorm",h),p=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return m(n,e),n.prototype.apply=function(e){return i.relu(e)},n.prototype.getClassName=function(){return"NonNeg"},n}(l),n.NonNeg=p,u.ClassNameMap.register("NonNeg",p),d=function(e){function n(n){var t=e.call(this)||this;return t.defaultMinValue=0,t.defaultMaxValue=1,t.defaultRate=1,t.defaultAxis=0,t.minValue=null!=n.minValue?n.minValue:t.defaultMinValue,t.maxValue=null!=n.maxValue?n.maxValue:t.defaultMaxValue,t.rate=null!=n.rate?n.rate:t.defaultRate,t.axis=null!=n.axis?n.axis:t.defaultAxis,t}return m(n,e),n.prototype.apply=function(e){var n=r(e,this.axis),t=i.add(i.scalarTimesArray(i.getScalar(this.rate),i.clip(n,this.minValue,this.maxValue)),i.scalarTimesArray(i.getScalar(1-this.rate),n));return i.multiply(e,i.divide(t,i.scalarPlusArray(i.getScalar(i.epsilon()),n)))},n.prototype.getClassName=function(){return"MinMaxNorm"},n.prototype.getConfig=function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}},n}(l),n.MinMaxNorm=d,u.ClassNameMap.register("MinMaxNorm",d),n.CONSTRAINT_IDENTIFIER_REGISTRY_SYMBOL_MAP={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"},n.serializeConstraint=function(e){return u.serializeKerasObject(e)},n.deserializeConstraint=o,n.getConstraint=function(e){return null==e?null:"string"==typeof e?o({className:e in n.CONSTRAINT_IDENTIFIER_REGISTRY_SYMBOL_MAP?n.CONSTRAINT_IDENTIFIER_REGISTRY_SYMBOL_MAP[e]:e,config:{}}):e instanceof l?e:o(e)}},830:function(e,n,t){"use strict";function r(e){return!!e.match(u)}var o,a,i,s,u;Object.defineProperty(n,"__esModule",{value:!0}),o=t(645),a=t(646),i=new Map,a.SerializableEnumRegistry.register("data_format",{channels_first:"channelsFirst",channels_last:"channelsLast"}),n.VALID_DATA_FORMAT_VALUES=["channelsFirst","channelsLast",void 0,null],n.checkDataFormat=function(e){if(null!=e&&n.VALID_DATA_FORMAT_VALUES.indexOf(e)<0)throw new o.ValueError(e+" is not a valid DataFormat.  Valid values as "+n.VALID_DATA_FORMAT_VALUES)},a.SerializableEnumRegistry.register("padding",{valid:"valid",same:"same",casual:"casual"}),n.VALID_PADDING_MODE_VALUES=["valid","same","casual",void 0,null],n.checkPaddingMode=function(e){if(null!=e&&n.VALID_PADDING_MODE_VALUES.indexOf(e)<0)throw new o.ValueError(e+" is not a valid PaddingMode.  Valid values as "+n.VALID_PADDING_MODE_VALUES)},n.VALID_POOL_MODE_VALUES=["max","avg",void 0,null],n.checkPoolMode=function(e){if(null!=e&&n.VALID_POOL_MODE_VALUES.indexOf(e)<0)throw new o.ValueError(e+" is not a valid PoolMode.  Valid values as "+n.VALID_POOL_MODE_VALUES)},s=[],n.nameScope=function(e,n){s.push(e);try{var t=n();return s.pop(),t}catch(r){throw s.pop(),r}},n.getScopedTensorName=function(e){if(!r(e))throw Error("Not a valid tensor name: '"+e+"'");return(0===s.length?"":s.join("/")+"/")+e},n.getUniqueTensorName=function(e){var n,t;if(!r(e))throw Error("Not a valid tensor name: '"+e+"'");return i.has(e)||i.set(e,0),n=i.get(e),i.set(e,i.get(e)+1),n>0?(t=e+"_"+n,i.set(t,1),t):e},u=RegExp(/^[A-Za-z][A-Za-z0-9\._\/]*$/),n.isValidTensorName=r},903:function(e,n,t){"use strict";function r(e,n){return void 0===n&&(n=1),m.elu(e,n)}function o(e){return m.selu(e)}function a(e){return m.relu(e)}function i(e){return m.minimum(f.scalar(6),m.relu(e))}function s(e){return e}function u(e){return m.sigmoid(e)}function l(e){return m.hardSigmoid(e)}function c(e){return m.softplus(e)}function h(e){return m.softsign(e)}function p(e){return m.tanh(e)}function d(e,n){return void 0===n&&(n=-1),m.softmax(e,n)}var f,m,g;Object.defineProperty(n,"__esModule",{value:!0}),f=t(644),m=t(652),g=t(645),n.getActivation=function(e){if(null==e)return s;if("elu"===e.toLowerCase())return r;if("hardsigmoid"===e.toLowerCase())return l;if("linear"===e.toLowerCase())return s;if("relu"===e.toLowerCase())return a;if("relu6"===e.toLowerCase())return i;if("selu"===e.toLowerCase())return o;if("sigmoid"===e.toLowerCase())return u;if("softmax"===e.toLowerCase())return d;if("softplus"===e.toLowerCase())return c;if("softsign"===e.toLowerCase())return h;if("tanh"===e.toLowerCase())return p;throw new g.ValueError("Unsupported activation function "+e)},n.elu=r,n.selu=o,n.relu=a,n.relu6=i,n.linear=s,n.sigmoid=u,n.hardSigmoid=l,n.softplus=c,n.softsign=h,n.tanh=p,n.softmax=d,n.serializeActivation=function(e){return e.name}}}]);