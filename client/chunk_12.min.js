/*! For license information please see chunk_12.min.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{599:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var r,o,l,s,c,u,_,d,h,f,p,m,g,v,y,b,w,x,k,E,C,S,O,T,I,M,D,P,A,j,z,N,L,R,U,q,F,B,H,W,G,X,K,Y,V,J,Q,Z,$,ee,te,ne,ae,ie,re,oe,le,se,ce,ue,_e,de,he,fe,pe,me,ge,ve,ye,be,we,xe,ke,Ee,Ce,Se,Oe,Te,Ie,Me,De,Pe,Ae,je,ze,Ne,Le,Re,Ue,qe,Fe,Be,He,We,Ge,Xe,Ke,Ye,Ve,Je,Qe,Ze,$e,et,tt,nt,at,it,rt,ot,lt,st,ct,ut,_t,dt,ht,ft,pt,mt,gt,vt,yt,bt,wt,xt,kt,Et,Ct,St,Ot,Tt,It,Mt,Dt,Pt,At,jt,zt,Nt,Lt,Rt,Ut,qt,Ft,Bt,Ht;Object.defineProperty(t,"__esModule",{value:!0}),r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n,a,i=[],r=!0,o=!1,l=void 0;try{for(n=e[Symbol.iterator]();!(r=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);r=!0);}catch(s){o=!0,l=s}finally{try{!r&&n.return&&n.return()}finally{if(o)throw l}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=Object.assign||function(e){var t,n,a;for(t=1;t<arguments.length;t++)for(a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},l=function(){function e(e,t){var n,a;for(n=0;n<t.length;n++)(a=t[n]).enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=n(690),c=a(s),u=n(691),_=n(155),d=a(_),h=n(0),f=a(h),p=n(259),m=a(p),g=n(281),v=a(g),y=n(77),b=a(y),w=n(54),x=a(w),k=a(n(52)),E=n(657),C=a(E),S=n(112),O=a(S),T=n(53),I=a(T),M=n(89),D=a(M),P=n(258),A=a(P),j=n(161),z=a(j),N=n(166),L=a(N),R=n(165),U=a(R),q=n(164),F=a(q),B=n(156),H=a(B),W=n(260),G=a(W),X=n(111),K=a(X),Y=n(110),V=a(Y),J=n(692),Q=a(J),Z=n(78),$=n(72),ee=a($),te=n(694),ne=a(te),ae=n(744),ie=a(ae),re=n(420),oe=a(re),le=n(745),se=a(le),ce=n(417),ue=a(ce),_e=n(746),de=a(_e),he=n(815),fe=a(he),pe=n(159),me=a(pe),ge=n(709),ve=a(ge),ye=n(711),be=a(ye),we=n(710),xe=a(we),ke=n(705),Ee=a(ke),Ce=n(703),Se=a(Ce),Oe=n(702),Te=a(Oe),Ie=n(707),Me=a(Ie),De=n(415),Pe=a(De),Ae=n(817),je=a(Ae),ze=n(708),Ne=a(ze),Le=n(673),Re=a(Le),Ue=n(701),qe=a(Ue),Fe=n(699),Be=a(Fe),He=n(700),We=a(He),Ge=n(818),Xe=a(Ge),Ke=n(706),Ye=a(Ke),Ve=n(704),Je=a(Ve),Qe=n(819),Ze=a(Qe),$e=n(820),et=a($e),tt=n(422),nt=a(tt),at=n(821),it=a(at),rt=n(822),ot=n(676),lt=n(824),st=n(826),ct=a(st),ut=n(827),_t=a(ut),dt=n(828),ht=a(dt),ft=n(698),pt=a(ft),mt=n(829),gt=a(mt),vt=n(830),yt=a(vt),bt=n(831),wt=a(bt),xt=n(667),kt=n(685),Et=a(kt),Ct=n(662),St=a(Ct),Ot=n(154),Tt=n(832),It=a(Tt),Mt=n(833),Dt=a(Mt),Pt=n(834),At=a(Pt),jt=n(647),zt=n(712),Nt=a(zt),window.mobileAndTabletCheck=function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t},Lt=window.mobileAndTabletCheck(),Rt=f.default.lazy((function(){return Promise.all([n.e(17),n.e(16)]).then(n.t.bind(null,923,7))})),Ut=(0,jt.SIMDopeCreate)({create:{new_of:!0,new_hex:!0},properties:{hsla:!0,hex:!0,rgb:!0}}),qt=Ut.Color,Ft=function(e){var t,n,a,r,o,l,s,c,u,_,d,h,f;return{green:{color:se.default[700]},red:{color:ue.default[500]},root:(t={contain:"layout size style paint",contentVisibility:"auto",width:"100%",height:"100%",position:"relative",paddingBottom:72},i(t,e.breakpoints.up("lg"),{paddingBottom:0}),i(t,"background","border-box"),t),contentInner:{height:"100%",width:"100%",maxHeight:"100%",position:"relative",display:"flex",contain:"paint style size layout"},contentCanvas:{width:"100%",height:"100%",maxHeight:"100%",display:"inline-block",contain:"paint style size layout !important"},contentDrawer:i({overscrollBehavior:"none",display:"flex",zIndex:1400},e.breakpoints.up("lg"),{display:"none"}),drawerHeader:(n={},i(n,e.breakpoints.down("md"),{padding:"16px 24px 8px 24px"}),i(n,"padding","36px 24px 8px 24px"),i(n,"position","relative"),i(n,"zIndex",-1),i(n,"background","#fff"),n),desktopintrovideowrapper:{cursor:"pointer",margin:"12px 24px",position:"absolute",right:0,top:0,"&:active, &:hover, &:active > video, &:hover > video":{height:96,width:96,transform:"scale(2)",zIndex:1},height:56,width:56,"&::after":{content:"''",background:"#fff !important",position:"absolute",right:0,top:0,width:"10%",height:"15%"}},desktopintrovideo:{position:"absolute",right:0,top:0,height:56,width:56},mobileintrovideowrapper:{zIndex:1,cursor:"pointer",margin:"16px 56px",position:"absolute",right:0,top:0,height:32,width:32,"&::after":{content:"''",background:"#fff !important",position:"absolute",right:0,top:0,width:"10%",height:"15%"}},mobileintrovideo:{position:"absolute",right:0,top:0,height:32,width:32},effectSliderText:{color:"#050c4c",fontWeight:"bold",textTransform:"uppercase"},effectSlider:{color:"#3729c1",padding:"16px 0px","& > .MuiSlider-track":{height:4}},coordinate:{padding:"6px 8px 6px 8px",display:"block",position:"absolute",top:0,left:"50%",transform:"translate(-50%, 0%)",borderRadius:"0px 0px 4px 4px",backgroundColor:"#ededffff",color:"#050c4c",boxShadow:"inset 0px 3px 6px #050c4c4d",whiteSpace:"nowrap"},drawerModalBackdropRoot:{contain:"layout size style paint"},drawerModal:{transform:"translateY(-32px)",marginTop:32,contain:"size layout style",overflow:"hidden"},contentDrawerFixed:(a={zIndex:20,contain:"style size paint layout",boxShadow:"-2px 0px 4px 0px rgb(0 0 0 / 20%), -4px 0px 5px 0px rgb(0 0 0 / 14%), -6px 0px 10px 0px rgb(0 0 0 / 12%)",maxHeight:"100%",height:"100%"},i(a,e.breakpoints.down("md"),{display:"none"}),i(a,"width",480),i(a,"overscrollBehavior","none"),i(a,"display","inline-block"),i(a,"animationFillMode","both"),i(a,"animationName","$drawer"),i(a,"animationDuration","250ms"),i(a,"animationTimingFunction","cubic-bezier(0.4, 0, 0.2, 1)"),i(a,"animationDirection","alternate"),i(a,"animationIterationCount","1"),i(a,"animationDelay","0ms"),i(a,"& > div",{animationFillMode:"both",animationName:"$opacity",animationDuration:"125ms",animationTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",animationDirection:"alternate",animationIterationCount:"1",animationDelay:"150ms"}),a),"@keyframes drawer":{"0%":{transform:"translateX(100%)"},"190%":{transform:"translateX(0%)"}},"@keyframes opacity":{"0%":{filter:"opacity(0)"},"190%":{filter:"opacity(1)"}},"@keyframes menu":{"0%":{transform:"translateY(100%)"},"190%":{transform:"translateY(0%)"}},drawerPaper:{width:480,overflowX:"overlay",background:"#fafafa",contain:"layout paint size style"},swipeableDrawerPaper:{maxWidth:"100%",overscrollBehavior:"none",overflow:"hidden",paddingBottom:"48px",borderBox:"content-box",height:"100%",contain:"layout paint size style"},drawerContainer:(o={transform:"translateZ(10px)",scrollBehavior:"smooth",contain:"size style paint layout",height:"100% !important",overflow:"overlay"},i(o,e.breakpoints.down("md"),{height:"calc(100vh - 180px) !important"}),i(o,e.breakpoints.up("lg"),{overflowX:"hidden"}),i(o,"& > div",{overflowX:"hidden !important",overflowY:"overlay !important",display:"inline !important",width:"100% !important",height:"100% !important",contain:"size style paint layout !important"}),i(o,"& div .react-swipeable-view-container > div",i({overflow:"initial !important",alignItems:"normal",contain:"size style !important",height:"100%"},e.breakpoints.down("md"),{height:"100% !important",paddingBottom:"24px",boxSizing:"border-box"})),i(o,"& div .react-swipeable-view-container > div[aria-hidden=true]",i({},e.breakpoints.up("lg"),{height:"16px"})),i(o,"& div .react-swipeable-view-container > div[aria-hidden=false]  > ul",i({},e.breakpoints.down("md"),{paddingBottom:0})),i(o,"& > div > .react-swipeable-view-container",(r={display:"flex !important",filter:"inherit !important",WebkitFilter:"inherit",willChange:"none !important",height:"100% !important"},i(r,e.breakpoints.up("lg"),{width:480}),i(r,e.breakpoints.down("md"),{width:"100%"}),r)),o),tabs:{contain:"paint size style layout",animationFillMode:"both",animationName:"$menu",animationDuration:"175ms",animationTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",animationDirection:"alternate",animationIterationCount:"1",animationDelay:"0ms",height:72,display:"grid","& .MuiTabs-scroller":{overflowY:"hidden"},"& .MuiTab-root":{minWidth:"auto",flex:"auto"},"& .MuiTabs-indicator":{backgroundColor:"#050c4c"}},"@keyframes bounce":{"0%":{transform:"translate3d(0, 0px, 0) scaleY(1.00)"},"20%":{transform:"translate3d(0, 2px, 0) scaleY(0.95)"},"40%":{transform:"translate3d(0, 0px, 0) scaleY(1.00)"},"70%":{transform:"translate3d(0, -2px, 0) scaleY(1.10)"},"80%":{transform:"translate3d(0, 1px, 0) scaleY(0.95)"},"90%":{transform:"translate3d(0, 0px, 0) scaleY(1.00)"}},tab:{backgroundColor:"#fafafa",color:"#050c4c",transition:"color, background-color cubic-bezier(0.4, 0, 0.2, 1) .275s","&.Mui-selected":{fontWeight:"bold",backgroundColor:"#dfddf2",color:"#050c4c",transition:"color, background-color cubic-bezier(0.4, 0, 0.2, 1) .175s",borderRadius:"4px 4px 0px 0px","& .MuiTab-wrapper":{animationDuration:"375ms",animationTimingFunction:"linear",animationName:"$bounce",transformOrigin:"center bottom"}},"&:hover":{fontWeight:"bold",backgroundColor:"#e8e6f5",color:"#050c4c",transition:"color, background-color cubic-bezier(0.4, 0, 0.2, 1) .175s",borderRadius:"4px 4px 0px 0px","& .MuiTab-wrapper":{animationDuration:"375ms",animationTimingFunction:"linear",animationName:"$bounce",transformOrigin:"center bottom"}},"&:first-child":{borderRadius:"0px 4px 0px 0px"},"&:last-child":{borderRadius:"4px 0px 0px 0px"},"& .MuiTab-wrapper":{fontSize:"11px"},"& .MuiTab-wrapper svg":{width:32,height:32,contentVisibility:"auto"}},tabNoIcon:{backgroundColor:"white",color:"#050c4c",transition:"color, background-color ease-in .175s","&.Mui-selected":{fontWeight:"bold",backgroundColor:"#dfddf2",color:"#050c4c",borderRadius:"4px 4px 0px 0px"},"&.MuiTab-labelIcon":{minHeight:36},"& .MuiTab-wrapper":{fontSize:"11px"},"& .MuiTab-wrapper svg":{width:32,height:32,display:"none",color:"#181063"}},"@keyframes backdropanim":{"0%":{filter:"drop-shadow(0px, 0px, 20px, 20px, #131c955c)"}},backdrop:{zIndex:2e3,color:"#fff",filter:"brightness(1.1) contrast(1.2) drop-shadow(0 0 12px #070b32)",background:"radial-gradient(farthest-corner, #001856d1 20%, #636eff52 80%, #474e9b2b)",contain:"layout paint size style",userSelect:"none",animation:"$backdropanim 16s linear infinite both"},backdropTextContent:{display:"block",textAlign:"center"},fatabs:(l={transition:"transform 45ms cubic-bezier(0.4, 0, 0.2, 1) 5ms",backgroundColor:"#fafafa",boxShadow:"0px 2px 4px -1px rgb(0 0 0 / 20%), 0px 4px 5px 0px rgb(0 0 0 / 14%), 0px 1px 10px 0px rgb(0 0 0 / 12%)",contain:"paint size style layout"},i(l,e.breakpoints.up("lg"),{display:"none"}),i(l,e.breakpoints.up("md"),{width:"100%"}),i(l,"zIndex",1300),i(l,"position","fixed"),i(l,"bottom",0),i(l,"right",0),i(l,"width","100%"),i(l,"height",72),l),listOfTools:(s={paddingTop:0},i(s,e.breakpoints.down("md"),{width:"100%"}),i(s,"width",360),s),contextMenuSubheader:{lineHeight:"24px",backgroundColor:"#eee",color:e.palette.secondary.light},contextMenuFuckYouActive:{cursor:'url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAApCAYAAAAiT5m3AAABXklEQVRYR+2XSxKCMAyGYSXqCdiJev8TqbjjBCqucMJMnDSk6QOKM0hXzPTxNemfB3n2o5GP4Z4OVYf7r/c66KygxfSSCL3Ut+xcHfupEPgoMEBxAHwFa/pZXe0dXaDqVVzLCyeaIkEMs7wxTZEAhUyVHMyhs4KpdTYwj0VNbF6Za7cpukf7Ms7lruaXcVWsZGC8iM3qHszVyhfHWIxg6qamabLnu+2ZXzC+IbqIFvZYsOb+AZgWdviGW5ZlaYSOLaG73p263wqWlEuBEkS6kC3eVbAG97FOi/fkYO4F7M0MVfMkQd/bNucq4KqrYbOk3NnAoF5edbjKYy2n50CeGGQu3tK4XBk6b7wx3ZwSTPO3aLHN3aHW8fX7YmumTL4gldX/A5YKj1iPaZkcGz62uqw2AlO9tfQLmxQsuRiF7ARjTeY9l09oaT/r0T3XssEgMmiBQgcUHbXLDD1wivUfqwJ8Oe4e4FEAAAAASUVORK5CYII=") 17 28, auto',"& .MuiList-padding":{padding:0}},contextMenuFuckYouDisable:{"& .MuiList-padding":{padding:0}},ripple:{contain:"layout paint size style",pointerEvents:"none",contentVisibility:"auto",mixBlendMode:"dodge"},infoIcon:{position:"absolute"},blueCenter:{color:e.palette.secondary.lighter,textAlign:"center",minWidth:"100%"},perspectiveButton:{position:"absolute",left:16,top:16,animationFillMode:"both",animationName:"$fadein",animationDuration:"225ms",animationTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",animationDirection:"alternate",animationIterationCount:"1",animationDelay:"175ms"},saveButton:(c={backgroundColor:"#0037ff14 !important",position:"absolute",right:496,top:16},i(c,e.breakpoints.down("md"),{right:16}),i(c,"animationFillMode","both"),i(c,"animationName","$fadein"),i(c,"animationDuration","225ms"),i(c,"animationTimingFunction","cubic-bezier(0.4, 0, 0.2, 1)"),i(c,"animationDirection","alternate"),i(c,"animationIterationCount","1"),i(c,"animationDelay","175ms"),c),confirmImportButton:(u={position:"absolute",left:16,bottom:16},i(u,e.breakpoints.down("md"),{bottom:88}),i(u,"animationFillMode","both"),i(u,"animationName","$fadein"),i(u,"animationDuration","225ms"),i(u,"animationTimingFunction","cubic-bezier(0.4, 0, 0.2, 1)"),i(u,"animationDirection","alternate"),i(u,"animationIterationCount","1"),i(u,"animationDelay","175ms"),u),zoomInButton:(_={position:"absolute",left:16,bottom:104},i(_,e.breakpoints.down("md"),{bottom:176}),i(_,"animationFillMode","both"),i(_,"animationName","$fadein"),i(_,"animationDuration","225ms"),i(_,"animationTimingFunction","cubic-bezier(0.4, 0, 0.2, 1)"),i(_,"animationDirection","alternate"),i(_,"animationIterationCount","1"),i(_,"animationDelay","175ms"),_),zoomOutButton:(d={position:"absolute",left:16,bottom:60},i(d,e.breakpoints.down("md"),{bottom:132}),i(d,"animationFillMode","both"),i(d,"animationName","$fadein"),i(d,"animationDuration","225ms"),i(d,"animationTimingFunction","cubic-bezier(0.4, 0, 0.2, 1)"),i(d,"animationDirection","alternate"),i(d,"animationIterationCount","1"),i(d,"animationDelay","175ms"),d),redoButton:(h={backgroundColor:"#0037ff14 !important",position:"absolute",right:496,bottom:60},i(h,e.breakpoints.down("md"),{right:16,bottom:132}),i(h,"animationFillMode","both"),i(h,"animationName","$fadein"),i(h,"animationDuration","225ms"),i(h,"animationTimingFunction","cubic-bezier(0.4, 0, 0.2, 1)"),i(h,"animationDirection","alternate"),i(h,"animationIterationCount","1"),i(h,"animationDelay","175ms"),h),undoButton:(f={backgroundColor:"#0037ff14 !important",position:"absolute",right:496,bottom:16},i(f,e.breakpoints.down("md"),{right:16,bottom:88}),i(f,"animationFillMode","both"),i(f,"animationName","$fadein"),i(f,"animationDuration","225ms"),i(f,"animationTimingFunction","cubic-bezier(0.4, 0, 0.2, 1)"),i(f,"animationDirection","alternate"),i(f,"animationIterationCount","1"),i(f,"animationDelay","175ms"),f),"@keyframes fadein":{"0%":{filter:"opacity(0)"},"190%":{filter:"opacity(1)"}},imageBackdrop:{filter:"brightness(1.5) contrast(0.75) drop-shadow(2px 4px 6px black)",width:"min(75vw, 75vh)"}}},Bt=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Ht.call(n),n.st4te={classes:e.classes,load_with:e.load_with+"",_history:Z.HISTORY,_perspective:!1,_library_dialog_open:!1,_library:{},_library_type:"open",_view_name_index:1,_handle_wheel_timestamp:Date.now(),_view_name_sub_index:0,_previous_view_name_index:1,_view_names:["palette","image","layers","tools","selection","effects","filters"],_canvas:null,_loading:!1,_loading_process:"",_can_undo:0,_can_redo:0,_current_color:"#ffffffff",_second_color:"#000000ff",_pxl_current_opacity:1,_width:32,_height:32,_import_size:"192",_import_colorize:"0",_hue:360,_slider_value:.25,_slider_value_width:192,_slider_value_height:96,_game_ended:!1,_tool:Lt?"MOVE":"PENCIL",_memory_tool:Lt?"MOVE":"PENCIL",_previous_tool_timestamp:1/0,_select_mode:"REPLACE",_pencil_mirror_mode:"NONE",_filters:[],_x:-1,_y:-1,_drag_file:!1,_is_something_selected:!1,_hide_canvas_content:!1,_show_original_image_in_background:!1,_show_transparent_image_in_background:!0,_is_image_import_mode:!1,_layers:[],_layer_index:0,_previous_layer_index:0,_mine_player_direction:"UP",_is_edit_drawer_open:!1,_kb:0,_saved_at:Date.now(),_fps:0,_prev_fps:0,_menu_mouse_y:null,_menu_mouse_x:null,_menu_data:{},_menu_event:null,_ripple:null,_ripple_color:"#ffffffff",_ripple_opacity:1,_is_pixel_dialog_post_edit_open:!1,_is_dialog_info_open:!1,_base64_url:"",_logged_account:{},_less_than_1280w:!1,_is_pixel_dialog_create_open:!1,_attachment_previews:{},_swipeable_drawer_handle_filters_thumbnail_change:function(){},_swipeable_drawer_set_props:function(){},_toolbox_container_ref:{},_files_waiting_download:[],_time_ago_initiated:!1,_fps_el:{},_xy_el:{},_settings:m.default.unpack(e.settings)},n.sraf=Object.create(Nt.default).init(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),l(t,[{key:"setSt4te",value:function(e,t){var n,a=Object.keys(e),i=0|a.length,r="";for(n=0;(0|n)<(0|i);n=(n+1|0)>>>0)r=a[n],this.st4te[r]=e[r];"function"==typeof t&&t()}},{key:"componentWillMount",value:function(){ee.default.trigger_loading_update(0),ee.default.trigger_page_render_complete(),setTimeout((function(){ee.default.trigger_loading_update(100)}),300)}},{key:"componentDidMount",value:function(){var e=this;ee.default.trigger_snackbar("Awesome buddy! Welcome back to the laboratory.",3500),(0,Ot.l)(null,(function(){e._compute_menu_drawer(),e.setSt4te({_time_ago_initiated:!0})}),!0),setTimeout((function(){e.st4te._is_pixel_dialog_create_open&&(ee.default.trigger_snackbar("Right here! Let's upload a picture now to create a new artwork.",6e3),setTimeout((function(){e.st4te._is_pixel_dialog_create_open&&(ee.default.trigger_snackbar("By the way, ...",1e3),setTimeout((function(){e.st4te._is_pixel_dialog_create_open&&(ee.default.trigger_snackbar("Huh, let me take my breath! ...",1500),setTimeout((function(){e.st4te._is_pixel_dialog_create_open&&ee.default.trigger_snackbar("You can set the size of your artwork before uploading your picture.",1e4)}),3e3))}),1500))}),8500))}),9e3),ee.default.jamy_update("happy"),window.addEventListener("resize",this._updated_dimensions),window.addEventListener("wheel",this._prevent_ctrl_zoom,{passive:!1}),document.addEventListener("keydown",this._handle_keydown),document.addEventListener("keyup",this._handle_keyup);try{document.getElementById("tabs-desktop").addEventListener("wheel",this._handle_wheel,{passive:!1})}catch(t){}v.default.register(this._handle_events.bind(this)),this.setSt4te({_h_svg:(0,xt.createLocalBlob)((0,St.default)(f.default.createElement(Et.default,{color:"#e5e5e5"}))),_h_svg_size:"100px 115px"}),(0,d.default)((function(){return n.e(40).then(n.t.bind(null,938,7))})).then((function(t){e.setSt4te({_library:t})})),this._set_saved_at_element(),this._try_load_with_payload(this.st4te.load_with),setTimeout((function(){e._request_force_update(!1,!0).then((function(){e._updated_dimensions()}))}),1e3)}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.load_with!==this.st4te.load_with?this.setSt4te(o({_settings:m.default.unpack(e.settings)},e),(function(){t._compute_menu_drawer(),t._request_force_update().then((function(){t._try_load_with_payload(t.st4te.load_with)}))})):this.setSt4te(o({_settings:m.default.unpack(e.settings)},e))}},{key:"_handle_events",value:function(e){var t=this;if("TRIGGER_CANVAS_ACTION"===e.type)switch(e.data.name.toUpperCase()){case"CONTRAST":this._to_auto_medium_more_contrast();break;case"SATURATION":this._to_auto_medium_more_saturation();break;case"PALETTE":this._less_colors_auto();break;case"SMOOTH":this._smooth_adjust();break;case"FILTER":this._handle_edit_drawer_open(null,6);break;case"RENDER":this._handle_edit_drawer_open(null,1),setTimeout((function(){t._handle_edit_drawer_open(null,1),setTimeout((function(){t._handle_edit_drawer_open(null,1)}),100)}),100)}}},{key:"componentWillUnmount",value:function(){this._backup_state(),ee.default.stop_sound(),window.removeEventListener("resize",this._updated_dimensions),window.removeEventListener("wheel",this._prevent_ctrl_zoom);try{document.getElementById("tabs-desktop").removeEventListener("wheel",this._handle_wheel,{passive:!1})}catch(e){}document.removeEventListener("keydown",this._handle_keydown),document.removeEventListener("keyup",this._handle_keyup),clearInterval(this.st4te._saved_at_interval)}},{key:"render",value:function(){var e=this,t=this.st4te,n=t.classes,a=t._canvas,i=t._loading,r=t._loading_process,o=t._is_image_import_mode,l=t._hide_canvas_content,s=t._show_original_image_in_background,u=t._show_transparent_image_in_background,_=t._can_undo,d=t._can_redo,p=t._current_color,m=t._slider_value,g=t._tool,v=t._import_size,y=t._hue,w=t._select_mode,k=t._pencil_mirror_mode,E=t._kb,C=t._mine_player_direction,S=t._menu_data,O=t._ripple_color,T=t._ripple_opacity,I=t._library_dialog_open,M=t._library,P=t._is_pixel_dialog_create_open,A=t._h_svg,j=t._h_svg_size,z=t._attachment_previews,N=t._perspective,L=t._files_waiting_download,R=t._time_ago_initiated,U=t._settings,q=t._text_dialog_open,F=t._drag_file;return S.pos_x=-1===S.pos_x?"out":S.pos_x,S.pos_y=-1===S.pos_y?"out":S.pos_y,f.default.createElement("div",{style:{height:"100%",position:"relative",pointerEvents:"none",userSelect:"none"},ref:this._set_root_ref},f.default.createElement("div",{className:n.root},f.default.createElement("div",{className:n.contentInner,style:{backgroundColor:"#f7f7f7",backgroundImage:'url("'+A+'")',backgroundRepeat:"repeat",backgroundSize:j,textRendering:"optimizespeed",imageRendering:"optimizespeed"}},f.default.createElement(h.Suspense,{fallback:f.default.createElement("div",{className:n.contentCanvas})},f.default.createElement(Rt,{set_compressor:this._set_png_compressors,perspective:N?2:0,on_state_export:this._handle_canvas_state_will_export,on_state_exported:this._handle_canvas_state_exported,on_fps_change:this._handle_fps_change,export_state_every_ms:Lt?3e5:21e4,shadow_size:Lt?0:1.5,key:"canvas",className:n.contentCanvas,ref:this._set_canvas_ref,tool:g,canvas_wrapper_padding:8,hide_canvas_content:l,show_original_image_in_background:s&&!0,show_transparent_image_in_background:u,select_mode:w,pencil_mirror_mode:k,hue:y,bucket_threshold:m,color_loss:m,pxl_current_opacity:1,onLoadComplete:this._handle_load_complete,onLoad:this._handle_load,onCanUndoRedoChange:this._handle_can_undo_redo_change,onSizeChange:this._handle_size_change,onCurrentColorChange:this._handle_current_color_change,onSomethingSelectedChange:this._handle_something_selected_change,onImageImportModeChange:this._handle_image_import_mode_change,onPositionChange:this._handle_position_change,onLayersChange:this._handle_layers_change,onFiltersThumbnailChange:this._handle_filters_thumbnail_change,onGameEnd:this._handle_game_end,onRelevantActionEvent:this._handle_relevant_action_event,setCursorFuckYou:this._set_cursor_fuck_you,onRightClick:this._handle_right_click,mine_player_direction:C,pxl_current_color:p,convert_scale:1,default_size:v,ideal_size:v,max_size:1.5*v,fast_drawing:!0,px_per_px:1})),this.drawer_desktop,this.menu)),f.default.createElement("div",{style:{pointerEvents:"all"}},f.default.createElement(x.default,{className:n.perspectiveButton,color:"primary",size:"small",onClick:this._toggle_perspective},N?f.default.createElement(et.default,null):f.default.createElement(Ze.default,null)),f.default.createElement(b.default,{className:n.saveButton,variant:"text",color:"primary",onClick:this._backup_state},f.default.createElement("span",{id:"saved_at"},"?")," ",f.default.createElement(Xe.default,null)," ",E<.5?"?":Math.round(10*E)/10," kB"),f.default.createElement(b.default,{disabled:!o,className:n.confirmImportButton,color:"primary",size:"small",onClick:function(){o?a.confirm_import():e._import_image_library()}},f.default.createElement(c.default,null)," ",o?"OK":"Import"),f.default.createElement(x.default,{className:n.zoomOutButton,color:"primary",size:"small",onClick:function(){a.zoom_out()}},f.default.createElement(Dt.default,null)),f.default.createElement(x.default,{className:n.zoomInButton,color:"primary",size:"small",onClick:function(){a.zoom_in()}},f.default.createElement(It.default,null)),f.default.createElement(b.default,{disabled:!d,variant:"text",color:"primary",size:"small",className:n.redoButton,onClick:function(t){e._redo()}},(-d||"")+" Redo"," ",f.default.createElement(je.default,{style:{transition:"ease-out 225ms transform 25m",transform:"rotate(+"+(360*d+90)+"deg)"}})),f.default.createElement(b.default,{disabled:!_,variant:"text",color:"primary",size:"small",className:n.undoButton,onClick:function(t){e._undo()}},f.default.createElement(je.default,{style:{transition:"ease-out 225ms transform 25ms",transform:"rotate(-"+(360*_+90)+"deg)"}}),(+_||"")+" Undo")),this.drawer_mobile,f.default.createElement(it.default,{keepMounted:!1,open:!!I,object:M,onClose:this._close_library,onSelectImage:this._from_library}),f.default.createElement(At.default,{keepMounted:!1,open:!!q,onClose:this._close_text,onSuccess:this._draw_text}),f.default.createElement(fe.default,{keepMounted:!1,theme_day:U._theme_day,open:!!P,pixel_arts:R?z:{},size:v,on_import_size_change:this._set_import_size,on_pixel_art_delete:this._delete_unsaved_pixel_art,import_JSON_state:this._handle_import_json_state_id,on_upload:this._handle_file_upload,onClose:this._handle_pixel_dialog_create_close}),f.default.createElement("div",{style:{position:"absolute",width:"100%",height:"100%",top:0,left:0,contain:"paint size style layout",visibility:"auto"}},f.default.createElement(Q.default,{className:n.ripple,ref:this._set_ripple_ref,center:!1,style:{color:O,opacity:T,position:"fixed",width:"100%",height:"100%"}}),f.default.createElement(D.default,{style:{pointerEvents:"all",cursor:"pointer"},onDrag:this._handle_file_upload,className:n.backdrop,open:!!(i||L.length>0||F+1e3>Date.now())},f.default.createElement("div",{className:n.backdropTextContent,style:{fontFamily:'"Industry Book"',textTransform:"uppercase"},onClick:this._continue_download},!F&&!!(i||L.length>0)&&f.default.createElement("h1",null,f.default.createElement(nt.default,{key:r||i,text:"browser"===r?"Laboratory in DANGER!":"LABORATORY PROCESSING",animation_delay_ms:0,animation_duration_ms:200})),!F&&L.length>0&&f.default.createElement("h3",null,f.default.createElement(nt.default,{key:L[0].name,text:"ACTION REQUIRED... "+L[0].name,animation_delay_ms:300,animation_duration_ms:500})),!F&&L.length>0&&f.default.createElement("div",null,f.default.createElement("img",{src:"/src/images/labostration/DOWNLOAD.svg",className:n.imageBackdrop})),!F&&L.length>0&&f.default.createElement("h4",null,f.default.createElement(nt.default,{pre:"[... ",app:" ...]",style:{textShadow:"0px 0px 16px white"},text:"CLICK ON THE SCREEN TO CONTINUE DOWNLOAD!",animation_delay_ms:Lt?5e3:2500,animation_duration_ms:500})),!F&&0===L.length&&i&&"browser"===r&&f.default.createElement("h3",null,f.default.createElement(nt.default,{text:"Doesn't feel like home for our dear code here.",animation_delay_ms:300,animation_duration_ms:500})),!F&&0===L.length&&i&&"browser"===r&&f.default.createElement("h4",null,f.default.createElement(nt.default,{pre:"[... ",app:" ...]",text:"It can take a while, please download an advanced browser.",animation_delay_ms:Lt?5e3:2500,animation_duration_ms:500})),!F&&0===L.length&&i&&"image_ai"===r&&f.default.createElement("h3",null,f.default.createElement(nt.default,{text:"AI processing your image",animation_delay_ms:300,animation_duration_ms:500})),F&&f.default.createElement("div",null,f.default.createElement("img",{src:"/src/images/labostration/ABDUCTION.svg",className:n.imageBackdrop})),F&&f.default.createElement("h4",null,f.default.createElement(nt.default,{pre:"[... ",app:" ...]",text:"Drop the file to the UFO.",animation_delay_ms:Lt?5e3:2500,animation_duration_ms:500})),F&&f.default.createElement("h3",null,f.default.createElement(nt.default,{text:"Ready for a new image abduction?",animation_delay_ms:300,animation_duration_ms:500})),!F&&0===L.length&&i&&"image_ai"===r&&f.default.createElement("div",null,f.default.createElement("img",{src:"/src/images/labostration/MOLECULE.svg",className:n.imageBackdrop})),!F&&0===L.length&&i&&"image_ai"===r&&f.default.createElement("h4",null,f.default.createElement(nt.default,{pre:"[... ",app:" ...]",text:"It can take a while, please wait ~10sec.",animation_delay_ms:Lt?5e3:2500,animation_duration_ms:500})),!F&&0===L.length&&i&&"image_preload"===r&&f.default.createElement("h3",null,f.default.createElement(nt.default,{text:"Preparing laboratory",animation_delay_ms:300,animation_duration_ms:500})),!F&&0===L.length&&i&&"image_preload"===r&&f.default.createElement("div",null,f.default.createElement("img",{src:"/src/images/labostration/SCIENCE.svg",className:n.imageBackdrop})),!F&&0===L.length&&i&&"image_preload"===r&&f.default.createElement("h4",null,f.default.createElement(nt.default,{pre:"[... ",app:" ...]",text:"It can take a while, please wait ~"+parseInt(3*parseFloat(v/100))*(Lt?3:1)+"sec.",animation_delay_ms:Lt?5e3:2500,animation_duration_ms:500})),!F&&0===L.length&&i&&"image_load"===r&&f.default.createElement("h3",null,f.default.createElement(nt.default,{text:"Abducting your image",animation_delay_ms:300,animation_duration_ms:500})),!F&&0===L.length&&i&&"image_load"===r&&f.default.createElement("div",null,f.default.createElement("img",{src:"/src/images/labostration/ABDUCTION.svg",className:n.imageBackdrop})),!F&&0===L.length&&i&&"image_load"===r&&f.default.createElement("h4",null,f.default.createElement(nt.default,{pre:"[... ",app:" ...]",text:"It can take a while, please wait ~"+parseInt(4*parseFloat(v/100))*(Lt?3:1)+"sec.",animation_delay_ms:Lt?5e3:2500,animation_duration_ms:500})),!F&&0===L.length&&i&&"image_render"===r&&f.default.createElement("div",null,f.default.createElement("img",{src:"/src/images/labostration/COMPUTING.svg",className:n.imageBackdrop})),!F&&0===L.length&&i&&"image_render"===r&&f.default.createElement("h3",null,f.default.createElement(nt.default,{text:"Atomic rendering in process",animation_delay_ms:300,animation_duration_ms:500})),!F&&0===L.length&&i&&"image_render"===r&&f.default.createElement("h4",null,f.default.createElement(nt.default,{pre:"[... ",app:" ...]",text:"It can take a while, please wait ~14sec.",animation_delay_ms:Lt?5e3:2500,animation_duration_ms:500})),!F&&0===L.length&&i&&"less_color"===r&&f.default.createElement("h3",null,f.default.createElement(nt.default,{text:"Coupling few color DNA",animation_delay_ms:300,animation_duration_ms:500})),!F&&0===L.length&&i&&"less_color"===r&&f.default.createElement("div",null,f.default.createElement("img",{src:"/src/images/labostration/GENOMA.svg",className:n.imageBackdrop})),!F&&0===L.length&&i&&"less_color"===r&&f.default.createElement("h4",null,f.default.createElement(nt.default,{pre:"[... ",app:" ...]",text:"It can take a while, please wait ~4sec.",animation_delay_ms:Lt?5e3:2500,animation_duration_ms:500})),!F&&0===L.length&&i&&"less_color_auto"===r&&f.default.createElement("h3",null,f.default.createElement(nt.default,{text:"Coupling the DNA of many color",animation_delay_ms:500,animation_duration_ms:500})),!F&&0===L.length&&i&&"less_color_auto"===r&&f.default.createElement("div",null,f.default.createElement("img",{src:"/src/images/labostration/GENOMA.svg",className:n.imageBackdrop})),!F&&0===L.length&&i&&"less_color_auto"===r&&f.default.createElement("h4",null,f.default.createElement(nt.default,{pre:"[... ",app:" ...]",text:"It can take a while, please wait ~7sec.",animation_delay_ms:Lt?5e3:2500,animation_duration_ms:500}))))))}}]),t}(f.default.PureComponent),Ht=function(){var e=this;this._request_force_update=function(t,n){return t=void 0===t||t,n=void 0!==n&&n,e.sraf.run_frame((function(){return new Promise((function(t,n){e.forceUpdate(t)}))}),!t,!n,Date.now(),"page_pixel").catch((function(){return e._request_force_update(t,n)}))},this._set_fps_and_xy_elements=function(){setTimeout((function(){e.st4te._less_than_1280w?e.setSt4te({_fps_el:{},_xy_el:{}}):e.setSt4te({_fps_el:document.getElementById("fps_el")||{},_xy_el:document.getElementById("xy_el")||{}})}),1e3)},this._prevent_ctrl_zoom=function(e){e.ctrlKey&&e.preventDefault()},this._set_saved_at_element=function(){e.st4te._saved_at_el||e.setSt4te({_saved_at_el:document.getElementById("saved_at")},(function(){var t=setInterval((function(){e.st4te._saved_at_el.innerText=(0,Ot.t)(e.st4te._saved_at||Date.now(),{mini:!0})}),1e3);e.setSt4te({_saved_at_interval:t})}))},this._try_load_with_payload=function(t){var a,i,o;0===t.length?(me.default.get_settings(e._process_settings_info_result),setTimeout((function(){e.setSt4te({_is_pixel_dialog_create_open:!(0!==t.length)},(function(){e._compute_menu_drawer(),e._request_force_update()}))}),725)):(a=!!t.startsWith("data:image/png;base64,"),i=a?"image/png":"image/jpeg",o=e.st4te._import_size,e._handle_load("image_preload"),(0,ot.base64_to_bitmap)(t,(function(t){var a,l,s,c,u;ee.default.trigger_voice("data_upload"),l=Lt?512:1024,s=parseInt((a=Lt?960:1440)*a),c=Math.min(parseInt(262144),Math.max(parseInt(o*o),parseInt(l*l))),u=Math.min(parseInt(262144),parseInt(o*o)),(0,ot.bitmap_to_imagedata)(t,s,(function(t){(0,d.default)((function(){return Promise.resolve().then(n.t.bind(null,654,7))})).then((function(n){var a=n.QuantiMatGlobal;(0,ot.imagedata_to_base64)(t,i,(function(t){(0,ot.base64_to_bitmap)(t,(function(n){(0,ot.bitmap_to_imagedata)(n,c,(function(n){a(n,256).then((function(n){var a=r(n,6),i=a[0],o=(a[1],a[2],a[3]),l=a[4],s=a[5];null===i?(window.dispatchEvent(new Event("art-upload-browsererror")),e._handle_load_complete("image_preload",{}),e._handle_load("browser"),ee.default.trigger_sfx("alert_high-intensity",.6),ee.default.jamy_update("flirty"),ee.default.trigger_snackbar("That's our end my little buddy! My instinctive dwelling require a browser I am supporting.",6e3),setTimeout((function(){ee.default.trigger_sfx("alert_high-intensity",.7),ee.default.jamy_update("sad"),ee.default.trigger_snackbar("Abandon, misfortune, sadness... I can't live in this strange place.",7e3),setTimeout((function(){ee.default.trigger_sfx("alert_high-intensity",.8),ee.default.jamy_update("suspicious"),ee.default.trigger_snackbar("Ho no! I just can't, but someone needs to give me back my usual laboratory environment!",7e3),setTimeout((function(){ee.default.trigger_sfx("alert_high-intensity",.9),ee.default.jamy_update("shocked"),ee.default.trigger_snackbar("Yes my enjoyable smartness, gladly you hear me now! Everything gonna be alright to look at me!",9e3),setTimeout((function(){ee.default.jamy_update("happy"),ee.default.trigger_sfx("alert_high-intensity",1),setTimeout((function(){ee.default.trigger_sfx("alert_high-intensity",1)}),750)}),4e3)}),8e3)}),8e3)}),7e3)):(setTimeout((function(){ee.default.trigger_snackbar("I am really awesome, within "+parseFloat(s/1e3).toFixed(3)+"sec. I've made disappears "+o+" colors, now there are "+l+" colors!",5700),setTimeout((function(){ee.default.jamy_update("happy")}),2e3)}),15e3),(0,ot.imagedata_to_base64)(i,"image/png",(function(n){(0,ot.base64_to_bitmap)(n,(function(n){(0,ot.bitmap_to_imagedata)(n,u,(function(n){(0,ot.imagedata_to_base64)(n,"image/png",(function(n){var a=new Image;a.addEventListener("load",(function(){e._handle_load_complete("image_preload",{}),e.setSt4te({_kb:0,_saved_at:1/0}),e.st4te._canvas.set_canvas_from_image(a,t,{},!1)}),{once:!0,capture:!0}),a.src=n}))}))}))}),C.default))}),C.default)}))}),C.default)}),C.default)})).catch((function(t){e._handle_load_complete("image_preload",{}),ee.default.trigger_snackbar("Be sure to have a recent browser or install Google Chrome for using it.",5700),ee.default.jamy_update("angry")}))}))}),C.default))},this._handle_canvas_state_will_export=function(){ee.default.trigger_loading_update(0),ee.default.jamy_update("suspicious"),ee.default.trigger_snackbar("Ok buddy! Saving yours.",1500),window.onbeforeunload=function(e){return"Your content that was being saved will be lost."}},this._handle_canvas_state_exported=function(t){if(ee.default.trigger_loading_update(75),ee.default.jamy_update("flirty"),ee.default.trigger_snackbar("Hold on! Compressing...",1e3),t.kb>.5){var n={};n["json_state-ID"+t.id+".json.lz"]=t,e.setSt4te({_kb:t.kb,_saved_at:Date.now()},(function(){e._compute_menu_drawer(),e._request_force_update(),me.default.set_settings({},(function(e,t){e&&(ee.default.trigger_loading_update(100),ee.default.trigger_snackbar("Looks like I can't save your file as our compression module can't load.",5700),ee.default.jamy_update("angry"))}),n,u.UJS,C.default,(function(e,t){ee.default.trigger_loading_update(100),e?(window.onbeforeunload=function(e){},ee.default.trigger_snackbar("Laboratory artwork failed to save.",2e3),ee.default.jamy_update("sad")):(window.onbeforeunload=function(e){},setTimeout((function(){setTimeout((function(){ee.default.jamy_update("happy")}),500),ee.default.trigger_snackbar("Success! Laboratory's artwork saved!",2e3)}),1e3))}))}))}else ee.default.trigger_loading_update(100),window.onbeforeunload=function(e){},setTimeout((function(){ee.default.trigger_snackbar("Huh, we don't store nearly empty file up here, buddy.",2e3)}),2e3)},this._handle_import_json_state_id=function(t){(0,d.default)((function(){return Promise.resolve().then(n.t.bind(null,691,7))})).then((function(n){var a=n.UJS;e._handle_load("image_preload"),ee.default.trigger_voice("accessing_memory"),me.default.get_settings((function(){}),["json_state-ID"+t+".json.lz"],e._process_settings_attachment_result,a,C.default)})).catch((function(){ee.default.trigger_snackbar("Looks like I can't get your file as our compression module can't load.",5700),ee.default.jamy_update("angry")}))},this._delete_unsaved_pixel_art=function(t){var n={};n["json_state-ID"+t+".json.lz"]="delete",me.default.set_settings({},e._process_settings_info_result,n,null,null,(function(n,a){if(n)ee.default.trigger_snackbar("DELETION, Failed!",2e3);else{ee.default.trigger_snackbar("DELETION, Successful!",2e3),ee.default.trigger_sfx("alert_high-intensity");var i=Object.assign({},e.st4te._attachment_previews);delete i["json_state-ID"+t+".json.lz"],e.setSt4te({_attachment_previews:i},(function(){e._request_force_update()}))}}))},this._updated_dimensions=function(){var t=document.documentElement,n=document.body||document.getElementsByTagName("body")[0],a=window.innerWidth||t.clientWidth||n.clientWidth,i=(window.innerHeight||t.clientHeight||n.clientHeight,!!(a<1280));e.setSt4te({_less_than_1280w:i},(function(){e._compute_menu_drawer(),e._compute_menu_drawer(),e._request_force_update(!1,!1).then((function(){e._set_fps_and_xy_elements()}))}))},this._handle_wheel=function(t){var n,a,i=t.deltaY;e.st4te._handle_wheel_timestamp+150<Date.now()&&(n=0===i?0:i>0?1:-1,(a=e.st4te._view_name_index+n|0)<0?a=e.st4te._view_name_index=e.st4te._view_names.length-1|0:a%=e.st4te._view_names.length+1|0,e._handle_view_name_change(a,e.st4te._view_name_index,(function(){e.setSt4te({_handle_wheel_timestamp:Date.now()})})))},this._handle_menu_close=function(){e.setSt4te({_menu_mouse_x:null,_menu_mouse_y:null},(function(){e._compute_menu_right_click(),e._request_force_update()}))},this._handle_right_click=function(t,n){n.pxl_color=e.st4te._canvas.get_pixel_color_from_pos(n.pos_x,n.pos_y),e.setSt4te({_menu_mouse_x:t.clientX-2,_menu_mouse_y:t.clientY-4,_menu_data:n,_menu_event:t},(function(){e._compute_menu_right_click(),e._request_force_update()}))},this._set_cursor_fuck_you=function(e){ee.default.jamy_update("happy",2500)},this._process_settings_info_result=function(t,n){if(!t&&void 0!==n){var a=void 0!==n.attachment_previews?n.attachment_previews:{};e.setSt4te({_attachment_previews:a},(function(){e._request_force_update()}))}},this._process_settings_attachment_result=function(t,n){var a=e.st4te._canvas.import_JS_state;e._handle_load_complete("image_preload",{}),t?(ee.default.trigger_snackbar("Looks like I can't get your file as something was erroneous.",5700),ee.default.jamy_update("angry"),e._handle_pixel_dialog_create_open()):(e.setSt4te({_kb:n.kb,_saved_at:Date.now()},(function(){e._request_force_update()})),a(n,(function(){e.setSt4te({_is_pixel_dialog_create_open:!1,_attachment_previews:{}},(function(){e._request_force_update()}))})))},this._handle_view_name_change=function(t){var n,a,i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},s=e.st4te,c=s._view_names,u=s._toolbox_container_ref;r=null===r?e.st4te._view_name_index:r,n=c[t]||c[0],r>(a=-1===c.indexOf(n)?0:c.indexOf(n))?ee.default.trigger_sfx("navigation_transition-left"):r<a&&ee.default.trigger_sfx("navigation_transition-right"),(i={})._view_name_sub_index=0,u.scrollTop=0,e.setSt4te(o({},i,{_previous_view_name_index:r||e.st4te._view_name_index,_view_name_index:a}),(function(){e._set_props_bypass_this(),e._compute_menu_drawer(),e._request_force_update(),l()}))},this._handle_view_name_switch=function(t,n){var a,i,r,l,s,c,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;("mouse"===t.pointerType&&0===t.button||"mouse"!==t.pointerType)&&(i=(a=e.st4te)._view_names,r=a._toolbox_container_ref,u=null===u?e.st4te._view_name_index:u,l=i[n]||i[0],u>(s=-1===i.indexOf(l)?0:i.indexOf(l))?ee.default.trigger_sfx("navigation_transition-left"):ee.default.trigger_sfx("navigation_transition-right"),c={},u!==s&&(c._view_name_sub_index=0,r.scrollTop=0),e.setSt4te(o({},c,{_previous_view_name_index:u||e.st4te._view_name_index,_view_name_index:s}),(function(){e._set_props_bypass_this(),e._compute_menu_drawer(),e._request_force_update()})))},this._handle_keydown=function(t){var n=e.st4te,a=n._tool,i=n._view_name_index,r=n._view_names,o=n._is_pixel_dialog_post_edit_open;if(t&&!o){if(t.preventDefault(),t.stopPropagation(),"MINE"===a)switch(t.preventDefault(),t.keyCode){case 38:e.setSt4te({_mine_player_direction:"UP"});break;case 40:e.setSt4te({_mine_player_direction:"DOWN"});break;case 37:e.setSt4te({_mine_player_direction:"LEFT"});break;case 39:e.setSt4te({_mine_player_direction:"RIGHT"})}else switch(t.keyCode){case 37:e._handle_view_name_change(i-1<0?r.length-1:i-1);break;case 39:e._handle_view_name_change(i+1>r.length-1?0:i+1);break;case 38:e._scroll_to_drawer(-1);break;case 40:e._scroll_to_drawer(1)}"1"===t.key?e._handle_view_name_change(0):"2"===t.key?e._handle_view_name_change(1):"3"===t.key?e._handle_view_name_change(2):"4"===t.key?e._handle_view_name_change(3):"5"===t.key?e._handle_view_name_change(4):"6"===t.key?e._handle_view_name_change(5):"7"===t.key?e._handle_view_name_change(6):t.ctrlKey&&"z"===t.key?e._undo():t.ctrlKey&&"y"===t.key?e._redo():t.ctrlKey&&"m"===t.key?e._set_tool("MINE"):t.ctrlKey&&"o"===t.key?e._upload_image():t.ctrlKey&&"i"===t.key?e._handle_file_import():t.ctrlKey||"o"!==t.key?t.ctrlKey||"b"!==t.key?t.ctrlKey||"h"!==t.key?t.ctrlKey||"x"!==t.key?t.ctrlKey||"u"!==t.key?t.ctrlKey||"r"!==t.key?t.ctrlKey&&"r"===t.key?e._set_tool("SELECT RECTANGLE"):t.ctrlKey||"e"!==t.key?t.ctrlKey&&"e"===t.key?e._set_tool("SELECT ELLIPSE"):t.ctrlKey||"l"!==t.key?t.ctrlKey&&"l"===t.key?e._set_tool("SELECT LINE"):t.ctrlKey||"p"!==t.key?t.ctrlKey||"n"!==t.key?t.ctrlKey&&"p"===t.key?e._set_tool("SELECT PIXEL"):t.ctrlKey&&"n"===t.key?e._set_tool("SELECT PENCIL PERFECT"):t.ctrlKey||"m"!==t.key?t.ctrlKey||"f"!==t.key?t.ctrlKey&&"f"===t.key?e._set_tool("SELECT PATH"):t.ctrlKey&&"k"===t.key?e._set_tool("SELECT COLOR THRESHOLD"):t.ctrlKey&&"g"===t.key?e._set_tool("SELECT COLOR"):t.ctrlKey&&"q"===t.key?e._download_image(1):t.ctrlKey&&"s"===t.key?e._download_image(32):"Enter"===t.key?(0,e.st4te._canvas.confirm_import)():t.ctrlKey?a.includes("SELECT")?(e.setSt4te({_previous_tool_timestamp:Date.now()}),e._set_select_mode("REMOVE")):(e.setSt4te({_previous_tool_timestamp:Date.now()}),e._set_tool("PICKER",!1)):"Shift"===t.key&&(a.includes("SELECT")?(e.setSt4te({_previous_tool_timestamp:Date.now()}),e._set_select_mode("ADD")):(e.setSt4te({_previous_tool_timestamp:Date.now()}),e._set_tool("MOVE",!1))):e._set_tool("CONTOUR"):e._set_tool("SET PENCIL MIRROR"):e._set_tool("PENCIL PERFECT"):e._set_tool("PENCIL"):e._set_tool("LINE"):e._set_tool("ELLIPSE"):e._set_tool("RECTANGLE"):e._set_tool("BORDER"):e._set_tool("EXCHANGE"):e._set_tool("HUE BUCKET"):e._set_tool("BUCKET"):e._set_tool("PICKER")}},this._undo=function(){(100*Math.random()|0)>90&&ee.default.trigger_snackbar("That was a nice undo!"),e.st4te._canvas.undo()},this._redo=function(){(100*Math.random()|0)>95&&(ee.default.jamy_update("suspicious"),ee.default.trigger_snackbar("Even nicer redo! Doo,doo,doo...",2500),setTimeout((function(){ee.default.jamy_update("annoyed"),ee.default.trigger_snackbar("Did I already said that today? I won't feel much smarter today.",3500),setTimeout((function(){ee.default.jamy_update("shocked"),ee.default.trigger_snackbar("No, huh!? I have feelings.",2500),setTimeout((function(){ee.default.jamy_update("flirty"),ee.default.trigger_snackbar("I am a real booooy! Yuhhh!")}),3e3)}),4e3)}),3e3)),e.st4te._canvas.redo()},this._set_png_compressors=function(){var t=e.st4te._canvas.set_png_compressors;(0,d.default)((function(){return n.e(0).then(n.t.bind(null,656,7))})).then((function(e){var a=e.png_quant;(0,d.default)((function(){return n.e(1).then(n.t.bind(null,665,7))})).then((function(e){var n=e.oxi_png;t(a,n)}))}))},this._backup_state=function(){var t=e.st4te._canvas,a=t.export_state,i=t.set_png_compressors;(0,d.default)((function(){return n.e(0).then(n.t.bind(null,656,7))})).then((function(e){var t=e.png_quant;(0,d.default)((function(){return n.e(1).then(n.t.bind(null,665,7))})).then((function(e){var n=e.oxi_png;i(t,n),a()}))}))},this._download_image=function(t){var a=e.st4te._canvas,i=a.get_base64_png_data_url,r=a.xxhashthat,o=a.set_png_compressors;window.dispatchEvent(new Event("art-download-raster"+t)),void 0!==i&&void 0!==r&&void 0!==o&&(0,d.default)((function(){return n.e(0).then(n.t.bind(null,656,7))})).then((function(a){var l=a.png_quant;(0,d.default)((function(){return n.e(1).then(n.t.bind(null,665,7))})).then((function(n){var a=n.oxi_png;o(l,a),i(t,!1,1,100,100).then((function(n){var a=n.url,i=r(a),o=document.createElement("a");o.download="PIXAPICS-"+i+"-PIXELATED-"+t+"x_RAS.png",o.href=a,o.click(),o.remove(),e._propose_selling_nft()}))}))}))},this._download_svg=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"xbrz",a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=e.st4te._canvas,s=l.get_base64_png_data_url,c=l.set_png_compressors,u=l.xxhashthat;window.dispatchEvent(new Event("art-download-vector"+t.toLowerCase())),ee.default.trigger_voice("please_wait"),ee.default.trigger_snackbar("Please wait... Files will download in a few seconds.",5700),ee.default.jamy_update("happy"),e.setSt4te({_loading:!0,_loading_process:"image_render"},(function(){(0,d.default)((function(){return n.e(0).then(n.t.bind(null,656,7))})).then((function(l){var _=l.png_quant;(0,d.default)((function(){return n.e(1).then(n.t.bind(null,665,7))})).then((function(n){var l=n.oxi_png;c(_,l),s(1,!0,1,100,100).then((function(n){var l=n.url,s=n.colors,c=u(l),_=e.st4te._files_waiting_download;_.push({name:"PIXAPICS-"+c+"-PIXELATED-1x_RAS.png",url:l}),e.setSt4te({_files_waiting_download:_},(function(){e._request_force_update()})),ee.default.trigger_voice("processing"),(0,rt.base64png_to_xbrz_svg)(l,(function(n,a,i,r){var l=e.st4te._files_waiting_download;l.push({name:"PIXAPICS-"+c+"-"+t.toUpperCase()+"-"+a+"x_RAS.png",url:""+n}),e.setSt4te({_files_waiting_download:l},(function(){e._request_force_update(),o?(0,lt.postJSON)("https://real-life-image.pixa-pics.workers.dev/init",""+n,(function(t,n){n&&(0,lt.postJSON)("https://real-life-image.pixa-pics.workers.dev/get",""+n,(function(t,n){n&&n.split(" ").forEach((function(t){fetch(t).then((function(t){t.blob().then((function(t,n){new Promise((function(e,n){var a=new FileReader;a.onload=function(){e(a.result)},a.onerror=function(){var n=URL.createObjectURL(t);e(n)},a.readAsDataURL(t)})).then((function(t){l.push({name:"PIXAPICS-"+c+"-PHOTO-REAL-BIG+AI_RAS-#"+n+".jpg",url:""+t}),e.setSt4te({_files_waiting_download:l},e._request_force_update)}))}))}))}))}),"application/text")}),"application/text"):(ee.default.trigger_snackbar("Looks like we had an unexpected issue",5700),ee.default.jamy_update("angry"))}))}),(function(n,a){if(n.length>0){var i=e.st4te._files_waiting_download;i.push({name:"PIXAPICS-"+c+"-"+t.toUpperCase()+"-"+a+"x_VEC.svg",url:n}),e.setSt4te({_files_waiting_download:i},(function(){e._request_force_update()}))}e.setSt4te({_loading:!1,_loading_process:""},(function(){e._propose_selling_nft()}))}),(function(n,a){if(n.length>0){var i=e.st4te._files_waiting_download;i.push({name:"PIXAPICS-"+c+"-"+t.toUpperCase()+"-"+a+"+CRT.png",url:n}),e.setSt4te({_files_waiting_download:i},(function(){e._request_force_update()}))}}),Array.from(s),t,!!a,!!i,!!r)}))}))}))}))},this._propose_selling_nft=function(){ee.default.trigger_voice("complete"),ee.default.trigger_sfx("hero_decorative-celebration-02"),ee.default.trigger_snackbar("Fantastic!",1500),setTimeout((function(){ee.default.trigger_share(),window.dispatchEvent(new Event("home-action-tryshare")),setTimeout((function(){ee.default.trigger_sfx("alert_high-intensity"),ee.default.trigger_snackbar("Your unique and stunning pixel art can now be turned into a valuable digital asset through the power of blockchain technology.",7e3),setTimeout((function(){ee.default.trigger_sfx("hero_decorative-celebration-02"),ee.default.trigger_snackbar("Sell your pixel art as an NFT on your favourite platform and become a part of the growing NFT community.",9e3)}),8e3)}),2e3)}),2e3)},this._continue_download=function(){var t,n,a=e.st4te._files_waiting_download;a.length>0&&(t=a.shift(),(n=document.createElement("a")).download=""+t.name,n.href=""+t.url,n.click(),delete t.url,delete t.name,n.remove(),e.setSt4te({_files_waiting_download:a},(function(){e._request_force_update()})))},this._handle_keyup=function(t){var n,a,i,r,o=e.st4te._is_pixel_dialog_post_edit_open;t&&!o&&(t.preventDefault(),t.stopPropagation(),a=(n=e.st4te)._tool,i=n._memory_tool,r=n._previous_tool_timestamp,i&&i!==a&&Date.now()-1e4<r?(e.setSt4te({_previous_tool_timestamp:1/0}),e._set_tool(i)):r<Date.now()&&a.includes("SELECT")&&(e.setSt4te({_previous_tool_timestamp:1/0}),e._set_select_mode("REPLACE")))},this._upload_image=function(t){e._handle_file_upload(t)},this._upload_image_library=function(){e.setSt4te({_library_dialog_open:!0,_library_type:"open"},(function(){e._request_force_update()}))},this._close_library=function(){e.setSt4te({_library_dialog_open:!1},(function(){e._request_force_update()}))},this._from_library=function(t){var n=e.st4te._library_type,a=e.st4te._canvas,i=a.set_canvas_from_image,r=a.import_image_on_canvas,o=new Image;o.src=t,o.onload=function(){"open"===n?(e.setSt4te({_kb:0,_saved_at:1/0},(function(){e._request_force_update()})),i(o)):"import"===n&&r(o,t),e._close_library()}},this._handle_file_upload=function(t){var n,a,i,r,o,l,s,c,u,_,d,h,f;"dataTransfer"in t&&t.dataTransfer.files.length>0&&(t.preventDefault(),t.stopPropagation()),e.st4te._drag_file&&e.setSt4te({_drag_file:0},(function(){e._request_force_update()})),a=(n=(t.target||{}).files||(t.srcElement||{}).files||(t.currentTarget||{}).files||((t.path||[])[0]||{}).files||(t.dataTransfer||{}).files||[])[0]||null,i=null;for(r=0;r<n.length;r++)(i=n[r]).type.startsWith("image/")&&(r=n.length);null===i&&null===a?(ee.default.trigger_snackbar("Looks like I can't get your file as something is erroneous.",5700),ee.default.jamy_update("angry")):null!==i&&(o=!("image/png"!==i.type),l=o?"image/png":i.type,(s=e.st4te)._import_colorize,c=s._import_size,u=e.st4te._canvas.set_canvas_from_image,d=parseInt((_=Lt?623.5382907247958:881.8163074019441)*_),h=Math.min(parseInt(262144),parseInt(c*c)),f=1,e._handle_load("image_preload"),ee.default.trigger_voice("data_upload"),(0,ot.file_to_imagedata_resized)(i,d,(function(t){(0,ot.imagedata_to_base64)(t,l,(function(n){for(;Math.round(t.width*f)*Math.round(t.height*f)>h;)f-=.01;(0,ot.base64_sanitize)(n,(function(t){(0,ot.base64_to_bitmap)(t,(function(t){(0,ot.bitmap_to_imagedata)(t,t.width*t.height|0,(function(t){(0,ot.imagedata_to_base64)(t,"image/png",(function(t){var a=new Image;a.addEventListener("load",(function(){e._handle_load_complete("image_preload",{}),e.setSt4te({_kb:0,_saved_at:1/0}),u(a,n,{},!1),setTimeout((function(){ee.default.trigger_snackbar("I am really awesome, here is your pixel art!",5700),setTimeout((function(){ee.default.jamy_update("happy")}),2e3)}),1e3)}),{once:!0,capture:!0}),a.src=t}),C.default)}),C.default)}),C.default)}),null,f,"doppel")}),C.default)}),C.default))},this._handle_file_import=function(t){var n,a,i,r,o=(t.target||{}).files||(t.srcElement||{}).files||(t.currentTarget||{}).files||((t.path||[])[0]||{}).files||[],l=(o[0],null);for(n=0;n<o.length;n++)(a=o[n]).type.startsWith("image/")&&(l=a);null!==l&&(i=new Image,r=e.st4te._canvas.import_image_on_canvas,(0,ot.file_to_base64)(l,(function(t){i.onload=function(){r(i,t),e._handle_menu_close()},i.src=t}),C.default))},this._import_image_library=function(){e.setSt4te({_library_dialog_open:!0,_library_type:"import"},(function(){e._request_force_update()}))},this._handle_load=function(t){ee.default.trigger_loading_update(0),e.setSt4te({_loading:!0,_loading_process:t},(function(){e._request_force_update()})),"image_preload"===t&&(e._handle_edit_drawer_close(),e._handle_menu_close(),e._handle_pixel_dialog_create_close())},this._handle_load_complete=function(t,n){ee.default.trigger_loading_update(100),e.setSt4te({_loading:!1,_loading_process:t},(function(){e._request_force_update().then((function(){e.st4te._saved_at>Date.now()-60&&e._backup_state(),e._updated_dimensions()}))})),"less_color"===t||"less_color_auto"===t?0!==n.colors_removed&&(ee.default.trigger_snackbar("I am a magician! And "+n.colors_removed+" colors are now gone, only "+n.colors_remaining+" remaining."),ee.default.trigger_sfx("navigation_selection-complete-celebration"),ee.default.jamy_update("happy")):"image_load"===t&&(n.only_scan?ee.default.trigger_sfx("ui_scan"):(ee.default.trigger_sfx("ui_scan"),ee.default.trigger_snackbar("DONE! We've imported an image with my now "+n.number_of_colors+" colors."),setTimeout((function(){ee.default.trigger_voice("complete")}),1e3),ee.default.jamy_update("happy"),e._handle_edit_drawer_close(),e._handle_menu_close(),e._handle_pixel_dialog_create_close()))},this._set_ripple_ref=function(t){null!=t&&e.setSt4te({_ripple:t})},this._set_canvas_ref=function(t){null!=t&&e.setSt4te({_canvas:t,_filters:t.get_filter_names()},(function(){e._request_force_update()}))},this._handle_position_change=function(t){var n,a;void 0!==e.st4te._xy_el&&(n=-1===t.x?"out":t.x+1,a=-1===t.y?"out":t.y+1,e.st4te._xy_el.textContent=" | X: "+n+", Y: "+a+" ")},this._handle_fps_change=function(t){void 0!==e.st4te._fps_el&&(e.st4te._fps_el.textContent="FPS: "+t)},this._handle_can_undo_redo_change=function(t,n){t=parseInt(t),n=parseInt(n);var a=!(e.st4te._can_undo===t&&e.st4te._can_redo===n);e.setSt4te({_can_undo:t,_can_redo:n},(function(){a&&e._request_force_update()}))},this._handle_size_change=function(t,n){var a=!(e.st4te._width===t&&e.st4te._height===n);e.setSt4te({_width:t,_height:n},(function(){a&&(e._compute_menu_drawer(),e._request_force_update())}))},this._handle_current_color_change=function(t,n){t=void 0!==t.rgb?qt.new_of(t.rgb.r,t.rgb.g,t.rgb.b,Math.round(parseInt(255*t.rgb.a))).hex:qt.new_hex(t).hex;var a=qt.new_hex(t).hsla[0];e.setSt4te({_current_color:t,_hue:a})},this._handle_relevant_action_event=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#ffffff",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=e.st4te._ripple;t&&i&&(ee.default.trigger_sfx("navigation_selection-complete-celebration"),0!==a&&e.setSt4te({_ripple_color:n,_ripple_opacity:a},(function(){setTimeout((function(){i.start(t)}),25),setTimeout((function(){i.stop(t)}),200)})))},this._handle_something_selected_change=function(t){var n=!(e.st4te._is_something_selected===t);e.setSt4te({_is_something_selected:t},(function(){n&&(e._compute_menu_right_click(),e._request_force_update())}))},this._set_value_from_slider_with_update=function(t,n){e.setSt4te({_slider_value:n||t.target.value},(function(){e._set_props_bypass_this()}))},this._set_width_from_slider=function(t,n){e.setSt4te({_slider_value_width:n||t.target.value},(function(){e._set_props_bypass_this()}))},this._set_height_from_slider=function(t,n){e.setSt4te({_slider_value_height:n||t.target.value},(function(){e._set_props_bypass_this()}))},this._set_import_size=function(t,n){e.setSt4te({_import_size:n||t.target.value})},this._set_import_colorize=function(t,n){e.setSt4te({_import_colorize:n||t.target.value})},this._revert_tool=function(){e.setSt4te({_tool:e.st4te._memory_tool})},this._set_tool=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.setSt4te({_tool:t.toUpperCase()},(function(){e._set_props_bypass_this()})),n&&e.setSt4te({_memory_tool:t.toUpperCase()})},this._set_select_mode=function(t){e.setSt4te({_select_mode:t.toUpperCase()},(function(){e._set_props_bypass_this()}))},this._set_pencil_mirror_mode=function(t){e.setSt4te({_pencil_mirror_mode:t.toUpperCase()},(function(){e._set_props_bypass_this()}))},this._switch_with_second_color=function(){var t=e.st4te,n=t._current_color,a=t._second_color;e.setSt4te({_current_color:a,_second_color:n},(function(){e._set_props_bypass_this()}))},this._show_hide_canvas_content=function(){e.setSt4te({_hide_canvas_content:!e.st4te._hide_canvas_content},(function(){e._set_props_bypass_this(),e.forceUpdate()}))},this._show_hide_background_image=function(){e.setSt4te({_show_original_image_in_background:!e.st4te._show_original_image_in_background},(function(){e._set_props_bypass_this()}))},this._show_hide_transparent_image=function(){e.setSt4te({_show_transparent_image_in_background:!e.st4te._show_transparent_image_in_background},(function(){e._set_props_bypass_this()}))},this._handle_image_import_mode_change=function(t){e.setSt4te({_is_image_import_mode:t},(function(){e._set_props_bypass_this(),e._request_force_update()}))},this._handle_layers_change=function(t,n){e.setSt4te({_previous_layer_index:parseInt(e.st4te._layer_index),_layer_index:parseInt(t),_layers:n},(function(){e._set_props_bypass_this()}))},this._handle_filters_thumbnail_change=function(t,n,a){e.st4te._swipeable_drawer_handle_filters_thumbnail_change(t,n,a)},this._set_filters_callback=function(t){e.setSt4te({_swipeable_drawer_handle_filters_thumbnail_change:t})},this._set_props_callback=function(t){e.setSt4te({_swipeable_drawer_set_props:t},(function(){e._set_props_bypass_this(),e._request_force_update()}))},this._set_props_bypass_this=function(){var t=e.st4te,n=t._view_name_index,a=t._previous_view_name_index,i=t._layers,r=t._layer_index,o=t._hide_canvas_content,l=t._show_original_image_in_background,s=t._show_transparent_image_in_background,c=t._hue,u=t._current_color,_=t._second_color,d=t._slider_value,h=t._tool,f=t._width,p=t._height,m=t._filters,g=t._select_mode,v=t._pencil_mirror_mode,y=t._is_something_selected,b=t._is_image_import_mode,w=t._import_size,x=t._import_colorize,k=t._slider_value_width,E=t._slider_value_height;e.st4te._canvas&&e.st4te._canvas._set_props({tool:h,hide_canvas_content:o,show_original_image_in_background:l&&!0,show_transparent_image_in_background:s,select_mode:g,pencil_mirror_mode:v,hue:c,bucket_threshold:d,color_loss:d,pxl_current_color:u,default_size:w,ideal_size:w,max_size:1.5*w}),e.st4te._swipeable_drawer_set_props({view_name_index:n%7,previous_view_name_index:a%7,layers:i,layer_index:r,hide_canvas_content:o,show_original_image_in_background:l,show_transparent_image_in_background:s,hue:c,current_color:u,second_color:_,slider_value:parseFloat(d),slider_value_width:k,slider_value_height:E,tool:h,width:parseInt(f),height:parseInt(p),filters:m,select_mode:g,pencil_mirror_mode:v,is_something_selected:y,is_image_import_mode:b,import_size:w,import_colorize:x})},this._handle_game_end=function(){e.setSt4te({_game_ended:!0},(function(){setTimeout((function(){e.setSt4te({_game_ended:!1})}),5e3)}))},this._handle_edit_drawer_open=function(t,n){var a,i,r,o,l,s,c;n=void 0!==n?n:e.st4te._view_name_index,a=!(e.st4te._view_name_index!==n)&&e.st4te._is_edit_drawer_open,i=e.st4te._toolbox_container_ref,r=!0,o=void 0,a&&null!==i?(l="swipetoolbox_i_"+n+"_"+(o=e.st4te._view_name_sub_index||0),o++,null!==(s=(document.getElementsByClassName(l)||[])[0]||null)?i.scrollTop=s.offsetTop:(o=0,i.scrollTop=0)):(o=0,i.scrollTop=0),c=!(e.st4te._is_edit_drawer_open===r&&e.st4te._view_name_index===n),e.setSt4te({_is_edit_drawer_open:r,_view_name_index:n,_view_name_sub_index:o},(function(){c&&(e._compute_menu_drawer(),e._request_force_update())}))},this._handle_edit_drawer_close=function(){var t=!!e.st4te._is_edit_drawer_open;e.setSt4te({_is_edit_drawer_open:!1},(function(){t&&(e._compute_menu_drawer(),e._request_force_update())}))},this._set_current_color=function(t){e._handle_menu_close(),e.setSt4te({_current_color:t},(function(){e._set_props_bypass_this()}))},this._exchange_pixel_colors=function(t,n,a){var i=e.st4te._canvas.exchange_pixel_color,r=e.st4te._menu_data;i(t,n,a),r.pxl_color=a,e._handle_menu_close(),e.setSt4te({_menu_data:r})},this._to_auto_medium_more_contrast=function(){(0,e.st4te._canvas.auto_adjust_contrast)(.2),ee.default.trigger_voice("enhanced")},this._to_auto_medium_more_saturation=function(){(0,e.st4te._canvas.auto_adjust_saturation)(.2),ee.default.trigger_voice("enhanced")},this._less_colors_auto=function(){var t=e.st4te,n=t._layers,a=t._layer_index,i=e.st4te._canvas.to_less_color;ee.default.trigger_voice("please_wait"),(n[a]||{}).number_of_colors,i("auto")},this._get_average_color_of_selection=function(){var t=(0,e.st4te._canvas.get_average_color_of_selection)();e._handle_current_color_change(t)},this._handle_pixel_dialog_create_close=function(){e.setSt4te({_is_pixel_dialog_create_open:!1,_attachment_previews:{}},(function(){e._request_force_update()}))},this._handle_pixel_dialog_create_open=function(){!1===e.st4te._is_pixel_dialog_create_open&&ee.default.trigger_sfx("hero_decorative-celebration-02"),me.default.get_settings(e._process_settings_info_result),setTimeout((function(){e.setSt4te({_is_pixel_dialog_create_open:!0},(function(){e._request_force_update()}))}),725)},this._set_toolbox_container_ref=function(t){null!=t&&e.setSt4te({_toolbox_container_ref:t})},this._set_root_ref=function(t){null!=t&&e.setSt4te({_root_ref:t},(function(){e.st4te._root_ref.addEventListener("drop",e._handle_file_upload,{capture:!0}),e.st4te._root_ref.addEventListener("dragenter",e._drop_start),e.st4te._root_ref.addEventListener("dragover",e._drop_start),e.st4te._root_ref.addEventListener("dragleave",e._drop_end)}))},this._drop_start=function(t){t.preventDefault(),t.stopPropagation(),e.setSt4te({_drag_file:Date.now()},(function(){e._request_force_update()}))},this._drop_end=function(t){t.preventDefault(),t.stopPropagation(),e.st4te._drag_file&&e.setSt4te({_drag_file:0},(function(){e._request_force_update()}))},this._scroll_to_drawer=function(t){var n,a,i,r;if((""+t).startsWith("swipetoolbox_i_"))n=(document.getElementsByClassName(t)||[])[0]||null,e.st4te._toolbox_container_ref.scrollTop=null!==n?n.offsetTop:0;else{for(a=e.st4te._toolbox_container_ref.scrollTop,i=(document.getElementsByClassName("swipetoolbox_i_"+e.st4te._view_name_index+"_0")||[])[0]||{},r=1;i;){if(!(a>i.offsetTop)){i=(document.getElementsByClassName("swipetoolbox_i_"+e.st4te._view_name_index+"_"+(r-1+t))||[])[0]||{};break}i=(document.getElementsByClassName("swipetoolbox_i_"+e.st4te._view_name_index+"_"+r++)||[])[0]||{}}e.st4te._toolbox_container_ref.scrollTop=i.offsetTop||0}},this._toggle_perspective=function(){var t=!e.st4te._perspective;t?(ee.default.trigger_voice("vision_activated"),e._set_tool("MOVE",!1)):(ee.default.trigger_voice("vision_deactivated"),e._revert_tool()),e.setSt4te({_perspective:t},(function(){e._request_force_update()}))},this._smooth_adjust=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;(0,e.st4te._canvas.smooth_adjust)(t)},this._close_text=function(){e.setSt4te({_text_dialog_open:!1},(function(){e._request_force_update()}))},this._open_text=function(){e.setSt4te({_text_dialog_open:!0},(function(){e._request_force_update()}))},this._draw_text=function(t,n){e._close_text(),(0,e.st4te._canvas.write_text)(t,n)},this._resume_video=function(){try{document.getElementById("labintro-video").play()}catch(e){}},this._compute_menu_right_click=function(){var t=e.st4te,n=t.classes,a=t._canvas,i=t._current_color,r=t._tool,o=t._width,l=t._height,s=t._pencil_mirror_mode,c=t._is_something_selected,u=t._menu_mouse_y,_=t._menu_mouse_x,d=t._menu_data,h=t._menu_event;d.pos_x=-1===d.pos_x?"out":d.pos_x,d.pos_y=-1===d.pos_y?"out":d.pos_y,e.menu=f.default.createElement(H.default,{className:n.contextMenuFuckYouDisable,PaperProps:{style:{maxHeight:380,width:240,overflowY:"overlay",contain:"paint style layout",scrollBehavior:"smooth",userSelect:"none",pointerEvents:u||_?"all":"none"}},onContextMenu:function(e){e.preventDefault()},MenuListProps:{dense:!0},transitionDuration:{enter:125,exit:250},open:!!u||!!_,onClose:e._handle_menu_close,disablePortal:!1,keepMounted:!0,anchorReference:"anchorPosition",anchorPosition:{top:0|u,left:0|_}},f.default.createElement("span",{style:{textAlign:"left",padding:"12px 8px",color:"#666"}},"X: ",d.pos_x,", Y: ",d.pos_y),f.default.createElement("div",{style:"SET PENCIL MIRROR"===r||"NONE"!==s?{}:{display:"none"}},f.default.createElement(G.default,{className:n.contextMenuSubheader},"Tools"),f.default.createElement(O.default,{button:!0,divider:!0,disabled:"PENCIL"===r,onClick:function(){e._set_tool("PENCIL")}},f.default.createElement(V.default,null,f.default.createElement(Be.default,null)),f.default.createElement(K.default,{primary:"Pencil"})),f.default.createElement(O.default,{button:!0,divider:!0,disabled:"PENCIL PERFECT"===r,onClick:function(){e._set_tool("PENCIL PERFECT")}},f.default.createElement(V.default,null,f.default.createElement(We.default,null)),f.default.createElement(K.default,{primary:"Pencil perfect"})),f.default.createElement(G.default,{className:n.contextMenuSubheader},"Mirror mode"),[{icon:f.default.createElement(qe.default,null),disabled:"NONE"===s,text:"None",on_click:function(){e._set_pencil_mirror_mode("NONE")}},{icon:f.default.createElement(qe.default,null),disabled:"VERTICAL"===s,text:"Vertical",on_click:function(){e._set_pencil_mirror_mode("VERTICAL")}},{icon:f.default.createElement(qe.default,null),disabled:"HORIZONTAL"===s,text:"Horizontal",on_click:function(){e._set_pencil_mirror_mode("HORIZONTAL")}},{icon:f.default.createElement(qe.default,null),disabled:"BOTH"===s,text:"Both",on_click:function(){e._set_pencil_mirror_mode("BOTH")}}].map((function(e){return f.default.createElement(O.default,{key:e.text,button:!0,divider:!0,disabled:e.disabled,onClick:e.on_click},f.default.createElement(V.default,null,e.icon),f.default.createElement(K.default,{primary:e.text}))}))),f.default.createElement("div",{style:c?{}:{display:"none"}},f.default.createElement(G.default,{className:n.contextMenuSubheader},"Apply to selection"),[{icon:f.default.createElement(Je.default,null),text:"Unselect",on_click:function(){a.to_selection_none()}},{icon:f.default.createElement(Te.default,null),text:"Colorize dynamical",on_click:function(){a.to_selection_changes(i,!1)}},{icon:f.default.createElement(Ye.default,null),text:"Get average color",on_click:function(){e._get_average_color_of_selection()}},{icon:f.default.createElement(Ee.default,null),text:"Shrink",on_click:function(){a.to_selection_size(-1)}},{icon:f.default.createElement(Ee.default,null),text:"Grow",on_click:function(){a.to_selection_size(1)}},{icon:f.default.createElement(Se.default,null),text:"Border",on_click:function(){a.to_selection_border()}},{icon:f.default.createElement(Te.default,null),text:"Bucket",on_click:function(){a.to_selection_bucket()}},{icon:f.default.createElement(Ee.default,null),text:"Crop",on_click:function(){a.to_selection_crop()}},{icon:f.default.createElement(Me.default,null),text:"Invert",on_click:function(){a.to_selection_invert()}},{icon:f.default.createElement(Pe.default,null),text:"Copy",on_click:function(){a.copy_selection()}},{icon:f.default.createElement(Ne.default,null),text:"Cut",on_click:function(){a.cut_selection()}},{icon:f.default.createElement(Re.default,null),text:"Erase",on_click:function(){a.erase_selection()}}].map((function(e){return f.default.createElement(O.default,{key:e.text,button:!0,divider:!0,onClick:e.on_click},f.default.createElement(V.default,null,e.icon),f.default.createElement(K.default,{primary:e.text}))}))),f.default.createElement(G.default,{style:null===d.pxl_color?{display:"none"}:{},className:n.contextMenuSubheader},"Color"),f.default.createElement(O.default,{button:!0,divider:!0,style:null===d.pxl_color?{display:"none"}:{},disabled:d.pxl_color===i||null===d.pxl_color,onClick:function(t){e._set_current_color(d.pxl_color),e._handle_relevant_action_event(h,d.pxl_color,1,!0)}},f.default.createElement(V.default,null,f.default.createElement(ie.default,{style:{color:d.pxl_color,background:"repeating-conic-gradient(#80808055 0% 25%, #00000000 0% 50%) 50% / calc(200% / "+o+") calc(200% / "+l+")"}})),f.default.createElement(K.default,{primary:"Pick color"})),f.default.createElement(O.default,{button:!0,divider:!0,style:null===d.pxl_color?{display:"none"}:{},disabled:d.pxl_color===i||null===d.pxl_color,onClick:function(t){e._exchange_pixel_colors(d.pos_x,d.pos_y,i+""),e._handle_relevant_action_event(h,i,1,!0)}},f.default.createElement(V.default,null,f.default.createElement(ie.default,{style:{color:i,background:"repeating-conic-gradient(#80808055 0% 25%, #00000000 0% 50%) 50% / calc(200% / "+o+") calc(200% / "+l+")"}})),f.default.createElement(K.default,{primary:"Replace color"})),f.default.createElement(G.default,{className:n.contextMenuSubheader},"Effect"),f.default.createElement(O.default,{button:!0,divider:!0,onClick:function(t){return e._to_auto_medium_more_contrast()}},f.default.createElement(V.default,null,f.default.createElement(ve.default,null)),f.default.createElement(K.default,{primary:"Increase contrast"})),f.default.createElement(O.default,{button:!0,divider:!0,onClick:function(t){return e._to_auto_medium_more_saturation()}},f.default.createElement(V.default,null,f.default.createElement(ve.default,null)),f.default.createElement(K.default,{primary:"Increase saturation"})),f.default.createElement(O.default,{button:!0,divider:!0,onClick:function(t){return e._handle_edit_drawer_open(null,6)}},f.default.createElement(V.default,null,f.default.createElement(ne.default,null)),f.default.createElement(K.default,{primary:"Add a filter"})),f.default.createElement(O.default,{button:!0,divider:!0,onClick:function(e){a.less_colors_stepped()}},f.default.createElement(V.default,null,f.default.createElement(be.default,null)),f.default.createElement(K.default,{primary:"Reduce color number"})),f.default.createElement(O.default,{button:!0,divider:!0,onClick:e._less_colors_auto},f.default.createElement(V.default,null,f.default.createElement(be.default,null)),f.default.createElement(K.default,{primary:"To auto colors number"})),f.default.createElement(O.default,{button:!0,divider:!0,onClick:function(t){return e._smooth_adjust(1)}},f.default.createElement(V.default,null,f.default.createElement(xe.default,null)),f.default.createElement(K.default,{primary:"Smooth a bit"})))},this._compute_menu_drawer=function(){var t=e.st4te,n=t.classes,a=t._canvas,i=t._view_name_index,r=t._previous_view_name_index,o=t._view_names,l=t._layers,s=t._layer_index,c=t._is_image_import_mode,u=t._hide_canvas_content,_=t._show_original_image_in_background,d=t._show_transparent_image_in_background,h=t._can_undo,p=t._can_redo,m=t._current_color,g=t._second_color,v=t._slider_value,y=t._tool,b=t._width,w=t._height,x=t._import_size,k=t._import_colorize,E=t._hue,C=t._filters,S=t._select_mode,O=t._pencil_mirror_mode,T=t._is_something_selected,M=t._is_edit_drawer_open,D=t._menu_data,P=t._less_than_1280w,j=t._slider_value_width,N=t._slider_value_height;D.pos_x=-1===D.pos_x?"out":D.pos_x,D.pos_y=-1===D.pos_y?"out":D.pos_y,P?e.drawer_mobile=f.default.createElement(f.default.Fragment,null,f.default.createElement(z.default,{className:n.contentDrawer,disableBackdropTransition:!1,disableSwipeToOpen:!1,disableDiscovery:!1,disablePortal:!0,keepMounted:!0,hysteresis:.314,minFlingVelocity:314,swipeAreaWidth:128,open:!!M,onOpen:e._handle_edit_drawer_open,onClose:e._handle_edit_drawer_close,classes:{paper:n.swipeableDrawerPaper,modal:n.drawerModal},transitionDuration:{appear:5,enter:50,exit:75},ModalProps:{disablePortal:!0,BackdropProps:{classes:{root:n.drawerModalBackdropRoot}}},variant:"temporary",anchor:"bottom",style:{pointerEvents:"all"}},f.default.createElement("div",{className:n.mobileintrovideowrapper},f.default.createElement("video",{className:n.mobileintrovideo,id:"labintro-video",width:"56",height:"56",onClick:e._resume_video,style:{aspectRatio:"1",transform:"translateZ(10px)"}},f.default.createElement("source",{src:"/src/videos/labintro.mp4",type:"video/mp4"}))),f.default.createElement(oe.default,{onClick:e._handle_edit_drawer_close}),f.default.createElement("div",{style:{display:"grid",contain:"layout paint style"}},f.default.createElement("div",{style:{boxShadow:"rgb(0 0 0 / 20%) 0px 2px 4px -1px, rgb(0 0 0 / 14%) 0px 4px 5px 0px, rgb(0 0 0 / 12%) 0px 1px 10px 0px",zIndex:1}},f.default.createElement("div",{className:n.drawerHeader},f.default.createElement(I.default,{className:n.effectSliderText,id:"strength-slider",gutterBottom:!0},"Effect strength :"),f.default.createElement(A.default,{key:"slider-"+(255*v|0),className:n.effectSlider,defaultValue:parseFloat(v),step:1/255,min:0,max:1,onChangeCommitted:e._set_value_from_slider_with_update,"aria-labelledby":"strength-slider"}))),f.default.createElement("div",{className:n.drawerContainer,ref:e._set_toolbox_container_ref},f.default.createElement(de.default,{should_update:M,slider_value_width:j,slider_value_height:N,onActionClose:e._handle_edit_drawer_close,canvas:a,is_mobile:Lt,view_class:n.listOfTools,view_names:o,is_image_import_mode:c,can_undo:h,can_redo:p,view_name_index:i,previous_view_name_index:r,layers:l,layer_index:s,hide_canvas_content:u,show_original_image_in_background:_,show_transparent_image_in_background:d,hue:E,current_color:m,second_color:g,slider_value:v,tool:y,width:parseInt(b),height:parseInt(w),filters:C,select_mode:S,pencil_mirror_mode:O,is_something_selected:T,import_size:x,import_colorize:k,set_filters_callback:e._set_filters_callback,set_props_callback:e._set_props_callback,set_tool:e._set_tool,set_select_mode:e._set_select_mode,set_pencil_mirror_mode:e._set_pencil_mirror_mode,set_width_from_slider:e._set_width_from_slider,set_height_from_slider:e._set_height_from_slider,set_import_size:e._set_import_size,set_import_colorize:e._set_import_colorize,switch_with_second_color:e._switch_with_second_color,show_hide_canvas_content:e._show_hide_canvas_content,show_hide_background_image:e._show_hide_background_image,show_hide_transparent_image:e._show_hide_transparent_image,on_current_color_change:e._handle_current_color_change,on_view_name_change:e._handle_view_name_change,on_upload_image:function(t){window.dispatchEvent(new Event("art-upload-drawer")),e._upload_image(t)},on_upload_image_library:e._upload_image_library,on_import_image:function(t){window.dispatchEvent(new Event("art-import-drawer")),e._handle_file_import(t)},on_import_image_library:e._import_image_library,on_request_draw_text:e._open_text,on_download_image:e._download_image,on_download_svg:e._download_svg,on_scroll_to:e._scroll_to_drawer})))),f.default.createElement("div",{className:n.fatabs,style:M&&P?{transform:"translateY(24px)",backgroundColor:"#fff"}:{}},f.default.createElement(U.default,{className:n.tabs,style:{pointerEvents:"all"},variant:"fullWidth",scrollButtons:"off",indicatorColor:"primary",textColor:"primary",selectionFollowsFocus:!0,value:i,onChange:e._handle_edit_drawer_open},f.default.createElement(F.default,{className:n.tab,label:"colors",icon:f.default.createElement(ct.default,null)}),f.default.createElement(F.default,{className:n.tab,label:"image",icon:f.default.createElement(_t.default,null)}),f.default.createElement(F.default,{className:n.tab,label:"layers",icon:f.default.createElement(ht.default,null)}),f.default.createElement(F.default,{className:n.tab,label:"tools",icon:f.default.createElement(pt.default,null)}),f.default.createElement(F.default,{className:n.tab,label:"select",icon:f.default.createElement(gt.default,null)}),f.default.createElement(F.default,{className:n.tab,label:"effects",icon:f.default.createElement(yt.default,null)}),f.default.createElement(F.default,{className:n.tab,label:"filters",icon:f.default.createElement(wt.default,null)})))):e.drawer_desktop=f.default.createElement(L.default,{className:n.contentDrawerFixed,variant:"permanent",anchor:"right",classes:{paper:n.drawerPaper}},f.default.createElement("div",{style:{display:"contents",pointerEvents:"all"}},f.default.createElement("div",{style:{boxShadow:"rgb(0 0 0 / 20%) 0px 2px 4px -1px, rgb(0 0 0 / 14%) 0px 4px 5px 0px, rgb(0 0 0 / 12%) 0px 1px 10px 0px",zIndex:1}},f.default.createElement("div",{className:n.drawerHeader},f.default.createElement("div",{className:n.desktopintrovideowrapper},f.default.createElement("video",{className:n.desktopintrovideo,id:"labintro-video",width:"56",height:"56",onClick:e._resume_video,style:{aspectRatio:"1",transform:"translateZ(10px)"}},f.default.createElement("source",{src:"/src/videos/labintro.mp4",type:"video/mp4"}))),f.default.createElement("span",{className:n.coordinate},f.default.createElement("span",{id:"fps_el"},"FPS: 0"),f.default.createElement("span",{id:"xy_el"}," | X: out, Y: out ")),f.default.createElement(I.default,{className:n.effectSliderText,id:"strength-slider",gutterBottom:!0},"Effect strength :"),f.default.createElement(A.default,{key:"slider-"+(255*v|0),defaultValue:parseFloat(v),className:n.effectSlider,step:1/255,min:0,max:1,onChangeCommitted:e._set_value_from_slider_with_update,"aria-labelledby":"strength-slider"})),f.default.createElement(U.default,{id:"tabs-desktop",className:n.tabs,variant:"fullWidth",indicatorColor:"primary",textColor:"primary",selectionFollowsFocus:!1,value:i,onChange:function(t,n){e._handle_view_name_change(n)}},f.default.createElement(F.default,{className:n.tab,label:"colors",icon:f.default.createElement(ct.default,null)}),f.default.createElement(F.default,{className:n.tab,label:"image",icon:f.default.createElement(_t.default,null)}),f.default.createElement(F.default,{className:n.tab,label:"layers",icon:f.default.createElement(ht.default,null)}),f.default.createElement(F.default,{className:n.tab,label:"tools",icon:f.default.createElement(pt.default,null)}),f.default.createElement(F.default,{className:n.tab,label:"select",icon:f.default.createElement(gt.default,null)}),f.default.createElement(F.default,{className:n.tab,label:"effects",icon:f.default.createElement(yt.default,null)}),f.default.createElement(F.default,{className:n.tab,label:"filters",icon:f.default.createElement(wt.default,null)}))),f.default.createElement("div",{className:n.drawerContainer,ref:e._set_toolbox_container_ref},f.default.createElement(de.default,{should_update:!Lt,slider_value_width:j,slider_value_height:N,canvas:a,view_class:n.listOfTools,is_mobile:Lt,view_names:o,is_image_import_mode:c,can_undo:h,can_redo:p,view_name_index:i,previous_view_name_index:r,layers:l,layer_index:s,hide_canvas_content:u,show_original_image_in_background:_,show_transparent_image_in_background:d,hue:E,current_color:m,second_color:g,slider_value:v,tool:y,width:parseInt(b),height:parseInt(w),filters:C,select_mode:S,pencil_mirror_mode:O,is_something_selected:T,import_size:x,import_colorize:k,set_filters_callback:e._set_filters_callback,set_props_callback:e._set_props_callback,set_tool:e._set_tool,set_select_mode:e._set_select_mode,set_pencil_mirror_mode:e._set_pencil_mirror_mode,set_width_from_slider:e._set_width_from_slider,set_height_from_slider:e._set_height_from_slider,set_import_size:e._set_import_size,set_import_colorize:e._set_import_colorize,switch_with_second_color:e._switch_with_second_color,show_hide_canvas_content:e._show_hide_canvas_content,show_hide_background_image:e._show_hide_background_image,show_hide_transparent_image:e._show_hide_transparent_image,on_current_color_change:e._handle_current_color_change,on_view_name_change:e._handle_view_name_change,on_upload_image:function(t){window.dispatchEvent(new Event("art-upload-drawer")),e._upload_image(t)},on_upload_image_library:e._upload_image_library,on_import_image:e._handle_file_import,on_import_image_library:e._import_image_library,on_request_draw_text:e._open_text,on_download_image:e._download_image,on_download_svg:e._download_svg,on_scroll_to:e._scroll_to_drawer}))))}},t.default=(0,k.default)(Ft)(Bt)},651:function(e,t,n){"use strict";var a,i;Object.defineProperty(t,"__esModule",{value:!0}),a=function(){function e(e,t){var n,a;for(n=0;n<t.length;n++)(a=t[n]).enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rgba_=t}return a(e,[{key:"setRGBA",value:function(e){this.rgba_[0]=e[0],this.rgba_[1]=e[1],this.rgba_[2]=e[2],this.rgba_[3]=e[3]}},{key:"setUint32",value:function(e){e=(0|e)>>>0,this.rgba_[3]=e>>24&255,this.rgba_[2]=e>>16&255,this.rgba_[1]=e>>8&255,this.rgba_[0]=255&e}},{key:"r",get:function(){return this.rgba_[0]}},{key:"g",get:function(){return this.rgba_[1]}},{key:"b",get:function(){return this.rgba_[2]}},{key:"a",get:function(){return this.rgba_[3]}},{key:"rgba",get:function(){return this.rgba_.subarray(0,4)}},{key:"uint32",get:function(){return(this.r<<24|this.g<<16|this.b<<8|this.a)>>>0}}],[{key:"createUint32",value:function(t){return new e(new Uint8Array(Uint32Array.of((0|t)>>>0).buffer))}}]),e}(),t.default=i},652:function(e,t,n){"use strict";var a,i,r,o,l;Object.defineProperty(t,"__esModule",{value:!0}),a=function(){function e(e,t){var n,a;for(n=0;n<t.length;n++)(a=t[n]).enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(651),r=(l=i)&&l.__esModule?l:{default:l},o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,null,[{key:"colorDifference",value:function(e,t){return Math.sqrt(Math.pow(e.r-t.r,2)+Math.pow(e.g-t.g,2)+Math.pow(e.b-t.b,2)+Math.pow(e.a-t.a,2))}},{key:"averageColor",value:function(e){var t,n=new Uint32Array(4);return e.forEach((function(e){var t=e.rgba;n[0]=(n[0]+t[0]|0)>>>0,n[1]=(n[1]+t[1]|0)>>>0,n[2]=(n[2]+t[2]|0)>>>0,n[3]=(n[3]+t[3]|0)>>>0})),t=e.length,new r.default(Uint8Array.of(n[0]/t|0,n[1]/t|0,n[2]/t|0,n[3]/t|0))}}]),e}(),t.default=o},654:function(e,t,n){"use strict";var a,i=n(653),r=n(647),o=(0,r.SIMDopeCreateConfAdd)({create:{new_of:!0},properties:{uint32:!0,laba:!0,rgbaon4bits:!0,rgbaon6bits:!0,rgbaon8bits:!0,rgbaon12bits:!0,rgbaon16bits:!0,skin:!0},methods:{simplify:!0,get_new_element:!0,get_use_element:!0,set_tail:!0,is_dark:!0,blend_first_with:!0,blend_first_with_tails:!0,blend_all:!0,manhattan_match_with:!0,copy:!0}}),l=Math.fround,s=l(1),c=l(.777),u=(0,r.SIMDopeCreate)(o),_=u.simdops,d=u.Color,h=u.Colors,f=(_.minus_int,_.int_not_equal,_.plus_int,_.plus_uint,_.minus_uint,_.multiply_int,_.multiply_uint,_.multiply_uint_4),p=(_.divide_uint,_.clamp_uint8,_.clamp_uint32,_.int_equal,_.uint_less,_.int_less,_.int_greater_equal,_.uint_not_equal,_.uint_less_equal,_.min_uint,function e(t){if(t=t||{},!(this instanceof e))return new e(t);t.pxl_colors=t.pxl_colors||new Uint32Array(0),t.pxls=t.pxls||new Uint32Array(0),this.new_pxls_="buffer"in t.pxls?new Uint32Array(t.pxls.buffer):Uint32Array.from(t.pxls),this.new_pxl_colors_="buffer"in t.pxl_colors?new h(t.pxl_colors.buffer):new h(Uint32Array.from(t.pxl_colors).buffer),this.original_pxls_=this.new_pxls_.slice(0,this.new_pxls_.length),this.original_pxl_colors_=this.new_pxl_colors_.slice_uint32(0,this.new_pxl_colors_.length);var n=0|this.new_pxl_colors_.length;this.new_pxl_colors_is_skin_mask_=new i.SetFixed(0|n),this.set_new_pxl_skin_mask(),this.best_color_number_=t.number_of_color,this.max_cluster_=n>65536?65537:n>16384?4097:n>8192?257:n>512?17:1,this.index_clusters_=Array(this.max_cluster_),this.length_clusters_=new Uint32Array(this.max_cluster_),this.pxl_colors_usage_=new Uint32Array(n),this.all_index_clusters_=new Uint32Array(n),this.clean_pxl_colors_=new Uint32Array(n),this.clean_pxl_colors_lookup_={},this.is_skin_ops_=0,this.match_ops_=0,this.blend_ops_=0,this.remove_duplicate_ops_=0,this.simplify_ops_=0,this.classify_on_x_bits_ops_=0});Object.defineProperty(p.prototype,"set_is_skin_ops",{get:function(){return function(e){this.is_skin_ops_=(0|e)>>>0}}}),Object.defineProperty(p.prototype,"set_match_ops",{get:function(){return function(e){this.match_ops_=(0|e)>>>0}}}),Object.defineProperty(p.prototype,"set_blend_ops",{get:function(){return function(e){this.blend_ops_=(0|e)>>>0}}}),Object.defineProperty(p.prototype,"set_remove_duplicate_ops",{get:function(){return function(e){this.remove_duplicate_ops_=(0|e)>>>0}}}),Object.defineProperty(p.prototype,"set_simplify_ops",{get:function(){return function(e){this.simplify_ops_=e}}}),Object.defineProperty(p.prototype,"set_classify_on_x_bits_ops",{get:function(){return function(e){this.classify_on_x_bits_ops_=e}}}),Object.defineProperty(p.prototype,"get_is_skin_ops",{get:function(){return function(){return 0|this.is_skin_ops_}}}),Object.defineProperty(p.prototype,"get_match_ops",{get:function(){return function(){return 0|this.match_ops_}}}),Object.defineProperty(p.prototype,"get_blend_ops",{get:function(){return function(){return 0|this.blend_ops_}}}),Object.defineProperty(p.prototype,"get_remove_duplicate_ops",{get:function(){return function(){return 0|this.remove_duplicate_ops_}}}),Object.defineProperty(p.prototype,"get_simplify_ops",{get:function(){return function(){return this.simplify_ops_}}}),Object.defineProperty(p.prototype,"get_classify_on_x_bits_ops",{get:function(){return function(){return this.classify_on_x_bits_ops_}}}),Object.defineProperty(p.prototype,"reset_deduplicate",{get:function(){return function(e){this.clean_pxl_colors_lookup_={},this.pxl_colors_usage_.fill(0,0,0|e),this.clean_pxl_colors_.fill(0,0,0|e)}}}),Object.defineProperty(p.prototype,"index_of_color_within_cleaned",{get:function(){return function(e){return(0|this.clean_pxl_colors_lookup_[(0|e)>>>0])-1|0}}}),Object.defineProperty(p.prototype,"set_cleaned_pxl_colors",{get:function(){return function(e,t){this.clean_pxl_colors_[(0|e)>>>0]=(0|t)>>>0,this.clean_pxl_colors_lookup_[(0|t)>>>0]=(e+1|0)>>>0}}}),Object.defineProperty(p.prototype,"increase_color_usage",{get:function(){return function(e){this.pxl_colors_usage_[(0|e)>>>0]=(this.pxl_colors_usage_[(0|e)>>>0]+1|0)>>>0}}}),Object.defineProperty(p.prototype,"set_new_pxls",{get:function(){return function(e,t){this.new_pxls_[(0|e)>>>0]=(0|t)>>>0}}}),Object.defineProperty(p.prototype,"set_new_pxl_colors",{get:function(){return function(e){this.new_pxl_colors_=new h(this.clean_pxl_colors_.buffer.slice(0,f(0|e))),this.set_new_pxl_skin_mask()}}}),Object.defineProperty(p.prototype,"set_new_pxl_skin_mask",{get:function(){return function(){var e=new d(new ArrayBuffer(4)),t=0|this.new_pxl_colors_.length,n=0;for(this.new_pxl_colors_is_skin_mask_=new i.SetFixed(0|t);(0|n)<(0|t);n=n+1|0)this.new_pxl_colors_.get_use_element(0|n,e).skin&&this.new_pxl_colors_is_skin_mask_.add(0|n);this.set_is_skin_ops(this.get_is_skin_ops()+n|0)}}}),Object.defineProperty(p.prototype,"get_a_new_pxl_color_from_pxl_index",{get:function(){return function(e){return 4294967295&this.new_pxl_colors_.buffer_getUint32(this.new_pxls_[0|e])}}}),Object.defineProperty(p.prototype,"reset_cluster",{get:function(){return function(){this.max_cluster_=this.new_pxl_colors_.length>65536?65537:this.new_pxl_colors_.length>16384?4097:this.new_pxl_colors_.length>8192?257:this.new_pxl_colors_.length>512?17:1,this.length_clusters_.fill(0,0,0|this.max_cluster);for(var e=0;(0|e)<(0|this.max_cluster);e=(e+1|0)>>>0)this.index_clusters_[0|e]=[]}}}),Object.defineProperty(p.prototype,"reset_original_data",{get:function(){return function(){this.new_pxl_colors_=new h(this.original_pxl_colors_.slice(0,this.original_pxl_colors_.length).buffer),this.new_pxls_=this.original_pxls_.slice(0,this.original_pxls_.length)}}}),Object.defineProperty(p.prototype,"add_in_indexes_cluster",{get:function(){return function(e,t){this.index_clusters_[(0|e)>>>0].push((0|t)>>>0)}}}),Object.defineProperty(p.prototype,"set_all_cluster_indexes",{get:function(){return function(){for(var e=0,t=0;(0|e)<(0|this.max_cluster);e=(e+1|0)>>>0)this.all_index_clusters_.set(this.index_clusters_[(0|e)>>>0],(0|t)>>>0),t=(t+this.get_length_in_index_clusters(0|e)|0)>>>0}}}),Object.defineProperty(p.prototype,"get_length_in_index_clusters",{get:function(){return function(e){return(0|this.index_clusters_[(0|e)>>>0].length)>>>0}}}),Object.defineProperty(p.prototype,"get_in_cluster_lengths",{get:function(){return function(e){return(0|this.length_clusters_[(0|e)>>>0])>>>0}}}),Object.defineProperty(p.prototype,"get_an_index_in_clusters",{get:function(){return function(e){return(0|this.all_index_clusters_[0|e])>>>0}}}),Object.defineProperty(p.prototype,"get_a_color_usage",{get:function(){return function(e){return(0|this.pxl_colors_usage_[0|e])>>>0}}}),Object.defineProperty(p.prototype,"set_a_color_usage",{get:function(){return function(e,t){return this.pxl_colors_usage_[0|e]=(0|t)>>>0}}}),Object.defineProperty(p.prototype,"get_a_color_usage_percent",{get:function(){return function(e){return l(this.pxl_colors_usage_[0|e]/this.new_pxls_.length)}}}),Object.defineProperty(p.prototype,"get_average_color_usage_percent",{get:function(){return function(e,t){var n,a,i;for(t=0|((t|=0)<(e|=0)?this.pxl_colors_usage_.length:t),n=0,a=0,i=0,a=0|e;(0|a)<(0|t);a=(a+1|0)>>>0)i=(0|this.get_an_index_in_clusters((0|a)>>>0))>>>0,n+=this.pxl_colors_usage_[0|i]/this.new_pxls_.length;return n/(t-e|0)}}}),Object.defineProperty(p.prototype,"get_a_new_pxl_color",{get:function(){return function(e){return this.new_pxl_colors_.get_new_element(0|e)}}}),Object.defineProperty(p.prototype,"is_pxl_color_skin",{get:function(){return function(e){return this.new_pxl_colors_is_skin_mask_.has(0|e)}}}),Object.defineProperty(p.prototype,"max_cluster",{get:function(){return 0|this.max_cluster_}}),Object.defineProperty(p.prototype,"new_pxls_length",{get:function(){return 0|this.new_pxls_.length}}),Object.defineProperty(p.prototype,"new_pxl_colors_length",{get:function(){return 0|this.new_pxl_colors_.length}}),Object.defineProperty(p.prototype,"best_color_number",{get:function(){return 0|this.best_color_number_}}),Object.defineProperty(p.prototype,"get_data",{get:function(){return function(){return Array.of(this.new_pxls_,this.new_pxl_colors_.slice_uint32(0,this.new_pxl_colors_.length),{deduplicate:this.get_remove_duplicate_ops(),simplify:this.get_simplify_ops(),classify:this.get_classify_on_x_bits_ops(),skin:this.get_is_skin_ops(),blend:this.get_blend_ops(),match:this.get_match_ops()})}}}),p.prototype.output=function(e){var t,n;return e=e||"heap",t=this.get_data(),"heap"==e?((n=new Uint32Array(2+t[0].length+t[1].length))[0]=0|t[0].length,n[1]=0|t[1].length,n.set(t[0],2),n.set(t[1],2+t[0].length),n.buffer):t},p.prototype.deduplicate=function(){var e,t,n,a,i;for(this.set_remove_duplicate_ops(this.get_remove_duplicate_ops()+1|0),this.reset_deduplicate(0|this.new_pxl_colors_length),e=0,t=0,n=0,a=0,i=0|this.new_pxls_length;(0|a)<(0|i);a=(a+1|0)>>>0)t=0|this.get_a_new_pxl_color_from_pxl_index(0|a),-1==(0|(n=0|this.index_of_color_within_cleaned(0|t)))&&(this.set_cleaned_pxl_colors(0|e,0|t),n=0|e,e=e+1|0),this.increase_color_usage(0|n),this.set_new_pxls(0|a,0|n);this.set_new_pxl_colors(e)},p.prototype.clusterize=function(){this.reset_cluster();var e=0;if(65537===this.max_cluster)for(;(0|e)<(0|this.new_pxl_colors_length);e=(e+1|0)>>>0)this.add_in_indexes_cluster((0|this.get_a_new_pxl_color((0|e)>>>0).rgbaon16bits)>>>0,(0|e)>>>0);else if(4097===this.max_cluster)for(;(0|e)<(0|this.new_pxl_colors_length);e=(e+1|0)>>>0)this.add_in_indexes_cluster((0|this.get_a_new_pxl_color((0|e)>>>0).rgbaon12bits)>>>0,(0|e)>>>0);else if(257===this.max_cluster)for(;(0|e)<(0|this.new_pxl_colors_length);e=(e+1|0)>>>0)this.add_in_indexes_cluster((0|this.get_a_new_pxl_color((0|e)>>>0).rgbaon8bits)>>>0,(0|e)>>>0);else if(17===this.max_cluster)for(;(0|e)<(0|this.new_pxl_colors_length);e=(e+1|0)>>>0)this.add_in_indexes_cluster((0|this.get_a_new_pxl_color((0|e)>>>0).rgbaon4bits)>>>0,(0|e)>>>0);else for(;(0|e)<(0|this.new_pxl_colors_length);e=(e+1|0)>>>0)this.add_in_indexes_cluster(0,(0|e)>>>0);this.max_cluster>1&&this.set_classify_on_x_bits_ops(this.get_classify_on_x_bits_ops()+this.new_pxl_colors_length),this.set_all_cluster_indexes()},p.prototype.process_threshold=function(e){var t,n,a,i,r,o,u,_,h,f,p,m,g,v,y,b,w,x,k,E,C,S,O,T,I,M;for(n=function(e,n){return l(Math.pow(e,t)/n)}(e=(0|e)>>>0,Math.pow(100,t=1.5)),a=!1,i=[],r=[],o=0,u=0,f=!1,p=!1,m=0,g=0,v=0,y=0,b=0,w=0,C=0,S=0,O=0,T=0,I=0,M=0,E=l((x=n)*c),k=l(x*s);(0|I)<(0|this.max_cluster);I=(I+1|0)>>>0){for(u=(o+((0|this.get_length_in_index_clusters(0|I))>>>0)|0)>>>0,b=this.get_average_color_usage_percent(0|o,0|u),O=0|o;(0|O)<(0|u);O=(O+1|0)>>>0){if(C=(0|this.get_an_index_in_clusters((0|O)>>>0))>>>0,_=this.get_a_new_pxl_color((0|C)>>>0),f=this.is_pxl_color_skin((0|C)>>>0),(0|(m=(0|this.get_a_color_usage((0|C)>>>0))>>>0))>0)for(i=[],T=0|o;(0|T)<(0|u);T=(T+1|0)>>>0)S=(0|this.get_an_index_in_clusters((0|T)>>>0))>>>0,h=this.get_a_new_pxl_color((0|S)>>>0),p=this.is_pxl_color_skin((0|S)>>>0),0|(g=(0|this.get_a_color_usage((0|S)>>>0))>>>0)&&(0|C)!=(0|S)&&(0|f)==(0|p)&&(v=this.get_a_color_usage_percent((0|C)>>>0)/b,y=this.get_a_color_usage_percent((0|S)>>>0)/b,M=l((M=f&&p?E:f||p?k:x)*(0*Math.abs(v-y)+.14*(2-(v+y))/2+.88)/1.02),_.manhattan_match_with(h,M)&&(w=l(g/m),a=!0,this.set_a_color_usage(0|S,0),i.push(h),r.push(w)));(0|i.length)>0&&(d.blend_all(_,i,r),i=[],r=[])}o=0|u}return a},p.prototype.round=function(){var e,t;if(this.new_pxl_colors_length>2048){for(e=0|(this.new_pxl_colors_length>6e4?4:this.new_pxl_colors_length>32e3?3:this.new_pxl_colors_length>16e3?2:this.new_pxl_colors_length>8192?1.5:this.new_pxl_colors_length>4096?1.25:1),t=0;(0|t)<(0|this.new_pxl_colors_length);t=(t+1|0)>>>0)this.get_a_new_pxl_color((0|t)>>>0).simplify(e);this.set_simplify_ops(this.get_simplify_ops()+this.new_pxl_colors_length)}},p.prototype.init=function(){return this.round(),this.deduplicate(),this.clusterize(),this},p.prototype.reset_original=function(){return this.reset_original_data(),this},p.prototype.run=function(){var e=0|(this.new_pxl_colors_length>6e4?12:this.new_pxl_colors_length>32e3?8:this.new_pxl_colors_length>16e3?4:this.new_pxl_colors_length>8192?3:this.new_pxl_colors_length>4096?2:1);if(this.new_pxl_colors_length<=this.best_color_number)return this.deduplicate(),this.clusterize(),this;for(;this.new_pxl_colors_length>this.best_color_number;)this.process_threshold(0|e)&&(this.deduplicate(),this.clusterize()),e=e+(this.new_pxl_colors_length>6e4?12:this.new_pxl_colors_length>32e3?8:this.new_pxl_colors_length>16e3?4:this.new_pxl_colors_length>8192?3:this.new_pxl_colors_length>4096?2:1)|0;return this.reset_original(),this.deduplicate(),this.clusterize(),this.process_threshold(0|e),this.deduplicate(),this.clusterize(),this},p.split_image_data=function(e){var t,n,a=new Uint32Array(e.data.buffer),i=Uint32Array.from(new Set(a)),r={},o=i.length,l=new Uint32Array(a.length);for(t=0,n=0|o;(0|t)<(0|n);t=(t+1|0)>>>0)r[i[0|t]]=(0|t)>>>0;for(t=0,n=0|a.length;(0|t)<(0|n);t=(t+1|0)>>>0)l[0|t]=(0|r[a[0|t]])>>>0;return[l,i,a,o]},a=function(e,t){return new Promise((function(n){var a,i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n,a,i=[],r=!0,o=!1,l=void 0;try{for(n=e[Symbol.iterator]();!(r=(a=n.next()).done)&&(i.push(a.value),4!==i.length);r=!0);}catch(s){o=!0,l=s}finally{try{!r&&n.return&&n.return()}finally{if(o)throw l}}return i}(e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(p.split_image_data(e)),r=i[0],o=i[1],l=i[2],s=i[3],c=Date.now(),u=p({pxls:r,pxl_colors:o,number_of_color:"auto"===t?s/1.314|0:parseFloat(t)<1?s-Math.ceil(s/25):t,width:e.width,height:e.height}).init().run().output("split"),_=Date.now(),d=u[0],h=0|d.length,f=u[1];for(a=0;(0|a)<(0|h);a=(a+1|0)>>>0)l[0|a]=(0|f[(0|d[0|a])>>>0])>>>0;n([e=new ImageData(new Uint8ClampedArray(l.buffer),e.width,e.height),d,f,s-f.length,f.length,_-c])}))},e.exports={QuantiMatGlobal:a,QuantiMat:p}},655:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n,a,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.strength=t,this.tilesManager=n,this.tiles=n.getTiles(),this.width=a,this.height=i}},657:function(e,t,n){"use strict";var a,i;Object.defineProperty(t,"__esModule",{value:!0}),a=(i=n(670))&&i.__esModule?i:{default:i},t.default=a.default.pool({minWorkers:0,maxWorkers:3})},659:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var r,o,l,s,c,u;Object.defineProperty(t,"__esModule",{value:!0}),r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n,a,i=[],r=!0,o=!1,l=void 0;try{for(n=e[Symbol.iterator]();!(r=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);r=!0);}catch(s){o=!0,l=s}finally{try{!r&&n.return&&n.return()}finally{if(o)throw l}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){var n,a;for(n=0;n<t.length;n++)(a=t[n]).enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),a(n(651)),a(n(652)),n(653),l=n(654),s=Math.abs,c=Math.imul,u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.contextSource=t}return o(e,[{key:"computePaletteData",value:function(){var t=this.contextSource.getImageData(0,0,this.contextSource.canvas.width,this.contextSource.canvas.height),n=Date.now(),a=e.quantizeImageData(this.contextSource,256),i=a.centroids.length,r=Date.now(),o=e._calculateDistortions(a,t),l=Date.now(),s=e._findElbowPoint(o.clustersDistortion),c=Date.now(),u=e._calculateElbowStrength(o.clustersDistortion,s),_=Date.now(),d=0===s?this.contextSource.getImageData(0,0,this.contextSource.canvas.width,this.contextSource.canvas.height):e.quantizeImageData(this.contextSource,s).imageData,h=Date.now();return console.log({quantizeImageData1:r-n,_calculateDistortions:l-r,_findElbowPoint:c-l,"_calculateElbowStrength+updateThreshold":_-c,quantizeImageData2:h-_}),{colorNumber:0===s?i:s,colorNumberCertainty:u,colorData:d}}},{key:"analyzeImageForTileSize",value:function(e){function t(e){for(var t,n,a,i=0,r=4,o=1;r>=4&&r<=32;)t=e[r],e[2*r-1],e[2*r],e[2*r+1],e[4*r-1],e[4*r],e[4*r+1],i<(n=t*r*(1+.1*r))&&(i=n,o=r),r++;return a=0,e.forEach((function(e,t){a+=e*t})),{tileSize:o,certainty:Math.fround(o*e[o]/a)}}var n,a,i,r,o,l,s,c=e.width,u=e.height,_=new Uint32Array(e.data.buffer),d=256,h=new Uint32Array(d),f=new Uint32Array(d),p=0,m=new Uint32Array(2);for(n=0;n<u;n++){for(p=0,a=1;a<c;a++)m[0]=n*c+a|0,m[1]=m[0]-1|0,_[m[0]]==_[m[1]]?p++:(p>1&&p<d&&(h[p]=h[p]+1|0),p=1);p>0&&p<d&&(h[p]=h[p]+1|0)}for(i=0;i<c;i++){for(p=0,r=1;r<u;r++)m[0]=r*c+i|0,m[1]=m[0]-c|0,_[m[0]]==_[m[1]]?p++:(p>1&&p<d&&(f[p]=f[p]+1|0),p=1);p>0&&p<d&&(f[p]=f[p]+1|0)}return o=t(h),l=t(f),{tileSize:(s=100*Math.max(o.certainty,l.certainty))===o.certainty?o.tileSize:l.tileSize,certainty:s}}}],[{key:"colorDifference",value:function(e,t){var n=Uint8Array.of(s((e>>24&255)-(t>>24&255)),s((e>>16&255)-(t>>16&255)),s((e>>8&255)-(t>>8&255))),a=Uint16Array.of(c(n[0],n[0]),c(n[1],n[1]),c(n[2],n[2]));return(0|Math.sqrt((((a[0]<<1)+a[0]|0)+(a[1]<<2)+(a[2]<<1)|0)/10))>>>0}},{key:"quantizeImageData",value:function(e,t){var n,a,i,o,s=e.getImageData(0,0,e.canvas.width,e.canvas.height),c=Date.now(),u=l.QuantiMat.split_image_data(s),_=r(u,2),d=_[0],h=_[1],f=Date.now(),p=(0,l.QuantiMat)({pxls:d,pxl_colors:h,number_of_color:Math.min(h.length,t),width:s.width,height:s.height}).init().run().output("split"),m=Date.now();for(console.log(f-c,m-f),n=p[0],a=p[1],i=new Uint32Array(n.length),o=0;o<n.length;o++)i[o]=a[n[o]];return s.data.set(new Uint8ClampedArray(i.buffer)),{imageData:s,clusterAssignments:n,centroids:a}}},{key:"_calculateDistortions",value:function(t,n){var a,i=t.imageData,r=t.clusterAssignments,o=t.centroids,l=Math.imul,s=0,c=new Uint32Array(n.data.buffer),u=new Uint32Array(i.data.buffer),_=new BigUint64Array(o.length),d=0;for(a=0;a<u.length;a++)s+=d=0|l(d=0|e.colorDifference(u[a],c[a]),d),_[r[a]]+=BigInt(d);return{totalDistortion:s,clustersDistortion:Array.from(_).map((function(e){return Number(e)})).sort((function(e,t){return t-e}))}}},{key:"_findElbowPoint",value:function(e){var t,n,a,i,r,o,l,s=[];for(e.forEach((function(e){e&&s.push(e)})),t=[],n=1;n<e.length;n++)a=e[n]-e[n-1],0!==(i=e[n-1])?t.push(a/i):t.push(0);for(r=0,o=t[0],l=1;l<t.length;l++)t[l]>o&&(r=l,o=t[l]);return r}},{key:"_calculateElbowStrength",value:function(e,t){var n,a,r,o=e.map((function(t,n){return n/(e.length-1)})),l=Math.max.apply(Math,i(e)),s=Math.min.apply(Math,i(e)),c=e.map((function(e){return(e-s)/(l-s)})),u=[0,c[0]],_=[1,c[c.length-1]],d=[o[t],c[t]],h=Math.sqrt(Math.pow(_[0]-u[0],2)+Math.pow(_[1]-u[1],2)),f=Math.abs(((r=_)[1]-(a=u)[1])*(n=d)[0]-(r[0]-a[0])*n[1]+r[0]*a[1]-r[1]*a[0])/Math.sqrt(Math.pow(r[1]-a[1],2)+Math.pow(r[0]-a[0],2));return Math.fround(f/h)}}]),e}(),t.default=u},660:function(e,t,n){"use strict";var a,i,r;Object.defineProperty(t,"__esModule",{value:!0}),a=function(){function e(e,t){var n,a;for(n=0;n<t.length;n++)(a=t[n]).enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(647),r=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=t,this.k=Math.min(n,Math.ceil(Math.sqrt(this.data.length))),this.centroids=Array(this.k),this.clusters=new Uint32Array(this.data.length),this.c1=new i.Color(new ArrayBuffer(4)),this.c2=new i.Color(new ArrayBuffer(4))}return a(e,[{key:"initializeCentroids",value:function(){var e,t,n=new Set,a=[];for(e=0;e<this.k;e++){t=void 0;do{t=Math.floor(Math.random()*this.data.length)}while(n.has(t));n.add(t),a.push(Uint8Array.from(this.data[t]))}this.centroids=a}},{key:"assignClusters",value:function(){var e=this;this.data.forEach((function(t,n){var a=Number.MAX_VALUE,i=0;e.centroids.forEach((function(n,r){var o=e.distance(t,n);o<a&&(a=o,i=r)})),e.clusters[n]=i}))}},{key:"updateCentroids",value:function(){var e=this,t=Array.from({length:this.k},(function(){return new Uint32Array(e.data[0].length)})),n=new Uint32Array(this.k);return this.data.forEach((function(a,i){var r=e.clusters[i];t[r]=t[r].map((function(e,t){return e+a[t]})),n[r]++})),n}},{key:"findFarthestPointFromCentroids",value:function(){var e=this,t=0,n=0;return this.data.forEach((function(a,i){var r=Number.MAX_VALUE;e.centroids.forEach((function(t){var n=e.distance(a,t);n<r&&(r=n)})),r>t&&(t=r,n=i)})),n}},{key:"distance",value:function(e,t){return this.c1.set_from_array(e),this.c2.set_from_array(t),16192*this.c1.fast_match_with(this.c2)|0}},{key:"reassignCentroids",value:function(e){for(var t=0;t<e.length;t++)0===e[t]&&(this.centroids[t]=this.findFarthestPointFromCentroids())}},{key:"run",value:function(){var e,t,n,a,i,r,o=this,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(this.initializeCentroids(),e=0,t=!1,n=void 0,a=function(){var a=o.centroids.map((function(e){return Uint32Array.from(e)}));o.assignClusters(),n=o.updateCentroids(),e++,t=o.centroids.every((function(e,t){return o.distance(e,a[t])<2})),s&&!t&&o.reassignCentroids(n)};!t&&e<l;)a();return i=this.getCentroidsPopulationCount(this.centroids,this.clusters),r=Array.from(this.centroids).map((function(e,t){return{data:Uint8ClampedArray.from(e),count:i[t]}})).sort((function(e,t){return t.count-e.count})),{centroids:this.centroids,clusters:this.clusters,centroidsSorted:r}}},{key:"getCentroidsPopulationCount",value:function(e,t){var n=new Uint32Array(e.length);return t.forEach((function(e){n[e]++})),n}}]),e}(),t.default=r},661:function(e,t,n){"use strict";var a,i;Object.defineProperty(t,"__esModule",{value:!0}),a=function(){function e(e,t){var n,a;for(n=0;n<t.length;n++)(a=t[n]).enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,null,[{key:"initializeCanvas",value:function(e,t,n){t=(e=e||{width:0,height:0}).width||t||1,n=e.height||n||1;var a=void 0,i=void 0;try{i=(a=new OffscreenCanvas(t,n)).getContext("2d",{willReadFrequently:!0,desynchronized:!0})}catch(r){(a=document.createElement("canvas")).width=t,a.height=n,i=a.getContext("2d",{willReadFrequently:!0})}return e instanceof ImageData?i.putImageData(e,0,0):e.width&&i.drawImage(e,0,0,t,n),{canvas:a,context:i}}},{key:"canvasContextToImageData",value:function(e){return e.getImageData(0,0,e.canvas.width,e.canvas.height)}}]),e}(),t.default=i},662:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var i=a(n(663)),r=a(n(664));e.exports=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=(0,i.default)(e);return n&&(t=/(?:#)[0-9a-f]{8}|(?:#)[0-9a-f]{6}|(?:#)[0-9a-f]{4}|(?:#)[0-9a-f]{3}/gi,a.match(t).forEach((function(e){var t=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n,a,i=[],r=!0,o=!1,l=void 0;try{for(n=e[Symbol.iterator]();!(r=(a=n.next()).done)&&(i.push(a.value),3!==i.length);r=!0);}catch(s){o=!0,l=s}finally{try{!r&&n.return&&n.return()}finally{if(o)throw l}}return i}(e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(e.match(/\w\w/g).map((function(e){return parseInt(e,16)}))),n=t[0],i=t[1],r=t[2],o=Math.round((n+i+r)/3),l=function(e,t,n){return e=e.toString(16),t=t.toString(16),n=n.toString(16),1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==n.length&&(n="0"+n),"#"+e+t+n}(o,o,o);a=a.replace(e,l)}))),(0,r.default)(a)}},667:function(e,t,n){"use strict";var a=n(668);e.exports={createLocalBlob:function(e){var t,n,i,r,o=(e.match(/(data\:([a-z]+\/[a-z\+]+)\;base64\,)([a-zA-Z0-9\/\+]+\(\=+)?/)||[,,])[1];return o?(n=(t=o.match(/data\:([a-z]+\/[a-z\+]+)\;base64\,/)[1]).match(/[a-z]+\/([a-z\+]+)/)[1],e=e.replace(o,""),i=(0,a.base64ToBytes)(e),r=new File([i],"name."+n,{type:t}),URL.createObjectURL(r)):""}}},668:function(e,t,n){"use strict";var a=new(n(266).B64chromium);e.exports={bytesToBase64:a.bytesToBase64.bind(a),base64ToBytes:a.base64ToBytes.bind(a)}},676:function(e,t,n){"use strict";var a,i=n(677),r=Object.getPrototypeOf((a=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e,this)})),function(){var e=a.apply(this,arguments);return new Promise((function(t,n){return function a(i,r){var o,l;try{l=(o=e[i](r)).value}catch(s){return void n(s)}if(!o.done)return Promise.resolve(l).then((function(e){a("next",e)}),(function(e){a("throw",e)}));t(l)}("next")}))})).constructor,o=Object.getPrototypeOf((function(){})).constructor,l=new o('var t = function(file) {\n    "use strict";\n    \n    try {\n        \n        return new Promise(function(resolve, _) {\n            resolve(new FileReaderSync().readAsDataURL(file));\n        });\n        \n    } catch(error) {\n    \n        return new Promise(function(resolve, _) {\n            var reader = new FileReader();\n            reader.onload = function(){ resolve(reader.result)};\n            reader.readAsDataURL(file);\n        });\n    }\n    \n}; return t;')(),s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null!==n?n.exec(l,[e]).catch((function(t){return l(e)})).timeout(5e3).then((function(e){t(e)})):l(e).then((function(e){t(e)}))},c=new r('var t = async function(base64) {\n\n    "use strict";\n\n    return fetch(base64).then(function(res) {\n\n        return res.blob().then(function(blb){\n\n            return createImageBitmap(blb, {\n                resizeQuality: "pixelated",\n                premultiplyAlpha: \'premultiply\'\n            });\n        });\n    });\n\n}; return t;')(),u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null!==n?n.exec(c,[e]).catch((function(t){return c(e)})).timeout(5e3).then((function(e){t(e)})):c(e).then((function(e){t(e)}))},_=function(e){for(var t,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2073600,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=1;Math.round(e.width*r)*Math.round(e.height*r)>a;)r-=.01;try{createImageBitmap(e,0,0,e.width,e.height,{resizeWidth:Math.round(e.width*r),resizeHeight:Math.round(e.height*r),resizeQuality:"pixelated",premultiplyAlpha:"premultiply"}).then((function(e){var t,n=void 0;try{n=new OffscreenCanvas(e.width,e.height)}catch(a){(n=document.createElement("canvas")).width=e.width,n.height=e.height}(t=n.getContext("2d")).imageSmoothingEnabled=!1,t.drawImage(e,0,0,e.width,e.height),i(t.getImageData(0,0,e.width,e.height))}))}catch(o){t=void 0;try{t=new OffscreenCanvas(Math.round(e.width*r),Math.round(e.height*r))}catch(l){(t=document.createElement("canvas")).width=Math.round(e.width*r),t.height=Math.round(e.height*r)}(n=t.getContext("2d")).imageSmoothingEnabled=!1,n.drawImage(e,0,0,t.width,t.height),i(n.getImageData(0,0,t.width,t.height))}},d=new o('var t = function(imagedata, type) {\n\n    "use strict"\n    type = type || "image/png";\n    var quality = type.includes("webp") ? 1: type.includes("png") ? undefined: 0.7;\n    try {\n    \n        return new Promise(function(resolve, _) {\n\n            createImageBitmap(imagedata, 0, 0, imagedata.width, imagedata.height, {\n                premultiplyAlpha: \'premultiply\',\n                resizeQuality: \'pixelated\'\n            }).then((bmp) => {\n            \n                var canvas;\n                    canvas = new OffscreenCanvas(imagedata.width, imagedata.height);\n                var ctx = canvas.getContext("bitmaprenderer");\n                    ctx.imageSmoothingEnabled = false;\n                    ctx.transferFromImageBitmap(bmp);\n                \n                canvas.convertToBlob({type: type, quality: quality}).then((blb) => {\n                    try {\n                        resolve(new FileReaderSync().readAsDataURL(blb));\n                    } catch(e2) {\n                        var reader = new FileReader();\n                        reader.onload = function(){ resolve(reader.result)};\n                        reader.readAsDataURL(blb);\n                    }\n                });\n            });\n        });\n       \n    }catch (e) {\n    \n        return new Promise(function(resolve, _) {\n            var canvas = document.createElement("canvas");\n            canvas.width = imagedata.width;\n            canvas.height = imagedata.height;\n            var ctx = canvas.getContext("2d");\n            ctx.imageSmoothingEnabled = false;\n            ctx.putImageData(imagedata, 0, 0);\n            \n            var base64 = canvas.toDataURL(type, quality);\n            canvas = null;\n            resolve(base64);\n        });\n    }\n\n}; return t;')();e.exports={file_to_imagedata_resized:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Date.now(),e.type,"image/jpg"!==e.type&&e.type,e.type,s(e,(function(e){u(e,(function(e){_(e,t,(function(e){n(e)}),a)}),a)}),a)},file_to_base64:s,base64_to_bitmap:u,bitmap_to_imagedata:_,imagedata_to_base64:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;null!==a?a.exec(d,[e,t]).catch((function(n){return d(e,t)})).timeout(5e3).then((function(e){n(e)})):d(e,t).then((function(e){n(e)}))},base64_sanitize:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};(function(e,t,n){return n=n||"pixelize",new Promise((function(a,r){var o=new Image,l=e.startsWith("data:image/png;");o.onload=function(){var e,r,s=o.naturalWidth*t,c=o.naturalHeight*t,u=function(e,t,n,a){var r,o,l,s,c=void 0;if("pixelize"===a||"normal"===a){r=void 0,o=void 0;try{r=new OffscreenCanvas(e.width,e.height),o=new OffscreenCanvas(t,n)}catch(u){r=document.createElement("canvas"),o=document.createElement("canvas"),r.width=e.width,r.height=e.height,o.width=t,o.height=n}l=r.getContext("2d"),s=o.getContext("2d"),l.imageSmoothingEnabled=!("normal"!==a),s.imageSmoothingEnabled=!("normal"!==a),l.drawImage(e,0,0,e.width,e.height),s.drawImage(r,0,0,r.width,r.height,0,0,o.width,o.height),c=s}else"doppel"===a&&(c=i.scaler.processImage(e,t,n));return c}(o,0|s,0|c,n);try{e=u.getImageData(0,0,u.canvas.width,u.canvas.height),createImageBitmap(e).then((function(e){var t,n;try{t=new OffscreenCanvas(e.width,e.height)}catch(i){(t=document.createElement("canvas")).height=e.height,t.width=e.width}(n=t.getContext("bitmaprenderer")).imageSmoothingEnabled=!1,n.transferFromImageBitmap(e),t.convertToBlob({type:l?"image/png":"image/jpeg"}).then((function(e){try{a((new FileReaderSync).readAsDataURL(e))}catch(n){var t=new FileReader;t.onload=function(){a(t.result)},t.readAsDataURL(e)}}))}))}catch(_){r=u.canvas,a(r.toDataURL(l?"image/png":"image/jpeg"))}},o.onerror=function(){r()},o.src=e}))})(e,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,arguments[4]).then((function(e){t(e)}))},file_to_bitmap:function(e,t){createImageBitmap(e).then(t)}}},677:function(e,t,n){"use strict";var a,i=(a=n(678))&&a.__esModule?a:{default:a},r=new i.default({strength:1,overlapFactor:1,despeckleStrength:.88});e.exports={scaler:r,ImageProcessor:i.default}},678:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var i,r,o,l,s,c,u,_,d,h,f,p;Object.defineProperty(t,"__esModule",{value:!0}),i=function(){function e(e,t){var n,a;for(n=0;n<t.length;n++)(a=t[n]).enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(659),o=a(r),l=n(679),s=a(l),c=n(681),u=a(c),_=n(661),d=a(_),h=n(652),f=a(h),p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.o=t||{},this.canvas=d.default.initializeCanvas(void 0,1,1).canvas,this.targetCanvas=d.default.initializeCanvas(void 0,1,1).canvas,this.options={despeckleStrength:this.o.despeckleStrength||this.o.strength||1,quantizeStrength:this.o.quantizeStrength||this.o.strength||1,mergeStrength:this.o.mergeStrength||this.o.strength||1,overlapFactor:this.o.overlapFactor||this.o.strength||1}}return i(e,[{key:"updateFilters",value:function(e){this.filters=new u.default(this.options,this.tilesManager,e,this.finalWidth,this.finalHeight)}},{key:"computeSmartParameters",value:function(){var e,t,n,a,i,r,l,s;this.imageManager=new o.default(this.context),t=(e=this.imageManager.computePaletteData()).colorNumber,n=e.colorNumberCertainty,a=e.colorData,n>.25&&(this.options.quantizeStrength=t,r=(i=this.imageManager.analyzeImageForTileSize(a)).tileSize,l=i.certainty,s=Math.sqrt(this.tileWidth*this.tileHeight),console.log(l,r),4*r>s&&r<4*s&&(console.log("changeFinalCanvasParameters: "+(this.canvas.width/r|0)+"/"+(this.canvas.height/r|0)),this.changeFinalCanvasParameters(this.canvas.width/r|0,this.canvas.height/r|0)))}},{key:"updateTiles",value:function(){this.tilesManager=new s.default(this.context,this.targetContext,this.targetImageData,this.sizes),this.tilesManager.createTiles(),this.tilesManager.computeTiles()}},{key:"paintTiles",value:function(){this.tilesManager.paintTiles()}},{key:"filterTiles",value:function(){this.filters.applyFilters()}},{key:"setCanvas",value:function(e,t,n){var a,i;e=0|e||1,t=0|t||1,n=n||{width:0,height:0},a=d.default.initializeCanvas(n),this.canvas=a.canvas,this.context=a.context,i=d.default.initializeCanvas(void 0,e,t),this.targetCanvas=i.canvas,this.targetContext=i.context,this.targetImageData=this.targetContext.getImageData(0,0,e,t),this.finalWidth=e,this.finalHeight=t,this.tileWidth=Math.fround(this.canvas.width/this.targetCanvas.width),this.tileHeight=Math.fround(this.canvas.height/this.targetCanvas.height)}},{key:"changeFinalCanvasParameters",value:function(e,t){e=0|e||1,t=0|t||1;var n=d.default.initializeCanvas(void 0,e,t);this.targetCanvas=n.canvas,this.targetContext=n.context,this.targetImageData=this.targetContext.getImageData(0,0,e,t),this.finalWidth=e,this.finalHeight=t,this.tileWidth=Math.fround(this.canvas.width/this.targetCanvas.width),this.tileHeight=Math.fround(this.canvas.height/this.targetCanvas.height)}},{key:"updateThreshold",value:function(){var e,t,n,a,i,r=this,o=this.tilesManager.getTiles(),l=[];for(e=0;e<this.finalHeight;e++)for(t=function(t){var n=o[t+e*r.finalWidth];r.tilesManager.getExtendedNeighbors(t,e,1).forEach((function(e){l.push(f.default.colorDifference(n.meanColor,e.meanColor))}))},n=0;n<this.finalWidth;n++)t(n);return a=l.reduce((function(e,t){return e+t}),0)/l.length,i=Math.sqrt(l.map((function(e){return Math.pow(e-a,2)})).reduce((function(e,t){return e+t}))/l.length),(a+i)/25}},{key:"processImage",value:function(e,t,n){var a,i,r,o,l,s,c,u=Date.now();return this.setCanvas(t,n,e),e.width<=t&&e.height<=n?this.context:(a=Date.now(),this.computeSmartParameters(),i=Date.now(),this.updateTiles(),r=Date.now(),this.updateFilters(this.updateThreshold()),o=Date.now(),this.filterTiles(),l=Date.now(),this.paintTiles(),s=Date.now(),console.log({setCanvas:a-u,updateTilesManager:i-a,initializeTiles:r-i,"updateFilters+updateThreshold":o-r,filterTiles:l-o,paintTiles:s-o}),c=this.targetContext,this.reset(),c)}},{key:"reset",value:function(){var e=this;Array.of("targetContext","tileHeight","tileWidth","finalWidth","finalHeight","targetImageData","targetContext","targetCanvas","context","canvas","tilesManager","filters","imageManager").forEach((function(t){delete e[t]})),this.canvas=d.default.initializeCanvas(void 0,1,1).canvas,this.targetCanvas=d.default.initializeCanvas(void 0,1,1).canvas}},{key:"sizes",get:function(){return{finalWidth:this.finalWidth,finalHeight:this.finalHeight,tileWidth:this.tileWidth,tileHeight:this.tileHeight,overlapFactor:this.options.overlapFactor}}}]),e}(),t.default=p},679:function(e,t,n){"use strict";var a,i,r,o,l;Object.defineProperty(t,"__esModule",{value:!0}),a=function(){function e(e,t){var n,a;for(n=0;n<t.length;n++)(a=t[n]).enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(680),r=(l=i)&&l.__esModule?l:{default:l},o=function(){function e(t,n,a,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.contextSource=t,this.contextDestination=n,this.imageData=a,this.overlapFactor=i.overlapFactor,this.finalWidth=i.finalWidth,this.finalHeight=i.finalHeight,this.tileWidth=i.tileWidth,this.tileHeight=i.tileHeight,this.tiles=Array(this.finalWidth*this.finalHeight).fill(null),this.tilesColorUint32a=new Uint32Array(this.finalWidth*this.finalHeight),this.tilesColorUint8a=new Uint8ClampedArray(this.tilesColorUint32a.buffer),this.extendedTileWidth=this.tileWidth*this.overlapFactor|0,this.extendedTileHeight=this.tileHeight*this.overlapFactor|0,this.tilePaddingWidth=(this.extendedTileWidth-this.tileWidth)/2+1|0,this.tilePaddingHeight=(this.extendedTileHeight-this.tileHeight)/2+1|0}return a(e,[{key:"getTiles",value:function(){return this.tiles}},{key:"extractTileData",value:function(e,t){var n=Math.max(0,e*this.tileWidth-this.tilePaddingWidth|0),a=Math.max(0,t*this.tileHeight-this.tilePaddingHeight|0);return this.contextSource.getImageData(0|n,0|a,0|this.extendedTileWidth,0|this.extendedTileHeight)}},{key:"createTiles",value:function(){var e,t,n,a;for(e=0;e<this.finalHeight;e++)for(t=0;t<this.finalWidth;t++)a=4*(n=t+e*this.finalWidth),this.tiles[n]=new r.default(this.extractTileData(t,e),this.tilesColorUint8a.subarray(a,a+4),t,e)}},{key:"computeTiles",value:function(){for(var e=0;e<this.tiles.length;e++)this.tiles[e].calculateMeanColor()}},{key:"getExtendedNeighbors",value:function(e,t,n){var a,i,r,o,l=[];for(a=-n;a<=n;a++)for(i=-n;i<=n;i++)r=e+a,o=t+i,0===a&&0===i||r<0||o<0||r>=this.finalWidth||o>=this.finalHeight||l.push(this.tiles[r+o*this.finalWidth]);return l}},{key:"paintTiles",value:function(){this.imageData.data.set(this.tilesColorUint8a),this.contextDestination.putImageData(this.imageData,0,0)}}]),e}(),t.default=o},680:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var i,r,o,l,s,c;Object.defineProperty(t,"__esModule",{value:!0}),i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n,a,i=[],r=!0,o=!1,l=void 0;try{for(n=e[Symbol.iterator]();!(r=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);r=!0);}catch(s){o=!0,l=s}finally{try{!r&&n.return&&n.return()}finally{if(o)throw l}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function e(e,t){var n,a;for(n=0;n<t.length;n++)(a=t[n]).enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(651),l=a(o),a(n(660)),s=n(654),c=function(){function e(t,n){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.imageData=t,this.meanColor=new l.default(n),this.coordinates=Uint16Array.of(i,r),a=this.imageData.data.length,this.k=a>=64?8:a>=16?6:a>=9?4:a>=2?3:1}return r(e,[{key:"extractColorData",value:function(e){var t,n=Array(e.length/4);for(t=0;t<e.length;t+=4)n[t/4]=e.subarray(t,t+4);return n}},{key:"quantizeColors",value:function(){var e,t=s.QuantiMat.split_image_data(this.imageData),n=i(t,2),a=n[0],r=n[1],o=(0,s.QuantiMat)({pxls:a,pxl_colors:r,number_of_color:Math.min(r.length,this.k),width:this.imageData.width,height:this.imageData.height}).init().run().output("split"),l=o[0],c=o[1],u=new Uint32Array(c.length);for(e=0;e<l.length;e++)u[c.indexOf(c[l[e]])]++;return[u,c]}},{key:"calculateMeanColor",value:function(){var e=this.quantizeColors(),t=i(e,2),n=t[0],a=t[1][n.indexOf(Math.max.apply(Math,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(Array.from(n))))];this.meanColor.setUint32(a)}},{key:"x",get:function(){return this.coordinates[0]}},{key:"y",get:function(){return this.coordinates[1]}}]),e}(),t.default=c},681:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var i,r,o,l,s,c,u,_;Object.defineProperty(t,"__esModule",{value:!0}),i=function(){function e(e,t){var n,a;for(n=0;n<t.length;n++)(a=t[n]).enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(682),o=a(r),l=n(683),s=a(l),c=n(684),u=a(c),_=function(){function e(t,n,a,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mergeFilter=new o.default(a*t.mergeStrength,n,i,r),this.despeckleFilter=new s.default(a*t.despeckleStrength,n,i,r),this.quantizeFilter=new u.default(t.quantizeStrength,n,i,r)}return i(e,[{key:"applyFilters",value:function(){this.quantizeFilter.apply()}}]),e}(),t.default=_},682:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var i,r,o,l,s;Object.defineProperty(t,"__esModule",{value:!0}),i=function(){function e(e,t){var n,a;for(n=0;n<t.length;n++)(a=t[n]).enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=a(n(655)),o=n(652),l=a(o),s=function(e){function t(e,n,a,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,a,i))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"apply",value:function(){var e,t,n,a=this,i=Array(this.width*this.height).fill(!1);for(e=0;e<this.height;e++)for(t=function(t){var n,r,o,s,c=t+e*a.width;if(i[c])return"continue";n=a.tiles[c],o=(r=a.tilesManager.getExtendedNeighbors(t,e,1)).length,(s=r.filter((function(e){return l.default.colorDifference(n.meanColor,e.meanColor)<a.strength}))).length>=o-2&&(s.forEach((function(e){e.meanColor.setRGBA(n.meanColor.rgba);var t=e.x+e.y*a.width;i[t]=!0})),i[c]=!0)},n=0;n<this.width;n++)t(n)}}]),t}(r.default),t.default=s},683:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var i,r,o,l,s,c,u,_,d;Object.defineProperty(t,"__esModule",{value:!0}),i=function(){function e(e,t){var n,a;for(n=0;n<t.length;n++)(a=t[n]).enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=a(n(655)),o=n(652),l=a(o),s=n(651),c=a(s),u=n(660),_=a(u),d=function(e){function t(e,n,a,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,a,i))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"apply",value:function(){var e,t;for(e=0;e<this.height;e++)for(t=0;t<this.width;t++)this.adaptiveDespeckleTile(t,e,this.strength)}},{key:"adaptiveDespeckleTile",value:function(e,t,n){var a,i,r,o,s,u,d,h,f=this.tiles[e+t*this.width].meanColor,p=this.tilesManager.getExtendedNeighbors(e,t,4),m=this.tilesManager.getExtendedNeighbors(e,t,1),g=p.length,v=p.map((function(e){return e.meanColor})),y=new _.default(v.map((function(e){return e.rgba})),4).run(g),b=(y.centroids,y.centroidsSorted);switch(y.clusters,this.determineClassification(b,g)){case"AREA":a=new c.default(b[0].data),(i=l.default.colorDifference(a,f))>0&&i<60&&f.setRGBA(a.rgba);break;case"EDGE":r=new c.default(b[0].data),o=new c.default(b[1].data),s=l.default.colorDifference(r,o),u=l.default.colorDifference(r,f),d=l.default.colorDifference(o,f),5*Math.abs(u-d)>=s&&(h=new c.default(new _.default(m.map((function(e){return e.meanColor.rgba})),4).run(4).centroidsSorted[0].data),f.setRGBA(h.rgba))}}},{key:"determineClassification",value:function(e,t){return e[0].count>=.75*t?"AREA":Math.abs(e[0].count-e[1].count)*Math.abs(e[2].count-e[3].count)<25?"SHAPE":Math.abs(e[0].count-e[1].count)<.75*Math.abs(e[1].count-e[2].count)?"EDGE":"COMPLEX"}}]),t}(r.default),t.default=d},684:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var i,r,o,l,s,c,u;Object.defineProperty(t,"__esModule",{value:!0}),i=function(){function e(e,t){var n,a;for(n=0;n<t.length;n++)(a=t[n]).enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=a(n(655)),o=n(659),l=a(o),s=n(661),c=a(s),u=function(e){function t(e,n,a,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,a,i))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"apply",value:function(){var e=this.strength,t=new ImageData(this.tilesManager.tilesColorUint8a,this.width,this.height),n=c.default.initializeCanvas(t).context,a=l.default.quantizeImageData(n,e).imageData;this.tilesManager.tilesColorUint8a.set(a.data)}}]),t}(r.default),t.default=u},691:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var i=a(n(734)),r=a(n(259));e.exports={UJS:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"COMPRESS_OBJECT";return new Promise((function(n,a){"COMPRESS_OBJECT"===t?n(new Uint8ClampedArray(i.default.compress(r.default.pack(e)).buffer)):"DECOMPRESS_UINT8A"===t&&n(r.default.unpack(i.default.uncompress(e)))}))}}},822:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var i=a(n(657)),r=a(n(155)),o=a(n(823));e.exports={base64png_to_xbrz_svg:function(e,t,a,l){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"xbrz",u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],_=arguments.length>7&&void 0!==arguments[7]&&arguments[7],d=arguments.length>8&&void 0!==arguments[8]&&arguments[8],h=new Image;h.onload=function(){var e,f,p,m,g,v,y,b,w,x,k=document.createElement("canvas"),E=k.getContext("2d"),C=h.width,S=h.height;k.width=C,k.height=S,E.drawImage(h,0,0,C,S),e=E.getImageData(0,0,C,S),f=function(e,t){return new Promise((function(t,a){(0,r.default)((function(){return n.e(3).then(n.t.bind(null,719,7))})).then((function(n){(0,n.crt)(e,1).then(t).catch(a)}))}))},p=function(e,t,a,o,l){u?(0,r.default)((function(){return n.e(1).then(n.t.bind(null,665,7))})).then((function(s){(0,s.oxi_png)(e,3,!1,i.default).then((function(e){l(e,t,a,o)})).catch((function(){(0,r.default)((function(){return n.e(0).then(n.t.bind(null,656,7))})).then((function(n){(0,n.png_quant)(e,100,100,1,i.default).then((function(e){l(e,t,a,o)})).catch((function(){l(e,t,a,o)}))})).catch((function(){l(e,t,a,o)}))}))})).catch((function(){l(e,t,a,o)})):l(e,t,a,o)},m=function(e,t){_?(0,r.default)((function(){return n.e(22).then(n.t.bind(null,939,7))})).then((function(o){(0,o.image_tracer)(e,{pal:s.map((function(e){return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:parseInt(e.slice(7,9),16)}})),corsenabled:!1,ltres:t,qtres:t,pathomit:t,rightangleenhance:!1,colorsampling:2,numberofcolors:512,mincolorratio:0,colorquantcycles:1,layering:0,strokewidth:Math.ceil(t/2),linefilter:!0,scale:1,roundcoords:2,viewbox:!0,desc:!1,lcpr:0,qcpr:0,blurradius:t,blurdelta:4*t},i.default).then((function(e){u?(0,r.default)((function(){return n.e(2).then(n.bind(null,689))})).then((function(n){var i=n.optimize;e=i(e,{path:"path-to.svg",multipass:!0,mergePaths:!0,mergeStyles:!0,collapseGroups:!0,reusePaths:!0,plugin:["multipass","mergePaths","collapseGroups","reusePaths","mergeStyles"]}).data,a("data:image/svg+xml;base64,"+window.btoa(e),t)})):a("data:image/svg+xml;base64,"+window.btoa(e),t)}))})):a("",0)},"depixelize"===c?(v=(g=(0,o.default)(e,_))[0],y=g[1],(b=document.createElement("canvas")).width=v.width,b.height=v.height,(w=b.getContext("2d")).putImageData(v,0,0),x=w.canvas.toDataURL("image/png"),d&&f(v).then((function(e){var t,n=document.createElement("canvas");n.width=e.width,n.height=e.height,n.getContext("2d").putImageData(e,0,0),t=n.toDataURL("image/png"),p(t,10,e.width,e.height,l)})),_&&(u?(0,r.default)((function(){return n.e(2).then(n.bind(null,689))})).then((function(e){var t=e.optimize;y=t(y,{path:"path-to.svg",multipass:!0,plugin:["mergePaths"]}).data,a("data:image/svg+xml;base64,"+window.btoa(y),10)})):a("data:image/svg+xml;base64,"+window.btoa(y),10)),p(x,10,v.width,v.height,t)):"omniscale"===c?(0,r.default)((function(){return n.e(23).then(n.t.bind(null,940,7))})).then((function(n){(0,n.omniscale)(e,8,i.default).then((function(e){var n,a,i=document.createElement("canvas");i.width=e.width,i.height=e.height,(n=i.getContext("2d")).putImageData(e,0,0),a=n.canvas.toDataURL("image/png"),d&&f(e).then((function(e){var t,n=document.createElement("canvas");n.width=e.width,n.height=e.height,n.getContext("2d").putImageData(e,0,0),t=n.toDataURL("image/png"),p(t,8,e.width,e.height,l)})),m(e,8),p(a,8,e.width,e.height,t)}))})):"hexagon"===c?(0,r.default)((function(){return n.e(6).then(n.t.bind(null,720,7))})).then((function(n){(0,n.hexagonrender)(e,16).then((function(e){var n,a,i=document.createElement("canvas");i.width=e.width,i.height=e.height,(n=i.getContext("2d")).putImageData(e,0,0),a=n.canvas.toDataURL("image/png"),d&&f(e).then((function(e){var t,n=document.createElement("canvas");n.width=e.width,n.height=e.height,n.getContext("2d").putImageData(e,0,0),t=n.toDataURL("image/png"),p(t,16,e.width,e.height,l)})),m(e,32/6),p(a,32,e.width,e.height,t)}))})):"kikko"===c?(0,r.default)((function(){return n.e(39).then(n.t.bind(null,941,7))})).then((function(n){(0,n.kikkorender)(e,24,i.default).then((function(e){var n,a,i=document.createElement("canvas");i.width=e.width,i.height=e.height,(n=i.getContext("2d")).putImageData(e,0,0),a=n.canvas.toDataURL("image/png"),d&&f(e).then((function(e){var t,n=document.createElement("canvas");n.width=e.width,n.height=e.height,n.getContext("2d").putImageData(e,0,0),t=n.toDataURL("image/png"),p(t,24,e.width,e.height,l)})),m(e,6),p(a,48,e.width,e.height,t)}))})):"hqnx"===c?(0,r.default)((function(){return n.e(21).then(n.t.bind(null,942,7))})).then((function(n){(0,n.hqnx)(e,4,i.default).then((function(e){var n,a,i=document.createElement("canvas");i.width=e.width,i.height=e.height,(n=i.getContext("2d")).putImageData(e,0,0),a=n.canvas.toDataURL("image/png"),d&&f(e).then((function(e){var t,n=document.createElement("canvas");n.width=e.width,n.height=e.height,n.getContext("2d").putImageData(e,0,0),t=n.toDataURL("image/png"),p(t,4,e.width,e.height,l)})),m(e,4),p(a,4,e.width,e.height,t)}))})):"epx"===c?(0,r.default)((function(){return n.e(20).then(n.t.bind(null,943,7))})).then((function(n){(0,n.epx)(e,4,i.default).then((function(e){var n,a,i=document.createElement("canvas");i.width=e.width,i.height=e.height,(n=i.getContext("2d")).putImageData(e,0,0),a=n.canvas.toDataURL("image/png"),d&&f(e).then((function(e){var t,n=document.createElement("canvas");n.width=e.width,n.height=e.height,n.getContext("2d").putImageData(e,0,0),t=n.toDataURL("image/png"),p(t,4,e.width,e.height,l)})),m(e,4),p(a,4,e.width,e.height,t)}))})):(0,r.default)((function(){return n.e(4).then(n.t.bind(null,721,7))})).then((function(n){n.default(e,6,i.default).then((function(e){var n,a,i=document.createElement("canvas");i.width=e.width,i.height=e.height,(n=i.getContext("2d")).putImageData(e,0,0),a=n.canvas.toDataURL("image/png"),d&&f(e).then((function(e){var t,n=document.createElement("canvas");n.width=e.width,n.height=e.height,n.getContext("2d").putImageData(e,0,0),t=n.toDataURL("image/png"),p(t,6,e.width,e.height,l)})),m(e,6),p(a,6,e.width,e.height,t)}))}))},h.src=e}}},823:function(e,t,n){"use strict";function a(e){return a="function"==typeof Symbol&&"symbol"==v(Symbol.iterator)?function(e){return void 0===e?"undefined":v(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":v(e)},a(e)}function i(){function e(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}function t(e,t,n,a){var i=t&&t.prototype instanceof r?t:r,o=Object.create(i.prototype),l=new f(a||[]);return b(o,"_invoke",{value:u(e,n,l)}),o}function n(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(a){return{type:"throw",arg:a}}}function r(){}function o(){}function l(){}function s(t){["next","throw","return"].forEach((function(n){e(t,n,(function(e){return this._invoke(n,e)}))}))}function c(e,t){function i(r,o,l,s){var c,u,_=n(e[r],e,o);if("throw"!==_.type)return(u=(c=_.arg).value)&&"object"==a(u)&&y.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,l,s)}),(function(e){i("throw",e,l,s)})):t.resolve(u).then((function(e){c.value=e,l(c)}),(function(e){return i("throw",e,l,s)}));s(_.arg)}var r;b(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){i(e,n,t,a)}))}return r=r?r.then(a,a):a()}})}function u(e,t,a){var i="suspendedStart";return function(r,o){var l,s,c;if("executing"===i)throw Error("Generator is already running");if("completed"===i){if("throw"===r)throw o;return{value:void 0,done:!0}}for(a.method=r,a.arg=o;;){if((l=a.delegate)&&(s=_(l,a))){if(s===C)continue;return s}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===i)throw i="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);if(i="executing","normal"===(c=n(e,t,a)).type){if(i=a.done?"completed":"suspendedYield",c.arg===C)continue;return{value:c.arg,done:a.done}}"throw"===c.type&&(i="completed",a.method="throw",a.arg=c.arg)}}}function _(e,t){var a,i,r=t.method,o=e.iterator[r];return void 0===o?(t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),C):"throw"===(a=n(o,e.iterator,t.arg)).type?(t.method="throw",t.arg=a.arg,t.delegate=null,C):(i=a.arg)?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,C):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,C)}function d(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function h(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function f(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(d,this),this.reset(!0)}function p(e){var t,n,a;if(e){if(t=e[x])return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return n=-1,(a=function t(){for(;++n<e.length;)if(y.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t}).next=a}return{next:m}}function m(){return{value:void 0,done:!0}}var g,v,y,b,w,x,k,E,C,S,O,T,I;i=function(){return g},g={},y=(v=Object.prototype).hasOwnProperty,b=Object.defineProperty||function(e,t,n){e[t]=n.value},w="function"==typeof Symbol?Symbol:{},x=w.iterator||"@@iterator",k=w.asyncIterator||"@@asyncIterator",E=w.toStringTag||"@@toStringTag";try{e({},"")}catch(M){e=function(e,t,n){return e[t]=n}}return g.wrap=t,C={},e(S={},x,(function(){return this})),(T=(O=Object.getPrototypeOf)&&O(O(p([]))))&&T!==v&&y.call(T,x)&&(S=T),I=l.prototype=r.prototype=Object.create(S),o.prototype=l,b(I,"constructor",{value:l,configurable:!0}),b(l,"constructor",{value:o,configurable:!0}),o.displayName=e(l,E,"GeneratorFunction"),g.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===o||"GeneratorFunction"===(t.displayName||t.name))},g.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,e(t,E,"GeneratorFunction")),t.prototype=Object.create(I),t},g.awrap=function(e){return{__await:e}},s(c.prototype),e(c.prototype,k,(function(){return this})),g.AsyncIterator=c,g.async=function(e,n,a,i,r){void 0===r&&(r=Promise);var o=new c(t(e,n,a,i),r);return g.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},s(I),e(I,E,"Generator"),e(I,x,(function(){return this})),e(I,"toString",(function(){return"[object Generator]"})),g.keys=function(e){var t,n=Object(e),a=[];for(t in n)a.push(t);return a.reverse(),function e(){for(;a.length;){var t=a.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},g.values=p,f.prototype={constructor:f,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(h),!e)for(var t in this)"t"===t.charAt(0)&&y.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){function t(t,a){return r.type="throw",r.arg=e,n.next=t,a&&(n.method="next",n.arg=void 0),!!a}var n,a,i,r,o,l;if(this.done)throw e;for(n=this,a=this.tryEntries.length-1;a>=0;--a){if(i=this.tryEntries[a],r=i.completion,"root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev)if(o=y.call(i,"catchLoc"),l=y.call(i,"finallyLoc"),o&&l){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(o){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}},abrupt:function(e,t){var n,a,i,r;for(n=this.tryEntries.length-1;n>=0;--n)if((a=this.tryEntries[n]).tryLoc<=this.prev&&y.call(a,"finallyLoc")&&this.prev<a.finallyLoc){i=a;break}return i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null),(r=i?i.completion:{}).type=e,r.arg=t,i?(this.method="next",this.next=i.finallyLoc,C):this.complete(r)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),C},finish:function(e){var t,n;for(t=this.tryEntries.length-1;t>=0;--t)if((n=this.tryEntries[t]).finallyLoc===e)return this.complete(n.completion,n.afterLoc),h(n),C},catch:function(e){var t,n,a,i;for(t=this.tryEntries.length-1;t>=0;--t)if((n=this.tryEntries[t]).tryLoc===e)return"throw"===(a=n.completion).type&&(i=a.arg,h(n)),i;throw Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:p(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),C}},g}function r(e,t){var n,a,i,r,o,l="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!l){if(Array.isArray(e)||(l=d(e))||t&&e&&"number"==typeof e.length)return l&&(e=l),n=0,{s:a=function(){},n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return i=!0,r=!1,{s:function(){l=l.call(e)},n:function(){var e=l.next();return i=e.done,e},e:function(e){r=!0,o=e},f:function(){try{i||null==l.return||l.return()}finally{if(r)throw o}}}}function o(e){var t="function"==typeof Map?new Map:void 0;return o=function(e){function n(){return l(e,arguments,u(this).constructor)}if(null===e||(a=e,-1===Function.toString.call(a).indexOf("[native code]")))return e;var a;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),c(n,e)},o(e)}function l(e,t,n){return l=s()?Reflect.construct.bind():function(e,t,n){var a,i=[null];return i.push.apply(i,t),a=new(Function.bind.apply(e,i)),n&&c(a,n.prototype),a},l.apply(null,arguments)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,a,i,r,o,l,s,c=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=c){o=[],l=!0,s=!1;try{if(i=(c=c.call(e)).next,0===t){if(Object(c)!==c)return;l=!1}else for(;!(l=(n=i.call(c)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(u){s=!0,a=u}finally{try{if(!l&&null!=c.return&&(r=c.return(),Object(r)!==r))return}finally{if(s)throw a}}return o}}(e,t)||d(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){var n,i,r;for(n=0;n<t.length;n++)(i=t[n]).enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(r=function(e,t){var n,i;if("object"!==a(e)||null===e)return e;if(void 0!==(n=e[Symbol.toPrimitive])){if("object"!==a(i=n.call(e,"string")))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return e+""}(i.key),"symbol"===a(r)?r:r+""),i)}function m(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function g(e){var t=e.length;return e.forEach((function(e,n,a){e.addEdge(a[(n+1)%t])})),e}var v,y,b;Object.defineProperty(t,"__esModule",{value:!0}),v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y=function(){function e(e,t,n){return[d(e,t,n),h(e,t,n),d(e,t+1,n),h(e,t,n+1)]}function t(e,t,n,a,i){var r,o=Array(i);for(r=0;r<i;++r)o[r]=e[r+n].slice(t,t+a);return o}function n(){this.vertices=[]}var l,d,h,p,g,v,y,b,w,x=function(){function e(t){var n,a=_(t,3),i=a[0],r=a[1],o=a[2];f(this,e),n=.299*i+.587*r+.114*o,this.y=Math.round(n),this.u=Math.round(.492*(o-n)),this.v=Math.round(.877*(i-n)),this.r=i,this.g=r,this.b=o,this.rgb=[i,r,o]}return m(e,[{key:"dissimilar",value:function(e){return Math.abs(this.r-e.r)+Math.abs(this.g-e.g)+Math.abs(this.b-e.b)>=1}},{key:"toString",value:function(){return"rgb("+this.rgb.join()+")"}}]),e}(),k=function(){function e(t,n){f(this,e),this.x=t,this.y=n,this.edges=[]}return m(e,[{key:"split",value:function(t){return new e((this.x+t.x)/2,(this.y+t.y)/2)}},{key:"adjust",value:function(e,t){return this.x+=e,this.y+=t,this}},{key:"clone",value:function(){return new e(this.x,this.y)}},{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y}},{key:"addEdge",value:function(e){-1==this.edges.indexOf(e)&&(this.edges.push(e),e.addEdge(this))}}]),e}(),E=function(e){function t(e){var n;return f(this,t),(n=o.call(this,1))[0]=e,n.circular=!1,n}!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(t,e);var n,i,o=(n=t,i=s(),function(){var e,t,r=u(n);return i?(t=u(this).constructor,e=Reflect.construct(r,arguments,t)):e=r.apply(this,arguments),function(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});return m(t,[{key:"splitAt",value:function(e){var n,a,i,o,l;if(1!==this.length){if(this[0]===e)this.shift();else if(this[this.length-1]===e)this.pop();else if(this.circular)for(n=this.shift();n!==e;n=this.shift())this.push(n);else{a=this.indexOf(e),o=r(i=this.slice(a+1));try{for(o.s();!(l=o.n()).done;)l.value.curve=i}catch(s){o.e(s)}finally{o.f()}this.length=a}e.curve=new t(e)}}},{key:"merge",value:function(e){var t,n,a,i,r,o;if(this!==e)for(n=(t=_([this,e].sort((function(e,t){return e.length-t.length})),2))[0],-1!==(a=t[1])[0].edges.indexOf(n[0])?(i=this.shift,r=this.unshift):-1!==a[0].edges.indexOf(n[n.length-1])?(i=this.pop,r=this.unshift):-1!==a[a.length-1].edges.indexOf(n[0])?(i=this.shift,r=this.push):-1!==a[a.length-1].edges.indexOf(n[n.length-1])&&(i=this.pop,r=this.push);n.length;)o=i.call(n),r.call(a,o),o.curve=a;else this.circular=e.length>2}}],[{key:"curve",value:function(e,t){return e.curve===t.curve?e.curve.length:0}}]),t}(o(Array)),C=function(){function e(t,n,a,i){f(this,e),this.x=t,this.y=n,this.edges=[,,,,,,,,],this.vertices=i||[],this.color=a,this.marked=!1,this.curve=new E(this)}return m(e,[{key:"relativePosition",value:function(e){var t=e.x,n=e.y-this.y;return(t-this.x+3*n+8)%9}},{key:"invalidCurve",value:function(){return this.valence()>2&&this.curve.length>1}},{key:"updateCurves",value:function(){this.valence()>2&&this.curve.splitAt(this)}},{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y}},{key:"removeEdge",value:function(t){e.removeEdge(this,t)}},{key:"canReach",value:function(e){return e&&!!this.edges[this.relativePosition(e)]}},{key:"valence",value:function(){return this.edges.filter((function(e){return e})).length}},{key:"toString",value:function(){return"("+[this.x,this.y].join()+") => "+this.edges.filter((function(e){return e})).map((function(e){return"("+[e.x,e.y].join()+")"})).join()}},{key:"edge",value:function(e,t){return this.edges[(e+3*t+8)%9]}},{key:"right",value:function(){return this.edges[0]}},{key:"left",value:function(){return this.edges[7]}},{key:"up",value:function(){return this.edges[5]}},{key:"down",value:function(){return this.edges[2]}},{key:"isEdge",value:function(){return this.edges.filter((function(e){return e})).length<4}},{key:"follow",value:i().mark((function e(t){var n,a,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this;case 1:if(!(n.canReach(t)&&n.valence()<3)){e.next=14;break}return e.next=4,t;case 4:if(!(t.valence()>2)){e.next=6;break}return e.abrupt("break",14);case 6:if(a=t.edges.filter((function(e){return e})),r=a[0]!=n?a[0]:a[1],n=t,(t=r)!=this){e.next=12;break}return e.abrupt("break",14);case 12:e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"square",value:function(){var e=_(this.edges,3),t=e[0],n=e[2],a=t&&n&&t.down()&&n.right();return[this,t,n,a].filter((function(e){return e}))}}],[{key:"addSimilarEdge",value:function(e,t){e.color&&t.color&&!e.color.dissimilar(t.color)&&(e.edges[e.relativePosition(t)]=t,t.edges[t.relativePosition(e)]=e,e.valence()>2&&e.curve.splitAt(e),t.valence()>2&&t.curve.splitAt(t),e.valence()<3&&t.valence()<3&&e.curve.merge(t.curve))}},{key:"removeEdge",value:function(e,t){e.edges[e.relativePosition(t)]=void 0,t.edges[t.relativePosition(e)]=void 0}}]),e}(),S=function(){function e(t,n,a){if(f(this,e),t.length!=n*a*4)throw Error("Wrong dimension of pixel buffer");this.width=n,this.height=a,this.pixels=t}return m(e,[{key:"create",value:i().mark((function e(){var t,n,a,r,o,l,s,c,u,_,d,h,f,p,m;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=this.width,n=this.height,a=Array(n),(r=Array(n+1))[0]=Array(t+1),o=0;o<t+1;++o)r[0][o]=new k(o,0);l=new C,s=Array(t).fill(l),o=0;case 9:if(!(o<n)){e.next=31;break}c=[l,l],u=a[o]=Array(t),_=r[o],(d=r[o+1]=Array(t+1))[0]=new k(0,o+1),h=0;case 16:if(!(h<t)){e.next=27;break}return d[h+1]=new k(h+1,o+1),f=[_[h],_[h+1],d[h+1],d[h]],p=u[h]=new C(h,o,this.pixel(h,o),f),m=[s[h],p],e.next=23,[c,m];case 23:c=m;case 24:++h,e.next=16;break;case 27:s=u;case 28:++o,e.next=9;break;case 31:this.nodes_old=a,this.vertices=a;case 33:case"end":return e.stop()}}),e,this)}))},{key:"createSimilarityGraph",value:function(){var e,t,n,a,i,o,l,s,c=r(this.create());try{for(c.s();!(e=c.n()).done;)t=_(e.value,2),a=(n=_(t[0],2))[0],i=n[1],l=(o=_(t[1],2))[0],s=o[1],C.addSimilarEdge(l,s),C.addSimilarEdge(i,s),4!==a.square().length&&(C.addSimilarEdge(l,i),C.addSimilarEdge(a,s))}catch(u){c.e(u)}finally{c.f()}return this}},{key:"graph",value:function(){this.height,this.width}},{key:"nodes",value:i().mark((function(){var e,t,n,a,r;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:n=this.width,a=this.height,r=this.nodes_old,t=0;case 2:if(!(t<a)){i.next=13;break}e=0;case 4:if(!(e<n)){i.next=10;break}return i.next=7,r[t][e];case 7:++e,i.next=4;break;case 10:++t,i.next=2;break;case 13:case"end":return i.stop()}}),r,this)}))},{key:"diagonals",value:i().mark((function e(){var t,n,a,r,o,l,s,c,u,_,d;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=this.width,l=this.height,s=this.nodes_old,n=1;case 2:if(!(n<l)){e.next=22;break}a=s[n-1],r=s[n],t=1;case 6:if(!(t<o)){e.next=19;break}if(c=a[t-1],u=a[t],_=r[t-1],d=r[t],!(c.canReach(u)||c.canReach(_)||d.canReach(u)||d.canReach(_))){e.next=13;break}return e.abrupt("continue",16);case 13:if(!c.canReach(d)||!u.canReach(_)){e.next=16;break}return e.next=16,[[c,d],[_,u]];case 16:++t,e.next=6;break;case 19:++n,e.next=2;break;case 22:case"end":return e.stop()}}),e,this)}))},{key:"pixel",value:function(e,t){var n=t*this.width*4+4*e;return new x(this.pixels.subarray(n,n+3))}}]),e}();return S.diagonals=function(e){return e[0][0].canReach(e[0][1])+e[1][0].canReach(e[1][1])},d=(l=function(e,t){var n=e,a=t;return function(e,t,i){return[e[i][t],e[i+a][t+n]]}})(0,1),h=l(1,0),p=l(1,1),g=l(1,-1),S.prototype.getDiagonals=function(e,t){return[p(this.nodes_old,e,t),g(this.nodes_old,e,t+1)]},v=function(e){return e[0].canReach(e[1])},y=function(e){return!e},b=function(e,t,n,a){return function(i){var r,o;for(i=i[0].edges.filter((function(e){return e})),r=[];i.length>0;)o=i.pop(),-1==r.indexOf(o)&&o.x>e&&o.x<t&&o.y>n&&o.y<a&&(r.push(o),i=i.concat(o.edges.filter((function(e){return e}))));return r}},S.prototype.linearize=function(){var t,n,a,i,r,o,l,s,c;for(t=1;t<this.width;++t)for(n=1;n<this.height;++n)e(this.nodes_old,t-1,n-1).map(v).every(y)&&(i=[0,0],r=(a=this.getDiagonals(t-1,n-1)).map(b(t-3,t+2,n-3,n+2)),(l=(o=a.map((function(e){return E.curve(e[0],e[1])})))[0]-o[1])>0?i[0]+=l:i[1]-=l,(s=r[0].length-r[1].length)>0?i[1]+=s:i[0]-=s,(c=a.map((function(e){return 1==e[0].valence()||1==e[1].valence()})))[0]&&!c[1]?i[0]+=5:!c[0]&&c[1]&&(i[1]+=5),i[0]>i[1]?C.removeEdge(a[1][0],a[1][1]):i[0]<i[1]?C.removeEdge(a[0][0],a[0][1]):(C.removeEdge(a[0][0],a[0][1]),C.removeEdge(a[1][0],a[1][1])));return this},w=function(e){var t,n,a,i=e[0][1];i.edge(-1,1)&&(a=(n=(t=i.vertices)[3]).clone(),i.down()||n.adjust(.25,.25),i.left()||a.adjust(-.25,-.25),e[0][0].vertices[2]=a,t.splice(4,0,a),a=(t=e[1][0].vertices).splice(0,1,a).pop(),t.push(a)),i.edge(1,1)&&(a=(n=(t=i.vertices)[2]).clone(),i.down()||n.adjust(-.25,.25),i.right()||a.adjust(.25,-.25),e[0][2].vertices[3]=a,t.splice(2,0,a),a=(t=e[1][2].vertices).splice(0,1,a).pop(),t.push(a))},S.prototype.createVoronoiDiagram=function(){var e,n,a,i=this.width-2,r=this.height-1,o=this.nodes_old;for(e=0;e<r;++e){for((n=t(o,0,e,2,2))[0].unshift(new C),n[1].unshift(new C),w(n),a=0;a<i;++a)w(t(o,a,e,3,2));(n=t(o,a,e,2,2))[0].push(new C),n[1].push(new C),w(n)}return this},S.prototype.contour=function(e){var t,n,a,i,r,o,l,s,c,u,_=e,d=[];if(0===_.valence())return _.vertices.slice();if(_.marked||!_.isEdge()||[[-1,-1],[0,-1],[1,-1]].some((function(e){return null!=this.edge.apply(this,e)}),_))return d;for(n=[],a=1,i=0,_.vertices[0],o=null;;){switch(_.marked=!0,n.push(_),t=void 0,a){case 1:if(t=_.edge(1,-1)){a=7;break}case 2:if(t=_.edge(1,0)){a=0;break}case 3:if(t=_.edge(1,1)){a=1;break}case 4:if(t=_.edge(0,1)){a=2;break}case 5:if(t=_.edge(-1,1)){a=3;break}case 6:if(t=_.edge(-1,0)){a=4;break}case 7:if(t=_.edge(-1,-1)){a=5;break}case 0:a=(t=_.edge(0,-1))?6:1}if(t){for(l=i,s=_.vertices.length,o&&t.equals(o)&&(r=_.vertices[l++%s],d.push(r));;){if(r=_.vertices[l++%s],-1!=(c=t.vertices.indexOf(r))){i=c;break}d.push(r)}if(e.equals(t)&&e.edges.filter((function(e){return e})).every((function(e){return e.marked||!e.isEdge()}))){for(l=i,s=t.vertices.length;l<s;)r=t.vertices[l++],d.push(r);break}o=_,_=t}}for(;0!=n.length;)(u=n.pop().edges.filter((function(e){return e&&!e.marked}))).forEach((function(e){e.marked=!0})),n.push.apply(n,u);return d},n.prototype=Object.create(null,{push:{enumerable:!1,value:function(e){this.vertices.push(e),e.addPath(this)}},splitAt:{enumerable:!1,value:function(e){var t=new n;t.vertices=this.vertices.slice(e),this.vertices.length=e+1,t.vertices.forEach((function(e){e.removePath(this),e.addPath(t)}))}}}),S.prototype.paths=function(e){new n},function(e,t,n){return new S(e,t,n)}}(),b=function(e,t,n){var a,i=y(e.data,e.width,e.height);return i.createSimilarityGraph(),i.createVoronoiDiagram(),i.linearize(),a=function(e,t){var n,a,i,r,o,l,s,c=e.width,u=e.height,_=e.nodes(),d=[],h=!0,f=!1,p=void 0;try{for(n=_[Symbol.iterator]();!(h=(a=n.next()).done);h=!0){for(i=a.value,r="L",l=(o=g(i.vertices))[0],s=0;s<o.length;++s)l=o[s],r+=Math.ceil(l.x*t)+","+Math.ceil(l.y*t)+" ";d.push('<path fill="'+i.color+'" d="M'+Math.ceil(o[0].x*t)+","+Math.ceil(o[0].y*t)+" "+r+'Z"/>')}}catch(m){f=!0,p=m}finally{try{!h&&n.return&&n.return()}finally{if(f)throw p}}return'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 '+c*t+" "+u*t+'">'+d.join("\n\t")+"</svg>"}(i,t),a},t.default=b},824:function(e,t,n){"use strict";var a=n(825);e.exports={loadJSON:function(e,t){var n=new XMLHttpRequest;try{n=new XMLHttpRequest}catch(a){try{n=new ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{n=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){t("Cannot load data",null)}}}n.open("GET",e,!0),n.onreadystatechange=function(){if(4==n.readyState&&200==n.status)try{var e=JSON.parse(n.responseText);t(null,e)}catch(a){t("Cannot understand response from network.",null)}else 4==n.readyState&&404==n.status&&t("Error 404",null)};try{n.send()}catch(a){t("Failed to fetch",null)}},postJSON:function(e,t,n){var i,r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"application/x-www-form-urlencoded",l=new Headers;l.append("Content-Type",o),i="multipart/form-data"===o?new FormData:new URLSearchParams,Object.entries(t).forEach((function(e){var t=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n,a,i=[],r=!0,o=!1,l=void 0;try{for(n=e[Symbol.iterator]();!(r=(a=n.next()).done)&&(i.push(a.value),2!==i.length);r=!0);}catch(s){o=!0,l=s}finally{try{!r&&n.return&&n.return()}finally{if(o)throw l}}return i}(e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(e),n=t[0],a=t[1];i.append(n,a)})),r={method:"POST",redirect:"follow",headers:l,body:"application/text"===o?t:"application/json"===o?(0,a.clean_json_text)(JSON.stringify(t)):i},fetch(e,r).then((function(e){return e.text()})).then((function(e){return n(null,e)})).catch((function(e){return n(e,null)}))},postDATA:function(e,t,n){var a=new XMLHttpRequest;try{a=new XMLHttpRequest}catch(i){try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(i){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(i){return void n("Cannot load data",null)}}}a.open("POST",e,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){if(4==a.readyState&&200==a.status)try{var e=JSON.parse(a.responseText);n(null,e)}catch(i){n("Cannot understand response from network.",null)}else 4==a.readyState&&404==a.status&&n("Error 404",null)};try{a.send(t)}catch(i){n("Failed to post",null)}}}},825:function(e,t,n){"use strict";e.exports={clean_json_text:function(e){return(e=e.replace(/\\n/g,"\\n").replace(/\\'/g,"\\'").replace(/\\"/g,'\\"').replace(/\\&/g,"\\&").replace(/\\r/g,"\\r").replace(/\\t/g,"\\t").replace(/\\b/g,"\\b").replace(/\\f/g,"\\f")).replace(/[\u0000-\u0019]+/g,"")}}}}]);