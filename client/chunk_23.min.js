(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{1048:function(t,e,i){"use strict";function r(t,e){return y.mean(y.square(y.subtract(e,t)),-1)}function n(t,e){return y.mean(y.abs(y.subtract(e,t)),-1)}function a(t,e){var i=y.subtract(t,e),r=y.clip(y.abs(t),y.epsilon(),Number.MAX_VALUE),n=y.abs(y.divide(i,r));return y.scalarTimesArray(y.getScalar(100),y.mean(n,-1))}function o(t,e){var i=y.getScalar(1),r=y.clip(e,y.epsilon(),Number.MAX_VALUE),n=y.log(y.scalarPlusArray(i,r)),a=y.clip(t,y.epsilon(),Number.MAX_VALUE),o=y.log(y.scalarPlusArray(i,a));return y.mean(y.square(y.subtract(n,o)),-1)}function s(t,e){var i=y.getScalar(0),r=y.getScalar(1),n=y.maximum(i,y.subtract(r,y.multiply(t,e)));return y.mean(y.square(n),-1)}function l(t,e){var i=y.getScalar(0),r=y.getScalar(1),n=y.maximum(i,y.subtract(r,y.multiply(t,e)));return y.mean(n,-1)}function u(t,e){var i=y.getScalar(0),r=y.getScalar(1),n=y.sum(y.multiply(t,e),-1),a=y.max(y.multiply(y.subtract(r,t),e),-1);return y.maximum(i,y.scalarPlusArray(r,y.subtract(a,n)))}function c(t,e){var i=y.getScalar(Math.log(2)),r=y.subtract(e,t),n=y.subtract(y.add(r,y.softplus(y.scalarTimesArray(y.getScalar(-2),r))),i);return y.mean(n,-1)}function p(t,e){return y.categoricalCrossentropy(t,e)}function h(t,e){return y.sparseCategoricalCrossentropy(t,e)}function g(t,e){return y.mean(y.binaryCrossentropy(t,e),-1)}function f(t,e){var i=y.clip(t,y.epsilon(),1),r=y.clip(e,y.epsilon(),1);return y.sum(y.multiply(t,y.log(y.divide(i,r))),-1)}function d(t,e){var i=y.log(y.scalarPlusArray(y.getScalar(y.epsilon()),e));return y.mean(y.subtract(e,y.multiply(t,i)),-1)}function m(t,e){var i=y.l2Normalize(t,-1),r=y.l2Normalize(e,-1),n=y.multiply(i,r);return y.neg(y.sum(n,-1))}var y,b;Object.defineProperty(e,"__esModule",{value:!0}),y=i(652),b=i(645),e.meanSquaredError=r,e.meanAbsoluteError=n,e.meanAbsolutePercentageError=a,e.meanSquaredLogarithmicError=o,e.squaredHinge=s,e.hinge=l,e.categoricalHinge=u,e.logcosh=c,e.categoricalCrossentropy=p,e.sparseCategoricalCrossentropy=h,e.binaryCrossentropy=g,e.kullbackLeiblerDivergence=f,e.poisson=d,e.cosineProximity=m,e.mse=r,e.MSE=r,e.mae=n,e.MAE=n,e.mape=a,e.MAPE=a,e.msle=o,e.MSLE=o,e.kld=f,e.KLD=f,e.cosine=m,e.get=function(t){var e={meanSquaredError:r,meanAbsoluteError:n,meanAbsolutePercentageError:a,meanSquaredLogarithmicError:o,squaredHinge:s,hinge:l,categoricalHinge:u,logcosh:c,categoricalCrossentropy:p,sparseCategoricalCrossentropy:h,binaryCrossentropy:g,kullbackLeiblerDivergence:f,poisson:d,cosineProximity:m};if("string"==typeof t){if(t in e)return e[t];throw new b.ValueError("Unknown loss "+t)}return t}},1049:function(t,e,i){"use strict";var r,n,a;Object.defineProperty(e,"__esModule",{value:!0}),r=i(645),n=i(646),a=i(733),e.normalizeArray=function(t,e,i){var o,s;if("number"==typeof t)return n.pyListRepeat(t,e);if(t.length!==e)throw new r.ValueError("The "+i+" argument must be a tuple of "+e+" integers. Received: "+t.length+" elements.");for(o=0;o<e;++o)if(s=t[o],!a.isInteger(s))throw new r.ValueError("The "+i+" argument must be a tuple of "+e+" integers. Received: "+JSON.stringify(t)+" including a non-integer number "+s);return t},e.convOutputLength=function(t,e,i,r,n){return void 0===n&&(n=1),null==t?t:Math.floor((("same"===i?t:t-(e+(e-1)*(n-1))+1)+r-1)/r)},e.deconvLength=function(t,e,i,n){if(null==t)return null;if("valid"===n)t=t*e+a.max([i-e,0]);else{if("same"!==n)throw new r.ValueError("Unsupport padding mode: "+n+".");t*=e}return t}},1256:function(t,e,i){var r=i(2139),n=i(2140),a=i(2141),o=i(2142),s=i(2143),l=i(2144),u=i(2145);u.alea=r,u.xor128=n,u.xorwow=a,u.xorshift7=o,u.xor4096=s,u.tychei=l,t.exports=u},1265:function(t,e,i){"use strict";var r,n,a,o,s,l,u,c;Object.defineProperty(e,"__esModule",{value:!0}),r=i(652),e.backend=r,n=i(2204),a=i(1267),e.Callback=a.Callback,e.CallbackList=a.CallbackList,e.CustomCallback=a.CustomCallback,o=i(1047),e.Model=o.Model,s=i(1270),e.RNN=s.RNN,l=i(1271),e.Sequential=l.Sequential,u=i(699),e.SymbolicTensor=u.SymbolicTensor,c=i(2216),e.version_layers=c.version,e.model=n.ModelExports.model,e.sequential=n.ModelExports.sequential,e.loadModel=n.ModelExports.loadModel,e.input=n.ModelExports.input,e.layers=n.LayerExports,e.constraints=n.ConstraintExports,e.initializers=n.InitializerExports,e.metrics=n.MetricExports,e.regularizers=n.RegularizerExports},1266:function(t,e,i){"use strict";function r(t,e,i){return("inboundNodes"===t||"outputLayers"===t||"inputLayers"===t)&&0===e&&"string"==typeof i}var n,a;Object.defineProperty(e,"__esModule",{value:!0}),n=i(645),a=i(646),e.convertPythonicToTs=function t(e,i){var o,s,l,u,c,p,h,g,f,d,m;if(null===e)return null;if("string"==typeof e)return a.toCamelCase(e);if("number"==typeof e||"boolean"==typeof e)return e;if(e instanceof Array){for(o=[],s=e.length,l=0;l<s;++l)r(i,l,u=e[l])?o.push(u):o.push(t(u,i));return o}for(c={},p=0,h=Object.keys(e);p<h.length;p++)if(f=e[g=h[p]],"name"===g&&"string"==typeof f)c[g]=f;else if(d=a.toCamelCase(g),!a.SerializableEnumRegistry.contains(g)||"string"!=typeof f&&null!=f)c[d]=t(f,d);else{if(null==(m=a.SerializableEnumRegistry.lookup(g,f)))throw new n.ValueError("Unkown value "+f+" for "+g+" Enum");c[d]=m}return c},e.convertTsToPythonic=function t(e,i){var n,o,s,l,u,c,p,h,g,f,d;if(null==e)return null;if("string"==typeof e)return a.toSnakeCase(e);if("number"==typeof e||"boolean"==typeof e)return e;if(e instanceof Array){for(n=[],o=e.length,s=0;s<o;++s)r(i,s,l=e[s])?n.push(l):n.push(t(l,i));return n}for(u={},c=0,p=Object.keys(e);c<p.length;c++)g=e[h=p[c]],f=a.toSnakeCase(h),"name"!==h&&"className"!==h||"string"!=typeof g?!a.SerializableEnumRegistry.contains(f)||"string"!=typeof g&&null!=g?u[f]=t(g,h):(d=a.SerializableEnumRegistry.reverseLookup(f,g),u[f]=d):u[f]=g;return u}},1268:function(t,e,i){"use strict";function r(t,e){var i=o.scalarTimesArray(o.getScalar(.5),a.onesLike(e)),r=o.cast(o.greater(e,i),t.dtype);return o.mean(o.equal(t,r),-1)}function n(t,e){return o.cast(o.equal(o.argmax(t,-1),o.argmax(e,-1)),"float32")}var a,o,s,l;Object.defineProperty(e,"__esModule",{value:!0}),a=i(644),o=i(652),s=i(645),l=i(1048),e.binaryAccuracy=r,e.categoricalAccuracy=n,e.binaryCrossentropy=function(t,e){return o.mean(o.binaryCrossentropy(t,e),-1)},e.sparseCategoricalAccuracy=function(t,e){throw new s.NotImplementedError},e.topKCategoricalAccuracy=function(t,e){throw new s.NotImplementedError},e.sparseTopKCategoricalAccuracy=function(t,e){throw new s.NotImplementedError},e.mse=l.meanSquaredError,e.MSE=l.meanSquaredError,e.mae=l.meanAbsoluteError,e.MAE=l.meanAbsoluteError,e.mape=l.meanAbsolutePercentageError,e.MAPE=l.meanAbsolutePercentageError,e.categoricalCrossentropy=l.categoricalCrossentropy,e.cosine=l.cosineProximity,e.sparseCategoricalCrossentropy=l.sparseCategoricalCrossentropy,e.get=function(t){var i={binaryAccuracy:r,categoricalAccuracy:n,categoricalCrossentropy:e.categoricalCrossentropy,sparseCategoricalCrossentropy:e.sparseCategoricalCrossentropy,mse:e.mse,MSE:e.MSE,mae:e.mae,MAE:e.MAE,mape:e.mape,MAPE:e.MAPE,cosine:e.cosine};if("string"==typeof t&&t in i)return i[t];if("string"!=typeof t&&null!=t)return t;throw new s.ValueError("Unknown metric "+t)}},1269:function(t,e,i){"use strict";var r,n,a,o,s,l,u,c,p,h,g,f,d,m,y,b,v,z,C,I=this&&this.__extends||(C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},function(t,e){function i(){this.constructor=t}C(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),r=i(644),n=i(903),a=i(652),o=i(830),s=i(758),l=i(669),u=i(645),c=i(734),p=i(759),h=i(699),g=i(1049),f=i(646),d=function(t){function e(e,i){var r=t.call(this,i)||this;if(r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.rank=e,1!==r.rank&&2!==r.rank)throw new u.NotImplementedError("Convolution layer for rank other than 1 or 2 ("+r.rank+") is not implemented yet.");if(r.filters=i.filters,r.kernelSize=g.normalizeArray(i.kernelSize,e,"kernelSize"),r.strides=g.normalizeArray(null==i.strides?1:i.strides,e,"strides"),r.padding=null==i.padding?"valid":i.padding,o.checkPaddingMode(r.padding),r.dataFormat=null==i.dataFormat?"channelsLast":i.dataFormat,o.checkDataFormat(r.dataFormat),r.dilationRate=null==i.dilationRate?1:i.dilationRate,1===r.rank&&Array.isArray(r.dilationRate)&&1!==r.dilationRate.length)throw new u.ValueError("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(r.dilationRate));if(2===r.rank)if("number"==typeof r.dilationRate)r.dilationRate=[r.dilationRate,r.dilationRate];else if(2!==r.dilationRate.length)throw new u.ValueError("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(r.dilationRate));return r.activation=n.getActivation(i.activation),r.useBias=null==i.useBias||i.useBias,r.kernelInitializer=c.getInitializer(i.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=c.getInitializer(i.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=s.getConstraint(i.kernelConstraint),r.biasConstraint=s.getConstraint(i.biasConstraint),r.kernelRegularizer=p.getRegularizer(i.kernelRegularizer),r.biasRegularizer=p.getRegularizer(i.biasRegularizer),r.activityRegularizer=p.getRegularizer(i.activityRegularizer),r}return I(e,t),e.prototype.build=function(t){var e,i,r,n;if(null==(t=f.getExactlyOneShape(t))[e="channelsFirst"===this.dataFormat?1:t.length-1])throw new u.ValueError("The channel dimension of the input should be defined. Found "+t[e]);i=t[e],r=this.kernelSize.concat([i,this.filters]),this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(n={},n[e]=i,n)}],this.built=!0},e.prototype.call=function(t,e){var i,r;if(t=f.getExactlyOneTensor(t),r=null==this.bias?null:this.bias.read(),1===this.rank)i=a.conv1dWithBias(t,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate);else if(2===this.rank)i=a.conv2dWithBias(t,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(3===this.rank)throw new u.NotImplementedError("3D convolution is not implemented yet.");return null!=this.activation&&(i=this.activation(i)),i},e.prototype.computeOutputShape=function(t){var e,i,r,n,a;for(t=f.getExactlyOneShape(t),e=[],i="channelsLast"===this.dataFormat?t.slice(1,t.length-1):t.slice(2),r=0;r<i.length;++r)n=g.convOutputLength(i[r],this.kernelSize[r],this.padding,this.strides[r],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[r]),e.push(n);return a=[t[0]],"channelsLast"===this.dataFormat?(a=a.concat(e)).push(this.filters):(a.push(this.filters),a=a.concat(e)),a},e.prototype.getConfig=function(){var e={rank:this.rank,filters:this.filters,kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:n.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:c.serializeInitializer(this.kernelInitializer),biasInitializer:c.serializeInitializer(this.biasInitializer),kernelRegularizer:p.serializeRegularizer(this.kernelRegularizer),biasRegularizer:p.serializeRegularizer(this.biasRegularizer),activityRegularizer:p.serializeRegularizer(this.activityRegularizer),kernelConstraint:s.serializeConstraint(this.kernelConstraint),biasConstraint:s.serializeConstraint(this.biasConstraint)},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},e}(l.Layer),e.Conv=d,m=function(t){function e(e){return t.call(this,2,e)||this}return I(e,t),e.prototype.getClassName=function(){return"Conv2D"},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,e},e}(d),e.Conv2D=m,f.ClassNameMap.register("Conv2D",m),y=function(t){function e(e){var i=t.call(this,e)||this;if(i.inputSpec=[new l.InputSpec({ndim:4})],"same"!==i.padding&&"valid"!==i.padding)throw new u.ValueError("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+i.padding);return i}return I(e,t),e.prototype.getClassName=function(){return"Conv2DTranspose"},e.prototype.build=function(t){var e,i,r,n;if(4!==(t=f.getExactlyOneShape(t)).length)throw new u.ValueError("Input should have rank 4; Received input shape: "+JSON.stringify(t));if(null==t[e="channelsFirst"===this.dataFormat?1:t.length-1])throw new u.ValueError("The channel dimension of the inputs should be defined. Found `None`.");i=t[e],r=this.kernelSize.concat([this.filters,i]),this.kernel=this.addWeight("kernel",r,h.DType.float32,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],h.DType.float32,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new l.InputSpec({ndim:4,axes:(n={},n[e]=i,n)})],this.built=!0},e.prototype.call=function(t,e){var i=this;return r.tidy((function(){var e,n,o,s,l,c,p,h,d,m,y,b,v=f.getExactlyOneTensor(t);if(4!==v.shape.length)throw new u.ValueError("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+v.shape.length);return n=(e=v.shape)[0],"channelsFirst"===i.dataFormat?(o=2,s=3):(o=1,s=2),l=e[o],c=e[s],p=i.kernelSize[0],h=i.kernelSize[1],d=i.strides[0],m=i.strides[1],y=[n,g.deconvLength(l,d,p,i.padding),g.deconvLength(c,m,h,i.padding),i.filters],"channelsLast"!==i.dataFormat&&(v=a.transpose(v,[0,2,3,1])),b=r.conv2dTranspose(v,i.kernel.read(),y,i.strides,i.padding),"channelsLast"!==i.dataFormat&&(b=a.transpose(b,[0,3,1,2])),null!=i.bias&&(b=a.biasAdd(b,i.bias.read(),i.dataFormat)),null!=i.activation&&(b=i.activation(b)),b}))},e.prototype.computeOutputShape=function(t){var e,i,r,n,a,o,s,l;return e=(t=f.getExactlyOneShape(t)).slice(),"channelsFirst"===this.dataFormat?(i=1,r=2,n=3):(i=3,r=1,n=2),a=this.kernelSize[0],o=this.kernelSize[1],s=this.strides[0],l=this.strides[1],e[i]=this.filters,e[r]=g.deconvLength(e[r],s,a,this.padding),e[n]=g.deconvLength(e[n],l,o,this.padding),e},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.dilationRate,e},e}(m),e.Conv2DTranspose=y,f.ClassNameMap.register("Conv2DTranspose",y),b=function(t){function e(e,i){var r=t.call(this,e,i)||this;if(r.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",r.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",r.depthwiseKernel=null,r.pointwiseKernel=null,null==i.filters)throw new u.ValueError("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=i.kernelInitializer||null!=i.kernelRegularizer||null!=i.kernelConstraint)throw new u.ValueError("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=i.padding&&"same"!==i.padding&&"valid"!==i.padding)throw new u.ValueError("SeparableConv"+r.rank+"D supports only padding modes: 'same' and 'valid', but received "+JSON.stringify(i.padding));return r.depthMultiplier=null==i.depthMultiplier?1:i.depthMultiplier,r.depthwiseInitializer=c.getInitializer(i.depthwiseInitializer||r.DEFAULT_DEPTHWISE_INITIALIZER),r.depthwiseRegularizer=p.getRegularizer(i.depthwiseRegularizer),r.depthwiseConstraint=s.getConstraint(i.depthwiseConstraint),r.pointwiseInitializer=c.getInitializer(i.depthwiseInitializer||r.DEFAULT_POINTWISE_INITIALIZER),r.pointwiseRegularizer=p.getRegularizer(i.pointwiseRegularizer),r.pointwiseConstraint=s.getConstraint(i.pointwiseConstraint),r}return I(e,t),e.prototype.build=function(t){var e,i,r,n,a,o,s;if((t=f.getExactlyOneShape(t)).length<this.rank+2)throw new u.ValueError("Inputs to SeparableConv"+this.rank+"D should have rank "+(this.rank+2)+", but received input shape: "+JSON.stringify(t));if(null==t[e="channelsFirst"===this.dataFormat?1:t.length-1]||t[e]<0)throw new u.ValueError("The channel dimension of the inputs should be defined, but found "+JSON.stringify(t[e]));for(i=t[e],r=this.kernelSize.concat([i,this.depthMultiplier]),n=[],a=0;a<this.rank;++a)n.push(1);n.push(i*this.depthMultiplier,this.filters),o=!0,this.depthwiseKernel=this.addWeight("depthwise_kernel",r,h.DType.float32,this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",n,h.DType.float32,this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],h.DType.float32,this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new l.InputSpec({ndim:this.rank+2,axes:(s={},s[e]=i,s)})],this.built=!0},e.prototype.call=function(t,e){var i;if(t=f.getExactlyOneTensor(t),1===this.rank)throw new u.NotImplementedError("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(t=a.transpose(t,[0,2,3,1])),i=r.separableConv2d(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(i=a.biasAdd(i,this.bias.read(),this.dataFormat)),null!=this.activation&&(i=this.activation(i)),"channelsFirst"===this.dataFormat&&(i=a.transpose(i,[0,3,1,2])),i},e.prototype.getClassName=function(){return"SeparableConv"},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=c.serializeInitializer(this.depthwiseInitializer),e.pointwiseInitializer=c.serializeInitializer(this.pointwiseInitializer),e.depthwiseRegularizer=p.serializeRegularizer(this.depthwiseRegularizer),e.pointwiseRegularizer=p.serializeRegularizer(this.pointwiseRegularizer),e.depthwiseConstraint=s.serializeConstraint(this.depthwiseConstraint),e.pointwiseConstraint=s.serializeConstraint(this.pointwiseConstraint),e},e}(d),e.SeparableConv=b,v=function(t){function e(e){return t.call(this,2,e)||this}return I(e,t),e.prototype.getClassName=function(){return"SeparableConv2D"},e}(b),e.SeparableConv2D=v,f.ClassNameMap.register("SeparableConv2D",v),z=function(t){function e(e){var i=t.call(this,1,e)||this;return i.inputSpec=[{ndim:3}],i}return I(e,t),e.prototype.getClassName=function(){return"Conv1D"},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,delete e.dataFormat,e},e}(d),e.Conv1D=z,f.ClassNameMap.register("Conv1D",z)},1270:function(t,e,i){"use strict";var r,n,a,o,s,l,u,c,p,h,g,f,d,m,y,b,v,z,C,I,A,w,S,R=this&&this.__extends||(S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},function(t,e){function i(){this.constructor=t}S(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),N=this&&this.__decorate||function(t,e,i,r){var n,a,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(a=t.length-1;a>=0;a--)(n=t[a])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(e,"__esModule",{value:!0}),r=i(644),n=i(903),a=i(652),o=i(758),s=i(669),l=i(669),u=i(645),c=i(734),p=i(759),h=i(699),g=i(646),f=i(733),d=i(902),m=function(t){function e(e){var i,r=t.call(this,e)||this;if(null==e.cell)throw new u.ValueError("cell property is missing for the constructor of RNN.");if(null==(i=Array.isArray(e.cell)?new w({cells:e.cell}):e.cell).stateSize)throw new u.ValueError("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return r.cell=i,r.returnSequences=null!=e.returnSequences&&e.returnSequences,r.returnState=null!=e.returnState&&e.returnState,r.goBackwards=null!=e.goBackwards&&e.goBackwards,r._stateful=null!=e.stateful&&e.stateful,r.unroll=null!=e.unroll&&e.unroll,r.supportsMasking=!0,r.inputSpec=[new s.InputSpec({ndim:3})],r.stateSpec=null,r.states=null,r.numConstants=null,r}return R(e,t),e.prototype.getStates=function(){if(null==this.states){var t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return f.range(0,t).map((function(t){return null}))}return this.states},e.prototype.setStates=function(t){this.states=t},e.prototype.computeOutputShape=function(t){var e,i,r,n,a,o,s;if(g.isArrayOfShapes(t)&&(t=t[0]),e=this.cell.stateSize,Array.isArray(e)||(e=[e]),i=e[0],r=this.returnSequences?[t[0],t[1],i]:[t[0],i],this.returnState){for(n=[],a=0,o=e;a<o.length;a++)s=o[a],n.push([t[0],s]);return[r].concat(n)}return r},e.prototype.computeMask=function(t,e){throw new u.NotImplementedError("computeMask has not been implemented for RNN yet")},e.prototype.build=function(t){var e,i,n,a;if(null!=this.numConstants)throw new u.NotImplementedError("Constants support is not implemented in RNN yet.");if(g.isArrayOfShapes(t)&&(t=t[0]),e=this.stateful?t[0]:null,i=t[t.length-1],this.inputSpec[0]=new s.InputSpec({shape:[e,null,i]}),n=[t[0]].concat(t.slice(2)),this.cell.build(n),a=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!r.util.arraysEqual(this.stateSpec.map((function(t){return t.shape[t.shape.length-1]})),a))throw new u.ValueError("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec="+this.stateSpec+"; However cell.stateSize is "+this.cell.stateSize)}else this.stateSpec=a.map((function(t){return new s.InputSpec({shape:[null,t]})}));if(this.stateful)throw new u.NotImplementedError("stateful RNN layer is not implemented yet")},e.prototype.resetStates=function(t){var e,i,n,o,s;if(!this.stateful)throw new u.AttributeError("Cannot call resetState() on an RNN Layer that is not stateful.");if(null==(e=this.inputSpec[0].shape[0]))throw new u.ValueError("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states)Array.isArray(this.cell.stateSize)?this.states=this.cell.stateSize.map((function(t){return a.zeros([e,t])})):this.states=[a.zeros([e,this.cell.stateSize])];else if(null==t)Array.isArray(this.cell.stateSize)?this.states=this.cell.stateSize.map((function(t){return a.zeros([e,t])})):this.states[0]=a.zeros([e,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states.length)throw new u.ValueError("Layer "+this.name+" expects "+this.states.length+" state(s), but it received "+t.length+" state value(s). Input received: "+t);for(i=0;i<this.states.length;++i){if(n=t[i],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[i]:this.cell.stateSize,s=[e,o],!r.util.arraysEqual(n.shape,s))throw new u.ValueError("State "+i+" is incompatible with layer "+this.name+": expected shape="+s+", received shape="+n.shape);this.states[i]=n}}},e.prototype.standardizeArgs=function(t,e,i){function r(t){return null==t||Array.isArray(t)?t:[t]}if(Array.isArray(t)){if(null!=e||null!=i)throw new u.ValueError("When inputs is an array, neither initialState or constants should be provided");null!=this.numConstants&&(i=t.slice(t.length-this.numConstants,t.length),t=t.slice(0,t.length-this.numConstants)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}return{inputs:t,initialState:e=r(e),constants:i=r(i)}},e.prototype.apply=function(e,i){var r,n,a,o,l,u,c,p,g,f,d=null==i?null:i.initialState,m=null==i?null:i.constants;if(null==i&&(i={}),e=(r=this.standardizeArgs(e,d,m)).inputs,d=r.initialState,m=r.constants,n=[],a=[],null!=d){for(i.initialState=d,n=n.concat(d),this.stateSpec=[],o=0,l=d;o<l.length;o++)u=l[o],this.stateSpec.push(new s.InputSpec({shape:u.shape}));a=a.concat(this.stateSpec)}return null!=m&&(i.constants=m,n=n.concat(m),this.numConstants=m.length),n[0]instanceof h.SymbolicTensor?(c=[e].concat(n),p=this.inputSpec.concat(a),g=this.inputSpec,this.inputSpec=p,f=t.prototype.apply.call(this,c,i),this.inputSpec=g,f):t.prototype.apply.call(this,e,i)},e.prototype.call=function(t,e){var i,r,n,o,s,l,c,p,h,f=this,d=null==e?null:e.mask,m=null==e?null:e.training,y=null==e?null:e.initialState;if(t=g.getExactlyOneTensor(t),null==y){if(this.stateful)throw new u.NotImplementedError("stateful RNN layer is not implemented yet.");y=this.getInitialState(t)}if(null!=d)throw new u.NotImplementedError("Masking is not implemented for RNN yet");if(i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,y.length!==i)throw new u.ValueError("RNN Layer has "+i+" state(s) but was passed "+y.length+" initial state(s).");if(r=t.shape[1],this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend."),n={training:m},o=function(t,e){var i=f.cell.call([t].concat(e),n);return[i[0],i.slice(1)]},l=(s=a.rnn(o,t,y,this.goBackwards,null,null,this.unroll,r))[0],c=s[1],p=s[2],this.stateful)throw new u.NotImplementedError("stateful RNN layer is not implemented yet");return h=this.returnSequences?c:l,this.returnState?[h].concat(p):h},e.prototype.getInitialState=function(t){var e=a.zeros(t.shape);return e=a.sum(e,[1,2]),e=a.expandDims(e),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map((function(t){return t>1?a.tile(e,[1,t]):e})):this.cell.stateSize>1?[a.tile(e,[1,this.cell.stateSize])]:[e]},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.trainable?this.cell.trainableWeights:[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights},enumerable:!0,configurable:!0}),e.prototype.getClassName=function(){return"RNN"},e.prototype.getConfig=function(){var e,i,r={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};return null!=this.numConstants&&(r.numConstants=this.numConstants),e=this.cell.getConfig(),r.cell={className:this.cell.getClassName(),config:e},i=t.prototype.getConfig.call(this),Object.assign(r,i),r},e}(l.Layer),e.RNN=m,g.ClassNameMap.register("RNN",m),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return R(e,t),N([r.doc({heading:"Layers",subheading:"Classes"})],e)}(l.Layer),e.RNNCell=y,b=function(t){function e(e){var i=t.call(this,e)||this;return i.DEFAULT_ACTIVATION="tanh",i.DEFAULT_KERNEL_INITIALIZER="glorotNormal",i.DEFAULT_RECURRENT_INITIALIZER="orthogonal",i.DEFAULT_BIAS_INITIALIZER="zeros",i.units=e.units,i.activation=n.getActivation(null==e.activation?i.DEFAULT_ACTIVATION:e.activation),i.useBias=null==e.useBias||e.useBias,i.kernelInitializer=c.getInitializer(e.kernelInitializer||i.DEFAULT_KERNEL_INITIALIZER),i.recurrentInitializer=c.getInitializer(e.recurrentInitializer||i.DEFAULT_RECURRENT_INITIALIZER),i.biasInitializer=c.getInitializer(e.biasInitializer||i.DEFAULT_BIAS_INITIALIZER),i.kernelRegularizer=p.getRegularizer(e.kernelRegularizer),i.recurrentRegularizer=p.getRegularizer(e.recurrentRegularizer),i.biasRegularizer=p.getRegularizer(e.biasRegularizer),i.kernelConstraint=o.getConstraint(e.kernelConstraint),i.recurrentConstraint=o.getConstraint(e.recurrentConstraint),i.biasConstraint=o.getConstraint(e.biasConstraint),i.dropout=f.min([1,f.max([0,null==e.dropout?0:e.dropout])]),i.recurrentDropout=f.min([1,f.max([0,null==e.recurrentDropout?0:e.recurrentDropout])]),i.stateSize=i.units,i}return R(e,t),e.prototype.build=function(t){t=g.getExactlyOneShape(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},e.prototype.call=function(t,e){var i,r,n;if(2!==t.length)throw new u.ValueError("SimpleRNNCell expects 2 input Tensors, got "+t.length+".");if(i=t[1],t=t[0],0!==this.dropout||0!==this.recurrentDropout)throw new u.NotImplementedError("Dropout is not implemented for SimpleRNNCell yet");return r=a.dot(t,this.kernel.read()),null!=this.bias&&(r=a.biasAdd(r,this.bias.read())),n=a.add(r,a.dot(i,this.recurrentKernel.read())),null!=this.activation&&(n=this.activation(n)),[n,n]},e.prototype.getClassName=function(){return"SimpleRNNCell"},e.prototype.getConfig=function(){var e={units:this.units,activation:n.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:c.serializeInitializer(this.kernelInitializer),recurrentInitializer:c.serializeInitializer(this.recurrentInitializer),biasInitializer:c.serializeInitializer(this.biasInitializer),kernelRegularizer:p.serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:p.serializeRegularizer(this.recurrentRegularizer),biasRegularizer:p.serializeRegularizer(this.biasRegularizer),activityRegularizer:p.serializeRegularizer(this.activityRegularizer),kernelConstraint:o.serializeConstraint(this.kernelConstraint),recurrentConstraint:o.serializeConstraint(this.recurrentConstraint),biasConstraint:o.serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},e}(y),e.SimpleRNNCell=b,g.ClassNameMap.register("SimpleRNNCell",b),v=function(t){function e(e){return e.cell=new b(e),t.call(this,e)||this}return R(e,t),e.prototype.call=function(e,i){var r=null==i?null:i.mask,n=null==i?null:i.training,a=null==i?null:i.initialState;return t.prototype.call.call(this,e,{mask:r,training:n,initialState:a})},Object.defineProperty(e.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),e.prototype.getClassName=function(){return"SimpleRNN"},e.prototype.getConfig=function(){var e={units:this.units,activation:n.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:c.serializeInitializer(this.kernelInitializer),recurrentInitializer:c.serializeInitializer(this.recurrentInitializer),biasInitializer:c.serializeInitializer(this.biasInitializer),kernelRegularizer:p.serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:p.serializeRegularizer(this.recurrentRegularizer),biasRegularizer:p.serializeRegularizer(this.biasRegularizer),activityRegularizer:p.serializeRegularizer(this.activityRegularizer),kernelConstraint:o.serializeConstraint(this.kernelConstraint),recurrentConstraint:o.serializeConstraint(this.recurrentConstraint),biasConstraint:o.serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},e}(m),e.SimpleRNN=v,g.ClassNameMap.register("SimpleRNN",v),z=function(t){function e(e){var i=t.call(this,e)||this;return i.DEFAULT_ACTIVATION="tanh",i.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",i.DEFAULT_KERNEL_INITIALIZER="glorotNormal",i.DEFAULT_RECURRENT_INITIALIZER="orthogonal",i.DEFAULT_BIAS_INITIALIZER="zeros",i.units=e.units,i.activation=n.getActivation(void 0===e.activation?i.DEFAULT_ACTIVATION:e.activation),i.recurrentActivation=n.getActivation(void 0===e.activation?i.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),i.useBias=null==e.useBias||e.useBias,i.kernelInitializer=c.getInitializer(e.kernelInitializer||i.DEFAULT_KERNEL_INITIALIZER),i.recurrentInitializer=c.getInitializer(e.recurrentInitializer||i.DEFAULT_RECURRENT_INITIALIZER),i.biasInitializer=c.getInitializer(e.biasInitializer||i.DEFAULT_BIAS_INITIALIZER),i.kernelRegularizer=p.getRegularizer(e.kernelRegularizer),i.recurrentRegularizer=p.getRegularizer(e.recurrentRegularizer),i.biasRegularizer=p.getRegularizer(e.biasRegularizer),i.kernelConstraint=o.getConstraint(e.kernelConstraint),i.recurrentConstraint=o.getConstraint(e.recurrentConstraint),i.biasConstraint=o.getConstraint(e.biasConstraint),i.dropout=f.min([1,f.max([0,null==e.dropout?0:e.dropout])]),i.recurrentDropout=f.min([1,f.max([0,null==e.recurrentDropout?0:e.recurrentDropout])]),i.implementation=e.implementation,i.stateSize=i.units,i}return R(e,t),e.prototype.build=function(t){var e=(t=g.getExactlyOneShape(t))[t.length-1];this.kernel=this.addWeight("kernel",[e,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},e.prototype.call=function(t,e){var i,r,n,o,s,l,c,p,h,g,f,d,m,y,b,v,z,C,I,A,w,S,R,N,E,_,O,k;if(0!==this.dropout||0!==this.recurrentDropout)throw new u.NotImplementedError("Dropout is not implemented for GRUCell yet");if(2!==t.length)throw new u.ValueError("GRUCell expects 2 input Tensors (inputs, h, c), got "+t.length+".");return i=t[1],t=t[0],1===this.implementation?(s=a.sliceAlongLastAxis(this.kernel.read(),0,this.units),l=a.sliceAlongLastAxis(this.kernel.read(),this.units,this.units),c=a.sliceAlongLastAxis(this.kernel.read(),2*this.units,this.units),p=a.sliceAlongLastAxis(this.recurrentKernel.read(),0,this.units),h=a.sliceAlongLastAxis(this.recurrentKernel.read(),this.units,this.units),g=a.sliceAlongLastAxis(this.recurrentKernel.read(),2*this.units,this.units),f=t,d=t,m=t,y=a.dot(f,s),b=a.dot(d,l),v=a.dot(m,c),this.useBias&&(z=a.sliceAlongFirstAxis(this.bias.read(),0,this.units),C=a.sliceAlongFirstAxis(this.bias.read(),this.units,this.units),I=a.sliceAlongFirstAxis(this.bias.read(),2*this.units,this.units),y=a.biasAdd(y,z),b=a.biasAdd(b,C),v=a.biasAdd(v,I)),A=i,w=i,S=i,r=this.recurrentActivation(a.add(y,a.dot(A,p))),n=this.recurrentActivation(a.add(b,a.dot(w,h))),o=this.activation(a.add(v,a.dot(a.multiply(n,S),g)))):(R=a.dot(t,this.kernel.read()),this.useBias&&(R=a.biasAdd(R,this.bias.read())),N=a.dot(i,a.sliceAlongLastAxis(this.recurrentKernel.read(),0,2*this.units)),y=a.sliceAlongLastAxis(R,0,this.units),b=a.sliceAlongLastAxis(R,this.units,this.units),E=a.sliceAlongLastAxis(N,0,this.units),_=a.sliceAlongLastAxis(N,this.units,this.units),r=this.recurrentActivation(a.add(y,E)),n=this.recurrentActivation(a.add(b,_)),v=a.sliceAlongLastAxis(R,2*this.units,this.units),O=a.dot(a.multiply(n,i),a.sliceAlongLastAxis(this.recurrentKernel.read(),2*this.units,this.units)),o=this.activation(a.add(v,O))),[k=a.add(a.multiply(r,i),a.multiply(a.scalarPlusArray(a.getScalar(1),a.neg(r)),o)),k]},e.prototype.getClassName=function(){return"GRUCell"},e.prototype.getConfig=function(){var e={units:this.units,activation:n.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:c.serializeInitializer(this.kernelInitializer),recurrentInitializer:c.serializeInitializer(this.recurrentInitializer),biasInitializer:c.serializeInitializer(this.biasInitializer),kernelRegularizer:p.serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:p.serializeRegularizer(this.recurrentRegularizer),biasRegularizer:p.serializeRegularizer(this.biasRegularizer),activityRegularizer:p.serializeRegularizer(this.activityRegularizer),kernelConstraint:o.serializeConstraint(this.kernelConstraint),recurrentConstraint:o.serializeConstraint(this.recurrentConstraint),biasConstraint:o.serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},e}(y),e.GRUCell=z,g.ClassNameMap.register("GRUCell",z),C=function(t){function e(e){return 0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new z(e),t.call(this,e)||this}return R(e,t),e.prototype.call=function(e,i){var r=null==i?null:i.mask,n=null==i?null:i.training,a=null==i?null:i.initialState;return t.prototype.call.call(this,e,{mask:r,training:n,initialState:a})},Object.defineProperty(e.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),e.prototype.getClassName=function(){return"GRU"},e.prototype.getConfig=function(){var e={units:this.units,activation:n.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:c.serializeInitializer(this.kernelInitializer),recurrentInitializer:c.serializeInitializer(this.recurrentInitializer),biasInitializer:c.serializeInitializer(this.biasInitializer),kernelRegularizer:p.serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:p.serializeRegularizer(this.recurrentRegularizer),biasRegularizer:p.serializeRegularizer(this.biasRegularizer),activityRegularizer:p.serializeRegularizer(this.activityRegularizer),kernelConstraint:o.serializeConstraint(this.kernelConstraint),recurrentConstraint:o.serializeConstraint(this.recurrentConstraint),biasConstraint:o.serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},e.fromConfig=function(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)},e}(m),e.GRU=C,g.ClassNameMap.register("GRU",C),I=function(t){function e(e){var i=t.call(this,e)||this;return i.DEFAULT_ACTIVATION="tanh",i.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",i.DEFAULT_KERNEL_INITIALIZER="glorotNormal",i.DEFAULT_RECURRENT_INITIALIZER="orthogonal",i.DEFAULT_BIAS_INITIALIZER="zeros",i.units=e.units,i.activation=n.getActivation(void 0===e.activation?i.DEFAULT_ACTIVATION:e.activation),i.recurrentActivation=n.getActivation(void 0===e.activation?i.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),i.useBias=null==e.useBias||e.useBias,i.kernelInitializer=c.getInitializer(e.kernelInitializer||i.DEFAULT_KERNEL_INITIALIZER),i.recurrentInitializer=c.getInitializer(e.recurrentInitializer||i.DEFAULT_RECURRENT_INITIALIZER),i.biasInitializer=c.getInitializer(e.biasInitializer||i.DEFAULT_BIAS_INITIALIZER),i.unitForgetBias=e.unitForgetBias,i.kernelRegularizer=p.getRegularizer(e.kernelRegularizer),i.recurrentRegularizer=p.getRegularizer(e.recurrentRegularizer),i.biasRegularizer=p.getRegularizer(e.biasRegularizer),i.kernelConstraint=o.getConstraint(e.kernelConstraint),i.recurrentConstraint=o.getConstraint(e.recurrentConstraint),i.biasConstraint=o.getConstraint(e.biasConstraint),i.dropout=f.min([1,f.max([0,null==e.dropout?0:e.dropout])]),i.recurrentDropout=f.min([1,f.max([0,null==e.recurrentDropout?0:e.recurrentDropout])]),i.implementation=e.implementation,i.stateSize=[i.units,i.units],i}return R(e,t),e.prototype.build=function(t){var e,i,r,n;e=(t=g.getExactlyOneShape(t))[t.length-1],this.kernel=this.addWeight("kernel",[e,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?(this.unitForgetBias?(r=this.biasInitializer,n=this.units,i=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return R(e,t),e.prototype.apply=function(t,e){var i=r.apply([n]),o=(new c.Ones).apply([n]),s=r.apply([2*n]);return a.concatAlongFirstAxis(a.concatAlongFirstAxis(i,o),s)},e.prototype.getClassName=function(){return"CustomInit"},e}(c.Initializer))):i=this.biasInitializer,this.bias=this.addWeight("bias",[4*this.units],null,i,this.biasRegularizer,!0,this.biasConstraint)):this.bias=null,this.built=!0},e.prototype.call=function(t,e){var i,r,n,o,s,l,c,p,h,g,f,d,m,y,b,v,z,C,I,A,w,S,R,N,E,_,O,k,L,x,T,M,D,P,F,j;if(0!==this.dropout||0!==this.recurrentDropout)throw new u.NotImplementedError("Dropout is not implemented for LSTMCell yet");if(3!==t.length)throw new u.ValueError("LSTMCell expects 3 input Tensors (inputs, h, c), got "+t.length+".");return i=t[1],r=t[2],t=t[0],1===this.implementation?(c=a.sliceAlongLastAxis(this.kernel.read(),0,this.units),p=a.sliceAlongLastAxis(this.kernel.read(),this.units,this.units),h=a.sliceAlongLastAxis(this.kernel.read(),2*this.units,this.units),g=a.sliceAlongLastAxis(this.kernel.read(),3*this.units,this.units),f=a.sliceAlongLastAxis(this.recurrentKernel.read(),0,this.units),d=a.sliceAlongLastAxis(this.recurrentKernel.read(),this.units,this.units),m=a.sliceAlongLastAxis(this.recurrentKernel.read(),2*this.units,this.units),y=a.sliceAlongLastAxis(this.recurrentKernel.read(),3*this.units,this.units),b=t,v=t,z=t,C=t,I=a.dot(b,c),A=a.dot(v,p),w=a.dot(z,h),S=a.dot(C,g),this.useBias&&(R=a.sliceAlongFirstAxis(this.bias.read(),0,this.units),N=a.sliceAlongFirstAxis(this.bias.read(),this.units,this.units),E=a.sliceAlongFirstAxis(this.bias.read(),2*this.units,this.units),_=a.sliceAlongFirstAxis(this.bias.read(),3*this.units,this.units),I=a.biasAdd(I,R),A=a.biasAdd(A,N),w=a.biasAdd(w,E),S=a.biasAdd(S,_)),O=i,k=i,L=i,x=i,n=this.recurrentActivation(a.add(I,a.dot(O,f))),o=this.recurrentActivation(a.add(A,a.dot(k,d))),s=a.add(a.multiply(o,r),a.multiply(n,this.activation(a.add(w,a.dot(L,m))))),l=this.recurrentActivation(a.add(S,a.dot(x,y)))):(T=a.dot(t,this.kernel.read()),T=a.add(T,a.dot(i,this.recurrentKernel.read())),this.useBias&&(T=a.biasAdd(T,this.bias.read())),M=a.sliceAlongLastAxis(T,0,this.units),D=a.sliceAlongLastAxis(T,this.units,this.units),P=a.sliceAlongLastAxis(T,2*this.units,this.units),F=a.sliceAlongLastAxis(T,3*this.units,this.units),n=this.recurrentActivation(M),o=this.recurrentActivation(D),s=a.add(a.multiply(o,r),a.multiply(n,this.activation(P))),l=this.recurrentActivation(F)),[j=a.multiply(l,this.activation(s)),j,s]},e.prototype.getClassName=function(){return"LSTMCell"},e.prototype.getConfig=function(){var e={units:this.units,activation:n.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:c.serializeInitializer(this.kernelInitializer),recurrentInitializer:c.serializeInitializer(this.recurrentInitializer),biasInitializer:c.serializeInitializer(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:p.serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:p.serializeRegularizer(this.recurrentRegularizer),biasRegularizer:p.serializeRegularizer(this.biasRegularizer),activityRegularizer:p.serializeRegularizer(this.activityRegularizer),kernelConstraint:o.serializeConstraint(this.kernelConstraint),recurrentConstraint:o.serializeConstraint(this.recurrentConstraint),biasConstraint:o.serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},e}(y),e.LSTMCell=I,g.ClassNameMap.register("LSTMCell",I),A=function(t){function e(e){return 0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new I(e),t.call(this,e)||this}return R(e,t),e.prototype.call=function(e,i){var r=null==i?null:i.mask,n=null==i?null:i.training,a=null==i?null:i.initialState;return t.prototype.call.call(this,e,{mask:r,training:n,initialState:a})},Object.defineProperty(e.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unitForgetBias",{get:function(){return this.cell.unitForgetBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),e.prototype.getClassName=function(){return"LSTM"},e.prototype.getConfig=function(){var e={units:this.units,activation:n.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:c.serializeInitializer(this.kernelInitializer),recurrentInitializer:c.serializeInitializer(this.recurrentInitializer),biasInitializer:c.serializeInitializer(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:p.serializeRegularizer(this.kernelRegularizer),recurrentRegularizer:p.serializeRegularizer(this.recurrentRegularizer),biasRegularizer:p.serializeRegularizer(this.biasRegularizer),activityRegularizer:p.serializeRegularizer(this.activityRegularizer),kernelConstraint:o.serializeConstraint(this.kernelConstraint),recurrentConstraint:o.serializeConstraint(this.recurrentConstraint),biasConstraint:o.serializeConstraint(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},e.fromConfig=function(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)},e}(m),e.LSTM=A,g.ClassNameMap.register("LSTM",A),w=function(t){function e(e){var i=t.call(this,e)||this;return i.cells=e.cells,i}return R(e,t),Object.defineProperty(e.prototype,"stateSize",{get:function(){var t,e,i,r=[];for(t=0,e=this.cells.slice().reverse();t<e.length;t++)i=e[t],Array.isArray(i.stateSize)?r.push.apply(r,i.stateSize):r.push(i.stateSize);return r},enumerable:!0,configurable:!0}),e.prototype.call=function(t,e){var i,r,n,a,o,s,l,u,c,p,h;for(i=t.slice(1),r=[],n=0,a=this.cells.slice().reverse();n<a.length;n++)o=a[n],Array.isArray(o.stateSize)?r.push(i.splice(0,o.stateSize.length)):r.push(i.splice(0,1));for(r.reverse(),s=[],u=0;u<this.cells.length;++u)o=this.cells[u],i=r[u],l=0===u?[t[0]].concat(i):[l[0]].concat(i),l=o.call(l,e),s.push(l.slice(1));for(i=[],c=0,p=s.slice().reverse();c<p.length;c++)h=p[c],i.push.apply(i,h);return[l[0]].concat(i)},e.prototype.build=function(t){var e,i,r,n;for(g.isArrayOfShapes(t)&&(t=t[0]),i=0,r=this.cells;i<r.length;i++)(n=r[i]).build(t),e=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,t=[t[0],e];this.built=!0},e.prototype.getClassName=function(){return"StackedRNNCells"},e.prototype.getConfig=function(){var e,i,r,n,a,o=[];for(e=0,i=this.cells;e<i.length;e++)r=i[e],o.push({className:this.getClassName(),config:r.getConfig()});return n={cells:o},a=t.prototype.getConfig.call(this),Object.assign(n,a),n},e.fromConfig=function(t,e,i){var r,n,a,o;for(void 0===i&&(i={}),r=[],n=0,a=e.cells;n<a.length;n++)o=a[n],r.push(d.deserialize(o,i));return new t({cells:r})},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){var t,e,i,r;if(!this.trainable)return[];for(t=[],e=0,i=this.cells;e<i.length;e++)r=i[e],t.push.apply(t,r.trainableWeights);return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){var t,e,i,r,n,a,o=[];for(t=0,e=this.cells;t<e.length;t++)i=e[t],o.push.apply(o,i.nonTrainableWeights);if(!this.trainable){for(r=[],n=0,a=this.cells;n<a.length;n++)i=a[n],r.push.apply(r,i.trainableWeights);return r.concat(o)}return o},enumerable:!0,configurable:!0}),e.prototype.getWeights=function(){var t,e,i,r=[];for(t=0,e=this.cells;t<e.length;t++)i=e[t],r.push.apply(r,i.weights);return a.batchGetValue(r)},e.prototype.setWeights=function(t){var e,i,r,n,o,s,l=[];for(e=0,i=this.cells;e<i.length;e++)for(n=(r=i[e]).weights.length,o=t.splice(n),s=0;s<r.weights.length;++s)l.push([r.weights[s],o[s]]);a.batchSetValue(l)},e}(y),e.StackedRNNCells=w,g.ClassNameMap.register("StackedRNNCells",w)},1271:function(t,e,i){"use strict";function r(t,e){return m(this,void 0,void 0,(function(){var i,r,a,o,s,l,c,h;return y(this,(function(g){switch(g.label){case 0:return null!=(i=t.modelTopology).model_config&&(i=i.model_config),r=p.convertPythonicToTs(i),a=u.deserialize(r,e),null==t.weightsManifest?[3,2]:[4,n.loadWeights(t.weightsManifest,t.pathPrefix,a.weights.map((function(t){return t.originalName})))];case 1:for(o=g.sent(),s={},l=0,c=a.weights;l<c.length;l++)h=c[l],s[h.name]=o[h.originalName];a.loadWeights(s,null,!0),g.label=2;case 2:return[2,a]}}))}))}var n,a,o,s,l,u,c,p,h,g,f=this&&this.__extends||(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},function(t,e){function i(){this.constructor=t}g(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),d=this&&this.__decorate||function(t,e,i,r){var n,a,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(a=t.length-1;a>=0;a--)(n=t[a])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},m=this&&this.__awaiter||function(t,e,i,r){return new(i||(i=Promise))((function(n,a){function o(t){try{l(r.next(t))}catch(e){a(e)}}function s(t){try{l(r.throw(t))}catch(e){a(e)}}function l(t){t.done?n(t.value):new i((function(e){e(t.value)})).then(o,s)}l((r=r.apply(t,e||[])).next())}))},y=this&&this.__generator||function(t,e){function i(i){return function(o){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(a=n[2&i[0]?"return":i[0]?"throw":"next"])&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[0,a.value]),i[0]){case 0:case 1:a=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((a=(a=s.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){s.label=i[1];break}if(6===i[0]&&s.label<a[1]){s.label=a[1],a=i;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(i);break}a[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(o){i=[6,o],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}var r,n,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o};Object.defineProperty(e,"__esModule",{value:!0}),n=i(644),a=i(652),o=i(669),s=i(1047),l=i(645),u=i(902),c=i(646),p=i(1266),e.modelFromJSON=r,e.loadModelInternal=function(t){return m(this,void 0,void 0,(function(){var e;return y(this,(function(i){switch(i.label){case 0:return[4,fetch(t)];case 1:return[4,i.sent().json()];case 2:if(null==(e=i.sent()).modelTopology)throw new l.ValueError('Missing field "modelTopology" from model JSON at path'+t);if(null==e.weightsManifest)throw new l.ValueError('Missing field "weightsManifest" from model JSON at path'+t);return e.pathPrefix=t.substring(0,t.lastIndexOf("/")),[2,r(e)]}}))}))},h=function(t){function e(e){var i,r,n,o=t.call(this,{inputs:[],outputs:[]})||this;if(e=e||{},o.trainable=!0,o._updatable=!0,o.built=!1,o.name=null!=e.name?e.name:a.getUid("sequential_"),null!=e.layers)for(i=0,r=e.layers;i<r.length;i++)n=r[i],o.add(n);return o}return f(e,t),i=e,e.prototype.getClassName=function(){return"Sequential"},e.prototype.add=function(t){var e,i;if(0===this.outputs.length){if(0===t.inboundNodes.length){if(null==t.batchInputShape)throw new l.ValueError("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");e=o.Input({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"}),t.apply(e)}if(1!==t.inboundNodes.length)throw new l.ValueError("A layer added to a Sequential model must not already be connected somewhere else. Model received layer "+t.name+" which has "+t.inboundNodes.length+" pre-existing inbound connections.");if(1!==t.inboundNodes[0].outputTensors.length)throw new l.ValueError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=o.getSourceInputs(this.outputs[0]),new o.Node({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:c.pyListRepeat(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((function(t){return t.shape})),outputShapes:this.outputs[0].shape})}else{if(i=t.apply(this.outputs[0]),Array.isArray(i))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.outputs=[i],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1},e.prototype.pop=function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}},e.prototype.call=function(t,e){return null==this.model&&this.build(),this.model.call(t,e)},e.prototype.build=function(t){if(0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new s.Model({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.model.updatable=this.updatable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0},e.prototype.setWeights=function(t){null==this.model&&this.build(),this.model.setWeights(t)},Object.defineProperty(e.prototype,"updatable",{get:function(){return this._updatable},set:function(t){this.built&&(this.model.updatable=t),this._updatable=t},enumerable:!0,configurable:!0}),e.prototype.evaluate=function(t,e,i){if(void 0===i&&(i={}),!this.built)throw new l.RuntimeError("The model needs to be compiled before being used.");return this.model.evaluate(t,e,i)},e.prototype.predict=function(t,e){return void 0===e&&(e={}),null==this.model&&this.build(),this.model.predict(t,e)},e.prototype.predictOnBatch=function(t){return null==this.model&&this.build(),this.model.predictOnBatch(t)},e.prototype.compile=function(t){this.build(),this.model.compile(t),this.optimizer=this.model.optimizer,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames},e.prototype.fit=function(t,e,i){return void 0===i&&(i={}),m(this,void 0,void 0,(function(){return y(this,(function(r){if(!this.built)throw new l.RuntimeError("The model needs to be compiled before being used.");return[2,this.model.fit(t,e,i)]}))}))},e.fromConfig=function(t,e){var r,n,a,o,s=new t({});if(!(s instanceof i))throw new l.ValueError("Sequential.fromConfig called on non-Sequential input: "+s);if(!(e instanceof Array))throw new l.ValueError("Sequential.fromConfig called without an array of configs");if(null==e[0].className||"Merge"===e[0].className)throw new l.ValueError("Legacy serialization format not supported yet.");for(r=0,n=e;r<n.length;r++)a=n[r],o=u.deserialize(a),s.add(o);return s},e.prototype.getConfig=function(){var t,e,i,r=[];for(t=0,e=this.layers;t<e.length;t++)i=e[t],r.push({className:i.getClassName(),config:i.getConfig()});return r},d([n.doc({heading:"Models",subheading:"Classes"})],e.prototype,"add",null),d([n.doc({heading:"Models",subheading:"Classes",configParamIndices:[2]})],e.prototype,"evaluate",null),d([n.doc({heading:"Models",subheading:"Classes",configParamIndices:[1]})],e.prototype,"predict",null),d([n.doc({heading:"Models",subheading:"Classes",configParamIndices:[2]})],e.prototype,"fit",null),i=d([n.doc({heading:"Models",subheading:"Classes"})],e);var i}(s.Model),e.Sequential=h,c.ClassNameMap.register("Sequential",h)},2139:function(t,e,i){!function(t){var e;!function(t,r,n){function a(t){var e,i=this,r=(e=4022871197,function(t){var i,r;for(t=t.toString(),i=0;i<t.length;i++)r=.02519603282416938*(e+=t.charCodeAt(i)),r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e);return 2.3283064365386963e-10*(e>>>0)});i.next=function(){var t=2091639*i.s0+2.3283064365386963e-10*i.c;return i.s0=i.s1,i.s1=i.s2,i.s2=t-(i.c=0|t)},i.c=1,i.s0=r(" "),i.s1=r(" "),i.s2=r(" "),i.s0-=r(t),i.s0<0&&(i.s0+=1),i.s1-=r(t),i.s1<0&&(i.s1+=1),i.s2-=r(t),i.s2<0&&(i.s2+=1),r=null}function o(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function s(t,e){var i=new a(t),r=e&&e.state,n=i.next;return n.int32=function(){return 4294967296*i.next()|0},n.double=function(){return n()+11102230246251565e-32*(2097152*n()|0)},n.quick=n,r&&("object"==typeof r&&o(r,i),n.state=function(){return o(i,{})}),n}r&&r.exports?r.exports=s:i(649)&&i(678)?void 0===(e=s)||(r.exports=e):this.alea=s}(0,t,i(649))}(i(685)(t))},2140:function(t,e,i){!function(t){var e;!function(t,r,n){function a(t){var e,i=this,r="";for(i.x=0,i.y=0,i.z=0,i.w=0,i.next=function(){var t=i.x^i.x<<11;return i.x=i.y,i.y=i.z,i.z=i.w,i.w^=i.w>>>19^t^t>>>8},t===(0|t)?i.x=t:r+=t,e=0;e<r.length+64;e++)i.x^=0|r.charCodeAt(e),i.next()}function o(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function s(t,e){var i=new a(t),r=e&&e.state,n=function(){return(i.next()>>>0)/4294967296};return n.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},n.int32=i.next,n.quick=n,r&&("object"==typeof r&&o(r,i),n.state=function(){return o(i,{})}),n}r&&r.exports?r.exports=s:i(649)&&i(678)?void 0===(e=s)||(r.exports=e):this.xor128=s}(0,t,i(649))}(i(685)(t))},2141:function(t,e,i){!function(t){var e;!function(t,r,n){function a(t){var e,i=this,r="";for(i.next=function(){var t=i.x^i.x>>>2;return i.x=i.y,i.y=i.z,i.z=i.w,i.w=i.v,(i.d=i.d+362437|0)+(i.v=i.v^i.v<<4^t^t<<1)|0},i.x=0,i.y=0,i.z=0,i.w=0,i.v=0,t===(0|t)?i.x=t:r+=t,e=0;e<r.length+64;e++)i.x^=0|r.charCodeAt(e),e==r.length&&(i.d=i.x<<10^i.x>>>4),i.next()}function o(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function s(t,e){var i=new a(t),r=e&&e.state,n=function(){return(i.next()>>>0)/4294967296};return n.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},n.int32=i.next,n.quick=n,r&&("object"==typeof r&&o(r,i),n.state=function(){return o(i,{})}),n}r&&r.exports?r.exports=s:i(649)&&i(678)?void 0===(e=s)||(r.exports=e):this.xorwow=s}(0,t,i(649))}(i(685)(t))},2142:function(t,e,i){!function(t){var e;!function(t,r,n){function a(t){var e=this;e.next=function(){var t,i,r=e.x,n=e.i;return t=r[n],i=(t^=t>>>7)^t<<24,i^=(t=r[n+1&7])^t>>>10,i^=(t=r[n+3&7])^t>>>3,i^=(t=r[n+4&7])^t<<7,t=r[n+7&7],i^=(t^=t<<13)^t<<9,r[n]=i,e.i=n+1&7,i},function(t,e){var i,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,i=0;i<e.length;++i)r[7&i]=r[7&i]<<15^e.charCodeAt(i)+r[i+1&7]<<13;for(;r.length<8;)r.push(0);for(i=0;i<8&&0===r[i];++i);for(8==i?r[7]=-1:r[i],t.x=r,t.i=0,i=256;i>0;--i)t.next()}(e,t)}function o(t,e){return e.x=t.x.slice(),e.i=t.i,e}function s(t,e){null==t&&(t=+new Date);var i=new a(t),r=e&&e.state,n=function(){return(i.next()>>>0)/4294967296};return n.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},n.int32=i.next,n.quick=n,r&&(r.x&&o(r,i),n.state=function(){return o(i,{})}),n}r&&r.exports?r.exports=s:i(649)&&i(678)?void 0===(e=s)||(r.exports=e):this.xorshift7=s}(0,t,i(649))}(i(685)(t))},2143:function(t,e,i){!function(t){var e;!function(t,r,n){function a(t){var e=this;e.next=function(){var t,i,r=e.w,n=e.X,a=e.i;return e.w=r=r+1640531527|0,i=n[a+34&127],t=n[a=a+1&127],i^=i<<13,t^=t<<17,i^=i>>>15,t^=t>>>12,i=n[a]=i^t,e.i=a,i+(r^r>>>16)|0},function(t,e){var i,r,n,a,o,s=[],l=128;for(e===(0|e)?(r=e,e=null):(r=0,l=Math.max(l,(e+="\0").length)),n=0,a=-32;a<l;++a)e&&(r^=e.charCodeAt((a+32)%e.length)),0===a&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(o=o+1640531527|0,n=0==(i=s[127&a]^=r+o)?n+1:0);for(n>=128&&(s[127&(e&&e.length||0)]=-1),n=127,a=512;a>0;--a)r=s[n+34&127],i=s[n=n+1&127],r^=r<<13,i^=i<<17,r^=r>>>15,i^=i>>>12,s[n]=r^i;t.w=o,t.X=s,t.i=n}(e,t)}function o(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function s(t,e){null==t&&(t=+new Date);var i=new a(t),r=e&&e.state,n=function(){return(i.next()>>>0)/4294967296};return n.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},n.int32=i.next,n.quick=n,r&&(r.X&&o(r,i),n.state=function(){return o(i,{})}),n}r&&r.exports?r.exports=s:i(649)&&i(678)?void 0===(e=s)||(r.exports=e):this.xor4096=s}(0,t,i(649))}(i(685)(t))},2144:function(t,e,i){!function(t){var e;!function(t,r,n){function a(t){var e,i=this,r="";for(i.next=function(){var t=i.b,e=i.c,r=i.d,n=i.a;return t=t<<25^t>>>7^e,e=e-r|0,r=r<<24^r>>>8^n,n=n-t|0,i.b=t=t<<20^t>>>12^e,i.c=e=e-r|0,i.d=r<<16^e>>>16^n,i.a=n-t|0},i.a=0,i.b=0,i.c=-1640531527,i.d=1367130551,t===Math.floor(t)?(i.a=t/4294967296|0,i.b=0|t):r+=t,e=0;e<r.length+20;e++)i.b^=0|r.charCodeAt(e),i.next()}function o(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function s(t,e){var i=new a(t),r=e&&e.state,n=function(){return(i.next()>>>0)/4294967296};return n.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},n.int32=i.next,n.quick=n,r&&("object"==typeof r&&o(r,i),n.state=function(){return o(i,{})}),n}r&&r.exports?r.exports=s:i(649)&&i(678)?void 0===(e=s)||(r.exports=e):this.tychei=s}(0,t,i(649))}(i(685)(t))},2145:function(t,e,i){var r;!function(e,n){function a(t,i,r){var a,b,v,z=[];return a=u(l((i=1==i?{entropy:!0}:i||{}).entropy?[t,c(e)]:null==t?function(){var t,i,r;try{return p&&(t=p.randomBytes)?t=t(g):(t=new Uint8Array(g),(h.crypto||h.msCrypto).getRandomValues(t)),c(t)}catch(n){return r=(i=h.navigator)&&i.plugins,[+new Date,h,r,h.screen,c(e)]}}():t,3),z),b=new o(z),(v=function(){for(var t=b.g(6),e=d,i=0;t<m;)t=(t+i)*g,e*=g,i=b.g(1);for(;t>=y;)t/=2,e/=2,i>>>=1;return(t+i)/e}).int32=function(){return 0|b.g(4)},v.quick=function(){return b.g(4)/4294967296},v.double=v,u(c(b.S),e),(i.pass||r||function(t,e,i,r){return r&&(r.S&&s(r,b),t.state=function(){return s(b,{})}),i?(n[f]=t,e):t})(v,a,"global"in i?i.global:this==n,i.state)}function o(t){var e,i=t.length,r=this,n=0,a=r.i=r.j=0,o=r.S=[];for(i||(t=[i++]);n<g;)o[n]=n++;for(n=0;n<g;n++)o[n]=o[a=b&a+t[n%i]+(e=o[n])],o[a]=e;(r.g=function(t){for(var e,i=0,n=r.i,a=r.j,o=r.S;t--;)e=o[n=b&n+1],i=i*g+o[b&(o[n]=o[a=b&a+e])+(o[a]=e)];return r.i=n,r.j=a,i})(g)}function s(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function l(t,e){var i,r=[],n=typeof t;if(e&&"object"==n)for(i in t)try{r.push(l(t[i],e-1))}catch(a){}return r.length?r:"string"==n?t:t+"\0"}function u(t,e){for(var i,r=t+"",n=0;n<r.length;)e[b&n]=b&(i^=19*e[b&n])+r.charCodeAt(n++);return c(e)}function c(t){return String.fromCharCode.apply(0,t)}var p,h=(0,eval)("this"),g=256,f="random",d=n.pow(g,6),m=n.pow(2,52),y=2*m,b=g-1;if(n["seed"+f]=a,u(n.random(),e),t.exports){t.exports=a;try{p=i(2146)}catch(v){}}else void 0===(r=a)||(t.exports=r)}([],Math)},2205:function(t,e,i){"use strict";var r,n,a;Object.defineProperty(e,"__esModule",{value:!0}),r=i(644),n=i(652),a=i(645),e.getOptimizer=function(t){var e={Adagrad:function(){return r.train.adagrad(.01)},Adam:function(){return r.train.adam(.001,.9,.999,n.epsilon())},RMSProp:function(){return r.train.rmsprop(.001,.9,null,n.epsilon())},SGD:function(){return r.train.sgd(.01)}};if(e.adagrad=e.Adagrad,e.adam=e.Adam,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new a.ValueError("Unknown Optimizer "+t)}},2207:function(t,e,i){"use strict";var r,n,a,o,s,l,u,c,p,h,g,f,d,m=this&&this.__extends||(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},function(t,e){function i(){this.constructor=t}d(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),r=i(644),n=i(903),a=i(652),o=i(652),s=i(669),l=i(645),u=i(699),c=i(646),p=function(t){function e(e){var i=t.call(this,null==e?{}:e)||this;return i.DEFAULT_ALPHA=.3,null==e&&(e={}),i.alpha=null==e.alpha?i.DEFAULT_ALPHA:e.alpha,i}return m(e,t),e.prototype.call=function(t,e){var i=c.getExactlyOneTensor(t);return r.leakyRelu(i,this.alpha)},e.prototype.computeOutputShape=function(t){return t},e.prototype.getClassName=function(){return"LeakyReLU"},e.prototype.getConfig=function(){var e={alpha:this.alpha},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},e}(s.Layer),e.LeakyReLU=p,c.ClassNameMap.register("LeakyReLU",p),h=function(t){function e(e){var i=t.call(this,null==e?{}:e)||this;if(i.DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==i.DEFAULT_ALPHA)throw new l.NotImplementedError("Non-default alpha value ("+e.alpha+") is not supported by the ELU layer yet.");return i.alpha=null==e.alpha?i.DEFAULT_ALPHA:e.alpha,i}return m(e,t),e.prototype.call=function(t,e){var i=c.getExactlyOneTensor(t);return r.elu(i)},e.prototype.computeOutputShape=function(t){return t},e.prototype.getClassName=function(){return"ELU"},e.prototype.getConfig=function(){var e={alpha:this.alpha},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},e}(s.Layer),e.ELU=h,c.ClassNameMap.register("ELU",h),g=function(t){function e(e){var i=t.call(this,null==e?{}:e)||this;return i.DEFAULT_THETA=1,null==e&&(e={}),i.theta=null==e.theta?i.DEFAULT_THETA:e.theta,i.thetaTensor=o.getScalar(i.theta),i}return m(e,t),e.prototype.call=function(t,e){var i=c.getExactlyOneTensor(t);return i.mul(a.cast(i.greater(this.thetaTensor),u.DType.float32))},e.prototype.computeOutputShape=function(t){return t},e.prototype.getClassName=function(){return"ThresholdedReLU"},e.prototype.getConfig=function(){var e={theta:this.theta},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},e}(s.Layer),e.ThresholdedReLU=g,c.ClassNameMap.register("ThresholdedReLU",g),f=function(t){function e(e){var i=t.call(this,null==e?{}:e)||this;return i.DEFAULT_AXIS=1,null==e&&(e={}),i.axis=null==e.theta?i.DEFAULT_AXIS:e.theta,i}return m(e,t),e.prototype.call=function(t,e){var i=c.getExactlyOneTensor(t);return n.softmax(i,this.axis)},e.prototype.computeOutputShape=function(t){return t},e.prototype.getClassName=function(){return"Softmax"},e.prototype.getConfig=function(){var e={axis:this.axis},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},e}(s.Layer),e.Softmax=f,c.ClassNameMap.register("Softmax",f)},2208:function(t,e,i){"use strict";var r,n,a,o,s,l,u,c,p,h,g=this&&this.__extends||(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},function(t,e){function i(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),r=i(652),n=i(758),a=i(645),o=i(734),s=i(759),l=i(1049),u=i(646),c=i(646),p=function(t){function e(e){var i=t.call(this,e)||this;return i.depthwiseKernel=null,i.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,i.depthwiseInitializer=o.getInitializer(e.depthwiseInitializer||i.DEFAULT_KERNEL_INITIALIZER),i.depthwiseConstraint=n.getConstraint(e.depthwiseConstraint),i.depthwiseRegularizer=s.getRegularizer(e.depthwiseRegularizer),i}return g(e,t),e.prototype.getClassName=function(){return"DepthwiseConv2D"},e.prototype.build=function(t){var e,i,r;if((t=c.getExactlyOneShape(t)).length<4)throw new a.ValueError("Inputs to DepthwiseConv2D should have rank 4. Received input shape: "+JSON.stringify(t)+".");if(null==t[e="channelsFirst"===this.dataFormat?1:3]||t[e]<0)throw new a.ValueError("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not ("+t[e]+").");i=t[e],r=[this.kernelSize[0],this.kernelSize[1],i,this.depthMultiplier],this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[i*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},e.prototype.call=function(t,e){t=c.getExactlyOneTensor(t);var i=r.depthwiseConv2d(t,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(i=r.biasAdd(i,this.bias.read(),this.dataFormat)),null!=this.activation&&(i=this.activation(i)),i},e.prototype.computeOutputShape=function(t){var e,i,r,n,a;return t=c.getExactlyOneShape(t),e="channelsFirst"===this.dataFormat?t[2]:t[1],i="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,n=l.convOutputLength(e,this.kernelSize[0],this.padding,this.strides[0]),a=l.convOutputLength(i,this.kernelSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],r,n,a]:[t[0],n,a,r]},e}(i(1269).Conv2D),e.DepthwiseConv2D=p,u.ClassNameMap.register("DepthwiseConv2D",p)},2209:function(t,e,i){"use strict";var r,n,a,o,s,l,u,c,p,h,g,f,d,m,y,b,v,z,C=this&&this.__extends||(z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},function(t,e){function i(){this.constructor=t}z(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),r=i(644),n=i(903),a=i(652),o=i(758),s=i(669),l=i(645),u=i(734),c=i(759),p=i(646),h=i(646),g=i(733),f=function(t){function e(e){var i=t.call(this,e)||this;if(i.rate=Math.max(Math.min(e.rate,1),0),i.rateScalar=a.getScalar(i.rate),i.noiseShape=e.noiseShape,i.seed=e.seed,null!=i.seed)throw new l.NotImplementedError("Non-default seed is not implemented in Dropout layer yet: "+i.seed);return i.supportsMasking=!0,i}return C(e,t),e.prototype.getNoiseShape=function(t){var e,i,r;if(null==this.noiseShape)return this.noiseShape;for(e=t.shape,i=[],r=0;r<this.noiseShape.length;++r)i.push(null==this.noiseShape[r]?e[r]:this.noiseShape[r]);return i},e.prototype.call=function(t,e){var i,n,o,s=this;if(this.invokeCallHook(t,e),i=p.getExactlyOneTensor(t),null!=this.noiseShape&&!r.util.arraysEqual(i.shape,this.noiseShape))throw new l.NotImplementedError("Non-default noise shape is not implemented in Dropout layer yet: "+JSON.stringify(this.noiseShape));return 0<this.rate&&this.rate<1?(n=null!=e.training&&e.training,o=this.getNoiseShape(i),a.inTrainPhase((function(){return a.dropout(i,s.rateScalar,o,s.seed)}),(function(){return i}),n)):t},e.prototype.getClassName=function(){return"Dropout"},e.prototype.getConfig=function(){var e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},e}(s.Layer),e.Dropout=f,p.ClassNameMap.register("Dropout",f),d=function(t){function e(e){var i,r=t.call(this,e)||this;return r.activation=null,r.useBias=!0,r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim&&(i=null,null!=e.batchSize&&(i=e.batchSize),r.batchInputShape=[i,e.inputDim]),r.units=e.units,r.activation=n.getActivation(e.activation),null!=e.useBias&&(r.useBias=e.useBias),r.kernelInitializer=u.getInitializer(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=u.getInitializer(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=o.getConstraint(e.kernelConstraint),r.biasConstraint=o.getConstraint(e.biasConstraint),r.kernelRegularizer=c.getRegularizer(e.kernelRegularizer),r.biasRegularizer=c.getRegularizer(e.biasRegularizer),r.activityRegularizer=c.getRegularizer(e.activityRegularizer),r.inputSpec=[{minNDim:2}],r}return C(e,t),e.prototype.build=function(t){var e,i;e=(t=p.getExactlyOneShape(t))[t.length-1],null==this.kernel&&(this.kernel=this.addWeight("kernel",[e,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(i={},i[-1]=e,i)}],this.built=!0},e.prototype.computeOutputShape=function(t){var e=(t=p.getExactlyOneShape(t)).slice();return e[e.length-1]=this.units,e},e.prototype.call=function(t,e){var i,r;return this.invokeCallHook(t,e),i=p.getExactlyOneTensor(t),r=a.dot(i,this.kernel.read()),null!=this.bias&&(r=a.biasAdd(r,this.bias.read())),null!=this.activation&&(r=this.activation(r)),r},e.prototype.getClassName=function(){return"Dense"},e.prototype.getConfig=function(){var e={units:this.units,activation:n.serializeActivation(this.activation),useBias:this.useBias,kernelInitializer:u.serializeInitializer(this.kernelInitializer),biasInitializer:u.serializeInitializer(this.biasInitializer),kernelRegularizer:c.serializeRegularizer(this.kernelRegularizer),biasRegularizer:c.serializeRegularizer(this.biasRegularizer),activityRegularizer:c.serializeRegularizer(this.activityRegularizer),kernelConstraint:o.serializeConstraint(this.kernelConstraint),biasConstraint:o.serializeConstraint(this.biasConstraint)},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},e}(s.Layer),e.Dense=d,p.ClassNameMap.register("Dense",d),m=function(t){function e(e){var i=t.call(this,e||{})||this;return i.inputSpec=[{minNDim:3}],i}return C(e,t),e.prototype.computeOutputShape=function(t){var e,i;for(e=0,i=(t=p.getExactlyOneShape(t)).slice(1);e<i.length;e++)if(null==i[e])throw new l.ValueError('The shape of the input to "Flatten" is not fully defined (got '+t.slice(1)+'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.');return[t[0],g.arrayProd(t,1)]},e.prototype.getClassName=function(){return"Flatten"},e.prototype.call=function(t,e){return this.invokeCallHook(t,e),a.batchFlatten(p.getExactlyOneTensor(t))},e}(s.Layer),e.Flatten=m,p.ClassNameMap.register("Flatten",m),y=function(t){function e(e){var i=t.call(this,e)||this;return i.supportsMasking=!0,i.activation=n.getActivation(e.activation),i}return C(e,t),e.prototype.getClassName=function(){return"Activation"},e.prototype.call=function(t,e){this.invokeCallHook(t,e);var i=p.getExactlyOneTensor(t);return this.activation(i)},e}(s.Layer),e.Activation=y,p.ClassNameMap.register("Activation",y),b=function(t){function e(e){var i=t.call(this,e)||this;return i.n=e.n,i.inputSpec=[{ndim:2}],i}return C(e,t),e.prototype.computeOutputShape=function(t){return[t[0],this.n,t[1]]},e.prototype.call=function(t,e){return t=h.getExactlyOneTensor(t),a.repeat(t,this.n)},e.prototype.getClassName=function(){return"RepeatVector"},e.prototype.getConfig=function(){var e={n:this.n},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},e}(s.Layer),e.RepeatVector=b,p.ClassNameMap.register("RepeatVector",b),v=function(t){function e(e){var i,r=t.call(this,e)||this;for(r.targetShape=e.targetShape,i=0;i<r.targetShape.length;++i)r.isUnknown(r.targetShape[i])&&(r.targetShape[i]=null);return r}return C(e,t),e.prototype.isUnknown=function(t){return t<0||null==t},e.prototype.fixUnknownDimension=function(t,e){var i,r,n,a="Total size of new array must be unchanged.",o=e.slice(),s=1,u=null;for(i=0;i<o.length;++i)if(r=o[i],this.isUnknown(r)){if(null!==u)throw new l.ValueError("Can only specifiy one unknown dimension.");u=i}else s*=r;if(n=g.arrayProd(t),null!==u){if(0===s||n%s!=0)throw new l.ValueError(a);o[u]=n/s}else if(n!==s)throw new l.ValueError(a);return o},e.prototype.computeOutputShape=function(t){var e,i=!1;for(e=0;e<t.length;++e)if(this.isUnknown(t[e])){i=!0;break}return i?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))},e.prototype.getClassName=function(){return"Reshape"},e.prototype.call=function(t,e){var i,r,n;return this.invokeCallHook(t,e),i=p.getExactlyOneTensor(t),n=(r=a.shape(i)).slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape)),a.reshape(i,n)},e}(s.Layer),e.Reshape=v,p.ClassNameMap.register("Reshape",v)},2210:function(t,e,i){"use strict";var r,n,a,o,s,l,u,c,p,h,g=this&&this.__extends||(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},function(t,e){function i(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),r=i(652),n=i(758),a=i(669),o=i(645),s=i(734),l=i(759),u=i(646),c=i(646),p=function(t){function e(e){var i,r=t.call(this,e)||this;return r.embeddings=null,r.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape&&(i=null,null!=e.batchSize&&(i=e.batchSize),null==e.inputLength?r.batchInputShape=[i,null]:r.batchInputShape=[i].concat(u.toList(e.inputLength))),r.inputDim=e.inputDim,r.outputDim=e.outputDim,r.embeddingsInitializer=s.getInitializer(e.embeddingsInitializer||r.DEFAULT_EMBEDDINGS_INITIALIZER),r.embeddingsRegularizer=l.getRegularizer(e.embeddingsRegularizer),r.activityRegularizer=l.getRegularizer(e.activityRegularizer),r.embeddingsConstraint=n.getConstraint(e.embeddingsConstraint),r.maskZero=e.maskZero,r.inputLength=e.inputLength,r}return g(e,t),e.prototype.build=function(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0},e.prototype.computeMask=function(t,e){throw new o.NotImplementedError("computeMask has not been implemented for Embedding yet")},e.prototype.computeOutputShape=function(t){var e,i,r,n,a;if(t=u.getExactlyOneShape(t),null==this.inputLength)return t.concat([this.outputDim]);if((e=u.toList(this.inputLength)).length!==t.length-1)throw new o.ValueError('"inputLength" is '+this.inputLength+", but received input shape has shape "+t);for(i=0,r=0;r<e.length;++r){if(n=e[r],a=t[r+1],null!=n&&null!=a&&n!==a)throw new o.ValueError('"inputLength" is '+this.inputLength+", but received input shape has shape "+t);null==n&&(e[i]=a),i++}return[t[0]].concat(e,[this.outputDim])},e.prototype.call=function(t,e){var i,n;return this.invokeCallHook(t,e),i=u.getExactlyOneTensor(t),"int32"!==r.dtype(i)&&(i=r.cast(i,"int32")),n=r.gather(this.embeddings.read(),i.as1D()),r.reshape(n,c.getExactlyOneShape(this.computeOutputShape(i.shape)))},e.prototype.getClassName=function(){return"Embedding"},e.prototype.getConfig=function(){var e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:s.serializeInitializer(this.embeddingsInitializer),embeddingsRegularizer:l.serializeRegularizer(this.embeddingsRegularizer),activityRegularizer:l.serializeRegularizer(this.activityRegularizer),embeddingsConstraint:n.serializeConstraint(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},e}(a.Layer),e.Embedding=p,u.ClassNameMap.register("Embedding",p)},2211:function(t,e,i){"use strict";var r,n,a,o,s,l,u,c,p,h,g,f,d,m,y=this&&this.__extends||(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},function(t,e){function i(){this.constructor=t}m(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),r=i(644),n=i(652),a=i(669),o=i(645),s=i(646),l=i(733),u=function(t){function e(e){var i=t.call(this,e||{})||this;return i.supportsMasking=!0,i}return y(e,t),e.prototype.getClassName=function(){return"Merge"},e.prototype.mergeFunction=function(t){throw new o.NotImplementedError},e.prototype.computeElementwiseOpOutputShape=function(t,e){var i,r,n,a;if(null==t||null==e)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(0===e.length)return t;for(i=t.slice(0,t.length-e.length),r=0;r<e.length;++r)if(n=t[t.length-e.length+r],a=e[r],null==n||null==a||n<0||a<0)i.push(null);else if(1===n)i.push(a);else if(1===a)i.push(n);else{if(n!==a)throw new o.ValueError("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));i.push(n)}return i},e.prototype.build=function(t){var e,i,r,n,a,l,u;if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[s.getExactlyOneShape(t)]),t.length<2)throw new o.ValueError("A merge layer should be called on an Array of at least 2 inputs. Got "+t.length+" input(s).");for(e=[],i=0,r=t;i<r.length;i++)null!=(n=r[i])&&null!==n[0]&&e.push(n[0]);if((e=s.unique(e)).length>1)throw new o.ValueError("Can not merge tensors with different batch sizes. Got tensors with shapes: "+JSON.stringify(t)+".");for(a=null==t[0]?null:t[0].slice(1),l=1;l<t.length;++l)n=null==t[l]?null:t[l].slice(1),a=this.computeElementwiseOpOutputShape(a,n);u=t.map((function(t){return t.length})),-1===t.indexOf(null)&&1===s.unique(u).length?this.reshapeRequired=!1:this.reshapeRequired=!0},e.prototype.call=function(t,e){var i,r,a,o,s,u,c,p,h,g,f,d,m,y,b,v,z,C,I;if(this.reshapeRequired){if(i=[],-1===(r=t.map((function(t){return n.ndim(t)}))).indexOf(null)){for(a=l.max(r),o=0,s=t;o<s.length;o++){for(u=s[o],c=n.ndim(u),p=0;p<a-c;++p)u=n.expandDims(u,1);i.push(u)}return this.mergeFunction(i)}for(h=!1,g=0,f=t;g<f.length;g++)u=f[g],null==(c=n.ndim(u))?(m=(d=n.shape(u))[0],y=d.slice(1).concat([m]),b=n.reshape(u,[m].concat(l.arrayProd(d.slice(1)))),b=n.permuteDimensions(b,[1,0]),b=n.reshape(b,y),i.push(b),h=!0):c>1?(v=l.range(1,c).concat([0]),i.push(n.permuteDimensions(u,v)),h=!0):i.push(u);return z=this.mergeFunction(i),C=n.ndim(z),h&&(null==C?(y=[m=(I=n.shape(z))[I.length-1]].concat(I.slice(0,I.length-1)),z=n.reshape(n.permuteDimensions(n.reshape(z,[-1,m]),[1,0]),y)):C>1&&(v=[C-1].concat(l.range(0,C-1)),z=n.permuteDimensions(z,v))),z}return this.mergeFunction(t)},e.prototype.computeOutputShape=function(t){var e,i,r,n,a,o;for(e=null==t[0]?null:t[0].slice(1),i=1;i<t.length;++i)r=null==t[i]?null:t[i].slice(1),e=this.computeElementwiseOpOutputShape(e,r);for(n=[],a=0,o=t;a<o.length;a++)null!=(r=o[a])&&null!==r[0]&&n.push(r[0]);return 1===(n=s.unique(n)).length?n.concat(e):[null].concat(e)},e}(a.Layer),e.Merge=u,c=function(t){function e(e){return t.call(this,e)||this}return y(e,t),e.prototype.getClassName=function(){return"Add"},e.prototype.mergeFunction=function(t){var e,i,r,a=n.zeros(t[0].shape);for(e=0,i=t;e<i.length;e++)r=i[e],a=n.add(a,r);return a},e}(u),e.Add=c,s.ClassNameMap.register("Add",c),e.add=function(t){return Array.isArray(t)?new c({}).apply(t):new c(t)},p=function(t){function e(e){return t.call(this,e)||this}return y(e,t),e.prototype.getClassName=function(){return"Multiply"},e.prototype.mergeFunction=function(t){var e,i,r,a=n.ones(t[0].shape);for(e=0,i=t;e<i.length;e++)r=i[e],a=n.multiply(a,r);return a},e}(u),e.Multiply=p,s.ClassNameMap.register("Multiply",p),e.multiply=function(t){return Array.isArray(t)?new p({}).apply(t):new p(t)},h=function(t){function e(e){return t.call(this,e)||this}return y(e,t),e.prototype.getClassName=function(){return"Average"},e.prototype.mergeFunction=function(t){var e,i,r,a=n.zeros(t[0].shape);for(e=0,i=t;e<i.length;e++)r=i[e],a=n.add(a,r);return n.scalarTimesArray(n.getScalar(1/t.length),a)},e}(u),e.Average=h,s.ClassNameMap.register("Average",h),e.average=function(t){return Array.isArray(t)?new h({}).apply(t):new h(t)},g=function(t){function e(e){return t.call(this,e)||this}return y(e,t),e.prototype.getClassName=function(){return"Maximum"},e.prototype.mergeFunction=function(t){var e,i=t[0];for(e=1;e<t.length;++e)i=n.maximum(i,t[e]);return i},e}(u),e.Maximum=g,s.ClassNameMap.register("Maximum",g),e.maximum=function(t){return Array.isArray(t)?new g({}).apply(t):new g(t)},f=function(t){function e(e){return t.call(this,e)||this}return y(e,t),e.prototype.getClassName=function(){return"Minimum"},e.prototype.mergeFunction=function(t){var e,i=t[0];for(e=1;e<t.length;++e)i=n.minimum(i,t[e]);return i},e}(u),e.Minimum=f,s.ClassNameMap.register("Minimum",f),e.minimum=function(t){return Array.isArray(t)?new f({}).apply(t):new f(t)},d=function(t){function e(e){var i=t.call(this,e)||this;return i.DEFAULT_AXIS=-1,null==e&&(e={}),i.axis=null==e.axis?i.DEFAULT_AXIS:e.axis,i.supportsMasking=!0,i.reshapeRequired=!1,i}return y(e,t),e.prototype.getClassName=function(){return"Concatenate"},e.prototype.build=function(t){var e,i,n,a,s,l,u,c,p,h;if(!Array.isArray(t)||!Array.isArray(t[0])||1===t.length)throw new o.ValueError("A `Concatenate` layer should be called on a list of at least 2 inputs");for(e=!0,i=0,n=t;i<n.length;i++)if(null!=(a=n[i])){e=!1;break}if(!e){for(s=[],l=0;l<t.length;++l){for((u=t[l].slice()).splice(this.axis,1),c=!1,p=0,h=s;p<h.length;p++)if(a=h[p],r.util.arraysEqual(a,u)){c=!0;break}c||s.push(u)}if(s.length>1)throw new o.ValueError("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}},e.prototype.mergeFunction=function(t){return n.concatenate(t,this.axis)},e.prototype.computeOutputShape=function(t){var e,i,r,n,a,s;if(!Array.isArray(t)||!Array.isArray(t[0]))throw new o.ValueError("A `Concatenate` layer should be called on a list of inputs.");for(i=(e=t)[0].slice(),r=this.axis<0?i.length+this.axis:this.axis,n=0,a=e.slice(1);n<a.length;n++){if(s=a[n],null==i[r]||null==s[r]){i[r]=null;break}i[r]+=s[r]}return i},e}(u),e.Concatenate=d,s.ClassNameMap.register("Concatenate",d),e.concatenate=function(t){return Array.isArray(t)?new d({}).apply(t):new d(t)}},2212:function(t,e,i){"use strict";var r,n,a,o,s,l,u,c,p,h,g,f=this&&this.__extends||(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},function(t,e){function i(){this.constructor=t}g(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),r=i(644),n=i(652),a=i(758),o=i(669),s=i(645),l=i(734),u=i(759),c=i(646),p=i(733),h=function(t){function e(e){var i=t.call(this,e)||this;return i.supportsMasking=!0,i.axis=null==e.axis?-1:e.axis,i.momentum=null==e.momentum?.99:e.momentum,i.epsilon=null==e.epsilon?.001:e.epsilon,i.center=null==e.center||e.center,i.scale=null==e.scale||e.scale,i.betaInitializer=l.getInitializer(e.betaInitializer||"zeros"),i.gammaInitializer=l.getInitializer(e.gammaInitializer||"ones"),i.movingMeanInitializer=l.getInitializer(e.movingMeanInitializer||"zeros"),i.movingVarianceInitializer=l.getInitializer(e.movingVarianceInitializer||"ones"),i.betaConstraint=a.getConstraint(e.betaConstraint),i.gammaConstraint=a.getConstraint(e.gammaConstraint),i.betaRegularizer=u.getRegularizer(e.betaRegularizer),i.gammaRegularizer=u.getRegularizer(e.gammaRegularizer),i.stepCount=0,i}return f(e,t),e.prototype.build=function(t){var e,i,r,n;if(null==(i=(t=c.getExactlyOneShape(t))[e=this.axis>=0?this.axis:this.axis+t.length]))throw new s.ValueError("Axis "+e+" of input tensor should have a defined dimension but the layer received an input with shape "+JSON.stringify(t)+".");this.inputSpec=[new o.InputSpec({ndim:t.length,axes:(n={},n[e]=i,n)})],r=[i],this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0},e.prototype.call=function(t,e){var i=this;return r.tidy((function(){var a,o,s,l,u,h,g,f,d,m,y,b,v,z,C,I=null!=e.training&&e.training,A=c.getExactlyOneTensor(t),w=n.shape(A),S=w.length,R=p.range(0,S),N=i.axis>=0?i.axis:i.axis+S;return R.splice(N,1),(a=c.pyListRepeat(1,S))[N]=w[N],(o=R.slice()).sort(),s=!r.util.arraysEqual(o,p.range(0,S).slice(0,S-1)),I?(u=(l=n.normalizeBatchInTraining(A,i.gamma.read(),i.beta.read(),R,i.epsilon))[0],h=l[1],g=l[2],f=p.arrayProd(R.map((function(t){return A.shape[t]}))),d=g.mul(n.getScalar(f/(f-(1+i.epsilon)))),i.stepCount++,z=r.movingAverage(i.movingMean.read(),h,i.momentum,i.stepCount),i.movingMean.write(z),C=r.movingAverage(i.movingVariance.read(),d,i.momentum,i.stepCount),i.movingVariance.write(C),u):s?(m=n.reshape(i.movingMean.read(),a),y=n.reshape(i.movingVariance.read(),a),b=i.center?n.reshape(i.beta.read(),a):null,v=i.scale?n.reshape(i.gamma.read(),a):null,n.batchNormalization(A,m,y,b,v,i.epsilon)):n.batchNormalization(A,i.movingMean.read(),i.movingVariance.read(),null==i.beta?null:i.beta.read(),null==i.gamma?null:i.gamma.read(),i.epsilon)}))},e.prototype.getClassName=function(){return"BatchNormalization"},e.prototype.getConfig=function(){var e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:l.serializeInitializer(this.betaInitializer),gammaInitializer:l.serializeInitializer(this.gammaInitializer),movingMeanInitializer:l.serializeInitializer(this.movingMeanInitializer),movingVarianceInitializer:l.serializeInitializer(this.movingVarianceInitializer),betaRegularizer:u.serializeRegularizer(this.betaRegularizer),gammaRegularizer:u.serializeRegularizer(this.gammaRegularizer),betaConstraint:a.serializeConstraint(this.betaConstraint),gammaConstraint:a.serializeConstraint(this.gammaConstraint)},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},e}(o.Layer),e.BatchNormalization=h,c.ClassNameMap.register("BatchNormalization",h)},2213:function(t,e,i){"use strict";var r,n,a,o,s,l,u,c=this&&this.__extends||(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},function(t,e){function i(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),r=i(1046),n=i(652),a=i(669),o=i(645),s=i(646),l=function(t){function e(e){var i,n,s=this;if(null==e&&(e={}),(s=t.call(this,e)||this).dataFormat=null==e.dataFormat?r.imageDataFormat():e.dataFormat,null==e.padding)s.padding=[[1,1],[1,1]];else if("number"==typeof e.padding)s.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new o.ValueError("ZeroPadding2D expects padding to be a length-2 array, but received a length-"+e.padding.length+" array.");if(i=void 0,n=void 0,"number"==typeof e.padding[0])i=[e.padding[0],e.padding[0]],n=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new o.ValueError("ZeroPadding2D expects height padding to be a length-2 array, but received a length-"+e.padding[0].length+" array.");if(i=e.padding[0],2!==e.padding[1].length)throw new o.ValueError("ZeroPadding2D expects width padding to be a length-2 array, but received a length-"+e.padding[1].length+" array.");n=e.padding[1]}s.padding=[i,n]}return s.inputSpec=[new a.InputSpec({ndim:4})],s}return c(e,t),e.prototype.computeOutputShape=function(t){var e,i;return t=s.getExactlyOneShape(t),"channelsFirst"===this.dataFormat?(e=null!=t[2]&&t[2]>=0?t[2]+this.padding[0][0]+this.padding[0][1]:null,i=null!=t[3]&&t[3]>=0?t[3]+this.padding[1][0]+this.padding[1][1]:null,[t[0],t[1],e,i]):(e=null!=t[1]&&t[1]>=0?t[1]+this.padding[0][0]+this.padding[0][1]:null,i=null!=t[2]&&t[2]>=0?t[2]+this.padding[1][0]+this.padding[1][1]:null,[t[0],e,i,t[3]])},e.prototype.call=function(t,e){return n.spatial2dPadding(s.getExactlyOneTensor(t),this.padding,this.dataFormat)},e.prototype.getClassName=function(){return"ZeroPadding2D"},e.prototype.getConfig=function(){var e={padding:this.padding,dataFormat:this.dataFormat},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},e}(a.Layer),e.ZeroPadding2D=l,s.ClassNameMap.register("ZeroPadding2D",l)},2214:function(t,e,i){"use strict";var r,n,a,o,s,l,u,c,p,h,g,f,d,m,y,b,v,z,C,I,A=this&&this.__extends||(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},function(t,e){function i(){this.constructor=t}I(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),r=i(652),n=i(830),a=i(669),o=i(669),s=i(645),l=i(1049),u=i(646),c=function(t){function e(e){var i=this;return null==e.poolSize&&(e.poolSize=2),(i=t.call(this,e)||this).poolSize=[e.poolSize],i.strides=null==e.strides?i.poolSize:[e.strides],i.padding=null==e.padding?"valid":e.padding,n.checkPaddingMode(i.padding),i.inputSpec=[new a.InputSpec({ndim:3})],i}return A(e,t),e.prototype.computeOutputShape=function(t){return t=u.getExactlyOneShape(t),length=l.convOutputLength(t[1],this.poolSize[0],this.padding,this.strides[0]),[t[0],length,t[2]]},e.prototype.call=function(t,e){this.invokeCallHook(t,e),t=r.expandDims(u.getExactlyOneTensor(t),2);var i=this.poolingFunction(u.getExactlyOneTensor(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return r.squeeze(i,2)},e.prototype.getConfig=function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},e}(o.Layer),e.Pooling1D=c,p=function(t){function e(e){return t.call(this,e)||this}return A(e,t),e.prototype.getClassName=function(){return"MaxPooling1D"},e.prototype.poolingFunction=function(t,e,i,a,o){return n.checkDataFormat(o),n.checkPaddingMode(a),r.pool2d(t,e,i,a,o,"max")},e}(c),e.MaxPooling1D=p,u.ClassNameMap.register("MaxPooling1D",p),h=function(t){function e(e){return t.call(this,e)||this}return A(e,t),e.prototype.getClassName=function(){return"AveragePooling1D"},e.prototype.poolingFunction=function(t,e,i,a,o){return n.checkDataFormat(o),n.checkPaddingMode(a),r.pool2d(t,e,i,a,o,"avg")},e}(c),e.AveragePooling1D=h,u.ClassNameMap.register("AveragePooling1D",h),g=function(t){function e(e){var i=this;return null==e.poolSize&&(e.poolSize=[2,2]),(i=t.call(this,e)||this).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],i.strides=null==e.strides?i.poolSize:e.strides,i.padding=null==e.padding?"valid":e.padding,i.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,n.checkDataFormat(i.dataFormat),n.checkPaddingMode(i.padding),i.inputSpec=[new a.InputSpec({ndim:4})],i}return A(e,t),e.prototype.computeOutputShape=function(t){var e,i;return t=u.getExactlyOneShape(t),e="channelsFirst"===this.dataFormat?t[2]:t[1],i="channelsFirst"===this.dataFormat?t[3]:t[2],e=l.convOutputLength(e,this.poolSize[0],this.padding,this.strides[0]),i=l.convOutputLength(i,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,i]:[t[0],e,i,t[3]]},e.prototype.call=function(t,e){return this.invokeCallHook(t,e),this.poolingFunction(u.getExactlyOneTensor(t),this.poolSize,this.strides,this.padding,this.dataFormat)},e.prototype.getConfig=function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},e}(o.Layer),e.Pooling2D=g,f=function(t){function e(e){return t.call(this,e)||this}return A(e,t),e.prototype.getClassName=function(){return"MaxPooling2D"},e.prototype.poolingFunction=function(t,e,i,a,o){return n.checkDataFormat(o),n.checkPaddingMode(a),r.pool2d(t,e,i,a,o,"max")},e}(g),e.MaxPooling2D=f,u.ClassNameMap.register("MaxPooling2D",f),d=function(t){function e(e){return t.call(this,e)||this}return A(e,t),e.prototype.getClassName=function(){return"AveragePooling2D"},e.prototype.poolingFunction=function(t,e,i,a,o){return n.checkDataFormat(o),n.checkPaddingMode(a),r.pool2d(t,e,i,a,o,"avg")},e}(g),e.AveragePooling2D=d,u.ClassNameMap.register("AveragePooling2D",d),m=function(t){function e(e){var i=t.call(this,e)||this;return i.inputSpec=[new a.InputSpec({ndim:3})],i}return A(e,t),e.prototype.computeOutputShape=function(t){return[t[0],t[2]]},e.prototype.call=function(t,e){throw new s.NotImplementedError},e}(o.Layer),e.GlobalPooling1D=m,y=function(t){function e(e){return t.call(this,e)||this}return A(e,t),e.prototype.getClassName=function(){return"GlobalAveragePooling1D"},e.prototype.call=function(t,e){var i=u.getExactlyOneTensor(t);return r.mean(i,1)},e}(m),e.GlobalAveragePooling1D=y,u.ClassNameMap.register("GlobalAveragePooling1D",y),b=function(t){function e(e){return t.call(this,e)||this}return A(e,t),e.prototype.getClassName=function(){return"GlobalMaxPooling1D"},e.prototype.call=function(t,e){var i=u.getExactlyOneTensor(t);return r.max(i,1)},e}(m),e.GlobalMaxPooling1D=b,u.ClassNameMap.register("GlobalMaxPooling1D",b),v=function(t){function e(e){var i=t.call(this,e)||this;return i.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,n.checkDataFormat(i.dataFormat),i.inputSpec=[new a.InputSpec({ndim:4})],i}return A(e,t),e.prototype.computeOutputShape=function(t){return"channelsLast"===this.dataFormat?[t[0],t[3]]:[t[0],t[1]]},e.prototype.call=function(t,e){throw new s.NotImplementedError},e.prototype.getConfig=function(){var e={dataFormat:this.dataFormat},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},e}(o.Layer),e.GlobalPooling2D=v,z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return A(e,t),e.prototype.call=function(t,e){var i=u.getExactlyOneTensor(t);return"channelsLast"===this.dataFormat?r.mean(i,[1,2]):r.mean(i,[2,3])},e.prototype.getClassName=function(){return"GlobalAveragePooling2D"},e}(v),e.GlobalAveragePooling2D=z,u.ClassNameMap.register("GlobalAveragePooling2D",z),C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return A(e,t),e.prototype.call=function(t,e){var i=u.getExactlyOneTensor(t);return"channelsLast"===this.dataFormat?r.max(i,[1,2]):r.max(i,[2,3])},e.prototype.getClassName=function(){return"GlobalMaxPooling2D"},e}(v),e.GlobalMaxPooling2D=C,u.ClassNameMap.register("GlobalMaxPooling2D",C)},2215:function(t,e,i){"use strict";var r,n,a,o,s,l,u,c,p,h,g=this&&this.__extends||(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},function(t,e){function i(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),r=i(652),n=i(669),a=i(645),o=i(646),s=i(902),l=function(t){function e(e){var i=t.call(this,e)||this;return i.layer=e.layer,i}return g(e,t),e.prototype.build=function(t){this.built=!0},Object.defineProperty(e.prototype,"trainable",{get:function(){return null!=this.layer&&this.layer.trainable},set:function(t){null!=this.layer&&(this.layer.trainable=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.layer.trainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.layer.nonTrainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updates",{get:function(){return this.layer._updates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"losses",{get:function(){return this.layer.losses},enumerable:!0,configurable:!0}),e.prototype.getWeights=function(){return this.layer.getWeights()},e.prototype.setWeights=function(t){this.layer.setWeights(t)},e.prototype.getConfig=function(){var e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},i=t.prototype.getConfig.call(this);return Object.assign(e,i),e},e.fromConfig=function(t,e,i){var r,n,a;return void 0===i&&(i={}),r=e.layer,n=s.deserialize(r,i),delete e.layer,Object.assign(a={layer:n},e),new t(a)},e}(n.Layer),e.Wrapper=l,u=function(t){function e(e){var i=t.call(this,e)||this;return i.supportsMasking=!0,i}return g(e,t),e.prototype.build=function(e){if((e=o.getExactlyOneShape(e)).length<3)throw new a.ValueError("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(e));this.inputSpec=[{shape:e}];var i=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(i),this.layer.built=!0),t.prototype.build.call(this,e)},e.prototype.computeOutputShape=function(t){var e,i,r;return e=[(t=o.getExactlyOneShape(t))[0]].concat(t.slice(2)),i=this.layer.computeOutputShape(e),r=t[1],[i[0],r].concat(i.slice(1))},e.prototype.call=function(t,e){var i,n=this;return t=o.getExactlyOneTensor(t),i=function(t,i){return[n.layer.call(t,e),[]]},r.rnn(i,t,[],!1,null,null,!1,t.shape[1])[1]},e.prototype.getClassName=function(){return"TimeDistributed"},e}(l),e.TimeDistributed=u,o.ClassNameMap.register("TimeDistributed",u),function(t){t[t.SUM=0]="SUM",t[t.MUL=1]="MUL",t[t.CONCAT=2]="CONCAT",t[t.AVE=3]="AVE"}(c=e.BidirectionalMergeMode||(e.BidirectionalMergeMode={})),o.SerializableEnumRegistry.register("merge_mode",{sum:c.SUM,mul:c.MUL,concat:c.CONCAT,ave:c.AVE}),p=function(t){function e(e){var i,r=t.call(this,e)||this;if(r.forwardLayer=e.layer,(i=e.layer.getConfig()).goBackwards=!0!==i.goBackwards,r.backwardLayer=s.deserialize({className:e.layer.getClassName(),config:i}),r.forwardLayer.name="forward_"+r.forwardLayer.name,r.backwardLayer.name="backward_"+r.backwardLayer.name,r.mergeMode=e.mergeMode,e.weights)throw new a.NotImplementedError("weights support is not implemented for Bidirectional layer yet.");return r._stateful=e.layer.stateful,r.returnSequences=e.layer.returnSequences,r.returnState=e.layer.returnState,r.supportsMasking=!0,r._trainable=!0,r.inputSpec=e.layer.inputSpec,r}return g(e,t),Object.defineProperty(e.prototype,"trainable",{get:function(){return this._trainable},set:function(t){this._trainable=t,null!=this.forwardLayer&&(this.forwardLayer.trainable=t),null!=this.backwardLayer&&(this.backwardLayer.trainable=t)},enumerable:!0,configurable:!0}),e.prototype.getWeights=function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())},e.prototype.setWeights=function(t){var e=t.length,i=Math.floor(e/2);this.forwardLayer.setWeights(t.slice(0,i)),this.backwardLayer.setWeights(t.slice(i))},e.prototype.computeOutputShape=function(t){var e,i,r,n=this.forwardLayer.computeOutputShape(t);return Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),this.returnState?(r=n.slice(1),e=n[0]):e=n[0],this.mergeMode===c.CONCAT?(e[e.length-1]*=2,i=[e]):i=null==this.mergeMode?[e,e.slice()]:[e],this.returnState?null==this.mergeMode?i.concat(r).concat(r.slice()):[e].concat(r).concat(r.slice()):o.singletonOrArray(i)},e.prototype.apply=function(e,i){var r=null;if(null!=i&&(r=i.initialState),Array.isArray(e)&&(r=e.slice(1),e=e[0]),null==r||0===r.length)return t.prototype.apply.call(this,e,i);throw new a.NotImplementedError("The support for initial states is not implemented for Bidirectional layers yet.")},e.prototype.call=function(t,e){var i,n,o,s;if(null!=e.mask)throw new a.NotImplementedError("The support for masking is not implemented for Bidirectional layers yet.");if(null!=e.initialState)throw new a.NotImplementedError("The support for initial states is not implemented for Bidirectional layers yet.");return i=this.forwardLayer.call(t,e),n=this.backwardLayer.call(t,e),this.returnState&&(Array.isArray(i)&&(o=i.slice(1).concat(n.slice(1))),i=i[0],n=n[0]),this.returnSequences&&(n=r.reverse(n,1)),this.mergeMode===c.CONCAT?s=r.concatenate([i,n]):this.mergeMode===c.SUM?s=r.add(i,n):this.mergeMode===c.AVE?s=r.scalarTimesArray(r.getScalar(.5),r.add(i,n)):this.mergeMode===c.MUL?s=r.multiply(i,n):null==this.mergeMode&&(s=[i,n]),this.returnState?null==this.mergeMode?s.concat(o):[s].concat(o):s},e.prototype.resetStates=function(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()},e.prototype.build=function(t){var e=this;r.nameScope(this.forwardLayer.name,(function(){e.forwardLayer.build(t)})),r.nameScope(this.backwardLayer.name,(function(){e.backwardLayer.build(t)})),this.built=!0},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)},enumerable:!0,configurable:!0}),e.prototype.getClassName=function(){return"Bidirectional"},e}(l),e.Bidirectional=p,o.ClassNameMap.register("Bidirectional",p)},2216:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.version="0.5.3"},2217:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.version="0.10.3"},646:function(t,e,i){"use strict";function r(t){return Array.isArray(t)?t:[t]}function n(t,e){return t<e?-1:t>e?1:0}var a,o,s,l,u,c=this&&this.__assign||Object.assign||function(t){var e,i,r,n;for(i=1,r=arguments.length;i<r;i++)for(n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t};Object.defineProperty(e,"__esModule",{value:!0}),a=i(645),o=i(699),e.pyListRepeat=function(t,e){var i,r;if(Array.isArray(t)){for(i=[],r=0;r<e;r++)i=i.concat(t);return i}return(i=Array(e)).fill(t),i},e.pyGetAttr=function(t,e,i){if(e in t)return t[e];if(void 0===i)throw new a.AttributeError("pyGetAttr: Attempting to get attribute "+e+"with no default value defined");return i},e.pyNormalizeArrayIndex=function(t,e){if(null==t||null==e)throw new a.ValueError("Must provide a valid array and index for pyNormalizeArrayIndex(). Got array "+t+" and index "+e+".");var i="Index "+e+" out of range for array of length "+t.length;if(e<0){if(e<-t.length)throw new a.IndexError(i);return t.length+e}if(e>=t.length)throw new a.IndexError(i);return e},e.assert=function(t,e){if(!t)throw new a.AssertionError(e)},e.count=function(t,e){var i,r,n=0;for(i=0,r=t;i<r.length;i++)r[i]===e&&n++;return n},s=function(){function t(){this.pythonClassNameMap={}}return t.getMap=function(){return null==t.instance&&(t.instance=new t),t.instance},t.register=function(t,e){this.getMap().pythonClassNameMap[t]=[e,e.fromConfig]},t}(),e.ClassNameMap=s,l=function(){function t(){this.enumRegistry={}}return t.getMap=function(){return null==t.instance&&(t.instance=new t),t.instance},t.register=function(e,i){if(t.contains(e))throw new a.ValueError("Attempting to register a repeated enum: "+e);this.getMap().enumRegistry[e]=i},t.contains=function(t){return t in this.getMap().enumRegistry},t.lookup=function(t,e){return this.getMap().enumRegistry[t][e]},t.reverseLookup=function(t,e){var i,r=this.getMap().enumRegistry[t];for(i in r)if(r[i]===e)return i;throw new a.ValueError("Could not find serialization string for "+e)},t}(),e.SerializableEnumRegistry=l,e.singletonOrArray=function(t){return 1===t.length?t[0]:t},e.toList=r,e.objectListUid=function(t){var e,i,n,o="";for(e=0,i=r(t);e<i.length;e++){if(null==(n=i[e]).id)throw new a.ValueError("Object "+n+" passed to objectListUid without an id");""!==o&&(o+=", "),o+=Math.abs(n.id)}return o},e.isArrayOfShapes=function(t){return Array.isArray(t)&&Array.isArray(t[0])},e.normalizeShapeList=function(t){return 0===t.length?[]:Array.isArray(t[0])?t:[t]},e.toSnakeCase=function(t){var e=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==e[0]?e:"private"+e},e.toCamelCase=function(t){return t.length<=1||-1===t.indexOf("_")?t:t.replace(/[_]+(\w|$)/g,(function(t,e){return e.toUpperCase()}))},u={},e.serializeKerasObject=function(t){return null==t?null:{className:t.getClassName(),config:t.getConfig()}},e.deserializeKerasObject=function(t,e,i,r){var n,o,s,l,p,h,g,f,d,m,y,b,v,z,C,I,A,w,S,R,N;if(void 0===e&&(e={}),void 0===i&&(i={}),void 0===r&&(r="object"),"string"==typeof t){if(o=void 0,(n=t)in i)o=i[n];else if(n in u)o=u[n];else if(null==(o=e[n]))throw new a.ValueError("Unknown "+r+": "+t);return o}if(null==(s=t).className||null==s.config)throw new a.ValueError(r+": Improper config format: "+JSON.stringify(s)+".\n'className' and 'config' must set.");if(p=void 0,h=void 0,(l=s.className)in i?(p=(S=i.get(l))[0],h=S[1]):l in u?(p=(R=u.className)[0],h=R[1]):l in e&&(p=(N=e[l])[0],h=N[1]),null==p)throw new a.ValueError("Unknown "+r+": "+l);if(null!=h){for(g={},f=0,d=Object.keys(u);f<d.length;f++)g[m=d[f]]=u[m];for(y=0,b=Object.keys(i);y<b.length;y++)g[m=b[y]]=i[m];for(s.config.customObjects=g,v=c({},u),z=0,C=Object.keys(i);z<C.length;z++)m=C[z],u[m]=i[m];return I=h(p,s.config),u=c({},v),I}for(v=c({},u),A=0,w=Object.keys(i);A<w.length;A++)m=w[A],u[m]=i[m];return I=new p(s.config),u=c({},v),I},e.getExactlyOneTensor=function(t){var e;if(Array.isArray(t)){if(1!==t.length)throw new a.ValueError("Expected Tensor length to be 1; got "+t.length);e=t[0]}else e=t;return e},e.getExactlyOneShape=function(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(1===t.length)return t[0];throw new a.ValueError("Expected exactly 1 Shape; got "+t.length)}return t},e.numberCompare=n,e.reverseNumberCompare=function(t,e){return-1*n(t,e)},e.stringToDType=function(t){if("float32"===t)return o.DType.float32;throw new a.ValueError("Invalid dtype: "+t)},e.stringsEqual=function(t,e){if(null==t||null==e)return t===e;if(t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0},e.unique=function(t){var e,i,r,n;if(null==t)return t;for(e=[],i=0,r=t;i<r.length;i++)n=r[i],-1===e.indexOf(n)&&e.push(n);return e},e.isObjectEmpty=function(t){if(null==t)throw new a.ValueError("Invalid value in obj: "+JSON.stringify(t));for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}},699:function(t,e,i){"use strict";function r(t){return t instanceof u?t.value():t}var n,a,o,s,l,u,c,p,h,g=this&&this.__decorate||function(t,e,i,r){var n,a,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(a=t.length-1;a>=0;a--)(n=t[a])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(e,"__esModule",{value:!0}),n=i(644),a=i(830),function(t){t.float32="float32",t.int32="int32",t.bool="bool"}(o=e.DType||(e.DType={})),s=0,l=g([n.doc({heading:"Models",subheading:"Classes"})],(function(t,e,i,r,n,o,l){this.dtype=t,this.shape=e,this.sourceLayer=i,this.inputs=r,this.callArgs=n,this.outputTensorIndex=l,this.id=s++,null!=o&&(this.originalName=a.getScopedTensorName(o),this.name=a.getUniqueTensorName(this.originalName))})),e.SymbolicTensor=l,u=function(){function t(t,e){this.dtype=o.float32,this.shape=t.shape,this.val=t,this.id=s++,null!=e&&(this.originalName=a.getScopedTensorName(e),this.name=a.getUniqueTensorName(this.originalName))}return t.prototype.value=function(){return this.val},t}(),e.ConcreteTensor=u,c="Variable",p=function(){function t(t,e,i,l,u){void 0===e&&(e=o.float32),void 0===i&&(i=c),void 0===l&&(l=!0),void 0===u&&(u=null),this.dtype=null==e?o.float32:e,this.shape=t.shape,this.id=s++,i=null==i?c:i,this.originalName=a.getScopedTensorName(i),this.name=a.getUniqueTensorName(this.originalName),this.trainable=l,this.constraint=u,this.val=n.variable(r(t),this.trainable,this.name,this.dtype)}return t.prototype.read=function(){return this.val},t.prototype.write=function(t){return function(t,e){if(t.shape.toString()!==e.shape.toString())throw Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}(this.val,t),this.val.assign(r(t)),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val)),this},t}(),e.LayerVariable=p,h=function(){},e.Serializable=h},711:function(t,e,i){"use strict";function r(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}var n,a,o;Object.defineProperty(e,"__esModule",{value:!0}),r(i(644)),r(i(1265)),n=i(644),a=i(1265),o=i(2217),e.version={"tfjs-core":n.version_core,"tfjs-layers":a.version_layers,tfjs:o.version}},733:function(t,e,i){"use strict";function r(t){return t=Array.isArray(t)?new Float32Array(t):t,s.tensor1d(t)}function n(t){return o.sum(r(t)).dataSync()[0]}function a(t){return n(t)/t.length}var o,s,l;Object.defineProperty(e,"__esModule",{value:!0}),o=i(644),s=i(644),l=i(645),e.isInteger=function(t){return t===parseInt(t.toString(),10)},e.arrayProd=function(t,e,i){var r,n;for(null==e&&(e=0),null==i&&(i=t.length),r=1,n=e;n<i;++n)r*=t[n];return r},e.min=function(t){return o.min(r(t)).dataSync()[0]},e.max=function(t){return o.max(r(t)).dataSync()[0]},e.sum=n,e.mean=a,e.variance=function(t){var e=o.sub(r(t),s.scalar(a(t)));return o.sum(o.mulStrict(e,e)).dataSync()[0]/t.length},e.range=function(t,e){var i,r;if(e<t)throw new l.ValueError("end ("+e+") < begin ("+t+") is forbidden.");for(i=[],r=t;r<e;++r)i.push(r);return i}},734:function(t,e,i){"use strict";function r(t){if(null!=t&&e.VALID_FAN_MODE_VALUES.indexOf(t)<0)throw new u.ValueError(t+" is not a valid FanMode.  Valid values as "+e.VALID_FAN_MODE_VALUES)}function n(t){if(null!=t&&e.VALID_DISTRIBUTION_VALUES.indexOf(t)<0)throw new u.ValueError(t+" is not a valid Distribution.  Valid values as "+e.VALID_DISTRIBUTION_VALUES)}function a(t,e){return void 0===e&&(e={}),p.deserializeKerasObject(t,p.ClassNameMap.getMap().pythonClassNameMap,e,"initializer")}var o,s,l,u,c,p,h,g,f,d,m,y,b,v,z,C,I,A,w,S,R,N,E=this&&this.__extends||(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},function(t,e){function i(){this.constructor=t}N(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),_=this&&this.__decorate||function(t,e,i,r){var n,a,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(a=t.length-1;a>=0;a--)(n=t[a])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(e,"__esModule",{value:!0}),o=i(644),s=i(652),l=i(830),u=i(645),c=i(699),p=i(646),h=i(733),p.SerializableEnumRegistry.register("mode",{fan_in:"fanIn",fan_out:"fanOut",fan_avg:"fanAvg"}),e.VALID_FAN_MODE_VALUES=["fanIn","fanOut","fanAvg",void 0,null],e.checkFanMode=r,p.SerializableEnumRegistry.register("distribution",{normal:"normal",uniform:"uniform"}),e.VALID_DISTRIBUTION_VALUES=["normal","uniform",void 0,null],e.checkDistribution=n,g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.fromConfig=function(t,e){return new t(e)},e.prototype.fromConfigUsesCustomObjects=function(){return!1},e.prototype.getConfig=function(){return{}},_([o.doc({heading:"Initializers",subheading:"Classes",namespace:"initializers"})],e)}(c.Serializable),e.Initializer=g,f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.getClassName=function(){return"Zeros"},e.prototype.apply=function(t,e){return s.zeros(t,e)},e}(g),e.Zeros=f,p.ClassNameMap.register("Zeros",f),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.getClassName=function(){return"Ones"},e.prototype.apply=function(t,e){return s.ones(t,e)},e}(g),e.Ones=d,p.ClassNameMap.register("Ones",d),m=function(t){function e(e){var i=t.call(this)||this;return i.value=e.value,i}return E(e,t),e.prototype.apply=function(t,e){return s.scalarTimesArray(o.scalar(this.value),s.ones(t,e))},e.prototype.getClassName=function(){return"Constant"},e.prototype.getConfig=function(){return{value:this.value}},e}(g),e.Constant=m,p.ClassNameMap.register("Constant",m),y=function(t){function e(e){var i=t.call(this)||this;return i.DEFAULT_MINVAL=-.05,i.DEFAULT_MAXVAL=.05,i.minval=e.minval||i.DEFAULT_MINVAL,i.maxval=e.maxval||i.DEFAULT_MAXVAL,i.seed=e.seed,i}return E(e,t),e.prototype.apply=function(t,e){return s.randomUniform(t,this.minval,this.maxval,e,this.seed)},e.prototype.getClassName=function(){return"RandomUniform"},e.prototype.getConfig=function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}},e}(g),e.RandomUniform=y,p.ClassNameMap.register("RandomUniform",y),b=function(t){function e(e){var i=t.call(this)||this;return i.DEFAULT_MEAN=0,i.DEFAULT_STDDEV=.05,i.mean=e.mean||i.DEFAULT_MEAN,i.stddev=e.stddev||i.DEFAULT_STDDEV,i.seed=e.seed,i}return E(e,t),e.prototype.apply=function(t,e){return s.randomNormal(t,this.mean,this.stddev,e,this.seed)},e.prototype.getClassName=function(){return"RandomNormal"},e.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},e}(g),e.RandomNormal=b,p.ClassNameMap.register("RandomNormal",b),v=function(t){function e(e){var i=t.call(this)||this;return i.DEFAULT_MEAN=0,i.DEFAULT_STDDEV=.05,i.mean=e.mean||i.DEFAULT_MEAN,i.stddev=e.stddev||i.DEFAULT_STDDEV,i.seed=e.seed,i}return E(e,t),e.prototype.apply=function(t,e){return s.truncatedNormal(t,this.mean,this.stddev,e,this.seed)},e.prototype.getClassName=function(){return"TruncatedNormal"},e.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},e}(g),e.TruncatedNormal=v,p.ClassNameMap.register("TruncatedNormal",v),z=function(t){function e(e){var i=t.call(this)||this;return i.gain=null!=e.gain?o.scalar(e.gain):s.getScalar(1),i}return E(e,t),e.prototype.apply=function(t,e){if(2!==t.length||t[0]!==t[1])throw new u.ValueError("Identity matrix initializer can only be used for 2D square matrices.");return s.scalarTimesArray(this.gain,s.eye(t[0]))},e.prototype.getClassName=function(){return"Identity"},e.prototype.getConfig=function(){return{gain:this.gain.get()}},e}(g),e.Identity=z,p.ClassNameMap.register("Identity",z),C=function(t){function e(e){var i=t.call(this)||this;if(e.scale<0)throw new u.ValueError("scale must be a positive float. Got: "+e.scale);return i.scale=null==e.scale?1:e.scale,i.mode=e.mode,r(i.mode),i.distribution=e.distribution,n(i.distribution),i.seed=e.seed,i}return E(e,t),e.prototype.apply=function(t,e){var i,r,n=function(t,e){var i,r,n,a;return void 0===e&&(e="channelsLast"),l.checkDataFormat(e),2===t.length?(i=t[0],r=t[1]):-1!==[3,4,5].indexOf(t.length)?"channelsFirst"===e?(n=h.arrayProd(t,2),i=t[1]*n,r=t[0]*n):"channelsLast"===e&&(n=h.arrayProd(t,0,t.length-2),i=t[t.length-2]*n,r=t[t.length-1]*n):(a=h.arrayProd(t),i=Math.sqrt(a),r=Math.sqrt(a)),[i,r]}(t),a=n[0],o=n[1],u=this.scale;return"fanIn"===this.mode?u/=Math.max(1,a):"fanOut"===this.mode?u/=Math.max(1,o):u/=Math.max(1,(a+o)/2),"normal"===this.distribution?(i=Math.sqrt(u),s.truncatedNormal(t,0,i,e,this.seed)):(r=Math.sqrt(3*u),s.randomUniform(t,-r,r,e,this.seed))},e.prototype.getClassName=function(){return"VarianceScaling"},e.prototype.getConfig=function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}},e}(g),e.VarianceScaling=C,p.ClassNameMap.register("VarianceScaling",C),I=function(t){function e(e){return t.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:e.seed})||this}return E(e,t),e}(C),e.GlorotUniform=I,p.ClassNameMap.register("GlorotUniform",I),A=function(t){function e(e){return t.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:e.seed})||this}return E(e,t),e}(C),e.GlorotNormal=A,p.ClassNameMap.register("GlorotNormal",A),w=function(t){function e(e){return t.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:e.seed})||this}return E(e,t),e}(C),e.HeNormal=w,p.ClassNameMap.register("HeNormal",w),S=function(t){function e(e){return t.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:e.seed})||this}return E(e,t),e}(C),e.LeCunNormal=S,p.ClassNameMap.register("LeCunNormal",S),R=function(t){function e(e){var i=t.call(this)||this;if(i.DEFAULT_GAIN=1,i.gain=null==e.gain?i.DEFAULT_GAIN:e.gain,i.seed=e.seed,null!=i.seed)throw new u.NotImplementedError("Random seed is not implemented for Orthogonal Initializer yet.");return i}return E(e,t),e.prototype.apply=function(t,e){var i,r,n;if(2!==t.length)throw new u.NotImplementedError("The Orthogonal Initializer does not support non-2D shapes yet.");return i=t[0]>=t[1]?t:[t[1],t[0]],r=s.randomNormal(i,0,1,c.DType.float32),(n=s.qr(r)[0]).shape[1]>i[1]&&(n=n.slice([0,0],i)),t[0]<t[1]&&(n=n.transpose()),s.scalarTimesArray(s.getScalar(this.gain),n)},e.prototype.getClassName=function(){return"Orthogonal"},e.prototype.getConfig=function(){return{gain:this.gain,seed:this.seed}},e}(g),e.Orthogonal=R,p.ClassNameMap.register("Orthogonal",R),e.INITIALIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",identity:"Identity",leCunNormal:"LeCunNormal",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"},e.serializeInitializer=function(t){return p.serializeKerasObject(t)},e.getInitializer=function(t){return"string"==typeof t?a({className:t in e.INITIALIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP?e.INITIALIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP[t]:t,config:{}}):t instanceof g?t:a(t)}},759:function(t,e,i){"use strict";function r(t,e){return void 0===e&&(e={}),s.deserializeKerasObject(t,s.ClassNameMap.getMap().pythonClassNameMap,e,"regularizer")}var n,a,o,s,l,u,c,p=this&&this.__extends||(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},function(t,e){function i(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),h=this&&this.__decorate||function(t,e,i,r){var n,a,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(a=t.length-1;a>=0;a--)(n=t[a])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(e,"__esModule",{value:!0}),n=i(644),a=i(652),o=i(699),s=i(646),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(o.Serializable),e.Regularizer=l,u=function(t){function e(e){var i=t.call(this)||this,r=null==e||null==e.l1?.01:e.l1,n=null==e||null==e.l2?.01:e.l2;return i.hasL1=0!==r,i.hasL2=0!==n,i.l1=a.getScalar(r),i.l2=a.getScalar(n),i}return p(e,t),i=e,e.prototype.apply=function(t){var e=n.zeros([1]);return this.hasL1&&(e=a.add(e,a.sum(a.scalarTimesArray(this.l1,a.abs(t))))),this.hasL2&&(e=a.add(e,a.sum(a.scalarTimesArray(this.l2,a.square(t))))),e.asScalar()},e.prototype.getClassName=function(){return"L1L2"},e.prototype.getConfig=function(){return{l1:this.l1.dataSync()[0],l2:this.l2.dataSync()[0]}},e.fromConfig=function(t,e){return new i({l1:e.l1,l2:e.l2})},i=h([n.doc({heading:"Regularizers",namespace:"regularizers"})],e);var i}(l),e.L1L2=u,s.ClassNameMap.register("L1L2",u),e.l1=function(t){return new u({l1:null!=t?t.l1:null,l2:0})},e.l2=function(t){return new u({l2:null!=t?t.l2:null,l1:0})},e.REGULARIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP={l1l2:"L1L2"},e.serializeRegularizer=function(t){return s.serializeKerasObject(t)},e.deserializeRegularizer=r,e.getRegularizer=function(t){return null==t?null:"string"==typeof t?r({className:t in e.REGULARIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP?e.REGULARIZER_IDENTIFIER_REGISTRY_SYMBOL_MAP[t]:t,config:{}}):t instanceof l?t:r(t)}},902:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(646);e.deserialize=function(t,e){return void 0===e&&(e={}),r.deserializeKerasObject(t,r.ClassNameMap.getMap().pythonClassNameMap,e,"layer")}}}]);